"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[162],{32162:function(e,n,t){t.r(n),t.d(n,{default:function(){return F}});var s=t(57437),l=t(2265),a=t(22079),i=t(40851),r=t(6093),o=t(46776),d=t(85269),c=t(33533),H=t(8088),M=t(96507),x=t(70812),u=t(67248),h=t(33457),C=t(41637);let m=()=>{let{m2i:e}=(0,C.tc)().user,n=(0,l.useMemo)(()=>e.columns.map(e=>({accessorKey:e,header:e,size:150})),[e]),t=(0,l.useRef)(null),[a,i]=(0,l.useState)([]),[r,o]=(0,l.useState)(!0),[d,c]=(0,l.useState)([]);(0,l.useEffect)(()=>{{let n=dfd.toJSON(e);i(n),o(!1)}},[e]),(0,l.useEffect)(()=>{try{var e,n;null===(n=t.current)||void 0===n||null===(e=n.scrollToIndex)||void 0===e||e.call(n,0)}catch(e){console.error(e)}},[d]);let H=(0,h.X0)({columns:n,data:a,defaultDisplayColumn:{enableResizing:!0},enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnResizing:!0,enableColumnVirtualization:!0,enableGlobalFilterModes:!0,enablePagination:!1,enableColumnPinning:!0,enableRowNumbers:!1,enableRowVirtualization:!0,muiTableContainerProps:{sx:{maxHeight:"378px"}},onSortingChange:c,state:{isLoading:r,sorting:d},rowVirtualizerInstanceRef:t,rowVirtualizerOptions:{overscan:5},columnVirtualizerOptions:{overscan:2}});return(0,s.jsx)(M.Z,{sx:{mt:3},children:(0,s.jsx)(h.P2,{table:H})})},p=e=>{let{id:n,label:t,value:a,setAnnParams:i,options:r}=e;return(0,s.jsx)(M.Z,{sx:{display:"flex",justifyContent:"center",mt:3},children:(0,s.jsx)(x.Z,{id:"virtualize-demo",sx:{width:300},disableListWrap:!0,value:a,onChange:(e,t)=>{i(e=>({...e,[n]:t})),"ionCol"==n&&i(e=>({...e,ionValPos:null,ionValNeg:null}))},options:r,renderInput:e=>(0,s.jsx)(u.Z,{...e,label:t}),renderOption:(e,n)=>(0,l.createElement)("li",{...e,key:n.id},n.label),isOptionEqualToValue:(e,n)=>e.id===n.id})})};var j=function(e){let{annParams:n,setAnnParams:t}=e,{m2i:a}=(0,C.tc)().user,i=(0,l.useMemo)(()=>a.columns.map(e=>({id:e,label:e})),[a]),r=[];return null!==n.ionCol&&(r=(r=[...new Set(a.column(n.ionCol.id).values)]).map(e=>({id:e,label:e}))),(0,s.jsxs)(M.Z,{sx:{display:"flex",justifyContent:"space-evenly"},children:[(0,s.jsxs)(M.Z,{sx:{width:"25%"},children:[(0,s.jsx)(d.Z,{variant:"h6",sx:{textAlign:"center"},children:"Set Columns"}),(0,s.jsx)(p,{id:"mzCol",label:"m/z Column",value:n.mzCol,setAnnParams:t,options:i}),(0,s.jsx)(p,{id:"rtCol",label:"Retention Time Column",value:n.rtCol,setAnnParams:t,options:i}),(0,s.jsx)(p,{id:"ionCol",label:"Ionisation Mode Column",value:n.ionCol,setAnnParams:t,options:i}),(0,s.jsxs)(M.Z,{sx:{visibility:null===n.ionCol?"hidden":"visible",opacity:null===n.ionCol?0:1,transition:"all 1s ease"},children:[(0,s.jsx)(p,{id:"ionValPos",label:"Positive Ion Value",value:n.ionValPos,setAnnParams:t,options:r}),(0,s.jsx)(p,{id:"ionValNeg",label:"Negative Ion Value",value:n.ionValNeg,setAnnParams:t,options:r})]})]}),(0,s.jsxs)(M.Z,{sx:{width:"70%"},children:[(0,s.jsx)(d.Z,{variant:"h6",sx:{textAlign:"center"},children:"Metabolomic Metadata"}),(0,s.jsx)(m,{})]})]})},P=t(54986),N=t(27400),b=t(88444),A=t(65984),O=t(8323);let Z=e=>{let{name:n,attr:t,setAnnParams:a,annParams:i}=e,[r,o]=(0,l.useState)(!1),d="rgba(255,255,255,1)";return(r||i[t].includes(n))&&(d="rgba(0,0,0,0.2)"),(0,s.jsx)(M.Z,{sx:{px:2,py:.5,mx:.5,my:.5,backgroundColor:d,border:"1px solid rgba(0,0,0,0.1)",borderRadius:2,userSelect:"none",cursor:"pointer",transition:"all 1s ease"},onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),onClick:()=>{i[t].includes(n)?a(e=>({...e,[t]:i[t].filter(e=>e!=n)})):a(e=>({...e,[t]:[...i[t],n]}))},children:n})},g=["M+H","M+2H","M+Na","M+K","M+NH4","M+H-H2O","M+H+NH4","2M+H","2M+Na","M+H+HCOONa","2M+H-H2O","M+3H","M+2H+Na","M+H+2K","M+H+2Na","M+3Na","M+H+Na","M+H+K","M+ACN+2H","M+2Na","M+2ACN+2H","M+3ACN+2H","M+CH3OH+H","M+ACN+H","M+2Na-H","M+IsoProp+H","M+ACN+Na","M+2K-H","M+DMSO+H","M+2ACN+H","M+IsoProp+Na+H","2M+NH4","2M+K","2M+ACN+H","2M+ACN+Na","3M+H","3M+Na","M+H-2H2O","M+NH4-H2O","M+Li","2M+2H+3H2O","M+H+CH3COOH","M+H+CH3COONa","M+F+H"],v=["M-H","M+Cl","M+HCOOH-H","M-H-H2O","M-H+HCOONa","M-H+CH3COONa","2M-H","M-3H","M-2H","M+Na-2H","M+K-2H","M+CH3COOH-H","M+Br","M+TFA-H","2M+HCOOH-H","2M+CH3COOH-H","3M-H","M+F","M+F+H"];var f=function(e){let{annParams:n,setAnnParams:t}=e;return(0,s.jsxs)(M.Z,{children:[(0,s.jsxs)(M.Z,{sx:{display:"block",textAlign:"center",alignItems:"center",justifyContent:"center"},children:[(0,s.jsx)(M.Z,{children:(0,s.jsx)(d.Z,{variant:"h6",children:"Tolerance (ppm)"})}),(0,s.jsx)(M.Z,{sx:{mt:2},children:(0,s.jsx)(u.Z,{sx:{width:80},id:"filled-number",label:"Number",type:"number",value:n.mzError,InputProps:{inputProps:{min:1}},onChange:e=>t(n=>({...n,mzError:e.target.value})),InputLabelProps:{shrink:!0}})})]}),(0,s.jsxs)(M.Z,{sx:{display:"flex",justifyContent:"space-evenly",textAlign:"center",mt:4},children:[(0,s.jsxs)(M.Z,{sx:{width:"70%"},children:[(0,s.jsx)(d.Z,{variant:"h6",children:"Positive Adducts"}),(0,s.jsx)(N.Z,{control:(0,s.jsx)(b.Z,{checked:g.every(e=>n.posAdd.includes(e)),onChange:()=>{g.every(e=>n.posAdd.includes(e))?t(e=>({...e,posAdd:[]})):t(e=>({...e,posAdd:g}))},inputProps:{"aria-label":"controlled"}}),label:"Select All"})]}),(0,s.jsxs)(M.Z,{sx:{width:"30%"},children:[(0,s.jsx)(d.Z,{variant:"h6",children:"Negative Adducts"}),(0,s.jsx)(N.Z,{control:(0,s.jsx)(b.Z,{checked:v.every(e=>n.negAdd.includes(e)),onChange:()=>{v.every(e=>n.negAdd.includes(e))?t(e=>({...e,negAdd:[]})):t(e=>({...e,negAdd:v}))},inputProps:{"aria-label":"controlled"}}),label:"Select all"})]})]}),(0,s.jsxs)(M.Z,{sx:{display:"flex",justifyContent:"space-evenly",textAlign:"center",mt:2},children:[(0,s.jsx)(M.Z,{sx:{width:"65%"},children:(0,s.jsx)(A.Z,{variant:"outlined",children:(0,s.jsx)(O.Z,{children:(0,s.jsx)(M.Z,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"space-evenly"},children:g.map(e=>(0,s.jsx)(Z,{name:e,attr:"posAdd",setAnnParams:t,annParams:n},e))})})})}),(0,s.jsx)(M.Z,{sx:{width:"29%"},children:(0,s.jsx)(A.Z,{variant:"outlined",children:(0,s.jsx)(O.Z,{children:(0,s.jsx)(M.Z,{sx:{display:"flex",flexWrap:"wrap",justifyContent:"space-evenly"},children:v.map(e=>(0,s.jsx)(Z,{name:e,attr:"negAdd",setAnnParams:t,annParams:n},e))})})})})]})]})},y=t(46022),w=t(90158);t(45353),(0,w.t9)();let S=[["PC","M+HCOOH-H"],["PC","M+Cl"],["PE","M-H"],["PE","M-H+HCOONa"],["PS","M-H"],["PG","M-H"],["PG","M-H+HCOONa"],["PI","M-H"],["PI","M-H+HCOONa"],["PA","M-H"],["PA","M-H+HCOONa"],["LPC","M+HCOOH-H"],["LPC","M+Cl"],["LPE","M-H"],["LPE","M-H+HCOONa"],["LPS","M-H"],["LPS","M-2H-Na"],["LPG","M-H"],["LPG","M-H+HCOONa"],["LPI","M-H"],["LPI","M-H+HCOONa"],["SM","M+HCOOH-H"],["SM","M+Cl"],["Cer","M+HCOOH-H"],["Cer","M+Cl"],["Cer","M-H"],["FAHFA","M-H"],["FAHFA","M+HCOOH-H"],["FA","M-H"],["FA","M-H-H2O"],["ST","M-H"],["ST","M-H-H2O"],["ST","M+HCOOH-H"]],T=[["PC","M+H"],["PC","M+Na"],["PC","M+K"],["PE","M+H"],["PE","M+Na"],["PG","M+NH4"],["PI","M+NH4"],["PA","M+NH4"],["LPC","M+H"],["LPC","M+Na"],["LPC","M+H-H2O"],["LPC","M+K"],["LPE","M+H"],["LPE","M+H-H2O"],["LPE","M+Na"],["SM","M+H"],["SM","M+Na"],["SM","M+K"],["SM","M+H-H2O"],["Cer","M+H-H2O"],["Cer","M+H"],["Cer","M+Na"],["Cer","M+K"],["Cholesterol","M+H-H2O"],["Cholesterol","M+NH4"],["CE","M+NH4"],["MG","M+NH4"],["MG","M+H"],["MG","M+Na"],["DG","M+NH4"],["DG","M+H-H2O"],["DG","M+Na"],["DG","M+H"],["TG","M+NH4"],["TG","M+Na"],["CAR","M+H"],["CAR","M+Na"],["FAHFA","M+NH4"],["FAHFA","M+H"],["FAHFA","M+H-H2O"],["FA","M+H"],["FA","M+H-H2O"],["ST","M+H"],["ST","M+H-H2O"]];var R=function(e){let{name:n,attr:t,annParams:l,setAnnParams:a}=e;return(0,s.jsxs)(M.Z,{sx:{textAlign:"center"},children:[(0,s.jsx)(d.Z,{variant:"h6",children:n}),(0,s.jsxs)(M.Z,{sx:{display:"flex",justifyContent:"space-evenly",mt:2},children:[(0,s.jsxs)(M.Z,{sx:{width:"30%"},children:[(0,s.jsx)(M.Z,{children:(0,s.jsx)(d.Z,{variant:"body",children:"Metabolite Retention Time Window"})}),(0,s.jsx)(M.Z,{sx:{mt:2},children:(0,s.jsx)(u.Z,{sx:{width:80},id:"filled-number",label:"Number",type:"number",step:.1,InputProps:{inputProps:{min:0}},value:l["mRtW".concat(t)],onChange:e=>a(n=>({...n,["mRtW".concat(t)]:e.target.value})),InputLabelProps:{shrink:!0}})})]}),(0,s.jsxs)(M.Z,{sx:{width:"30%"},children:[(0,s.jsx)(M.Z,{children:(0,s.jsx)(d.Z,{variant:"body",children:"Lipid Retention Time Window"})}),(0,s.jsx)(M.Z,{sx:{mt:2},children:(0,s.jsx)(u.Z,{sx:{width:80},id:"filled-number",label:"Number",type:"number",step:.1,InputProps:{inputProps:{min:0}},value:l["lRtW".concat(t)],onChange:e=>a(n=>({...n,["lRtW".concat(t)]:e.target.value})),InputLabelProps:{shrink:!0}})})]})]}),(0,s.jsxs)(M.Z,{sx:{mt:4},children:[(0,s.jsx)(d.Z,{variant:"body",children:"Lipid Class and Possible Adducts"}),(0,s.jsx)(M.Z,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,s.jsx)(y.sZ,{data:l["lipidAdd".concat(t)],rowHeaders:!0,colHeaders:["Lipid","Adduct"],height:400,width:250,licenseKey:"non-commercial-and-evaluation",contextMenu:{callback:function(e,n,t){console.log("Selected option:",e)},items:{row_above:{name:"Insert row above this one"},row_below:{name:"Insert row below this one"},remove_row:{name:"Remove this row"}},zIndex:5e3}})})]})]})},E=t(42568),L=function(e){let{showButton:n,onAnnotate:t}=e,[a,i]=(0,l.useState)(!1),r=a?"rgba(255,0,0,0.4)":"rgba(255,0,0,0.2)";return r=n?r:"rgba(0,0,0,0.10)",(0,s.jsx)(M.Z,{sx:{position:"sticky",height:0,width:0,top:10,left:"85%",zIndex:100,margin:"right",transition:"all 0.5s ease",userSelect:"none"},children:(0,s.jsx)(A.Z,{sx:{backgroundColor:r,transition:"all 1s ease",cursor:n?"pointer":"not-allowed",width:150,height:60,textAlign:"center",px:1,py:1},onMouseEnter:e=>i(!0),onMouseLeave:e=>i(!1),onClick:()=>n&&t(),children:(0,s.jsxs)(M.Z,{sx:{display:"flex",justifyContent:"space-evenly"},children:[(0,s.jsx)(M.Z,{children:(0,s.jsx)(d.Z,{gutterBottom:!0,variant:"h7",component:"div",children:"Annotate Features"})}),(0,s.jsx)(M.Z,{sx:{py:1},children:(0,s.jsx)(E.Z,{})})]})})})},I=t(11093),k=function(e){let{setPage:n,setCreatingJob:t,setAnnotating:a}=e,{API_URL:i}=(0,I.S)(),{jobID:r}=(0,C.tc)(),o=(0,C.Lq)(),[d,c]=(0,l.useState)({mzCol:null,rtCol:null,ionCol:null,ionValPos:null,ionValNeg:null,mzError:5,posAdd:["M+H","M+2H","M+Na","M+K","M+H-H2O","M+H+HCOONa","M+NH4"],negAdd:["M-H","M-2H","M-H+HCOONa","M+Na-2H","M+Cl","M-H-H2O"],mRtWPos:.1,lRtWPos:2,mRtWNeg:.1,lRtWNeg:2,lipidAddPos:T,lipidAddNeg:S,status:"waiting"});return(0,s.jsxs)(M.Z,{children:[(0,s.jsx)(L,{showButton:d.mzCol&&d.rtCol&&d.ionCol&&(d.ionValPos&&d.posAdd.length>0||d.ionValNeg&&d.negAdd.length>0),onAnnotate:()=>{if(!(d.mzError>0)||!(d.mRtWPos>0)||!(d.lRtWPos>0)||!(d.mRtWNeg>0)||!(d.lRtWNeg>0)){window.alert("Error! Please check number fields");return}fetch("".concat(i,"/post_ann_params/").concat(r),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),o({type:"set-ann-params",annParams:d}),a(!0),t(""),n("results")}}),(0,s.jsxs)(M.Z,{sx:{mt:2},children:[(0,s.jsx)(j,{annParams:d,setAnnParams:c}),(0,s.jsx)(P.Z,{sx:{mt:4,mb:4},children:"PUTATIVE ANNOTATIONS PARAMETERS (CMM)"}),(0,s.jsx)(f,{annParams:d,setAnnParams:c}),(0,s.jsx)(P.Z,{sx:{mt:4,mb:4},children:"TURBOPUTATIVE PARAMETERS (TPMetrics)"}),(0,s.jsxs)(M.Z,{sx:{display:"flex",justifyContent:"space-evenly"},children:[(0,s.jsx)(M.Z,{sx:{width:"45%"},children:(0,s.jsx)(R,{name:"Mode Positive",attr:"Pos",annParams:d,setAnnParams:c})}),(0,s.jsx)(M.Z,{sx:{width:"0%",borderLeft:"1px solid rgba(0,0,0,0.1)"}}),(0,s.jsx)(M.Z,{sx:{width:"45%"},children:(0,s.jsx)(R,{name:"Mode Negative",attr:"Neg",annParams:d,setAnnParams:c})})]})]})]})};let z=l.forwardRef(function(e,n){return(0,s.jsx)(H.Z,{direction:"up",ref:n,...e})});function F(e){let{creatingJob:n,setCreatingJob:t,setPage:l,setAnnotating:H}=e;return(0,s.jsxs)(a.Z,{fullScreen:!0,open:"annotations-params"==n,TransitionComponent:z,sx:{zIndex:10},children:[(0,s.jsx)(i.Z,{sx:{position:"relative",backgroundColor:"rgba(160, 0, 0, 1)"},children:(0,s.jsxs)(r.Z,{children:[(0,s.jsx)(o.Z,{edge:"start",color:"inherit",onClick:()=>t("ask-annotations"),"aria-label":"close",children:(0,s.jsx)(c.default,{})}),(0,s.jsx)(d.Z,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:"Metabolomic Putative Annotations"})]})}),(0,s.jsx)(M.Z,{className:"m-2",children:(0,s.jsx)(k,{setPage:l,setCreatingJob:t,setAnnotating:H})})]})}}}]);