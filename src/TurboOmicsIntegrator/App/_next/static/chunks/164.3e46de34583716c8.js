"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{4621:function(e,t,l){l.r(t),l.d(t,{default:function(){return ec}});var a=l(57437),n=l(22079),i=l(8088),s=l(2265),r=l(11093),o=l(41637),c=l(96507),d=l(18687),u=l(85269);let p=e=>{let{setSelectedOmic:t,selfSelectedOmic:l,setSelfSelectedOmic:n,buttonOmic:i,title:r,scroll:c}=e,p=(0,o.tc)().omics.length,m={act:"#424242",noAct:"#FFFFFF"},h={act:"#FFFFFF",noAct:"#424242"},[x,g]=(0,s.useState)(!1),b=l==i||x;return(0,a.jsx)(d.Z,{elevation:3,onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),style:{backgroundColor:b?m.act:m.noAct,color:b?h.act:h.noAct,width:"".concat(100/p,"%"),height:70,transition:"all 0.3s ease",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>{l!=i&&(n(i),setTimeout(()=>t(i),500),c())},children:(0,a.jsx)(u.Z,{variant:"h5",children:r})})};var m=function(e){let{selectedOmic:t,setSelectedOmic:l,scrollOmic:n}=e,i=(0,o.tc)().omics,{OMIC2NAME:d}=(0,r.S)(),[u,m]=(0,s.useState)(t);return(0,a.jsx)(c.Z,{display:"flex",children:i.map(e=>(0,a.jsx)(p,{setSelectedOmic:l,selfSelectedOmic:u,setSelfSelectedOmic:m,buttonOmic:e,title:d[e],scroll:()=>n(i.indexOf(e)-i.indexOf(t))},e))})},h=l(33533),x=l(40851),g=l(6093),b=l(46776),_=function(e){let{setExploreF:t,title:l}=e;return(0,a.jsx)(x.Z,{sx:{position:"relative",backgroundColor:"#666666"},children:(0,a.jsx)(g.Z,{children:(0,a.jsxs)(c.Z,{sx:{display:"flex",width:"100%"},children:[(0,a.jsx)(c.Z,{sx:{width:"5%"},children:(0,a.jsx)(b.Z,{edge:"start",color:"inherit",onClick:()=>{t(!1)},"aria-label":"close",children:(0,a.jsx)(h.default,{})})}),(0,a.jsx)(c.Z,{sx:{pt:.5,textAlign:"center",width:"90%"},children:(0,a.jsx)(u.Z,{sx:{ml:2},variant:"h6",component:"div",children:l})}),(0,a.jsx)(c.Z,{sx:{width:"5%"}})]})})})};l(26604);var y=l(36012),E=l(10537),C=l(64728),f=l(13716),F=l(49600),S=l(93202),j=l(44909),A=l(16573),R=l(50039),T=l(24235),N=l(33343),v=l(2047),w=l(79857),M=l(78295),O=l(36612),I=l(90053),G=l(16691),P=l.n(G),D=l(38592),Z=l(92069),H=l(2678);let L=["GO:MF","GO:BP","GO:CC","KEGG","REAC"],B=e=>{let{myData:t}=e,l=(0,s.useRef)();return(0,a.jsx)(c.Z,{sx:{height:520,overflowY:"auto",overflowX:"hidden"},children:(0,a.jsxs)(c.Z,{sx:{width:550,m:"auto"},children:[(0,a.jsx)(c.Z,{sx:{width:0,position:"relative",left:50},children:(0,a.jsx)(H.L,{scatterRef:l,fileName:"GO_Enrichment"})}),(0,a.jsxs)(j.v,{ref:l,width:530,height:Math.max(480,80*t.length),data:t,margin:{top:0,right:0,left:150,bottom:20},layout:"vertical",children:[(0,a.jsx)(A.q,{strokeDasharray:"3 3"}),(0,a.jsx)(R.B,{type:"category",dataKey:"labelName",minTickGap:30}),(0,a.jsx)(T.K,{type:"number",children:(0,a.jsx)(N._,{value:"-Log10 (FDR)",offset:-10,position:"insideBottom"})}),(0,a.jsx)(v.u,{content:(0,a.jsx)(k,{})}),(0,a.jsx)(w.D,{content:()=>(0,a.jsx)(K,{}),align:"center",verticalAlign:"top"}),(0,a.jsx)(M.$,{dataKey:"-Log10(pvalue)",barSize:15,children:t.map(e=>(0,a.jsx)(O.b,{fill:U(e.source)},e.native))})]})]})})},k=e=>{let{active:t,payload:l}=e;return t&&l&&l.length?(0,a.jsxs)(c.Z,{className:"custom-tooltip",sx:{width:350,backgroundColor:"rgba(255,255,255,0.8)",border:"1px solid rgba(50, 50, 50, 0.8)",padding:1,borderRadius:1,color:"rgba(50,50,50,1)"},children:[(0,a.jsx)(u.Z,{variant:"h7",sx:{display:"block"},children:"".concat(l[0].payload.source," - ").concat(l[0].payload.native)}),(0,a.jsx)(u.Z,{variant:"h7",sx:{display:"block"},children:"".concat(l[0].payload.name)}),(0,a.jsx)(u.Z,{variant:"h7",sx:{display:"block"},children:"".concat(l[0].payload.description)}),(0,a.jsx)(u.Z,{variant:"h7",sx:{display:"block"},children:"FDR = ".concat(l[0].payload.FDR)})]}):null},K=()=>{let e=[{value:"GO:MF",color:I.s[0]},{value:"GO:BP",color:I.s[1]},{value:"GO:CC",color:I.s[2]},{value:"KEGG",color:I.s[3]},{value:"REAC",color:I.s[4]}].filter(e=>L.includes(e.value));return(0,a.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"10px"},children:e.map((e,t)=>(0,a.jsxs)("div",{style:{marginRight:"20px",display:"flex",alignItems:"center"},children:[(0,a.jsx)("div",{style:{width:"15px",height:"15px",backgroundColor:e.color,marginRight:"5px"}}),(0,a.jsx)("span",{children:e.value})]},t))})},U=e=>{switch(e){case"GO:MF":return I.s[0];case"GO:BP":return I.s[1];case"GO:CC":return I.s[2];case"KEGG":return I.s[3];case"REAC":return I.s[4]}},z=e=>{let{myData:t,setCategory:l,myUsrFilt:n,setMyUsrFilt:i}=e,r=()=>{let e=(0,Z.iL)({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0,filename:"Protein_GO_Enrichment"}),l=t.map(e=>({GO:e.native,Type:e.source,Name:e.name,FDR:e.FDR})),a=(0,Z.gB)(e)(l);(0,Z.LR)(e)(a)},o=(0,s.useMemo)(()=>[{header:"GO",accessorKey:"native",size:100},{header:"Type",accessorKey:"source",size:170,filterVariant:"multi-select"},{header:"Name",accessorKey:"name",size:220},{header:"FDR",accessorKey:"FDR",size:50,filterFn:"lessThan"}],[]),d=(0,s.useMemo)(()=>t.length>0?{[t[0].native]:!0}:{},[t]),[u,p]=(0,s.useState)(d);(0,s.useEffect)(()=>{0==Object.keys(u).length?l(null):l(t.filter(e=>e.native==Object.keys(u)[0])[0])},[u,t,l]);let m=(0,D.X0)({columns:o,data:t,layoutMode:"grid",enableBottomToolbar:!1,enableColumnResizing:!0,enablePagination:!1,enableColumnPinning:!1,enableRowNumbers:!1,enableRowActions:!1,enableRowSelection:!0,enableMultiRowSelection:!1,enableDensityToggle:!1,enableColumnFilters:!0,enableFullScreenToggle:!1,enableHiding:!1,enableColumnActions:!1,muiTableContainerProps:{sx:{maxHeight:"250px"}},enableFacetedValues:!0,initialState:{density:"compact",showGlobalFilter:!0,showColumnFilters:!0,columnFilters:[{id:"FDR",value:.1}],rowSelection:{initialSelectedRow:d}},positionToolbarAlertBanner:"bottom",getRowId:e=>e.native,muiTableBodyRowProps:e=>{let{row:t}=e;return{onClick:t.getToggleSelectedHandler(),sx:{cursor:"pointer"}}},onRowSelectionChange:p,state:{rowSelection:u},renderTopToolbarCustomActions:e=>{let{table:t}=e;return(0,a.jsx)(c.Z,{sx:{display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap"},children:(0,a.jsx)(F.Z,{onClick:r,startIcon:(0,a.jsx)(S.Z,{}),children:"Export All Data"})})}}),[h,x]=(0,s.useState)(t.map(e=>e.native)),g=m.getFilteredRowModel().rows.map(e=>e.id);return h.every(e=>g.includes(e))&&g.every(e=>h.includes(e))||x(g),(0,s.useEffect)(()=>{console.log("Setting ID"),n.every(e=>h.includes(e))&&h.every(e=>n.includes(e))||i(h)},[h,i,n]),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(D.P2,{table:m})})};var V=function(e){let{omic:t,fRef:l,setCategory:n,colFid:i,setQ2cat:d}=e,p=(0,r.S)().BASE_URL,m=(0,o.tc)().user["".concat(t,"2i")],{OS:h}=(0,o.tc)(),[x,g]=(0,s.useState)(null),b=(0,s.useMemo)(()=>{let e=m.column(i.id).values;return e.filter((t,l)=>e.indexOf(t)==l)},[m,i]),_=(0,s.useMemo)(()=>{let e=l.map(e=>e[i.id]);return e.filter((t,l)=>e.indexOf(t)==l)},[i,l]),y=(0,s.useCallback)(async()=>{let e=await fetch("https://biit.cs.ut.ee/gprofiler/api/gost/profile/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organism:h.id,query:_,domain_scope:"custom",background:b,user_threshold:.1,significance_threshold_method:"bonferroni",sources:L})}),t=await e.json(),l=t.meta.genes_metadata.query.query_1.mapping;t.ensgs2myid={},Object.keys(l).map((e,a)=>{t.ensgs2myid[Object.values(l)[a][0]]=e}),t.myid=t.meta.genes_metadata.query.query_1.ensgs.map(e=>t.ensgs2myid[e]),t.result=t.result.map(e=>({...e,myid:t.myid.filter((t,l)=>e.intersections[l].length>0)})),g(t)},[h,_,b]);(0,s.useEffect)(()=>{let e=setTimeout(y,100);return()=>clearTimeout(e)},[_,b,y]);let E=(0,s.useMemo)(()=>{if(null==x)return null;let e=x.result.map(e=>({...e,"-Log10(pvalue)":Math.round(-(1e4*Math.log10(e.p_value)))/1e4,FDR:Number.parseFloat(e.p_value).toExponential(2),labelName:e.name.split(" ").slice(0,4).join(" ")+(e.name.split(" ").length>4?"...":"")}));return e},[x]),[C,f]=(0,s.useState)([]),F=(0,s.useMemo)(()=>{if(null===E)return null;let e=E.filter(e=>C.includes(e.native));return e},[E,C]);return(0,s.useEffect)(()=>{if(null===F)return;let e={};x.myid.map(t=>{e[t]=[]}),F.map(t=>{t.myid.map(l=>e[l].push(t))}),d(e)},[F,x,d]),(0,a.jsxs)(c.Z,{sx:{mt:3},children:[(0,a.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"center"},children:[(0,a.jsx)(c.Z,{sx:{mr:2},children:(0,a.jsx)(u.Z,{variant:"h6",children:"GO Enrichment with"})}),(0,a.jsx)(c.Z,{sx:{cursor:"pointer"},onClick:()=>window.open("https://biit.cs.ut.ee/gprofiler/gost","_blank","noreferrer"),children:(0,a.jsx)(P(),{src:"".concat(p,"/gProfiler_logo.png"),width:110,height:30,className:"d-inline-block align-top",alt:"g:Profiler"})})]}),(0,a.jsx)(c.Z,{children:E&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{sx:{border:"0px solid #999999",borderRadius:5,p:1,maxWidth:700,m:"auto"},children:(0,a.jsx)(B,{myData:F})}),(0,a.jsx)(c.Z,{sx:{pl:2,mt:1,width:"206%"},children:(0,a.jsx)(z,{myData:E,setCategory:n,myUsrFilt:C,setMyUsrFilt:f})})]})})]})};l(50294);let Y=["AFFY_HC_G110","AFFY_HG_FOCUS","AFFY_HG_U133A_2","AFFY_HG_U133B","AFFY_HG_U133_PLUS_2","AFFY_HG_U95A","AFFY_HG_U95AV2","AFFY_HG_U95B","AFFY_HG_U95C","AFFY_HG_U95D","AFFY_HG_U95E","AFFY_HTA_2_0","AFFY_HT_HG_U133_PLUS_PM","AFFY_HUEX_1_0_ST_V2","AFFY_HUGENEFL","AFFY_HUGENE_1_0_ST_V1","AFFY_HUGENE_2_0_ST_V1","AFFY_HUGENE_2_1_ST_V1","AFFY_PRIMEVIEW","AFFY_U133_X3P","AGILENT_CGH_44B","AGILENT_GPL19072","AGILENT_GPL26966","AGILENT_GPL6848","AGILENT_SUREPRINT_G3_GE_8X60K","AGILENT_SUREPRINT_G3_GE_8X60K_V2","AGILENT_WHOLEGENOME","AGILENT_WHOLEGENOME_4X44K_V1","AGILENT_WHOLEGENOME_4X44K_V2","ARRAYEXPRESS","BIOGRID","CCDS","CCDS_ACC","CHEMBL","CODELINK_CODELINK","DBASS3","DBASS3_ACC","DBASS5","DBASS5_ACC","EMBL","ENSG","ENSP","ENST","ENS_LRG_GENE","ENS_LRG_TRANSCRIPT","ENTREZGENE","ENTREZGENE_ACC","ENTREZGENE_TRANS_NAME","GENECARDS","GENECARDS_ACC","GO","GOSLIM_GOA","HGNC","HGNC_ACC","HGNC_TRANS_NAME","HPA","HPA_ACC","ILLUMINA_HUMANREF_8_V3","ILLUMINA_HUMANWG_6_V3","MEROPS","MIM_GENE","MIM_GENE_ACC","MIM_MORBID","MIM_MORBID_ACC","MIRBASE","MIRBASE_ACC","MIRBASE_TRANS_NAME","PDB","PHALANX_ONEARRAY","PROTEIN_ID","PROTEIN_ID_ACC","REACTOME","REACTOME_GENE","REACTOME_TRANSCRIPT","REFSEQ_MRNA","REFSEQ_MRNA_ACC","REFSEQ_MRNA_PREDICTED","REFSEQ_MRNA_PREDICTED_ACC","REFSEQ_NCRNA","REFSEQ_NCRNA_ACC","REFSEQ_NCRNA_PREDICTED","REFSEQ_NCRNA_PREDICTED_ACC","REFSEQ_PEPTIDE","REFSEQ_PEPTIDE_ACC","REFSEQ_PEPTIDE_PREDICTED","REFSEQ_PEPTIDE_PREDICTED_ACC","RFAM","RFAM_ACC","RFAM_TRANS_NAME","RNACENTRAL","UCSC","UNIPARC","UNIPROTSPTREMBL","UNIPROTSPTREMBL_ACC","UNIPROTSWISSPROT","UNIPROTSWISSPROT_ACC","UNIPROT_GN","UNIPROT_GN_ACC","UNIPROT_ISOFORM","WIKIGENE","WIKIGENE_ACC"];var W=l(70812),Q=l(67248),X=e=>{let{options:t,selectedField:l,setSelectedField:n,children:i}=e,r=(e,l)=>{l?n(l):n(t[0])};return(0,a.jsxs)(c.Z,{children:[(0,a.jsx)(u.Z,{variant:"h6",children:i}),(0,a.jsx)(W.Z,{id:"feature-id-field",sx:{width:300,margin:"auto",mt:2},disableListWrap:!0,value:l,onChange:(e,t)=>r(e,t),options:t,renderInput:e=>(0,a.jsx)(Q.Z,{...e,label:"Field"}),renderOption:(e,t)=>(0,s.createElement)("li",{...e,key:t.label},t.label),isOptionEqualToValue:(e,t)=>e.id===t.id})]})};let q=e=>{let{qCat:t,fRef:l,omic:n,colFid:i}=e,r=i.id,o=(0,s.useMemo)(()=>{let e={};return l.map(t=>{e[t[r]]=!0}),e},[l,r]),d=(0,s.useMemo)(()=>{let e=Object.keys(o),l=[];return(l=t.map(t=>({...t,desc:t.description.replace(/\[[^\]]*\]/g,""),filtered:e.includes(t.converted)?1:0}))).sort((e,t)=>t.filtered-e.filtered),l},[t,o]),u=(0,s.useMemo)(()=>[{header:"ID",accessorKey:"converted",size:60},{header:"GN",accessorKey:"name",size:60},{header:"Description",accessorKey:"desc"}],[]),p=()=>{let e=(0,Z.iL)({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0,filename:"CategoryProteins"}),t=d.map(e=>({ID:e.converted,GN:e.name,Description:e.desc,Filtered:e.filtered})),l=(0,Z.gB)(e)(t);(0,Z.LR)(e)(l)},m=(0,s.useRef)(null),[h,x]=(0,s.useState)(!0),[g,b]=(0,s.useState)([]);(0,s.useEffect)(()=>{x(!1)},[]),(0,s.useEffect)(()=>{try{var e,t;null===(t=m.current)||void 0===t||null===(e=t.scrollToIndex)||void 0===e||e.call(t,0)}catch(e){console.error(e)}},[g]);let _=(0,D.X0)({columns:u,data:d,layoutMode:"grid",enableBottomToolbar:!0,positionToolbarAlertBanner:"bottom",enableSelectAll:!1,enablePagination:!1,enableRowPinning:!1,enableRowSelection:!1,enableStickyHeader:!0,enableColumnPinning:!1,enableDensityToggle:!1,enableColumnFilters:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnActions:!1,rowPinningDisplayMode:"select-sticky",muiTableContainerProps:{sx:{maxHeight:"300px"}},enableRowVirtualization:!0,enableColumnVirtualization:!0,getRowId:e=>e.converted,state:{rowSelection:o,isLoading:h,sorting:g},rowVirtualizerInstanceRef:m,rowVirtualizerOptions:{overscan:5},columnVirtualizerOptions:{overscan:2},initialState:{rowSelection:o,density:"compact",showGlobalFilter:!0},renderTopToolbarCustomActions:e=>{let{table:t}=e;return(0,a.jsx)(c.Z,{sx:{display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap"},children:(0,a.jsx)(F.Z,{onClick:p,startIcon:(0,a.jsx)(S.Z,{}),children:"Export All Data"})})}});return(0,a.jsx)(D.P2,{table:_})};var $=function(e){let{omic:t,fRef:l,f2MeanL:n,setQ2cat:i,colFid:r,setColFid:d}=e,{OS:u}=(0,o.tc)(),p=(0,C.a0)().MOFA.displayOpts.selectedPlot.mdataCol,m=(0,o.tc)().mdataType[p],[h,x]=(0,s.useState)(null),[g,b]=(0,s.useState)(null),[_,y]=(0,s.useState)(!0),E=(0,o.tc)().user["".concat(t,"2i")],f=(0,s.useMemo)(()=>E.columns.map(e=>({label:e,id:e})),[E]),F=(0,s.useMemo)(()=>Y.map(e=>({id:e,label:e})),[]),[S,j]=(0,s.useState)("q"==t?F[97]:F[42]),A=(0,s.useCallback)(async()=>{y(!0);let e=await fetch("https://biit.cs.ut.ee/gprofiler/api/convert/convert/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organism:u.id,query:h.native,target:S.id})}),t=await e.json(),l=[...new Set(E.column(r.id).values)],a=t.result.filter(e=>l.includes(e.converted));b(a=a.filter((e,t,l)=>t===l.findIndex(t=>t.converted===e.converted))),setTimeout(()=>y(!1),500)},[h,u,r.id,E,S]);return(0,s.useEffect)(()=>{if(null==h)b(null);else{let e=setTimeout(A,100);return()=>clearTimeout(e)}},[h,A]),(0,a.jsxs)(c.Z,{children:[(0,a.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"center"},children:[(0,a.jsx)(X,{options:f,selectedField:r,setSelectedField:d,children:"Select Column Containing ID"}),(0,a.jsx)(c.Z,{sx:{width:10}}),(0,a.jsx)(X,{options:F,selectedField:S,setSelectedField:j,children:"Select ID Format"})]}),(0,a.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"space-around"},children:[(0,a.jsx)(c.Z,{sx:{width:"45%",mt:3},children:(0,a.jsx)(V,{omic:t,fRef:l,setCategory:x,colFid:r,setQ2cat:i})}),(0,a.jsx)(c.Z,{sx:{width:"45%"},children:"categorical"==m.type&&m.levels.length>1&&g&&(0,a.jsx)(c.Z,{sx:{pl:2,mt:13},children:(0,a.jsx)(c.Z,{sx:{opacity:_?0:1,transition:"all ease 0.2s"},children:(0,a.jsx)(q,{qCat:g,fRef:l,omic:t,colFid:r})})})})]})]})},J=l(80553),ee=l(33457);let et=[{label:"KEGG",id:"KEGG"},{label:"ChEBI",id:"ChEBI"},{label:"PubChem (CID)",id:"PubChem"},{label:"HMDB",id:"HMDB"}],el=e=>{let{myData:t,setCategory:l,myUsrFilt:n,setMyUsrFilt:i}=e,r=()=>{let e=(0,Z.iL)({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0,filename:"Metabolite_Enrichment"}),l=t.map(e=>({ID:e.id,Type:e.db,Name:e.name,pvalue:e.pvalue,FDR:e.FDR,"N. mapped":e.N_pathway_mapped,"N. target":e.N_pathway_sig})),a=(0,Z.gB)(e)(l);(0,Z.LR)(e)(a)},o=(0,s.useMemo)(()=>[{header:"ID",accessorKey:"id",size:100},{header:"Type",accessorKey:"db",size:120,filterVariant:"multi-select"},{header:"Name",accessorKey:"name",size:220},{header:"pvalue",accessorKey:"pvalue",size:100,filterFn:"lessThan"},{header:"FDR",accessorKey:"FDR",size:80,filterFn:"lessThan"},{header:"N. Backg.",accessorKey:"N_pathway_mapped",size:100},{header:"N. Target",accessorKey:"N_pathway_sig",size:100}],[]),d=(0,s.useMemo)(()=>t.length>0?{[t[0].id]:!0}:{},[t]),[u,p]=(0,s.useState)(d);(0,s.useEffect)(()=>{0==Object.keys(u).length?l(null):l(t.filter(e=>e.id==Object.keys(u)[0])[0])},[u,t,l]);let m=(0,ee.X0)({columns:o,data:t,layoutMode:"grid",enableBottomToolbar:!1,enableColumnResizing:!0,enablePagination:!1,enableColumnPinning:!1,enableRowNumbers:!1,enableRowActions:!1,enableRowSelection:!0,enableMultiRowSelection:!1,enableDensityToggle:!1,enableColumnFilters:!0,enableFullScreenToggle:!1,enableHiding:!1,enableColumnActions:!1,muiTableContainerProps:{sx:{maxHeight:"330px",minHeight:"330px"}},enableFacetedValues:!0,initialState:{density:"compact",showGlobalFilter:!0,showColumnFilters:!0,columnFilters:[{id:"pvalue",value:.05}],rowSelection:{initialSelectedRow:d},sorting:[{id:"pvalue",desc:!1}]},positionToolbarAlertBanner:"bottom",getRowId:e=>e.id,muiTableBodyRowProps:e=>{let{row:t}=e;return{onClick:t.getToggleSelectedHandler(),sx:{cursor:"pointer"}}},onRowSelectionChange:p,state:{rowSelection:u},renderTopToolbarCustomActions:e=>{let{table:t}=e;return(0,a.jsx)(c.Z,{sx:{display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap"},children:(0,a.jsx)(F.Z,{onClick:r,startIcon:(0,a.jsx)(S.Z,{}),children:"Export All Data"})})}}),[h,x]=(0,s.useState)(t.map(e=>e.native)),g=m.getFilteredRowModel().rows.map(e=>e.id);return h.every(e=>g.includes(e))&&g.every(e=>h.includes(e))||x(g),(0,s.useEffect)(()=>{console.log("Setting ID"),n.every(e=>h.includes(e))&&h.every(e=>n.includes(e))||i(h)},[h,i,n]),(0,a.jsx)(ee.P2,{table:m})},ea=e=>{let{mCat:t,idType:l}=e,n=l.id,{myData:i,mySet:r}=(0,s.useMemo)(()=>{let e=[];t.pathway_mapped.map(l=>{let a=J.g[t.db].indexOf(l);e.push({ID:J.g[n][a],Name:J.g.Name[a],Target:t.pathway_sig.includes(l)})}),e.sort((e,t)=>t.Target-e.Target);let l={};return e.map(e=>{e.Target&&(l[e.ID]=!0)}),{myData:e,mySet:l}},[t,n]),o=(0,s.useMemo)(()=>[{header:"ID",accessorKey:"ID",size:60},{header:"Name",accessorKey:"Name",size:60}],[]),d=()=>{let e=(0,Z.iL)({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0,filename:"CategoryMetabolites"}),t=i.map(e=>({ID:e.ID,Name:e.Name,Filtered:e.Target})),l=(0,Z.gB)(e)(t);(0,Z.LR)(e)(l)},u=(0,s.useRef)(null),[p,m]=(0,s.useState)(!0),[h,x]=(0,s.useState)([]);(0,s.useEffect)(()=>{m(!1)},[]),(0,s.useEffect)(()=>{try{var e,t;null===(t=u.current)||void 0===t||null===(e=t.scrollToIndex)||void 0===e||e.call(t,0)}catch(e){console.error(e)}},[h]);let g=(0,ee.X0)({columns:o,data:i,layoutMode:"grid",enableBottomToolbar:!0,positionToolbarAlertBanner:"bottom",enableSelectAll:!1,enablePagination:!1,enableRowPinning:!1,enableRowSelection:!1,enableStickyHeader:!0,enableColumnPinning:!1,enableDensityToggle:!1,enableColumnFilters:!1,enableFullScreenToggle:!1,enableHiding:!1,enableColumnActions:!1,rowPinningDisplayMode:"select-sticky",muiTableContainerProps:{sx:{maxHeight:"250px",minHeight:"250px"}},enableRowVirtualization:!0,enableColumnVirtualization:!0,getRowId:e=>e.ID,state:{rowSelection:r,isLoading:p,sorting:h},rowVirtualizerInstanceRef:u,rowVirtualizerOptions:{overscan:5},columnVirtualizerOptions:{overscan:2},initialState:{rowSelection:r,density:"compact",showGlobalFilter:!0},renderTopToolbarCustomActions:e=>{let{table:t}=e;return(0,a.jsx)(c.Z,{sx:{display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap"},children:(0,a.jsx)(F.Z,{onClick:d,startIcon:(0,a.jsx)(S.Z,{}),children:"Export All Data"})})}});return(0,a.jsx)(ee.P2,{table:g})};var en=function(e){let{fRef:t,f2MeanL:l,colFid:n,setColFid:i,setM2cat:d}=e,{jobID:u}=(0,o.tc)(),{API_URL:p}=(0,r.S)(),{m2i:m}=(0,o.tc)().user,h=(0,o.tc)().f2x.m,{OS:x}=(0,o.tc)(),g=(0,s.useMemo)(()=>m.columns.map(e=>({label:e,id:e})),[m]),[b,_]=(0,s.useState)(et[0]),y=(0,s.useMemo)(()=>["ChEBI","PubChem"].includes(b.id),[b]),[E,C]=(0,s.useState)([]),{midTargetArr:f,midArr:F,midIndex:S,db2usr:j}=(0,s.useMemo)(()=>{let e,l,a;let i={};return n&&(e=t.map(e=>e[n.id]).filter(e=>e),l=m.column(n.id).values.filter((e,t)=>e&&h[t]),y?(e=e.map(e=>Number(e).toString()),l=l.map(e=>{let t=Number(e).toString();return i[t]=e,t})):l.map(e=>i[e]=e),a=(l=l.map(t=>({id:t,target:e.includes(t)}))).map(e=>J.g[b.id].indexOf(e.id))),{midTargetArr:e,midArr:l,midIndex:a,db2usr:i}},[n,b,y,t,m,h]);(0,s.useEffect)(()=>{if(null===n)return;let e={};if(S.every(e=>-1==e)){console.log("No index found"),C([]);return}["KEGG","ChEBI"].map(t=>{e[t]=S.map((e,l)=>({id:J.g[t][e],target:F[l].target})).filter(e=>e.id)}),fetch("".concat(p,"/run_ora/").concat(u,"/").concat(x.scientific_name),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{e.KEGG=e.KEGG.map(e=>({...e,name:e.name.split(" - ").slice(0,-1).join(" - ")}));let t=[];Object.keys(e).map(l=>{e[l].map(e=>t.push({...e,pvalue:Math.round(1e3*e.pvalue)/1e3,db:l}))}),C(t.filter(e=>e.N_pathway_sig>0))})},[S,F,n,p,x,u]);let[A,R]=(0,s.useState)(null),[T,N]=(0,s.useState)([]);return(0,s.useEffect)(()=>{if(console.log("setM2Cat"),!n)return;let e={};f.map(t=>e[j[t]]=[]),E.filter(e=>T.includes(e.id)).map(t=>{t.pathway_sig.map(l=>{let a=J.g[b.id][J.g[t.db].indexOf(l)];a&&f.includes(a)&&e[j[a]].push({native:t.id,name:t.name})})}),d(e)},[T,f,E,b,n,j,d]),(0,a.jsxs)(c.Z,{sx:{},children:[(0,a.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"center",pb:4},children:[(0,a.jsx)(X,{options:g,selectedField:n,setSelectedField:e=>i(e),children:"Select Column Containing ID"}),(0,a.jsx)(c.Z,{sx:{width:10}}),(0,a.jsx)(X,{options:et,selectedField:b,setSelectedField:e=>_(e),children:"Select ID Type"})]}),n&&(0,a.jsxs)(c.Z,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[(0,a.jsx)(c.Z,{sx:{width:"65%"},children:(0,a.jsx)(el,{myData:E,setCategory:R,myUsrFilt:T,setMyUsrFilt:N})}),(0,a.jsx)(c.Z,{sx:{width:"30%"},children:A&&(0,a.jsx)(ea,{mCat:A,idType:b})})]})]})};let ei=e=>{let{table:t,q2cat:l,colFid:n}=e,i=e=>{let t=(0,Z.iL)({fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0,filename:"Feature_Table"}),a=e.map(e=>e.original);Object.keys(l).length>0&&(a=a.map(e=>({...e,Category_ID:void 0===l[e[n.id]]||0==l[e[n.id]].length?"":l[e[n.id]].map(e=>e.native).join(";"),Category_Name:void 0===l[e[n.id]]||0==l[e[n.id]].length?"":l[e[n.id]].map(e=>e.name).join(";")})));let i=(0,Z.gB)(t)(a);(0,Z.LR)(t)(i)};return(0,a.jsxs)(c.Z,{sx:{display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap"},children:[(0,a.jsx)(c.Z,{children:(0,a.jsx)(D.UN,{table:t})}),(0,a.jsx)(F.Z,{disabled:0===t.getFilteredRowModel().rows.length,onClick:()=>i(t.getFilteredRowModel().rows),startIcon:(0,a.jsx)(S.Z,{}),children:"Export Table"})]})};var es=e=>{let{omic:t,sign:l,thr:n,f2MeanL:i,q2cat:r,colFid:d}=e,u=(0,o.tc)().user["".concat(t,"2i")],p=(0,C.a0)().MOFA.displayOpts.selectedPlot.Factor,m=(0,C.a0)().MOFA.displayOpts.selectedPlot.mdataCol,h=(0,o.tc)().mdataType[m],x=(0,C.a0)().MOFA.data.loadings[t][p],g=(0,s.useMemo)(()=>{let e=[];return e=e.concat(u.columns.map(e=>({header:e,accessorKey:e,muiTableHeadCellProps:{align:"left"},muiTableBodyCellProps:{align:"left"},filterFn:"contains"}))),"categorical"==h.type&&e.push(...h.levels.map(e=>({header:"Z̄(".concat(e,")"),accessorKey:e,muiTableHeadCellProps:{align:"left"},muiTableBodyCellProps:{align:"center"},filterFn:"greaterThan"}))),e.push({header:p,accessorKey:p,muiTableHeadCellProps:{align:"left"},muiTableBodyCellProps:{align:"center"},filterFn:"up"==l?"greaterThan":"lessThan"}),e},[u,h,p,l]),b=(0,s.useMemo)(()=>{let e=(0,E.$i)(u.fillNa("")),t={};return Object.keys(i).map(a=>{("up"==l&&x[a]>n||"down"==l&&x[a]<n)&&(t[a]={...e[a],...i[a],[p]:Math.round(1e4*x[a])/1e4})}),t=Object.values(t)},[u,i,p,x,l,n]),_=(0,ee.X0)({columns:g,data:b,layoutMode:"grid",enableColumnResizing:!0,enableSelectAll:!1,enableColumnFilterModes:!0,enableColumnFilters:!0,enableColumnOrdering:!0,enableGrouping:!0,enableColumnPinning:!0,enableFacetedValues:!0,enableRowActions:!1,enableRowSelection:!1,enableDensityToggle:!1,enableFullScreenToggle:!0,enableGlobalFilter:!1,initialState:{density:"compact",showColumnFilters:!0,showGlobalFilter:!1,columnFilters:[{id:p,value:Math.round(1e4*n)/1e4}],sorting:[{id:p,desc:"up"==l}]},paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",muiPaginationProps:{rowsPerPageOptions:[10],shape:"rounded",variant:"outlined"},renderTopToolbar:e=>{let{table:t}=e;return(0,a.jsx)(ei,{table:t,q2cat:r,colFid:d})}});return(0,a.jsx)(c.Z,{sx:{px:5,pb:3},children:(0,a.jsx)(ee.P2,{table:_})})},er=function(e){let{omic:t,thrLRef:l}=e,{OMIC2NAME:n}=(0,r.S)(),i=(0,o.tc)().user["".concat(t,"2i")],d=(0,C.a0)().MOFA.displayOpts.selectedPlot.Factor,p=(0,C.a0)().MOFA.data.loadings[t][d],m=(0,s.useMemo)(()=>{let e=(0,E.$i)(i),t={up:[],down:[]};return Object.keys(p).map(a=>{p[a]>l.up&&t.up.push(e[a]),p[a]<l.down&&t.down.push(e[a])}),t},[i,p,l.up,l.down]),h=(0,C.a0)().MOFA.displayOpts.selectedPlot.mdataCol,x=(0,o.tc)().mdataType[h],g=(0,o.tc)().norm["x".concat(t)],b=(0,s.useMemo)(()=>{let e={},t=(0,E.$i)(g),l=[...m.up.map(e=>Object.values(e)[0]),...m.down.map(e=>Object.values(e)[0])],a={};return Object.keys(t).map(e=>{a[e]={},l.map(l=>a[e][l]=t[e][l])}),l.map(t=>{e[t]={}}),"categorical"==x.type&&x.levels.map(t=>{let l=new dfd.DataFrame(x.level2id[t].map(e=>a[e]).filter(e=>void 0!=e)),n=l.mean({axis:0}).round(4);n.index.map((l,a)=>{e[l][t]=n.values[a]})}),e},[g,x,m.down,m.up]),[_,F]=(0,s.useState)("m"==t?null:{label:i.columns[0],id:i.columns[0]}),[S,j]=(0,s.useState)({up:{},down:{}}),A=(0,s.useMemo)(()=>{let e={};return e.up=e=>j(t=>({...t,up:e})),e.down=e=>j(t=>({...t,down:e})),e},[j]);return(0,a.jsx)(y.tv,{"aria-label":"My Favorite Images",children:["up","down"].map(e=>(0,a.jsx)(y.jw,{children:(0,a.jsxs)(c.Z,{sx:{p:2,textAlign:"center"},children:[(0,a.jsxs)(u.Z,{variant:"h5",children:["up"==e?"Positively":"Negatively"," Associated ",n[t]]}),(0,a.jsx)(f.c,{height:"75vh",children:(0,a.jsxs)(f.E,{children:[(0,a.jsx)(es,{omic:t,sign:e,thr:l[e],f2MeanL:b,q2cat:S[e],colFid:_}),m[e].length>0&&(0,a.jsx)(c.Z,{children:"q"==t||"t"==t?(0,a.jsx)($,{omic:t,fRef:m[e],f2MeanL:b,colFid:_,setColFid:F,setQ2cat:A[e]}):(0,a.jsx)(en,{fRef:m[e],f2MeanL:b,colFid:_,setColFid:F,setM2cat:A[e]})})]})})]})},e))})};let eo=s.forwardRef(function(e,t){return(0,a.jsx)(i.Z,{direction:"up",ref:t,...e})});var ec=function(e){let{exploreF:t,setExploreF:l,Factor:i,mdataCol:r,thrLRef:d,setEFLoading:u}=e,{omics:p}=(0,o.tc)(),[h,x]=(0,s.useState)(p[0]),g=(0,s.useRef)(null);return(0,s.useEffect)(()=>{u(!1)},[u]),(0,a.jsxs)(n.Z,{fullScreen:!0,open:t,TransitionComponent:eo,children:[(0,a.jsx)(_,{setExploreF:l,title:"Explore Features: ".concat(i," vs ").concat(r)}),(0,a.jsx)(m,{selectedOmic:h,setSelectedOmic:x,scrollOmic:e=>{let t=g.current,l=t.clientWidth;t.scrollLeft=t.scrollLeft+e*l}}),(0,a.jsx)(c.Z,{sx:{overflow:"hidden"},ref:g,children:(0,a.jsx)(c.Z,{sx:{display:"flex",width:"".concat(100*p.length,"%")},children:p.map(e=>(0,a.jsx)(c.Z,{sx:{width:"".concat(100/p.length,"%"),opacity:h==e?1:0,transition:"all ease 0.5s"},children:(0,a.jsx)(er,{omic:e,thrLRef:d[e]})},e))})})]})}}}]);