"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[433],{58433:function(e,t,i){i.r(t);var l=i(57437),n=i(96507),s=i(2265),a=i(41637),d=i(51808),r=i(54755),c=i(11093),u=i(98864),o=i.n(u);let p=o()(()=>i.e(178).then(i.bind(i,81178)),{loadableGenerated:{webpack:()=>[81178]}}),h=o()(()=>i.e(520).then(i.bind(i,92520)),{loadableGenerated:{webpack:()=>[92520]}}),m=[{label:"KEGG",id:"KEGG"},{label:"ChEBI",id:"ChEBI"},{label:"PubChem (CID)",id:"PubChem"},{label:"HMDB",id:"HMDB"}];t.default=function(e){let{fRef:t,f2MeanL:i,colFid:u,setColFid:o,setM2cat:x,MetaboID:f}=e,{jobID:b}=(0,a.tc)(),{API_URL:j}=(0,c.S)(),{m2i:y}=(0,a.tc)().user,C=(0,a.tc)().f2x.m,{OS:g}=(0,a.tc)(),Z=(0,s.useMemo)(()=>y.columns.map(e=>({label:e,id:e})),[y]),[S,E]=(0,s.useState)(m[0]),w=(0,s.useMemo)(()=>["ChEBI","PubChem"].includes(S.id),[S]),[G,v]=(0,s.useState)([]),{midTargetArr:M,midArr:_,midIndex:k,db2usr:F}=(0,s.useMemo)(()=>{let e,i,l;let n={};return u&&(e=t.map(e=>e[u.id]).filter(e=>e),i=y.column(u.id).values.filter((e,t)=>e&&C[t]),w?(e=e.map(e=>Number(e).toString()),i=i.map(e=>{let t=Number(e).toString();return n[t]=e,t})):i.map(e=>n[e]=e),l=(i=i.map(t=>({id:t,target:e.includes(t)}))).map(e=>f[S.id].indexOf(e.id))),{midTargetArr:e,midArr:i,midIndex:l,db2usr:n}},[u,S,w,t,y,C,f]);(0,s.useEffect)(()=>{if(null===u)return;let e={};if(k.every(e=>-1==e)){console.log("No index found"),v([]);return}["KEGG","ChEBI"].map(t=>{e[t]=k.map((e,i)=>({id:f[t][e],target:_[i].target})).filter(e=>e.id)}),fetch("".concat(j,"/run_ora/").concat(b,"/").concat(g.scientific_name),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{e.KEGG=e.KEGG.map(e=>({...e,name:e.name.split(" - ").slice(0,-1).join(" - ")}));let t=[];Object.keys(e).map(i=>{e[i].map(e=>t.push({...e,pvalue:Math.round(1e3*e.pvalue)/1e3,db:i}))}),v(t.filter(e=>e.N_pathway_sig>0))})},[k,_,u,j,g,b,f]);let[I,N]=(0,s.useState)(null),[O,B]=(0,s.useState)([]);(0,s.useEffect)(()=>{if(console.log("setM2Cat"),!u)return;let e={};M.map(t=>e[F[t]]=[]),G.filter(e=>O.includes(e.id)).map(t=>{t.pathway_sig.map(i=>{let l=f[S.id][f[t.db].indexOf(i)];l&&M.includes(l)&&e[F[l]].push({native:t.id,name:t.name})})}),x(e)},[O,M,G,S,u,F,x,f]);let[D,K]=(0,s.useState)(!0);return(0,l.jsxs)(n.Z,{sx:{},children:[(0,l.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"center",pb:4},children:[(0,l.jsx)(d.Z,{options:Z,selectedField:u,setSelectedField:e=>o(e),children:"Select Column Containing ID"}),(0,l.jsx)(n.Z,{sx:{width:10}}),(0,l.jsx)(d.Z,{options:m,selectedField:S,setSelectedField:e=>E(e),children:"Select ID Type"})]}),u&&(0,l.jsxs)(n.Z,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[(0,l.jsx)(n.Z,{sx:{width:"65%"},children:(0,l.jsx)(p,{myData:G,setCategory:N,myUsrFilt:O,setMyUsrFilt:B})}),(0,l.jsx)(n.Z,{sx:{width:"30%",display:"flex",justifyContent:"center",border:"0px solid blue"},children:I&&(0,l.jsxs)(l.Fragment,{children:[D&&(0,l.jsxs)(n.Z,{sx:{border:"0px solid red",alignSelf:"center",width:"80%"},children:[(0,l.jsx)(n.Z,{children:"Loading Metabolites..."}),(0,l.jsx)(n.Z,{sx:{p:4},children:(0,l.jsx)(r.Z,{})})]}),(0,l.jsx)(h,{mCat:I,idType:S,setShowLoading:K})]})})]})]})}},51808:function(e,t,i){var l=i(57437),n=i(2265),s=i(96507),a=i(85269),d=i(70812),r=i(67248);t.Z=e=>{let{options:t,selectedField:i,setSelectedField:c,children:u}=e,o=(e,i)=>{i?c(i):c(t[0])};return(0,l.jsxs)(s.Z,{children:[(0,l.jsx)(a.Z,{variant:"h6",children:u}),(0,l.jsx)(d.Z,{id:"feature-id-field",sx:{width:300,margin:"auto",mt:2},disableListWrap:!0,value:i,onChange:(e,t)=>o(e,t),options:t,renderInput:e=>(0,l.jsx)(r.Z,{...e,label:"Field"}),renderOption:(e,t)=>(0,n.createElement)("li",{...e,key:t.label},t.label),isOptionEqualToValue:(e,t)=>e.id===t.id})]})}}}]);