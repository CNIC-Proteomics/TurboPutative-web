"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[54],{26398:function(e,l,t){var i=t(26314);l.Z=void 0;var n=i(t(80984)),a=t(57437),s=(0,n.default)((0,a.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");l.Z=s},66054:function(e,l,t){t.r(l);var i=t(57437),n=t(2265),a=t(96507),s=t(49600),o=t(70812),r=t(67248),d=t(85269),c=t(5096),p=t(35009),m=t(46349),u=t(64494),x=t(14604),b=t(41637),h=t(64728),I=t(11093),f=t(26398);let g={m:[{label:"ChEBI",id:"ChEBI"},{label:"KEGG",id:"KEGG"},{label:"PubChem (CID)",id:"PubChem"},{label:"HMDB",id:"HMDB"}],q:[{label:"Uniprot Protein ID",id:"Uniprot Protein ID"},{label:"Entrez ID",id:"Entrez ID"},{label:"Ensembl Gene ID",id:"Ensembl Gene ID"},{label:"Ensembl Transcript ID ",id:"Ensembl Transcript ID"},{label:"Official Gene Symbol",id:"Official Gene Symbol"}],t:[{label:"Uniprot Protein ID",id:"Uniprot Protein ID"},{label:"Entrez ID",id:"Entrez ID"},{label:"Ensembl Gene ID",id:"Ensembl Gene ID"},{label:"Ensembl Transcript ID ",id:"Ensembl Transcript ID"},{label:"Official Gene Symbol",id:"Official Gene Symbol"}]},y=e=>{let{o:l,omicIdCol_i:t,setOmicIdCol_i:s,omicIdType_i:d,setOmicIdType_i:h,handleOmicIdChange:f}=e,{OMIC2NAME:y}=(0,I.S)(),j=(0,b.tc)().user["".concat(l,"2i")].columns.map(e=>({label:e,id:e}));return(0,i.jsxs)(a.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,i.jsx)(a.Z,{children:(0,i.jsx)(o.Z,{value:t,onChange:(e,t)=>{s(t),f(l,t,d)},isOptionEqualToValue:(e,l)=>e.id===l.id,id:"omic-id-column",options:j,sx:{width:250},renderInput:e=>(0,i.jsx)(r.Z,{...e,label:"".concat(y[l]," ID Column")}),renderOption:(e,l)=>(0,n.createElement)("li",{...e,key:l.label},l.label)})}),(0,i.jsx)(a.Z,{sx:{mt:4},children:(0,i.jsxs)(c.Z,{variant:"standard",fullWidth:!0,children:[(0,i.jsx)(p.Z,{shrink:!0,id:"demo-simple-select-label"}),(0,i.jsxs)(m.Z,{sx:{minWidth:"180px"},labelId:"demo-controlled-open-select-label",id:"demo-controlled-open-select",value:d,label:"ID Type",onChange:e=>{h(e.target.value),f(l,t,e.target.value)},children:[(0,i.jsx)(u.Z,{value:"",children:(0,i.jsx)("em",{children:"None"})}),g[l].map(e=>(0,i.jsx)(u.Z,{value:e,children:e.label},e.id))]}),(0,i.jsx)(x.Z,{children:"ID Type"})]})})]},l)},j=(e,l)=>{let t=e.filter(e=>e);return"m"==l?/^[0-9]+$/.test(t[0])?g.m[0]:/^C[0-9]+$/.test(t[0])?g.m[1]:/^HMDB[0-9]+$/.test(t[0])?g.m[3]:null:/^[OPQ][0-9][A-Z0-9]{3}[0-9]|[A-NR-Z][0-9]([A-Z][A-Z0-9]{2}[0-9]){1,2}$/.test(t[0])?g[l][0]:/^[0-9]+$/.test(t[0])?g[l][1]:/^ENS[A-Z]{0,3}G[0-9]+$/.test(t[0])?g[l][2]:/^ENS[A-Z]{0,3}T[0-9]+$/.test(t[0])?g[l][3]:/^[A-Z]+$/.test(t[0])?g[l][4]:null},Z=(e,l,t,i)=>{let n="";return n+=e.id,l.isCategorical&&(n+="_"+l.g1.id+"_"+l.g2.id),Object.keys(t).map(e=>{t[e]&&i[e]&&(n+="_"+e+"_"+t[e].id+"_"+i[e].id)}),n=n.replace(/[^a-zA-Z0-9]/g,"_")};l.default=function(e){let{setRId2info:l,fetchJobRun:c,setLoading:p}=e,{omics:m,mdataType:u,OS:x,f2x:I}=(0,b.tc)(),g=(0,b.tc)().user,C=(0,h.mX)(),v=(0,h.a0)().PWA,[E,O]=(0,n.useState)(v.MetaboID);(0,n.useEffect)(()=>{E?p(!1):t.e(794).then(t.t.bind(t,91794,19)).then(e=>{O(e),C({type:"set-pwa-attr",attr:"MetaboID",value:e}),p(!1),console.log("MetaboID loaded")})},[p,O,C,E]);let D=g.mdata,[S,T]=(0,n.useState)(v.mdataCol),[_,w]=(0,n.useState)(v.mdataCategorical),[G,N]=(0,n.useState)(v.omicIdCol?v.omicIdCol:m.reduce((e,l)=>({...e,[l]:null}),{})),[P,A]=(0,n.useState)(v.omicIdType?v.omicIdType:m.reduce((e,l)=>({...e,[l]:""}),{})),[k,M]=(0,n.useState)(v.omicIdR?v.omicIdR:m.reduce((e,l)=>({...e,[l]:null}),{})),q=async(e,t,i)=>{if(console.log(e,t,i),!t){M(l=>({...l,[e]:null})),l(l=>({...l,[e]:{}}));return}let n=g["".concat(e,"2i")].column(t.id),a=I[e],s=n.index.filter((e,l)=>a[l]),o=n.values.filter((e,l)=>a[l]),r=[],d={},c={};if(!i){if(!(i=j(o,e))){M(l=>({...l,[e]:null})),l(l=>({...l,[e]:{}}));return}A(l=>({...l,[e]:i}))}if("m"==e){let e=o.map(e=>E[i.id].indexOf(e));(r=e.map(e=>E.ChEBI[e])).map((l,t)=>{l&&(c[l]={xId:s[t],uId:o[t],Name:E.Name[e[t]]})})}else if("q"==e||"t"==e){let l=[],t=await fetch("https://biit.cs.ut.ee/gprofiler/api/convert/convert/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organism:x.id,query:o,target:"UNIPROTSWISSPROT_ACC"})}),i=await t.json();l=i.result.filter(e=>"None"!=e.converted&&1==e.n_converted);let n=l.map(e=>e.incoming),a=await fetch("https://biit.cs.ut.ee/gprofiler/api/convert/convert/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({organism:x.id,query:o.filter(e=>!n.includes(e)),target:"UNIPROTSPTREMBL_ACC"})}),d=await a.json();l.concat(d.result.filter(e=>"None"!=e.converted&&1==e.n_converted)),l=l.map(l=>({...l,converted_prefix:"".concat(e,"_").concat(l.converted)}));let p={};s.map((e,l)=>p[e]=o[l]);let m={};l.map(e=>m[e.incoming]=e.converted_prefix),r=s.map(e=>m[p[e]]);let u={};o.map((e,l)=>u[e]=s[l]),l.map(e=>{c[e.converted_prefix]={uId:e.incoming,xId:u[e.incoming],name:e.name,description:e.description}})}s.map((e,l)=>{r[l]&&(d[e]=r[l])}),M(l=>({...l,[e]:d})),l(l=>({...l,[e]:c}))};return(0,i.jsxs)(a.Z,{sx:{display:"flex",justifyContent:"space-evenly",mt:4},children:[(0,i.jsxs)(a.Z,{sx:{width:"25%",display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,i.jsx)(a.Z,{sx:{textAlign:"center",mt:7,position:"absolute",top:145},children:(0,i.jsx)(s.Z,{variant:"outlined",color:"primary",endIcon:(0,i.jsx)(f.Z,{}),disabled:!(S&&(!_.isCategorical||_.g1&&_.g2)&&Object.values(G).some(e=>e)&&m.every(e=>!(G[e]&&P[e])||k[e])),onClick:()=>{C({type:"set-pwa-params",mdataCol:S,mdataCategorical:_,omicIdCol:G,omicIdType:P,omicIdR:k}),c(S,_,k,Z(S,_,G,P))},children:"Run Analysis"})}),(0,i.jsx)(a.Z,{sx:{display:"flex"},children:(0,i.jsx)(o.Z,{value:S,onChange:(e,l)=>{l&&(T(l),"categorical"==u[l.id].type?w(e=>({isCategorical:!0,colOpts:u[l.id].levels.map(e=>({label:e,id:e})),g1:null,g2:null})):w(e=>({isCategorical:!1,colOpts:[],g1:null,g2:null})))},isOptionEqualToValue:(e,l)=>e.id===l.id,id:"metadata-column",options:D.columns.filter(e=>"categorical"==u[e].type).map(e=>({label:e,id:e})),sx:{width:300},renderInput:e=>(0,i.jsx)(r.Z,{...e,label:"Metadata Column"}),renderOption:(e,l)=>(0,n.createElement)("li",{...e,key:l.label},l.label)})}),(0,i.jsxs)(a.Z,{sx:{display:"flex",mt:4,alignItems:"center",opacity:_.isCategorical?1:0,transition:"all 0.5s ease"},children:[(0,i.jsx)(a.Z,{children:(0,i.jsx)(o.Z,{value:_.g1,onChange:(e,l)=>w(e=>({...e,g1:l})),isOptionEqualToValue:(e,l)=>e.id===l.id,id:"metadata-column",options:_.colOpts,sx:{width:150},renderInput:e=>(0,i.jsx)(r.Z,{...e,label:"First Group"}),renderOption:(e,l)=>(0,n.createElement)("li",{...e,key:l.label},l.label)})}),(0,i.jsx)(a.Z,{sx:{px:2},children:(0,i.jsx)(d.Z,{children:"vs"})}),(0,i.jsx)(a.Z,{children:(0,i.jsx)(o.Z,{value:_.g2,onChange:(e,l)=>w(e=>({...e,g2:l})),isOptionEqualToValue:(e,l)=>e.id===l.id,id:"metadata-column",options:_.colOpts,sx:{width:150},renderInput:e=>(0,i.jsx)(r.Z,{...e,label:"Second Group"}),renderOption:(e,l)=>(0,n.createElement)("li",{...e,key:l.label},l.label)})})]})]}),(0,i.jsx)(a.Z,{sx:{width:"2%",borderWidth:"0px 1px 0px 0px",borderStyle:"dashed",borderColor:"#aaaaaa"}}),(0,i.jsx)(a.Z,{sx:{width:"55%",display:"flex",justifyContent:"space-evenly"},children:m.map(e=>(0,i.jsx)(y,{o:e,omicIdCol_i:G[e],setOmicIdCol_i:l=>N(t=>({...t,[e]:l})),omicIdType_i:P[e],setOmicIdType_i:l=>A(t=>({...t,[e]:l})),handleOmicIdChange:q},e))})]})}}}]);