"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[607],{93202:function(e,t,l){var n=l(26314);t.Z=void 0;var r=n(l(80984)),a=l(57437),s=(0,r.default)((0,a.jsx)("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"FileDownload");t.Z=s},81607:function(e,t,l){l.r(t),l.d(t,{default:function(){return k}});var n=l(57437),r=l(96507),a=l(2265),s=l(49600),o=l(85269),i=l(47042),d=l(33457),c=l(11093),u=l(92069),p=l(93202),x=l(41637);let h={muiTableHeadCellProps:{align:"center"},muiTableBodyCellProps:{align:"center"},size:150};var f=function(e){let{runId:t,model_info:l,view:f,workingOmics:m}=e,{OMIC2NAME:b,API_URL:g}=(0,c.S)(),{jobID:y}=(0,x.tc)(),[j,v]=(0,a.useState)({status:"ready"}),w=(0,a.useRef)(),C=(0,a.useCallback)(async e=>{console.log("fetching stats model");let t=await fetch("".concat(g,"/get_stats_model/").concat(y,"/").concat(f,"/").concat(e)),l=await t.json();console.log(l),"waiting"!=l.status&&(v(l),clearInterval(w.current))},[g,y,f,w]);(0,a.useEffect)(()=>{if(console.log("useEffect"),"ready"!=j.status)return;let e=setInterval(()=>C(t),5e3);return w.current=e,()=>clearInterval(e)},[C,w,j,t]);let Z=(0,a.useMemo)(()=>{let e=[];return"Multi-View"==f&&(e=m.map(e=>({header:"".concat(b[e]," (%)"),id:e,accessorFn:t=>(100*t.omic_weight[b[e]]).toFixed(2),...h}))),e},[m,b,f]),S=(0,a.useMemo)(()=>[{accessorKey:"LV",header:"Latent Variable",...h},...Z,{id:"R2",header:"R2",accessorFn:e=>"".concat(Math.round(1e4*e.R2)/1e4),...h},{id:"pv",header:"p-value",accessorFn:e=>"".concat(e.pv<1e-4?e.pv.toExponential(2):e.pv.toFixed(5)),...h}],[Z]),E=(0,d.X0)({columns:S,data:l.LV,enableColumnFilterModes:!1,enableColumnOrdering:!1,enableGrouping:!1,enableColumnPinning:!1,enableFacetedValues:!1,enableRowActions:!1,enableRowSelection:!1,enableGlobalFilter:!1,enableColumnActions:!1,enableSorting:!1,enableDensityToggle:!1,enableHiding:!1,enableFullScreenToggle:!1,enableFilters:!1,enableBottomToolbar:!1,renderTopToolbarCustomActions:e=>{let{table:t}=e;return(0,n.jsxs)(r.Z,{sx:{width:"100%",display:"flex",gap:"16px",padding:"8px",flexWrap:"wrap",alignItems:"center",justifyContent:"space-between"},children:[(0,n.jsx)(r.Z,{sx:{border:"0px solid red"},children:(0,n.jsx)(s.Z,{onClick:()=>(function(e,t,l){let n=(0,u.iL)({fieldSeparator:",",decimalSeparator:".",columnHeaders:t,filename:l}),r=(0,u.gB)(n)(e);(0,u.LR)(n)(r)})(t.getRowModel().rows.map(e=>e._valuesCache),t.getAllColumns().map(e=>({key:e.columnDef.id,displayLabel:e.columnDef.header})),"PathwayAnalysis_Model"),startIcon:(0,n.jsx)(p.Z,{}),children:"Export Table"})}),(0,n.jsxs)(r.Z,{sx:{border:"0px solid red",textAlign:"center"},children:[(0,n.jsxs)(o.Z,{variant:"body1",children:["Model R2 = ",l.model.R2.toFixed(4)]}),(0,n.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,n.jsxs)(o.Z,{variant:"body1",sx:{border:"0px solid blue"},children:["p-value ","â‰¤"," "]}),(0,n.jsxs)(r.Z,{sx:{pl:.75},children:[["ready","waiting"].includes(j.status)&&(0,n.jsx)(r.Z,{sx:{pt:.5},children:(0,n.jsx)(i.Z,{size:15,disableShrink:!0})}),"ok"==j.status&&(0,n.jsx)(o.Z,{variant:"body1",children:j.statsModel.R2pv})]})]})]})]})}});return(0,n.jsx)(r.Z,{children:(0,n.jsx)(d.P2,{table:E})})},m=l(70812),b=l(67248),g=l(35048),y=l(41125),j=l(16573),v=l(24235),w=l(33343),C=l(50039),Z=l(79857),S=l(89366),E=l(90053);let F=e=>{let{selectedLV:t,setSelectedLV:l,projOpts:s}=e;return(0,n.jsxs)(r.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,n.jsx)(r.Z,{sx:{px:2},children:(0,n.jsx)(m.Z,{value:t.x,onChange:(e,t)=>t&&l(e=>({...e,x:t})),isOptionEqualToValue:(e,t)=>e.id===t.id,id:"xAxis",options:s,sx:{width:120},renderInput:e=>(0,n.jsx)(b.Z,{...e,label:"X Axis"}),renderOption:(e,t)=>(0,a.createElement)("li",{...e,key:t.label},t.label)})}),(0,n.jsx)(r.Z,{sx:{px:2},children:(0,n.jsx)(m.Z,{value:t.y,onChange:(e,t)=>t&&l(e=>({...e,y:t})),isOptionEqualToValue:(e,t)=>e.id===t.id,id:"yAxis",options:s,sx:{width:120},renderInput:e=>(0,n.jsx)(b.Z,{...e,label:"Y Axis"}),renderOption:(e,t)=>(0,a.createElement)("li",{...e,key:t.label},t.label)})})]})};var L=function(e){let{projections:t,nLV:l,mdataCategorical:s}=e;console.log(s);let o=(0,x.tc)().user.mdata.column(s.mdataCol),i=(0,a.useMemo)(()=>t.map(e=>({sample:e.sample,g:o.values[o.index.indexOf(e.sample)],...e.proj.reduce((e,t,l)=>({...e,["LV".concat(l+1)]:t}),{})})),[t,o]),d=(0,a.useMemo)(()=>{let e=[];for(let t=1;t<=l;t++)e.push("LV".concat(t));return e.map(e=>({label:e,id:e}))},[l]),[c,u]=(0,a.useState)({x:d[0],y:d[1]});return console.log(c),(0,n.jsxs)(r.Z,{sx:{},children:[(0,n.jsx)(r.Z,{children:(0,n.jsx)(F,{selectedLV:c,setSelectedLV:u,projOpts:d})}),(0,n.jsx)(r.Z,{children:(0,n.jsx)(g.h,{width:"100%",height:400,children:(0,n.jsxs)(y.G,{margin:{top:5,right:20,bottom:20,left:20},children:[(0,n.jsx)(j.q,{}),(0,n.jsx)(v.K,{type:"number",dataKey:c.x.label,name:c.x.label,children:(0,n.jsx)(w._,{value:"".concat(c.x.label),offset:-10,position:"insideBottom"})}),(0,n.jsx)(C.B,{type:"number",dataKey:c.y.label,name:c.y.label,children:(0,n.jsx)(w._,{value:c.y.label,offset:20,position:"insideLeft",angle:-90})}),(0,n.jsx)(Z.D,{verticalAlign:"top"}),(0,n.jsx)(S.b,{name:s.g1.id,data:i.filter(e=>e.g==s.g1.id),fill:E.s[0]}),(0,n.jsx)(S.b,{name:s.g2.id,data:i.filter(e=>e.g==s.g2.id),fill:E.s[1]})]})})})]})},k=function(e){let{pwa_res:t,runId:l,rId2info:a,view:s,workingOmics:o,mdataCategorical:i}=e;return console.log(t),(0,n.jsx)(r.Z,{children:(0,n.jsxs)(r.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(r.Z,{sx:{width:"50%"},children:(0,n.jsx)(f,{runId:l,model_info:t.model_info,view:s,workingOmics:o})}),(0,n.jsx)(r.Z,{sx:{width:"50%"},children:(0,n.jsx)(L,{projections:t.projections,nLV:t.model_info.LV.length,mdataCategorical:i})})]})})}},92069:function(e,t,l){l.d(t,{LR:function(){return C},gB:function(){return w},iL:function(){return r}});var n={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},r=e=>Object.assign({},n,e);class a extends Error{constructor(e){super(e),this.name="CsvGenerationError"}}class s extends Error{constructor(e){super(e),this.name="EmptyHeadersError"}}class o extends Error{constructor(e){super(e),this.name="CsvDownloadEnvironmentError"}}var i=e=>e,d=e=>e,c=e=>"object"==typeof e?i(e.key):i(e),u=e=>"object"==typeof e?i(e.displayLabel):i(e),p=(e,...t)=>t.reduce((e,t)=>t(e),e),x=e=>t=>e.useBom?i(d(t)+"\uFEFF"):t,h=e=>t=>e.showTitle?i(d(t)+e.title):t,f=e=>t=>i(d(e)+d(t)+"\r\n"),m=e=>(t,l)=>b(e)(i(t+l)),b=e=>t=>i(d(t)+e.fieldSeparator),g=(e,t)=>l=>{if(!e.showColumnHeaders)return l;if(t.length<1)throw new s("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let n=i("");for(let l=0;l<t.length;l++){let r=u(t[l]);n=m(e)(n,v(e,r))}return n=i(d(n).slice(0,-1)),f(l)(n)},y=(e,t,l)=>n=>{let r=n;for(var a=0;a<l.length;a++){let n=i("");for(let r=0;r<t.length;r++){let s=c(t[r]),o=void 0===l[a][d(s)]?e.replaceUndefinedWith:l[a][d(s)];n=m(e)(n,v(e,o))}n=i(d(n).slice(0,-1)),r=f(r)(n)}return r},j=e=>+e===e&&(!isFinite(e)||!!(e%1)),v=(e,t)=>{if("locale"===e.decimalSeparator&&j(t))return t.toLocaleString();if("."!==e.decimalSeparator&&j(t))return t.toString().replace(".",e.decimalSeparator);if("string"==typeof t){let l=t;return(e.quoteStrings||e.fieldSeparator&&t.indexOf(e.fieldSeparator)>-1||t.indexOf("\n")>-1||t.indexOf("\r")>-1)&&(l=e.quoteCharacter+t+e.quoteCharacter),l}if("boolean"==typeof t&&e.boolDisplay){let l=t?"true":"false";return e.boolDisplay[l]}return t},w=e=>t=>{let l=r(e),n=l.useKeysAsHeaders?Object.keys(t[0]):l.columnHeaders,s=p(i(""),x(l),h(l),g(l,n),y(l,n,t));if(d(s).length<1)throw new a("Output is empty. Is your data formatted correctly?");return s},C=e=>t=>{if(!window)throw new o("Downloading only supported in a browser environment.");let l=r(e),n=d(t),a=l.useTextFile?"plain":"csv",s=l.useTextFile?"txt":"csv",i=new Blob([n],{type:`text/${a};charset=utf8;`}),c=document.createElement("a");c.download=`${l.filename}.${s}`,c.href=URL.createObjectURL(i),c.setAttribute("visibility","hidden"),document.body.appendChild(c),c.click(),document.body.removeChild(c)}}}]);