(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[625],{42568:function(t,e,i){"use strict";var r=i(26314);e.Z=void 0;var n=r(i(80984)),o=i(57437);e.Z=(0,n.default)([(0,o.jsx)("path",{d:"M6.41 6 5 7.41 9.58 12 5 16.59 6.41 18l6-6z"},"0"),(0,o.jsx)("path",{d:"m13 6-1.41 1.41L16.17 12l-4.58 4.59L13 18l6-6z"},"1")],"KeyboardDoubleArrowRight")},43571:function(t){t.exports=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,i){return(e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,i)}function i(t,r,n){return(i=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?function(t,i,r){var n=[null];n.push.apply(n,i);var o=new(Function.bind.apply(t,n));return r&&e(o,r.prototype),o}:Reflect.construct).apply(null,arguments)}function r(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return n(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}var o,s=Object.hasOwnProperty,l=Object.setPrototypeOf,a=Object.isFrozen,h=Object.getPrototypeOf,u=Object.getOwnPropertyDescriptor,c=Object.freeze,d=Object.seal,g=Object.create,f="undefined"!=typeof Reflect&&Reflect,p=f.apply,m=f.construct;p||(p=function(t,e,i){return t.apply(e,i)}),c||(c=function(t){return t}),d||(d=function(t){return t}),m||(m=function(t,e){return i(t,r(e))});var w=x(Array.prototype.forEach),b=x(Array.prototype.pop),y=x(Array.prototype.push),C=x(String.prototype.toLowerCase),S=x(String.prototype.toString),E=x(String.prototype.match),R=x(String.prototype.replace),T=x(String.prototype.indexOf),M=x(String.prototype.trim),O=x(RegExp.prototype.test),k=(o=TypeError,function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return m(o,e)});function x(t){return function(e){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];return p(t,e,r)}}function I(t,e,i){i=null!==(r=i)&&void 0!==r?r:C,l&&l(t,null);for(var r,n=e.length;n--;){var o=e[n];if("string"==typeof o){var s=i(o);s!==o&&(a(e)||(e[n]=s),o=s)}t[o]=!0}return t}function A(t){var e,i=g(null);for(e in t)!0===p(s,t,[e])&&(i[e]=t[e]);return i}function N(t,e){for(;null!==t;){var i=u(t,e);if(i){if(i.get)return x(i.get);if("function"==typeof i.value)return x(i.value)}t=h(t)}return function(t){return console.warn("fallback value for",t),null}}var H=c(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_=c(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),P=c(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),D=c(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),L=c(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),B=c(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),W=c(["#text"]),V=c(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),F=c(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),j=c(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=c(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),$=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),z=d(/<%[\w\W]*|[\w\W]*%>/gm),K=d(/\${[\w\W]*}/gm),G=d(/^data-[\-\w.\u00B7-\uFFFF]/),Y=d(/^aria-[\-\w]+$/),X=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),q=d(/^(?:\w+script|data):/i),Z=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),J=d(/^html$/i),Q=function(e,i){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var r=null,n="data-tt-policy-suffix";i.currentScript&&i.currentScript.hasAttribute(n)&&(r=i.currentScript.getAttribute(n));var o="dompurify"+(r?"#"+r:"");try{return e.createPolicy(o,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function e(){var i,n,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,s=function(t){return e(t)};if(s.version="2.4.7",s.removed=[],!o||!o.document||9!==o.document.nodeType)return s.isSupported=!1,s;var l=o.document,a=o.document,h=o.DocumentFragment,u=o.HTMLTemplateElement,d=o.Node,g=o.Element,f=o.NodeFilter,p=o.NamedNodeMap,m=void 0===p?o.NamedNodeMap||o.MozNamedAttrMap:p,x=o.HTMLFormElement,tt=o.DOMParser,te=o.trustedTypes,ti=g.prototype,tr=N(ti,"cloneNode"),tn=N(ti,"nextSibling"),to=N(ti,"childNodes"),ts=N(ti,"parentNode");if("function"==typeof u){var tl=a.createElement("template");tl.content&&tl.content.ownerDocument&&(a=tl.content.ownerDocument)}var ta=Q(te,l),th=ta?ta.createHTML(""):"",tu=a,tc=tu.implementation,td=tu.createNodeIterator,tg=tu.createDocumentFragment,tf=tu.getElementsByTagName,tp=l.importNode,tm={};try{tm=A(a).documentMode?a.documentMode:{}}catch(t){}var tw={};s.isSupported="function"==typeof ts&&tc&&void 0!==tc.createHTMLDocument&&9!==tm;var tv=X,tb=null,ty=I({},[].concat(r(H),r(_),r(P),r(L),r(W))),tC=null,tS=I({},[].concat(r(V),r(F),r(j),r(U))),tE=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),tR=null,tT=null,tM=!0,tO=!0,tk=!1,tx=!0,tI=!1,tA=!1,tN=!1,tH=!1,t_=!1,tP=!1,tD=!1,tL=!0,tB=!1,tW=!0,tV=!1,tF={},tj=null,tU=I({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),t$=null,tz=I({},["audio","video","img","source","image","track"]),tK=null,tG=I({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tY="http://www.w3.org/1998/Math/MathML",tX="http://www.w3.org/2000/svg",tq="http://www.w3.org/1999/xhtml",tZ=tq,tJ=!1,tQ=null,t0=I({},[tY,tX,tq],S),t1=["application/xhtml+xml","text/html"],t2=null,t4=a.createElement("form"),t5=function(t){return t instanceof RegExp||t instanceof Function},t8=function(e){t2&&t2===e||(e&&"object"===t(e)||(e={}),e=A(e),n="application/xhtml+xml"===(i=i=-1===t1.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?S:C,tb="ALLOWED_TAGS"in e?I({},e.ALLOWED_TAGS,n):ty,tC="ALLOWED_ATTR"in e?I({},e.ALLOWED_ATTR,n):tS,tQ="ALLOWED_NAMESPACES"in e?I({},e.ALLOWED_NAMESPACES,S):t0,tK="ADD_URI_SAFE_ATTR"in e?I(A(tG),e.ADD_URI_SAFE_ATTR,n):tG,t$="ADD_DATA_URI_TAGS"in e?I(A(tz),e.ADD_DATA_URI_TAGS,n):tz,tj="FORBID_CONTENTS"in e?I({},e.FORBID_CONTENTS,n):tU,tR="FORBID_TAGS"in e?I({},e.FORBID_TAGS,n):{},tT="FORBID_ATTR"in e?I({},e.FORBID_ATTR,n):{},tF="USE_PROFILES"in e&&e.USE_PROFILES,tM=!1!==e.ALLOW_ARIA_ATTR,tO=!1!==e.ALLOW_DATA_ATTR,tk=e.ALLOW_UNKNOWN_PROTOCOLS||!1,tx=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,tI=e.SAFE_FOR_TEMPLATES||!1,tA=e.WHOLE_DOCUMENT||!1,t_=e.RETURN_DOM||!1,tP=e.RETURN_DOM_FRAGMENT||!1,tD=e.RETURN_TRUSTED_TYPE||!1,tH=e.FORCE_BODY||!1,tL=!1!==e.SANITIZE_DOM,tB=e.SANITIZE_NAMED_PROPS||!1,tW=!1!==e.KEEP_CONTENT,tV=e.IN_PLACE||!1,tv=e.ALLOWED_URI_REGEXP||tv,tZ=e.NAMESPACE||tq,tE=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&t5(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(tE.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&t5(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(tE.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(tE.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),tI&&(tO=!1),tP&&(t_=!0),tF&&(tb=I({},r(W)),tC=[],!0===tF.html&&(I(tb,H),I(tC,V)),!0===tF.svg&&(I(tb,_),I(tC,F),I(tC,U)),!0===tF.svgFilters&&(I(tb,P),I(tC,F),I(tC,U)),!0===tF.mathMl&&(I(tb,L),I(tC,j),I(tC,U))),e.ADD_TAGS&&(tb===ty&&(tb=A(tb)),I(tb,e.ADD_TAGS,n)),e.ADD_ATTR&&(tC===tS&&(tC=A(tC)),I(tC,e.ADD_ATTR,n)),e.ADD_URI_SAFE_ATTR&&I(tK,e.ADD_URI_SAFE_ATTR,n),e.FORBID_CONTENTS&&(tj===tU&&(tj=A(tj)),I(tj,e.FORBID_CONTENTS,n)),tW&&(tb["#text"]=!0),tA&&I(tb,["html","head","body"]),tb.table&&(I(tb,["tbody"]),delete tR.tbody),c&&c(e),t2=e)},t9=I({},["mi","mo","mn","ms","mtext"]),t3=I({},["foreignobject","desc","title","annotation-xml"]),t7=I({},["title","style","font","a","script"]),t6=I({},_);I(t6,P),I(t6,D);var et=I({},L);I(et,B);var ee=function(t){var e=ts(t);e&&e.tagName||(e={namespaceURI:tZ,tagName:"template"});var r=C(t.tagName),n=C(e.tagName);return!!tQ[t.namespaceURI]&&(t.namespaceURI===tX?e.namespaceURI===tq?"svg"===r:e.namespaceURI===tY?"svg"===r&&("annotation-xml"===n||t9[n]):!!t6[r]:t.namespaceURI===tY?e.namespaceURI===tq?"math"===r:e.namespaceURI===tX?"math"===r&&t3[n]:!!et[r]:t.namespaceURI===tq?(e.namespaceURI!==tX||!!t3[n])&&(e.namespaceURI!==tY||!!t9[n])&&!et[r]&&(t7[r]||!t6[r]):"application/xhtml+xml"===i&&!!tQ[t.namespaceURI])},ei=function(t){y(s.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=th}catch(e){t.remove()}}},er=function(t,e){try{y(s.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){y(s.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!tC[t]){if(t_||tP)try{ei(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}}},en=function(t){if(tH)t="<remove></remove>"+t;else{var e,r,n=E(t,/^[\r\n\t ]+/);r=n&&n[0]}"application/xhtml+xml"===i&&tZ===tq&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var o=ta?ta.createHTML(t):t;if(tZ===tq)try{e=new tt().parseFromString(o,i)}catch(t){}if(!e||!e.documentElement){e=tc.createDocument(tZ,"template",null);try{e.documentElement.innerHTML=tJ?th:o}catch(t){}}var s=e.body||e.documentElement;return(t&&r&&s.insertBefore(a.createTextNode(r),s.childNodes[0]||null),tZ===tq)?tf.call(e,tA?"html":"body")[0]:tA?e.documentElement:s},eo=function(t){return td.call(t.ownerDocument||t,t,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT,null,!1)},es=function(e){return"object"===t(d)?e instanceof d:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},el=function(t,e,i){tw[t]&&w(tw[t],function(t){t.call(s,e,i,t2)})},ea=function(t){if(el("beforeSanitizeElements",t,null),t instanceof x&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof m)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)||O(/[\u0080-\uFFFF]/,t.nodeName))return ei(t),!0;var e,i=n(t.nodeName);if(el("uponSanitizeElement",t,{tagName:i,allowedTags:tb}),t.hasChildNodes()&&!es(t.firstElementChild)&&(!es(t.content)||!es(t.content.firstElementChild))&&O(/<[/\w]/g,t.innerHTML)&&O(/<[/\w]/g,t.textContent)||"select"===i&&O(/<template/i,t.innerHTML))return ei(t),!0;if(!tb[i]||tR[i]){if(!tR[i]&&eu(i)&&(tE.tagNameCheck instanceof RegExp&&O(tE.tagNameCheck,i)||tE.tagNameCheck instanceof Function&&tE.tagNameCheck(i)))return!1;if(tW&&!tj[i]){var r=ts(t)||t.parentNode,o=to(t)||t.childNodes;if(o&&r)for(var l=o.length,a=l-1;a>=0;--a)r.insertBefore(tr(o[a],!0),tn(t))}return ei(t),!0}return t instanceof g&&!ee(t)||("noscript"===i||"noembed"===i||"noframes"===i)&&O(/<\/no(script|embed|frames)/i,t.innerHTML)?(ei(t),!0):(tI&&3===t.nodeType&&(e=R(e=t.textContent,$," "),e=R(e,z," "),e=R(e,K," "),t.textContent!==e&&(y(s.removed,{element:t.cloneNode()}),t.textContent=e)),el("afterSanitizeElements",t,null),!1)},eh=function(t,e,i){if(tL&&("id"===e||"name"===e)&&(i in a||i in t4))return!1;if(tO&&!tT[e]&&O(G,e));else if(tM&&O(Y,e));else if(!tC[e]||tT[e]){if(!(eu(t)&&(tE.tagNameCheck instanceof RegExp&&O(tE.tagNameCheck,t)||tE.tagNameCheck instanceof Function&&tE.tagNameCheck(t))&&(tE.attributeNameCheck instanceof RegExp&&O(tE.attributeNameCheck,e)||tE.attributeNameCheck instanceof Function&&tE.attributeNameCheck(e))||"is"===e&&tE.allowCustomizedBuiltInElements&&(tE.tagNameCheck instanceof RegExp&&O(tE.tagNameCheck,i)||tE.tagNameCheck instanceof Function&&tE.tagNameCheck(i))))return!1}else if(tK[e]);else if(O(tv,R(i,Z,"")));else if(("src"===e||"xlink:href"===e||"href"===e)&&"script"!==t&&0===T(i,"data:")&&t$[t]);else if(tk&&!O(q,R(i,Z,"")));else if(i)return!1;return!0},eu=function(t){return t.indexOf("-")>0},ec=function(e){el("beforeSanitizeAttributes",e,null);var i,r,o,l,a=e.attributes;if(a){var h={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:tC};for(l=a.length;l--;){var u=(i=a[l]).name,c=i.namespaceURI;if(r="value"===u?i.value:M(i.value),o=n(u),h.attrName=o,h.attrValue=r,h.keepAttr=!0,h.forceKeepAttr=void 0,el("uponSanitizeAttribute",e,h),r=h.attrValue,!h.forceKeepAttr&&(er(u,e),h.keepAttr)){if(!tx&&O(/\/>/i,r)){er(u,e);continue}tI&&(r=R(r,$," "),r=R(r,z," "),r=R(r,K," "));var d=n(e.nodeName);if(eh(d,o,r)){if(tB&&("id"===o||"name"===o)&&(er(u,e),r="user-content-"+r),ta&&"object"===t(te)&&"function"==typeof te.getAttributeType){if(c);else switch(te.getAttributeType(d,o)){case"TrustedHTML":r=ta.createHTML(r);break;case"TrustedScriptURL":r=ta.createScriptURL(r)}}try{c?e.setAttributeNS(c,u,r):e.setAttribute(u,r),b(s.removed)}catch(t){}}}}el("afterSanitizeAttributes",e,null)}},ed=function t(e){var i,r=eo(e);for(el("beforeSanitizeShadowDOM",e,null);i=r.nextNode();)el("uponSanitizeShadowNode",i,null),ea(i)||(i.content instanceof h&&t(i.content),ec(i));el("afterSanitizeShadowDOM",e,null)};return s.sanitize=function(e){var i,r,a,u,c,g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((tJ=!e)&&(e="<!-->"),"string"!=typeof e&&!es(e)){if("function"==typeof e.toString){if("string"!=typeof(e=e.toString()))throw k("dirty is not a string, aborting")}else throw k("toString is not a function")}if(!s.isSupported){if("object"===t(o.toStaticHTML)||"function"==typeof o.toStaticHTML){if("string"==typeof e)return o.toStaticHTML(e);if(es(e))return o.toStaticHTML(e.outerHTML)}return e}if(tN||t8(g),s.removed=[],"string"==typeof e&&(tV=!1),tV){if(e.nodeName){var f=n(e.nodeName);if(!tb[f]||tR[f])throw k("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof d)1===(r=(i=en("<!---->")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===r.nodeName?i=r:"HTML"===r.nodeName?i=r:i.appendChild(r);else{if(!t_&&!tI&&!tA&&-1===e.indexOf("<"))return ta&&tD?ta.createHTML(e):e;if(!(i=en(e)))return t_?null:tD?th:""}i&&tH&&ei(i.firstChild);for(var p=eo(tV?e:i);a=p.nextNode();)3===a.nodeType&&a===u||ea(a)||(a.content instanceof h&&ed(a.content),ec(a),u=a);if(u=null,tV)return e;if(t_){if(tP)for(c=tg.call(i.ownerDocument);i.firstChild;)c.appendChild(i.firstChild);else c=i;return(tC.shadowroot||tC.shadowrootmod)&&(c=tp.call(l,c,!0)),c}var m=tA?i.outerHTML:i.innerHTML;return tA&&tb["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&O(J,i.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+m),tI&&(m=R(m,$," "),m=R(m,z," "),m=R(m,K," ")),ta&&tD?ta.createHTML(m):m},s.setConfig=function(t){t8(t),tN=!0},s.clearConfig=function(){t2=null,tN=!1},s.isValidAttribute=function(t,e,i){return t2||t8({}),eh(n(t),n(e),i)},s.addHook=function(t,e){"function"==typeof e&&(tw[t]=tw[t]||[],y(tw[t],e))},s.removeHook=function(t){if(tw[t])return b(tw[t])},s.removeHooks=function(t){tw[t]&&(tw[t]=[])},s.removeAllHooks=function(){tw={}},s}()}()},45353:function(){},84695:function(t){t.exports=(function t(e,i,r){function n(s,l){if(!i[s]){if(!e[s]){if(o)return o(s,!0);var a=Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){return n(e[s][1][t]||t)},h,h.exports,t,e,i,r)}return i[s].exports}for(var o=void 0,s=0;s<r.length;s++)n(r[s]);return n})({1:[function(t,e,i){!function(t){"use strict";var i,r=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,n=Math.ceil,o=Math.floor,s="[BigNumber Error] ",l=s+"Number primitive has more than 15 significant digits: ",a=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function h(t){var e=0|t;return 0<t||t===e?e:e-1}function u(t){for(var e,i,r=1,n=t.length,o=t[0]+"";r<n;){for(i=14-(e=t[r++]+"").length;i--;e="0"+e);o+=e}for(n=o.length;48===o.charCodeAt(--n););return o.slice(0,n+1||1)}function c(t,e){var i,r,n=t.c,o=e.c,s=t.s,l=e.s,a=t.e,h=e.e;if(!s||!l)return null;if(i=n&&!n[0],r=o&&!o[0],i||r)return i?r?0:-l:s;if(s!=l)return s;if(i=s<0,r=a==h,!n||!o)return r?0:!n^i?1:-1;if(!r)return h<a^i?1:-1;for(l=(a=n.length)<(h=o.length)?a:h,s=0;s<l;s++)if(n[s]!=o[s])return n[s]>o[s]^i?1:-1;return a==h?0:h<a^i?1:-1}function d(t,e,i,r){if(t<e||i<t||t!==(t<0?n(t):o(t)))throw Error(s+(r||"Argument")+("number"==typeof t?t<e||i<t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function g(t){var e=t.c.length-1;return h(t.e/14)==e&&t.c[e]%2!=0}function f(t,e){return(1<t.length?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function p(t,e,i){var r,n;if(e<0){for(n=i+".";++e;n+=i);t=n+t}else if(++e>(r=t.length)){for(n=i,e-=r;--e;n+=i);t+=n}else e<r&&(t=t.slice(0,e)+"."+t.slice(e));return t}(i=function t(e){var i,m,w,b,y,C,S,E,R,T=B.prototype={constructor:B,toString:null,valueOf:null},M=new B(1),O=20,k=4,x=-7,I=21,A=-1e7,N=1e7,H=!1,_=1,P=0,D={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},L="0123456789abcdefghijklmnopqrstuvwxyz";function B(t,e){var i,n,s,a,h,u,c,g,f=this;if(!(f instanceof B))return new B(t,e);if(null==e){if(t instanceof B)return f.s=t.s,f.e=t.e,void(f.c=(t=t.c)?t.slice():t);if((u="number"==typeof t)&&0*t==0){if(f.s=1/t<0?(t=-t,-1):1,t===~~t){for(a=0,h=t;10<=h;h/=10,a++);return f.e=a,void(f.c=[t])}g=String(t)}else{if(g=String(t),!r.test(g))return w(f,g,u);f.s=45==g.charCodeAt(0)?(g=g.slice(1),-1):1}-1<(a=g.indexOf("."))&&(g=g.replace(".","")),0<(h=g.search(/e/i))?(a<0&&(a=h),a+=+g.slice(h+1),g=g.substring(0,h)):a<0&&(a=g.length)}else{if(d(e,2,L.length,"Base"),g=String(t),10==e)return j(f=new B(t instanceof B?t:g),O+f.e+1,k);if(u="number"==typeof t){if(0*t!=0)return w(f,g,u,e);if(f.s=1/t<0?(g=g.slice(1),-1):1,B.DEBUG&&15<g.replace(/^0\.0*|\./,"").length)throw Error(l+t);u=!1}else f.s=45===g.charCodeAt(0)?(g=g.slice(1),-1):1;for(i=L.slice(0,e),a=h=0,c=g.length;h<c;h++)if(0>i.indexOf(n=g.charAt(h))){if("."==n){if(a<h){a=c;continue}}else if(!s&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){s=!0,h=-1,a=0;continue}return w(f,String(t),u,e)}-1<(a=(g=m(g,e,10,f.s)).indexOf("."))?g=g.replace(".",""):a=g.length}for(h=0;48===g.charCodeAt(h);h++);for(c=g.length;48===g.charCodeAt(--c););if(g=g.slice(h,++c)){if(c-=h,u&&B.DEBUG&&15<c&&(9007199254740991<t||t!==o(t)))throw Error(l+f.s*t);if(N<(a=a-h-1))f.c=f.e=null;else if(a<A)f.c=[f.e=0];else{if(f.e=a,f.c=[],h=(a+1)%14,a<0&&(h+=14),h<c){for(h&&f.c.push(+g.slice(0,h)),c-=14;h<c;)f.c.push(+g.slice(h,h+=14));h=14-(g=g.slice(h)).length}else h-=c;for(;h--;g+="0");f.c.push(+g)}}else f.c=[f.e=0]}function W(t,e,i,r){var n,o,s,l,a;if(null==i?i=k:d(i,0,8),!t.c)return t.toString();if(n=t.c[0],s=t.e,null==e)a=u(t.c),a=1==r||2==r&&(s<=x||I<=s)?f(a,s):p(a,s,"0");else if(o=(t=j(new B(t),e,i)).e,l=(a=u(t.c)).length,1==r||2==r&&(e<=o||o<=x)){for(;l<e;a+="0",l++);a=f(a,o)}else if(e-=s,a=p(a,o,"0"),l<o+1){if(0<--e)for(a+=".";e--;a+="0");}else if(0<(e+=o-l))for(o+1==l&&(a+=".");e--;a+="0");return t.s<0&&n?"-"+a:a}function V(t,e){for(var i,r=1,n=new B(t[0]);r<t.length;r++){if(!(i=new B(t[r])).s){n=i;break}e.call(n,i)&&(n=i)}return n}function F(t,e,i){for(var r=1,n=e.length;!e[--n];e.pop());for(n=e[0];10<=n;n/=10,r++);return(i=r+14*i-1)>N?t.c=t.e=null:t.c=i<A?[t.e=0]:(t.e=i,e),t}function j(t,e,i,r){var s,l,h,u,c,d,g,f=t.c;if(f){t:{for(s=1,u=f[0];10<=u;u/=10,s++);if((l=e-s)<0)l+=14,h=e,g=(c=f[d=0])/a[s-h-1]%10|0;else if((d=n((l+1)/14))>=f.length){if(!r)break t;for(;f.length<=d;f.push(0));c=g=0,h=(l%=14)-14+(s=1)}else{for(c=u=f[d],s=1;10<=u;u/=10,s++);g=(h=(l%=14)-14+s)<0?0:c/a[s-h-1]%10|0}if(r=r||e<0||null!=f[d+1]||(h<0?c:c%a[s-h-1]),r=i<4?(g||r)&&(0==i||i==(t.s<0?3:2)):5<g||5==g&&(4==i||r||6==i&&(0<l?0<h?c/a[s-h]:0:f[d-1])%10&1||i==(t.s<0?8:7)),e<1||!f[0])return f.length=0,r?(e-=t.e+1,f[0]=a[(14-e%14)%14],t.e=-e||0):f[0]=t.e=0,t;if(0==l?(f.length=d,u=1,d--):(f.length=d+1,u=a[14-l],f[d]=0<h?o(c/a[s-h]%a[h])*u:0),r)for(;;){if(0==d){for(l=1,h=f[0];10<=h;h/=10,l++);for(h=f[0]+=u,u=1;10<=h;h/=10,u++);l!=u&&(t.e++,1e14==f[0]&&(f[0]=1));break}if(f[d]+=u,1e14!=f[d])break;f[d--]=0,u=1}for(l=f.length;0===f[--l];f.pop());}t.e>N?t.c=t.e=null:t.e<A&&(t.c=[t.e=0])}return t}function U(t){var e,i=t.e;return null===i?t.toString():(e=u(t.c),e=i<=x||I<=i?f(e,i):p(e,i,"0"),t.s<0?"-"+e:e)}return B.clone=t,B.ROUND_UP=0,B.ROUND_DOWN=1,B.ROUND_CEIL=2,B.ROUND_FLOOR=3,B.ROUND_HALF_UP=4,B.ROUND_HALF_DOWN=5,B.ROUND_HALF_EVEN=6,B.ROUND_HALF_CEIL=7,B.ROUND_HALF_FLOOR=8,B.EUCLID=9,B.config=B.set=function(t){var e,i;if(null!=t){if("object"!=typeof t)throw Error(s+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(d(i=t[e],0,1e9,e),O=i),t.hasOwnProperty(e="ROUNDING_MODE")&&(d(i=t[e],0,8,e),k=i),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((i=t[e])&&i.pop?(d(i[0],-1e9,0,e),d(i[1],0,1e9,e),x=i[0],I=i[1]):(d(i,-1e9,1e9,e),x=-(I=i<0?-i:i))),t.hasOwnProperty(e="RANGE")){if((i=t[e])&&i.pop)d(i[0],-1e9,-1,e),d(i[1],1,1e9,e),A=i[0],N=i[1];else{if(d(i,-1e9,1e9,e),!i)throw Error(s+e+" cannot be zero: "+i);A=-(N=i<0?-i:i)}}if(t.hasOwnProperty(e="CRYPTO")){if((i=t[e])!==!!i)throw Error(s+e+" not true or false: "+i);if(i){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw H=!i,Error(s+"crypto unavailable");H=i}else H=i}if(t.hasOwnProperty(e="MODULO_MODE")&&(d(i=t[e],0,9,e),_=i),t.hasOwnProperty(e="POW_PRECISION")&&(d(i=t[e],0,1e9,e),P=i),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(i=t[e]))throw Error(s+e+" not an object: "+i);D=i}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(i=t[e])||/^.$|[+-.\s]|(.).*\1/.test(i))throw Error(s+e+" invalid: "+i);L=i}}return{DECIMAL_PLACES:O,ROUNDING_MODE:k,EXPONENTIAL_AT:[x,I],RANGE:[A,N],CRYPTO:H,MODULO_MODE:_,POW_PRECISION:P,FORMAT:D,ALPHABET:L}},B.isBigNumber=function(t){return t instanceof B||t&&!0===t._isBigNumber||!1},B.maximum=B.max=function(){return V(arguments,T.lt)},B.minimum=B.min=function(){return V(arguments,T.gt)},B.random=(b=9007199254740992*Math.random()&2097151?function(){return o(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,i,r,l,h,u=0,c=[],g=new B(M);if(null==t?t=O:d(t,0,1e9),l=n(t/14),H){if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(l*=2));u<l;)9e15<=(h=131072*e[u]+(e[u+1]>>>11))?(i=crypto.getRandomValues(new Uint32Array(2)),e[u]=i[0],e[u+1]=i[1]):(c.push(h%1e14),u+=2);u=l/2}else{if(!crypto.randomBytes)throw H=!1,Error(s+"crypto unavailable");for(e=crypto.randomBytes(l*=7);u<l;)9e15<=(h=281474976710656*(31&e[u])+1099511627776*e[u+1]+4294967296*e[u+2]+16777216*e[u+3]+(e[u+4]<<16)+(e[u+5]<<8)+e[u+6])?crypto.randomBytes(7).copy(e,u):(c.push(h%1e14),u+=7);u=l/7}}if(!H)for(;u<l;)(h=b())<9e15&&(c[u++]=h%1e14);for(l=c[--u],t%=14,l&&t&&(h=a[14-t],c[u]=o(l/h)*h);0===c[u];c.pop(),u--);if(u<0)c=[r=0];else{for(r=-1;0===c[0];c.splice(0,1),r-=14);for(u=1,h=c[0];10<=h;h/=10,u++);u<14&&(r-=14-u)}return g.e=r,g.c=c,g}),B.sum=function(){for(var t=1,e=arguments,i=new B(e[0]);t<e.length;)i=i.plus(e[t++]);return i},m=function(){var t="0123456789";function e(t,e,i,r){for(var n,o,s=[0],l=0,a=t.length;l<a;){for(o=s.length;o--;s[o]*=e);for(s[0]+=r.indexOf(t.charAt(l++)),n=0;n<s.length;n++)s[n]>i-1&&(null==s[n+1]&&(s[n+1]=0),s[n+1]+=s[n]/i|0,s[n]%=i)}return s.reverse()}return function(r,n,o,s,l){var a,h,c,d,g,f,m,w,b=r.indexOf("."),y=O,C=k;for(0<=b&&(d=P,P=0,r=r.replace(".",""),f=(w=new B(n)).pow(r.length-b),P=d,w.c=e(p(u(f.c),f.e,"0"),10,o,t),w.e=w.c.length),c=d=(m=e(r,n,o,l?(a=L,t):(a=t,L))).length;0==m[--d];m.pop());if(!m[0])return a.charAt(0);if(b<0?--c:(f.c=m,f.e=c,f.s=s,m=(f=i(f,w,y,C,o)).c,g=f.r,c=f.e),b=m[h=c+y+1],d=o/2,g=g||h<0||null!=m[h+1],g=C<4?(null!=b||g)&&(0==C||C==(f.s<0?3:2)):d<b||b==d&&(4==C||g||6==C&&1&m[h-1]||C==(f.s<0?8:7)),h<1||!m[0])r=g?p(a.charAt(1),-y,a.charAt(0)):a.charAt(0);else{if(m.length=h,g)for(--o;++m[--h]>o;)m[h]=0,h||(++c,m=[1].concat(m));for(d=m.length;!m[--d];);for(b=0,r="";b<=d;r+=a.charAt(m[b++]));r=p(r,c,a.charAt(0))}return r}}(),i=function(){function t(t,e,i){var r,n,o,s,l=0,a=t.length,h=e%1e7,u=e/1e7|0;for(t=t.slice();a--;)l=((n=h*(o=t[a]%1e7)+(r=u*o+(s=t[a]/1e7|0)*h)%1e7*1e7+l)/i|0)+(r/1e7|0)+u*s,t[a]=n%i;return l&&(t=[l].concat(t)),t}function e(t,e,i,r){var n,o;if(i!=r)o=r<i?1:-1;else for(n=o=0;n<i;n++)if(t[n]!=e[n]){o=t[n]>e[n]?1:-1;break}return o}function i(t,e,i,r){for(var n=0;i--;)t[i]-=n,n=t[i]<e[i]?1:0,t[i]=n*r+t[i]-e[i];for(;!t[0]&&1<t.length;t.splice(0,1));}return function(r,n,s,l,a){var u,c,d,g,f,p,m,w,b,y,C,S,E,R,T,M,O,k=r.s==n.s?1:-1,x=r.c,I=n.c;if(!(x&&x[0]&&I&&I[0]))return new B(r.s&&n.s&&(x?!I||x[0]!=I[0]:I)?x&&0==x[0]||!I?0*k:k/0:NaN);for(b=(w=new B(k)).c=[],k=s+(c=r.e-n.e)+1,a||(a=1e14,c=h(r.e/14)-h(n.e/14),k=k/14|0),d=0;I[d]==(x[d]||0);d++);if(I[d]>(x[d]||0)&&c--,k<0)b.push(1),g=!0;else{for(R=x.length,M=I.length,k+=2,1<(f=o(a/(I[d=0]+1)))&&(I=t(I,f,a),x=t(x,f,a),M=I.length,R=x.length),E=M,C=(y=x.slice(0,M)).length;C<M;y[C++]=0);O=[0].concat(O=I.slice()),T=I[0],I[1]>=a/2&&T++;do{if(f=0,(u=e(I,y,M,C))<0){if(S=y[0],M!=C&&(S=S*a+(y[1]||0)),1<(f=o(S/T)))for(a<=f&&(f=a-1),m=(p=t(I,f,a)).length,C=y.length;1==e(p,y,m,C);)f--,i(p,M<m?O:I,m,a),m=p.length,u=1;else 0==f&&(u=f=1),m=(p=I.slice()).length;if(m<C&&(p=[0].concat(p)),i(y,p,C,a),C=y.length,-1==u)for(;1>e(I,y,M,C);)f++,i(y,M<C?O:I,C,a),C=y.length}else 0===u&&(f++,y=[0]);b[d++]=f,y[0]?y[C++]=x[E]||0:(y=[x[E]],C=1)}while((E++<R||null!=y[0])&&k--);g=null!=y[0],b[0]||b.splice(0,1)}if(1e14==a){for(d=1,k=b[0];10<=k;k/=10,d++);j(w,s+(w.e=d+14*c-1)+1,l,g)}else w.e=c,w.r=+g;return w}}(),y=/^(-?)0([xbo])(?=\w[\w.]*$)/i,C=/^([^.]+)\.$/,S=/^\.([^.]+)$/,E=/^-?(Infinity|NaN)$/,R=/^\s*\+(?=[\w.])|^\s+|\s+$/g,w=function(t,e,i,r){var n,o=i?e:e.replace(R,"");if(E.test(o))t.s=isNaN(o)?null:o<0?-1:1,t.c=t.e=null;else{if(!i&&(o=o.replace(y,function(t,e,i){return n="x"==(i=i.toLowerCase())?16:"b"==i?2:8,r&&r!=n?t:e}),r&&(n=r,o=o.replace(C,"$1").replace(S,"0.$1")),e!=o))return new B(o,n);if(B.DEBUG)throw Error(s+"Not a"+(r?" base "+r:"")+" number: "+e);t.c=t.e=t.s=null}},T.absoluteValue=T.abs=function(){var t=new B(this);return t.s<0&&(t.s=1),t},T.comparedTo=function(t,e){return c(this,new B(t,e))},T.decimalPlaces=T.dp=function(t,e){var i,r,n;if(null!=t)return d(t,0,1e9),null==e?e=k:d(e,0,8),j(new B(this),t+this.e+1,e);if(!(i=this.c))return null;if(r=((n=i.length-1)-h(this.e/14))*14,n=i[n])for(;n%10==0;n/=10,r--);return r<0&&(r=0),r},T.dividedBy=T.div=function(t,e){return i(this,new B(t,e),O,k)},T.dividedToIntegerBy=T.idiv=function(t,e){return i(this,new B(t,e),0,1)},T.exponentiatedBy=T.pow=function(t,e){var i,r,l,a,h,u,c,d,f=this;if((t=new B(t)).c&&!t.isInteger())throw Error(s+"Exponent not an integer: "+U(t));if(null!=e&&(e=new B(e)),h=14<t.e,!f.c||!f.c[0]||1==f.c[0]&&!f.e&&1==f.c.length||!t.c||!t.c[0])return d=new B(Math.pow(+U(f),h?2-g(t):+U(t))),e?d.mod(e):d;if(u=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new B(NaN);(r=!u&&f.isInteger()&&e.isInteger())&&(f=f.mod(e))}else{if(9<t.e&&(0<f.e||f.e<-1||(0==f.e?1<f.c[0]||h&&24e7<=f.c[1]:f.c[0]<8e13||h&&f.c[0]<=9999975e7)))return a=f.s<0&&g(t)?-0:0,-1<f.e&&(a=1/a),new B(u?1/a:a);P&&(a=n(P/14+2))}for(c=h?(i=new B(.5),u&&(t.s=1),g(t)):(l=Math.abs(+U(t)))%2,d=new B(M);;){if(c){if(!(d=d.times(f)).c)break;a?d.c.length>a&&(d.c.length=a):r&&(d=d.mod(e))}if(l){if(0===(l=o(l/2)))break;c=l%2}else if(j(t=t.times(i),t.e+1,1),14<t.e)c=g(t);else{if(0==(l=+U(t)))break;c=l%2}f=f.times(f),a?f.c&&f.c.length>a&&(f.c.length=a):r&&(f=f.mod(e))}return r?d:(u&&(d=M.div(d)),e?d.mod(e):a?j(d,P,k,void 0):d)},T.integerValue=function(t){var e=new B(this);return null==t?t=k:d(t,0,8),j(e,e.e+1,t)},T.isEqualTo=T.eq=function(t,e){return 0===c(this,new B(t,e))},T.isFinite=function(){return!!this.c},T.isGreaterThan=T.gt=function(t,e){return 0<c(this,new B(t,e))},T.isGreaterThanOrEqualTo=T.gte=function(t,e){return 1===(e=c(this,new B(t,e)))||0===e},T.isInteger=function(){return!!this.c&&h(this.e/14)>this.c.length-2},T.isLessThan=T.lt=function(t,e){return 0>c(this,new B(t,e))},T.isLessThanOrEqualTo=T.lte=function(t,e){return -1===(e=c(this,new B(t,e)))||0===e},T.isNaN=function(){return!this.s},T.isNegative=function(){return this.s<0},T.isPositive=function(){return 0<this.s},T.isZero=function(){return!!this.c&&0==this.c[0]},T.minus=function(t,e){var i,r,n,o,s=this.s;if(e=(t=new B(t,e)).s,!s||!e)return new B(NaN);if(s!=e)return t.s=-e,this.plus(t);var l=this.e/14,a=t.e/14,u=this.c,c=t.c;if(!l||!a){if(!u||!c)return u?(t.s=-e,t):new B(c?this:NaN);if(!u[0]||!c[0])return c[0]?(t.s=-e,t):new B(u[0]?this:3==k?-0:0)}if(l=h(l),a=h(a),u=u.slice(),s=l-a){for((n=(o=s<0)?(s=-s,u):(a=l,c)).reverse(),e=s;e--;n.push(0));n.reverse()}else for(r=(o=(s=u.length)<(e=c.length))?s:e,s=e=0;e<r;e++)if(u[e]!=c[e]){o=u[e]<c[e];break}if(o&&(n=u,u=c,c=n,t.s=-t.s),0<(e=(r=c.length)-(i=u.length)))for(;e--;u[i++]=0);for(e=1e14-1;s<r;){if(u[--r]<c[r]){for(i=r;i&&!u[--i];u[i]=e);--u[i],u[r]+=1e14}u[r]-=c[r]}for(;0==u[0];u.splice(0,1),--a);return u[0]?F(t,u,a):(t.s=3==k?-1:1,t.c=[t.e=0],t)},T.modulo=T.mod=function(t,e){var r,n;return t=new B(t,e),this.c&&t.s&&(!t.c||t.c[0])?t.c&&(!this.c||this.c[0])?(9==_?(n=t.s,t.s=1,r=i(this,t,0,3),t.s=n,r.s*=n):r=i(this,t,0,_),(t=this.minus(r.times(t))).c[0]||1!=_||(t.s=this.s),t):new B(this):new B(NaN)},T.multipliedBy=T.times=function(t,e){var i,r,n,o,s,l,a,u,c,d,g,f,p,m=this.c,w=(t=new B(t,e)).c;if(!(m&&w&&m[0]&&w[0]))return this.s&&t.s&&(!m||m[0]||w)&&(!w||w[0]||m)?(t.s*=this.s,m&&w?(t.c=[0],t.e=0):t.c=t.e=null):t.c=t.e=t.s=null,t;for(r=h(this.e/14)+h(t.e/14),t.s*=this.s,(a=m.length)<(d=w.length)&&(p=m,m=w,w=p,n=a,a=d,d=n),n=a+d,p=[];n--;p.push(0));for(n=d;0<=--n;){for(i=0,g=w[n]%1e7,f=w[n]/1e7|0,o=n+(s=a);n<o;)i=((u=g*(u=m[--s]%1e7)+(l=f*u+(c=m[s]/1e7|0)*g)%1e7*1e7+p[o]+i)/1e14|0)+(l/1e7|0)+f*c,p[o--]=u%1e14;p[o]=i}return i?++r:p.splice(0,1),F(t,p,r)},T.negated=function(){var t=new B(this);return t.s=-t.s||null,t},T.plus=function(t,e){var i,r=this.s;if(e=(t=new B(t,e)).s,!r||!e)return new B(NaN);if(r!=e)return t.s=-e,this.minus(t);var n=this.e/14,o=t.e/14,s=this.c,l=t.c;if(!n||!o){if(!s||!l)return new B(r/0);if(!s[0]||!l[0])return l[0]?t:new B(s[0]?this:0*r)}if(n=h(n),o=h(o),s=s.slice(),r=n-o){for((i=0<r?(o=n,l):(r=-r,s)).reverse();r--;i.push(0));i.reverse()}for((r=s.length)-(e=l.length)<0&&(i=l,l=s,s=i,e=r),r=0;e;)r=(s[--e]=s[e]+l[e]+r)/1e14|0,s[e]=1e14===s[e]?0:s[e]%1e14;return r&&(s=[r].concat(s),++o),F(t,s,o)},T.precision=T.sd=function(t,e){var i,r,n;if(null!=t&&!!t!==t)return d(t,1,1e9),null==e?e=k:d(e,0,8),j(new B(this),t,e);if(!(i=this.c))return null;if(r=14*(n=i.length-1)+1,n=i[n]){for(;n%10==0;n/=10,r--);for(n=i[0];10<=n;n/=10,r++);}return t&&this.e+1>r&&(r=this.e+1),r},T.shiftedBy=function(t){return d(t,-9007199254740991,9007199254740991),this.times("1e"+t)},T.squareRoot=T.sqrt=function(){var t,e,r,n,o,s=this.c,l=this.s,a=this.e,c=O+4,d=new B("0.5");if(1!==l||!s||!s[0])return new B(!l||l<0&&(!s||s[0])?NaN:s?this:1/0);if((r=0==(l=Math.sqrt(+U(this)))||l==1/0?(((e=u(s)).length+a)%2==0&&(e+="0"),l=Math.sqrt(+e),a=h((a+1)/2)-(a<0||a%2),new B(e=l==1/0?"1e"+a:(e=l.toExponential()).slice(0,e.indexOf("e")+1)+a)):new B(l+"")).c[0]){for((l=(a=r.e)+c)<3&&(l=0);;)if(o=r,r=d.times(o.plus(i(this,o,c,1))),u(o.c).slice(0,l)===(e=u(r.c)).slice(0,l)){if(r.e<a&&--l,"9999"!=(e=e.slice(l-3,l+1))&&(n||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(j(r,r.e+O+2,1),t=!r.times(r).eq(this));break}if(!n&&(j(o,o.e+O+2,0),o.times(o).eq(this))){r=o;break}c+=4,l+=4,n=1}}return j(r,r.e+O+1,k,t)},T.toExponential=function(t,e){return null!=t&&(d(t,0,1e9),t++),W(this,t,e,1)},T.toFixed=function(t,e){return null!=t&&(d(t,0,1e9),t=t+this.e+1),W(this,t,e)},T.toFormat=function(t,e,i){var r;if(null==i)null!=t&&e&&"object"==typeof e?(i=e,e=null):t&&"object"==typeof t?(i=t,t=e=null):i=D;else if("object"!=typeof i)throw Error(s+"Argument not an object: "+i);if(r=this.toFixed(t,e),this.c){var n,o=r.split("."),l=+i.groupSize,a=+i.secondaryGroupSize,h=i.groupSeparator||"",u=o[0],c=o[1],d=this.s<0,g=d?u.slice(1):u,f=g.length;if(a&&(n=l,l=a,f-=a=n),0<l&&0<f){for(n=f%l||l,u=g.substr(0,n);n<f;n+=l)u+=h+g.substr(n,l);0<a&&(u+=h+g.slice(n)),d&&(u="-"+u)}r=c?u+(i.decimalSeparator||"")+((a=+i.fractionGroupSize)?c.replace(RegExp("\\d{"+a+"}\\B","g"),"$&"+(i.fractionGroupSeparator||"")):c):u}return(i.prefix||"")+r+(i.suffix||"")},T.toFraction=function(t){var e,r,n,o,l,h,c,d,g,f,p,m,w=this.c;if(null!=t&&(!(c=new B(t)).isInteger()&&(c.c||1!==c.s)||c.lt(M)))throw Error(s+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+U(c));if(!w)return new B(this);for(e=new B(M),g=r=new B(M),n=d=new B(M),m=u(w),l=e.e=m.length-this.e-1,e.c[0]=a[(h=l%14)<0?14+h:h],t=!t||0<c.comparedTo(e)?0<l?e:g:c,h=N,N=1/0,c=new B(m),d.c[0]=0;f=i(c,e,0,1),1!=(o=r.plus(f.times(n))).comparedTo(t);)r=n,n=o,g=d.plus(f.times(o=g)),d=o,e=c.minus(f.times(o=e)),c=o;return o=i(t.minus(r),n,0,1),d=d.plus(o.times(g)),r=r.plus(o.times(n)),d.s=g.s=this.s,p=1>i(g,n,l*=2,k).minus(this).abs().comparedTo(i(d,r,l,k).minus(this).abs())?[g,n]:[d,r],N=h,p},T.toNumber=function(){return+U(this)},T.toPrecision=function(t,e){return null!=t&&d(t,1,1e9),W(this,t,e,2)},T.toString=function(t){var e,i=this,r=i.s,n=i.e;return null===n?r?(e="Infinity",r<0&&(e="-"+e)):e="NaN":(e=null==t?n<=x||I<=n?f(u(i.c),n):p(u(i.c),n,"0"):10===t?p(u((i=j(new B(i),O+n+1,k)).c),i.e,"0"):(d(t,2,L.length,"Base"),m(p(u(i.c),n,"0"),10,t,r,!0)),r<0&&i.c[0]&&(e="-"+e)),e},T.valueOf=T.toJSON=function(){return U(this)},T._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(T[Symbol.toStringTag]="BigNumber",T[Symbol.for("nodejs.util.inspect.custom")]=T.valueOf),null!=e&&B.set(e),B}()).default=i.BigNumber=i,void 0!==e&&e.exports?e.exports=i:(t||(t="undefined"!=typeof self&&self?self:window),t.BigNumber=i)}(this)},{}],2:[function(t,e,i){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){var e=t%10;return 1==~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,i){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var i=[],r=!0,n=!1,o=void 0;try{for(var s,l=t[Symbol.iterator]();!(r=(s=l.next()).done)&&(i.push(s.value),!e||i.length!==e);r=!0);}catch(t){n=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(n)throw o}}return i}(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance")}()}var n=t("./globalState"),o=t("./validating"),s=t("./parsing"),l=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a={general:{scale:1024,suffixes:l,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:l,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function u(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length?arguments[2]:void 0;if("string"==typeof e&&(e=s.parseFormat(e)),!o.validateFormat(e))return"ERROR: invalid format";var r=e.prefix||"",l=e.postfix||"",u=function(t,e,i){var r,o,s,l,u,d,p,m,w,b,y,C,S,E,R,T,M,O,k,x,I,A,N,H,_,P,D,L;switch(e.output){case"currency":return T=e=f(e,n.currentCurrencyDefaultFormat()),M=n.currentCurrency(),O=Object.assign({},h,T),k=void 0,x="",I=!!O.totalLength||!!O.forceAverage||O.average,A=T.currencyPosition||M.position,N=T.currencySymbol||M.symbol,O.spaceSeparated&&(x=" "),"infix"===A&&(k=x+N+x),H=g({instance:t,providedFormat:T,state:n,decimalSeparator:k}),"prefix"===A&&(H=t._value<0&&"sign"===O.negative?"-".concat(x).concat(N).concat(H.slice(1)):N+x+H),A&&"postfix"!==A||(H=H+(x=I?"":x)+N),H;case"percent":return P=(_=e=f(e,n.currentPercentageDefaultFormat())).prefixSymbol,D=g({instance:i(100*t._value),providedFormat:_,state:n}),L=Object.assign({},h,_),P?"%".concat(L.spaceSeparated?" ":"").concat(D):"".concat(D).concat(L.spaceSeparated?" ":"","%");case"byte":return b=a[(w=e=f(e,n.currentByteDefaultFormat())).base||"binary"],C=(y=c(t._value,b.suffixes,b.scale)).value,S=y.suffix,E=g({instance:i(C),providedFormat:w,state:n,defaults:n.currentByteDefaultFormat()}),R=n.currentAbbreviations(),"".concat(E).concat(R.spaced?" ":"").concat(S);case"time":return e=f(e,n.currentTimeDefaultFormat()),d=Math.floor(t._value/60/60),p=Math.floor((t._value-60*d*60)/60),m=Math.round(t._value-60*d*60-60*p),"".concat(d,":").concat(p<10?"0":"").concat(p,":").concat(m<10?"0":"").concat(m);case"ordinal":return r=e=f(e,n.currentOrdinalDefaultFormat()),o=n.currentOrdinal(),s=Object.assign({},h,r),l=g({instance:t,providedFormat:r,state:n}),u=o(t._value),"".concat(l).concat(s.spaceSeparated?" ":"").concat(u);default:return g({instance:t,providedFormat:e,numbro:i})}}(t,e,i);return(u=r+u)+l}function c(t,e,i){var r=e[0],n=Math.abs(t);if(i<=n){for(var o=1;o<e.length;++o){var s=Math.pow(i,o),l=Math.pow(i,o+1);if(s<=n&&n<l){r=e[o],t/=s;break}}r===e[0]&&(t/=Math.pow(i,e.length-1),r=e[e.length-1])}return{value:t,suffix:r}}function d(t){for(var e="",i=0;i<t;i++)e+="0";return e}function g(t){var e,i,o,s,l,a,u,c,g,f=t.instance,p=t.providedFormat,m=t.state,w=void 0===m?n:m,b=t.decimalSeparator,y=t.defaults,C=void 0===y?w.currentDefaults():y,S=f._value;if(0===S&&w.hasZeroFormat())return w.getZeroFormat();if(!isFinite(S))return S.toString();var E,R,T,M,O,k,x,I,A=Object.assign({},h,C,p),N=A.totalLength,H=N?0:A.characteristic,_=A.optionalCharacteristic,P=A.forceAverage,D=!!N||!!P||A.average,L=N?-1:D&&void 0===p.mantissa?0:A.mantissa,B=!N&&(void 0===p.optionalMantissa?-1===L:A.optionalMantissa),W=A.trimMantissa,V=A.thousandSeparated,F=A.spaceSeparated,j=A.negative,U=A.forceSign,$=A.exponential,z="";if(D){var K,G,Y,X,q,Z,J,Q,tt,te,ti=(G=(K={value:S,forceAverage:P,abbreviations:w.currentAbbreviations(),spaceSeparated:F,totalLength:N}).value,Y=K.forceAverage,X=K.abbreviations,q=K.spaceSeparated,J=void 0===(Z=K.totalLength)?0:Z,Q="",te=-1,(tt=Math.abs(G))>=1e12&&!Y||"trillion"===Y?(Q=X.trillion,G/=1e12):tt<1e12&&tt>=1e9&&!Y||"billion"===Y?(Q=X.billion,G/=1e9):tt<1e9&&tt>=1e6&&!Y||"million"===Y?(Q=X.million,G/=1e6):(tt<1e6&&tt>=1e3&&!Y||"thousand"===Y)&&(Q=X.thousand,G/=1e3),Q&&(Q=(void 0!==q&&q?" ":"")+Q),J&&(te=Math.max(J-G.toString().split(".")[0].length,0)),{value:G,abbreviation:Q,mantissaPrecision:te});S=ti.value,z+=ti.abbreviation,N&&(L=ti.mantissaPrecision)}if($){var tr=(R=(E={value:S,characteristicPrecision:H}).value,M=void 0===(T=E.characteristicPrecision)?0:T,k=(O=r(R.toExponential().split("e"),2))[0],x=O[1],I=+k,M&&1<M&&(I*=Math.pow(10,M-1),x=0<=(x=+x-(M-1))?"+".concat(x):x),{value:I,abbreviation:"e".concat(x)});S=tr.value,z=tr.abbreviation+z}var tn,to,ts=function(t,e,i,n,o){if(-1===n)return t;var s=-1!==e.toString().indexOf("e")?function(t,e){var i=t.toString(),n=r(i.split("e"),2),o=n[0],s=n[1],l=r(o.split("."),2),a=l[0],h=l[1],u=void 0===h?"":h;if(0<+s)i=a+u+d(s-u.length);else{var c=".";c=0>+a?"-0".concat(c):"0".concat(c);var g=(d(-s-1)+Math.abs(a)+u).substr(0,e);g.length<e&&(g+=d(e-g.length)),i=c+g}return 0<+s&&0<e&&(i+=".".concat(d(e))),i}(e,n):(Math.round(+"".concat(e,"e+").concat(n))/Math.pow(10,n)).toFixed(n),l=r(s.toString().split("."),2),a=l[0],h=l[1],u=void 0===h?"":h;if(u.match(/^0+$/)&&(i||o))return a;var c=u.match(/0+$/);return o&&c?"".concat(a,".").concat(u.toString().slice(0,c.index)):s.toString()}(S.toString(),S,B,L,W);return e=ts=function(t,e,i,n){var o=t,s=r(o.toString().split("."),2),l=s[0],a=s[1];if(l.match(/^-?0$/)&&i)return a?"".concat(l.replace("0",""),".").concat(a):l.replace("0","");if(l.length<n)for(var h=n-l.length,u=0;u<h;u++)o="0".concat(o);return o.toString()}(ts,0,_,H),i=S,o=b,l=(s=w.currentDelimiters()).thousands,o=o||s.decimal,a=s.thousandsSize||3,c=(u=e.toString()).split(".")[0],g=u.split(".")[1],V&&(i<0&&(c=c.slice(1)),(function(t,e){for(var i=[],r=0,n=t;0<n;n--)r===e&&(i.unshift(n),r=0),r++;return i})(c.length,a).forEach(function(t,e){c=c.slice(0,t+e)+l+c.slice(t+e)}),i<0&&(c="-".concat(c))),ts=u=g?c+o+g:c,(D||$)&&(ts+=z),(U||S<0)&&(tn=ts,ts=0===(to=S)?tn:0==+tn?tn.replace("-",""):0<to?"+".concat(tn):"sign"===j?tn:"(".concat(tn.replace("-",""),")")),ts}function f(t,e){if(!t)return e;var i=Object.keys(t);return 1===i.length&&"output"===i[0]?e:t}e.exports=function(t){return{format:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return u.apply(void 0,i.concat([t]))},getByteUnit:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return(function(t){var e=a.general;return c(t._value,e.suffixes,e.scale).suffix}).apply(void 0,i.concat([t]))},getBinaryByteUnit:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return(function(t){var e=a.binary;return c(t._value,e.suffixes,e.scale).suffix}).apply(void 0,i.concat([t]))},getDecimalByteUnit:function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return(function(t){var e=a.decimal;return c(t._value,e.suffixes,e.scale).suffix}).apply(void 0,i.concat([t]))},formatOrDefault:f}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,i){"use strict";var r=t("./en-US"),n=t("./validating"),o=t("./parsing"),s={},l=void 0,a={},h=null,u={};function c(){return a[l]}s.languages=function(){return Object.assign({},a)},s.currentLanguage=function(){return l},s.currentCurrency=function(){return c().currency},s.currentAbbreviations=function(){return c().abbreviations},s.currentDelimiters=function(){return c().delimiters},s.currentOrdinal=function(){return c().ordinal},s.currentDefaults=function(){return Object.assign({},c().defaults,u)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),c().timeFormat)},s.setDefaults=function(t){t=o.parseFormat(t),n.validateFormat(t)&&(u=t)},s.getZeroFormat=function(){return h},s.setZeroFormat=function(t){return h="string"==typeof t?t:null},s.hasZeroFormat=function(){return null!==h},s.languageData=function(t){if(t){if(a[t])return a[t];throw Error('Unknown tag "'.concat(t,'"'))}return c()},s.registerLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!n.validateLanguage(t))throw Error("Invalid language data");a[t.languageTag]=t,e&&(l=t.languageTag)},s.setLanguage=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:r.languageTag;if(!a[t]){var i=t.split("-")[0],n=Object.keys(a).find(function(t){return t.split("-")[0]===i});return a[n]?void(l=n):void(l=e)}l=t},s.registerLanguage(r),l=r.languageTag,e.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,i){"use strict";e.exports=function(e){return{loadLanguagesInNode:function(i){i.forEach(function(i){var r=void 0;try{r=t("../languages/".concat(i))}catch(t){console.error('Unable to load "'.concat(i,'". No matching language file found.'))}r&&e.registerLanguage(r)})}}}},{}],6:[function(t,e,i){"use strict";var r=t("bignumber.js");function n(t,e,i){var n=new r(t._value),o=e;return i.isNumbro(e)&&(o=e._value),o=new r(o),t._value=n.minus(o).toNumber(),t}e.exports=function(t){return{add:function(e,i){var n,o;return n=new r(e._value),o=i,t.isNumbro(i)&&(o=i._value),o=new r(o),e._value=n.plus(o).toNumber(),e},subtract:function(e,i){return n(e,i,t)},multiply:function(e,i){var n,o;return n=new r(e._value),o=i,t.isNumbro(i)&&(o=i._value),o=new r(o),e._value=n.times(o).toNumber(),e},divide:function(e,i){var n,o;return n=new r(e._value),o=i,t.isNumbro(i)&&(o=i._value),o=new r(o),e._value=n.dividedBy(o).toNumber(),e},set:function(e,i){var r;return r=i,t.isNumbro(i)&&(r=i._value),e._value=r,e},difference:function(e,i){var r;return n(r=t(e._value),i,t),Math.abs(r._value)}}}},{"bignumber.js":1}],7:[function(t,e,i){"use strict";function r(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var n=t("./globalState"),o=t("./validating"),s=t("./loading")(g),l=t("./unformatting"),a=t("./formatting")(g),h=t("./manipulating")(g),u=t("./parsing"),c=function(){var t,e;function i(t){(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,i),this._value=t}return t=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return a.format(this,t)}},{key:"formatCurrency",value:function(t){return"string"==typeof t&&(t=u.parseFormat(t)),(t=a.formatOrDefault(t,n.currentCurrencyDefaultFormat())).output="currency",a.format(this,t)}},{key:"formatTime",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return t.output="time",a.format(this,t)}},{key:"binaryByteUnits",value:function(){return a.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return a.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return a.getByteUnit(this)}},{key:"difference",value:function(t){return h.difference(this,t)}},{key:"add",value:function(t){return h.add(this,t)}},{key:"subtract",value:function(t){return h.subtract(this,t)}},{key:"multiply",value:function(t){return h.multiply(this,t)}},{key:"divide",value:function(t){return h.divide(this,t)}},{key:"set",value:function(t){return h.set(this,d(t))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}],r(i.prototype,t),e&&r(i,e),i}();function d(t){var e=t;return g.isNumbro(t)?e=t._value:"string"==typeof t?e=g.unformat(t):isNaN(t)&&(e=NaN),e}function g(t){return new c(d(t))}g.version="2.1.2",g.isNumbro=function(t){return t instanceof c},g.language=n.currentLanguage,g.registerLanguage=n.registerLanguage,g.setLanguage=n.setLanguage,g.languages=n.languages,g.languageData=n.languageData,g.zeroFormat=n.setZeroFormat,g.defaultFormat=n.currentDefaults,g.setDefaults=n.setDefaults,g.defaultCurrencyFormat=n.currentCurrencyDefaultFormat,g.validate=o.validate,g.loadLanguagesInNode=s.loadLanguagesInNode,g.unformat=l.unformat,e.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,i){"use strict";e.exports={parseFormat:function(t){var e,i,r,n,o,s,l,a,h,u=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof t?t:(function(t,e){if(-1===t.indexOf("$")){if(-1===t.indexOf("%"))return -1!==t.indexOf("bd")?(e.output="byte",e.base="general"):-1!==t.indexOf("b")?(e.output="byte",e.base="binary"):-1!==t.indexOf("d")?(e.output="byte",e.base="decimal"):-1===t.indexOf(":")?-1!==t.indexOf("o")&&(e.output="ordinal"):e.output="time";e.output="percent"}else e.output="currency"}(t=(n=(r=t=(i=(e=t).match(/^{([^}]*)}/))?(u.prefix=i[1],e.slice(i[0].length)):e).match(/{([^}]*)}$/))?(u.postfix=n[1],r.slice(0,-n[0].length)):r,u),(o=t.match(/[1-9]+[0-9]*/))&&(u.totalLength=+o[0]),(s=t.split(".")[0].match(/0+/))&&(u.characteristic=s[0].length),function(t,e){if(-1!==t.indexOf(".")){var i=t.split(".")[0];e.optionalCharacteristic=-1===i.indexOf("0")}}(t,u),-1!==t.indexOf("a")&&(u.average=!0),-1!==(l=t).indexOf("K")?u.forceAverage="thousand":-1!==l.indexOf("M")?u.forceAverage="million":-1!==l.indexOf("B")?u.forceAverage="billion":-1!==l.indexOf("T")&&(u.forceAverage="trillion"),function(t,e){var i=t.split(".")[1];if(i){var r=i.match(/0+/);r&&(e.mantissa=r[0].length)}}(t,u),(a=t).match(/\[\.]/)?u.optionalMantissa=!0:a.match(/\./)&&(u.optionalMantissa=!1),-1!==t.indexOf(",")&&(u.thousandSeparated=!0),-1!==t.indexOf(" ")&&(u.spaceSeparated=!0),(h=t).match(/^\+?\([^)]*\)$/)&&(u.negative="parenthesis"),h.match(/^\+?-/)&&(u.negative="sign"),t.match(/^\+/)&&(u.forceSign=!0),u)}}},{}],9:[function(t,e,i){"use strict";var r=[{key:"ZiB",factor:11805916207174113e5},{key:"ZB",factor:1e21},{key:"YiB",factor:12089258196146292e8},{key:"YB",factor:1e24},{key:"TiB",factor:1099511627776},{key:"TB",factor:1e12},{key:"PiB",factor:0x4000000000000},{key:"PB",factor:1e15},{key:"MiB",factor:1048576},{key:"MB",factor:1e6},{key:"KiB",factor:1024},{key:"KB",factor:1e3},{key:"GiB",factor:1073741824},{key:"GB",factor:1e9},{key:"EiB",factor:0x1000000000000000},{key:"EB",factor:1e18},{key:"B",factor:1}];function n(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}e.exports={unformat:function(e,i){var o,s,l,a=t("./globalState"),h=a.currentDelimiters(),u=a.currentCurrency().symbol,c=a.currentOrdinal(),d=a.getZeroFormat(),g=a.currentAbbreviations(),f=void 0;if("string"==typeof e)f=!function(t,e){if(!t.indexOf(":")||":"===e.thousands)return!1;var i=t.split(":");if(3!==i.length)return!1;var r=+i[0],n=+i[1],o=+i[2];return!isNaN(r)&&!isNaN(n)&&!isNaN(o)}(e,h)?function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,a=6<arguments.length?arguments[6]:void 0;if(""!==t)return t===s?0:function t(e,i){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",s=3<arguments.length?arguments[3]:void 0,l=4<arguments.length?arguments[4]:void 0,a=5<arguments.length?arguments[5]:void 0,h=6<arguments.length?arguments[6]:void 0;if(!isNaN(+e))return+e;var u="",c=e.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(c!==e)return -1*t(c,i,o,s,l,a,h);for(var d=0;d<r.length;d++){var g=r[d];if((u=e.replace(g.key,""))!==e)return t(u,i,o,s,l,a,h)*g.factor}if((u=e.replace("%",""))!==e)return t(u,i,o,s,l,a,h)/100;var f=parseFloat(e);if(!isNaN(f)){var p=s(f);if(p&&"."!==p&&(u=e.replace(new RegExp("".concat(n(p),"$")),""))!==e)return t(u,i,o,s,l,a,h);var m={};Object.keys(a).forEach(function(t){m[a[t]]=t});for(var w=Object.keys(m).sort().reverse(),b=w.length,y=0;y<b;y++){var C=w[y],S=m[C];if((u=e.replace(C,""))!==e){var E=void 0;switch(S){case"thousand":E=1e3;break;case"million":E=1e6;break;case"billion":E=1e9;break;case"trillion":E=1e12}return t(u,i,o,s,l,a,h)*E}}}}(function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",r=t.replace(i,"");return(r=r.replace(RegExp("([0-9])".concat(n(e.thousands),"([0-9])"),"g"),"$1$2")).replace(e.decimal,".")}(t,e,i),e,i,o,s,l,a)}(e,h,u,c,d,g,i):(s=+(o=e.split(":"))[0],l=+o[1],+o[2]+60*l+3600*s);else{if("number"!=typeof e)return;f=e}if(void 0!==f)return f}}},{"./globalState":4}],10:[function(t,e,i){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=t("./unformatting"),o=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,s={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(t,e){return"byte"===e.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(t){return"byte"===t.output}},characteristic:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(t){return 0<=t},message:"value must be positive"},{restriction:function(t,e){return!e.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(t){return 0<=t},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(t,e){return"percent"===e.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(t){return t.match(o)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function a(t){return!!n.unformat(t)}function h(t,e,i){var n,o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],l=Object.keys(t).map(function(n){if(!e[n])return console.error("".concat(i," Invalid key: ").concat(n)),!1;var o=t[n],l=e[n];if("string"==typeof l&&(l={type:l}),"format"===l.type){if(!h(o,s,"[Validate ".concat(n,"]"),!0))return!1}else if(r(o)!==l.type)return console.error("".concat(i," ").concat(n,' type mismatched: "').concat(l.type,'" expected, "').concat(r(o),'" provided')),!1;if(l.restrictions&&l.restrictions.length)for(var a=l.restrictions.length,u=0;u<a;u++){var c=l.restrictions[u],d=c.restriction,g=c.message;if(!d(o,t))return console.error("".concat(i," ").concat(n," invalid value: ").concat(g)),!1}return l.restriction&&!l.restriction(o,t)?(console.error("".concat(i," ").concat(n," invalid value: ").concat(l.message)),!1):l.validValues&&-1===l.validValues.indexOf(o)?(console.error("".concat(i," ").concat(n," invalid value: must be among ").concat(JSON.stringify(l.validValues),', "').concat(o,'" provided')),!1):!l.children||!!h(o,l.children,"[Validate ".concat(n,"]"))});return o||l.push.apply(l,function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(n=Object.keys(e).map(function(r){var n=e[r];if("string"==typeof n&&(n={type:n}),n.mandatory){var o=n.mandatory;if("function"==typeof o&&(o=o(t)),o&&void 0===t[r])return console.error("".concat(i,' Missing mandatory key "').concat(r,'"')),!1}return!0}))||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance")}()),l.reduce(function(t,e){return t&&e},!0)}function u(t){return h(t,s,"[Validate format]")}e.exports={validate:function(t,e){var i=a(t),r=u(e);return i&&r},validateFormat:u,validateInput:a,validateLanguage:function(t){return h(t,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},86284:function(t,e,i){"use strict";var r=i(80043),n=i(71747),o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(n(t)+" is not a function")}},7285:function(t,e,i){"use strict";var r=i(45930),n=String,o=TypeError;t.exports=function(t){if(r(t))return t;throw new o("Can't set "+n(t)+" as a prototype")}},38609:function(t,e,i){"use strict";var r=i(25354),n=i(42957),o=i(94982).f,s=r("unscopables"),l=Array.prototype;void 0===l[s]&&o(l,s,{configurable:!0,value:n(null)}),t.exports=function(t){l[s][t]=!0}},51485:function(t,e,i){"use strict";var r=i(56695),n=String,o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(n(t)+" is not an object")}},28786:function(t,e,i){"use strict";var r=i(50949),n=i(70076),o=i(24464),s=function(t){return function(e,i,s){var l,a=r(e),h=o(a);if(0===h)return!t&&-1;var u=n(s,h);if(t&&i!=i){for(;h>u;)if((l=a[u++])!=l)return!0}else for(;h>u;u++)if((t||u in a)&&a[u]===i)return t||u||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},56609:function(t,e,i){"use strict";var r=i(12534),n=i(97631),o=TypeError,s=Object.getOwnPropertyDescriptor,l=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=l?function(t,e){if(n(t)&&!s(t,"length").writable)throw new o("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},32482:function(t,e,i){"use strict";var r=i(58842);t.exports=r([].slice)},6938:function(t,e,i){"use strict";var r=i(58842),n=r({}.toString),o=r("".slice);t.exports=function(t){return o(n(t),8,-1)}},99743:function(t,e,i){"use strict";var r=i(8830),n=i(80043),o=i(6938),s=i(25354)("toStringTag"),l=Object,a="Arguments"===o(function(){return arguments}()),h=function(t,e){try{return t[e]}catch(t){}};t.exports=r?o:function(t){var e,i,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=h(e=l(t),s))?i:a?o(e):"Object"===(r=o(e))&&n(e.callee)?"Arguments":r}},70783:function(t,e,i){"use strict";var r=i(19472),n=i(35191),o=i(85575),s=i(94982);t.exports=function(t,e,i){for(var l=n(e),a=s.f,h=o.f,u=0;u<l.length;u++){var c=l[u];r(t,c)||i&&r(i,c)||a(t,c,h(e,c))}}},60549:function(t,e,i){"use strict";var r=i(12534),n=i(94982),o=i(29085);t.exports=r?function(t,e,i){return n.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},29085:function(t){"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},64584:function(t,e,i){"use strict";var r=i(12534),n=i(94982),o=i(29085);t.exports=function(t,e,i){r?n.f(t,e,o(0,i)):t[e]=i}},64897:function(t,e,i){"use strict";var r=i(80043),n=i(94982),o=i(75412),s=i(43743);t.exports=function(t,e,i,l){l||(l={});var a=l.enumerable,h=void 0!==l.name?l.name:e;if(r(i)&&o(i,h,l),l.global)a?t[e]=i:s(e,i);else{try{l.unsafe?t[e]&&(a=!0):delete t[e]}catch(t){}a?t[e]=i:n.f(t,e,{value:i,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return t}},43743:function(t,e,i){"use strict";var r=i(97738),n=Object.defineProperty;t.exports=function(t,e){try{n(r,t,{value:e,configurable:!0,writable:!0})}catch(i){r[t]=e}return e}},36138:function(t,e,i){"use strict";var r=i(71747),n=TypeError;t.exports=function(t,e){if(!delete t[e])throw new n("Cannot delete property "+r(e)+" of "+r(t))}},12534:function(t,e,i){"use strict";var r=i(44256);t.exports=!r(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},47039:function(t,e,i){"use strict";var r=i(97738),n=i(56695),o=r.document,s=n(o)&&n(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},53745:function(t){"use strict";var e=TypeError;t.exports=function(t){if(t>9007199254740991)throw e("Maximum allowed index exceeded");return t}},71167:function(t){"use strict";t.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},44880:function(t,e,i){"use strict";var r=i(57960);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},59174:function(t,e,i){"use strict";var r=i(97738),n=i(6938);t.exports="process"===n(r.process)},57960:function(t){"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},4130:function(t,e,i){"use strict";var r,n,o=i(97738),s=i(57960),l=o.process,a=o.Deno,h=l&&l.versions||a&&a.version,u=h&&h.v8;u&&(n=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!n&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(n=+r[1]),t.exports=n},51971:function(t){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},55759:function(t,e,i){"use strict";var r=i(58842),n=Error,o=r("".replace),s=String(new n("zxcasd").stack),l=/\n\s*at [^:]*:[^\n]*/,a=l.test(s);t.exports=function(t,e){if(a&&"string"==typeof t&&!n.prepareStackTrace)for(;e--;)t=o(t,l,"");return t}},47865:function(t,e,i){"use strict";var r=i(60549),n=i(55759),o=i(96653),s=Error.captureStackTrace;t.exports=function(t,e,i,l){o&&(s?s(t,e):r(t,"stack",n(i,l)))}},96653:function(t,e,i){"use strict";var r=i(44256),n=i(29085);t.exports=!r(function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",n(1,7)),7!==t.stack)})},69272:function(t,e,i){"use strict";var r=i(97738),n=i(85575).f,o=i(60549),s=i(64897),l=i(43743),a=i(70783),h=i(51559);t.exports=function(t,e){var i,u,c,d,g,f=t.target,p=t.global,m=t.stat;if(i=p?r:m?r[f]||l(f,{}):r[f]&&r[f].prototype)for(u in e){if(d=e[u],c=t.dontCallGetSet?(g=n(i,u))&&g.value:i[u],!h(p?u:f+(m?".":"#")+u,t.forced)&&void 0!==c){if(typeof d==typeof c)continue;a(d,c)}(t.sham||c&&c.sham)&&o(d,"sham",!0),s(i,u,d,t)}}},44256:function(t){"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},35815:function(t,e,i){"use strict";var r=i(21115),n=Function.prototype,o=n.apply,s=n.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},39668:function(t,e,i){"use strict";var r=i(16919),n=i(86284),o=i(21115),s=r(r.bind);t.exports=function(t,e){return n(t),void 0===e?t:o?s(t,e):function(){return t.apply(e,arguments)}}},21115:function(t,e,i){"use strict";var r=i(44256);t.exports=!r(function(){var t=(function(){}).bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})},55817:function(t,e,i){"use strict";var r=i(21115),n=Function.prototype.call;t.exports=r?n.bind(n):function(){return n.apply(n,arguments)}},56309:function(t,e,i){"use strict";var r=i(12534),n=i(19472),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,l=n(o,"name"),a=l&&(!r||r&&s(o,"name").configurable);t.exports={EXISTS:l,PROPER:l&&"something"===(function(){}).name,CONFIGURABLE:a}},46346:function(t,e,i){"use strict";var r=i(58842),n=i(86284);t.exports=function(t,e,i){try{return r(n(Object.getOwnPropertyDescriptor(t,e)[i]))}catch(t){}}},16919:function(t,e,i){"use strict";var r=i(6938),n=i(58842);t.exports=function(t){if("Function"===r(t))return n(t)}},58842:function(t,e,i){"use strict";var r=i(21115),n=Function.prototype,o=n.call,s=r&&n.bind.bind(o,o);t.exports=r?s:function(t){return function(){return o.apply(t,arguments)}}},35651:function(t,e,i){"use strict";var r=i(97738),n=i(80043);t.exports=function(t,e){var i;return arguments.length<2?n(i=r[t])?i:void 0:r[t]&&r[t][e]}},52789:function(t,e,i){"use strict";var r=i(99743),n=i(22112),o=i(86617),s=i(18778),l=i(25354)("iterator");t.exports=function(t){if(!o(t))return n(t,l)||n(t,"@@iterator")||s[r(t)]}},38397:function(t,e,i){"use strict";var r=i(55817),n=i(86284),o=i(51485),s=i(71747),l=i(52789),a=TypeError;t.exports=function(t,e){var i=arguments.length<2?l(t):e;if(n(i))return o(r(i,t));throw new a(s(t)+" is not iterable")}},44430:function(t,e,i){"use strict";var r=i(58842),n=i(97631),o=i(80043),s=i(6938),l=i(92455),a=r([].push);t.exports=function(t){if(o(t))return t;if(n(t)){for(var e=t.length,i=[],r=0;r<e;r++){var h=t[r];"string"==typeof h?a(i,h):("number"==typeof h||"Number"===s(h)||"String"===s(h))&&a(i,l(h))}var u=i.length,c=!0;return function(t,e){if(c)return c=!1,e;if(n(this))return e;for(var r=0;r<u;r++)if(i[r]===t)return e}}}},22112:function(t,e,i){"use strict";var r=i(86284),n=i(86617);t.exports=function(t,e){var i=t[e];return n(i)?void 0:r(i)}},97738:function(t,e,i){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof i.g&&i.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},19472:function(t,e,i){"use strict";var r=i(58842),n=i(84405),o=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(n(t),e)}},68347:function(t){"use strict";t.exports={}},91162:function(t,e,i){"use strict";var r=i(35651);t.exports=r("document","documentElement")},11149:function(t,e,i){"use strict";var r=i(12534),n=i(44256),o=i(47039);t.exports=!r&&!n(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},33910:function(t,e,i){"use strict";var r=i(58842),n=i(44256),o=i(6938),s=Object,l=r("".split);t.exports=n(function(){return!s("z").propertyIsEnumerable(0)})?function(t){return"String"===o(t)?l(t,""):s(t)}:s},16752:function(t,e,i){"use strict";var r=i(80043),n=i(56695),o=i(37908);t.exports=function(t,e,i){var s,l;return o&&r(s=e.constructor)&&s!==i&&n(l=s.prototype)&&l!==i.prototype&&o(t,l),t}},12402:function(t,e,i){"use strict";var r=i(58842),n=i(80043),o=i(29145),s=r(Function.toString);n(o.inspectSource)||(o.inspectSource=function(t){return s(t)}),t.exports=o.inspectSource},15822:function(t,e,i){"use strict";var r=i(56695),n=i(60549);t.exports=function(t,e){r(e)&&"cause"in e&&n(t,"cause",e.cause)}},65230:function(t,e,i){"use strict";var r,n,o,s=i(99819),l=i(97738),a=i(56695),h=i(60549),u=i(19472),c=i(29145),d=i(80050),g=i(68347),f="Object already initialized",p=l.TypeError,m=l.WeakMap;if(s||c.state){var w=c.state||(c.state=new m);w.get=w.get,w.has=w.has,w.set=w.set,r=function(t,e){if(w.has(t))throw new p(f);return e.facade=t,w.set(t,e),e},n=function(t){return w.get(t)||{}},o=function(t){return w.has(t)}}else{var b=d("state");g[b]=!0,r=function(t,e){if(u(t,b))throw new p(f);return e.facade=t,h(t,b,e),e},n=function(t){return u(t,b)?t[b]:{}},o=function(t){return u(t,b)}}t.exports={set:r,get:n,has:o,enforce:function(t){return o(t)?n(t):r(t,{})},getterFor:function(t){return function(e){var i;if(!a(e)||(i=n(e)).type!==t)throw new p("Incompatible receiver, "+t+" required");return i}}}},88714:function(t,e,i){"use strict";var r=i(25354),n=i(18778),o=r("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||s[o]===t)}},97631:function(t,e,i){"use strict";var r=i(6938);t.exports=Array.isArray||function(t){return"Array"===r(t)}},80043:function(t){"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},51559:function(t,e,i){"use strict";var r=i(44256),n=i(80043),o=/#|\.prototype\./,s=function(t,e){var i=a[l(t)];return i===u||i!==h&&(n(e)?r(e):!!e)},l=s.normalize=function(t){return String(t).replace(o,".").toLowerCase()},a=s.data={},h=s.NATIVE="N",u=s.POLYFILL="P";t.exports=s},86617:function(t){"use strict";t.exports=function(t){return null==t}},56695:function(t,e,i){"use strict";var r=i(80043);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},45930:function(t,e,i){"use strict";var r=i(56695);t.exports=function(t){return r(t)||null===t}},9168:function(t){"use strict";t.exports=!1},65375:function(t,e,i){"use strict";var r=i(35651),n=i(80043),o=i(50112),s=i(20327),l=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return n(e)&&o(e.prototype,l(t))}},5040:function(t,e,i){"use strict";var r=i(39668),n=i(55817),o=i(51485),s=i(71747),l=i(88714),a=i(24464),h=i(50112),u=i(38397),c=i(52789),d=i(84471),g=TypeError,f=function(t,e){this.stopped=t,this.result=e},p=f.prototype;t.exports=function(t,e,i){var m,w,b,y,C,S,E,R=i&&i.that,T=!!(i&&i.AS_ENTRIES),M=!!(i&&i.IS_RECORD),O=!!(i&&i.IS_ITERATOR),k=!!(i&&i.INTERRUPTED),x=r(e,R),I=function(t){return m&&d(m,"normal",t),new f(!0,t)},A=function(t){return T?(o(t),k?x(t[0],t[1],I):x(t[0],t[1])):k?x(t,I):x(t)};if(M)m=t.iterator;else if(O)m=t;else{if(!(w=c(t)))throw new g(s(t)+" is not iterable");if(l(w)){for(b=0,y=a(t);y>b;b++)if((C=A(t[b]))&&h(p,C))return C;return new f(!1)}m=u(t,w)}for(S=M?t.next:m.next;!(E=n(S,m)).done;){try{C=A(E.value)}catch(t){d(m,"throw",t)}if("object"==typeof C&&C&&h(p,C))return C}return new f(!1)}},84471:function(t,e,i){"use strict";var r=i(55817),n=i(51485),o=i(22112);t.exports=function(t,e,i){var s,l;n(t);try{if(!(s=o(t,"return"))){if("throw"===e)throw i;return i}s=r(s,t)}catch(t){l=!0,s=t}if("throw"===e)throw i;if(l)throw s;return n(s),i}},18778:function(t){"use strict";t.exports={}},24464:function(t,e,i){"use strict";var r=i(42510);t.exports=function(t){return r(t.length)}},75412:function(t,e,i){"use strict";var r=i(58842),n=i(44256),o=i(80043),s=i(19472),l=i(12534),a=i(56309).CONFIGURABLE,h=i(12402),u=i(65230),c=u.enforce,d=u.get,g=String,f=Object.defineProperty,p=r("".slice),m=r("".replace),w=r([].join),b=l&&!n(function(){return 8!==f(function(){},"length",{value:8}).length}),y=String(String).split("String"),C=t.exports=function(t,e,i){"Symbol("===p(g(e),0,7)&&(e="["+m(g(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),i&&i.getter&&(e="get "+e),i&&i.setter&&(e="set "+e),(!s(t,"name")||a&&t.name!==e)&&(l?f(t,"name",{value:e,configurable:!0}):t.name=e),b&&i&&s(i,"arity")&&t.length!==i.arity&&f(t,"length",{value:i.arity});try{i&&s(i,"constructor")&&i.constructor?l&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=c(t);return s(r,"source")||(r.source=w(y,"string"==typeof e?e:"")),t};Function.prototype.toString=C(function(){return o(this)&&d(this).source||h(this)},"toString")},61325:function(t){"use strict";var e=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?i:e)(r)}},20409:function(t,e,i){"use strict";var r=i(92455);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:r(t)}},42957:function(t,e,i){"use strict";var r,n=i(51485),o=i(79400),s=i(51971),l=i(68347),a=i(91162),h=i(47039),u=i(80050),c="prototype",d="script",g=u("IE_PROTO"),f=function(){},p=function(t){return"<"+d+">"+t+"</"+d+">"},m=function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e},w=function(){var t,e=h("iframe");return e.style.display="none",a.appendChild(e),e.src=String("java"+d+":"),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F},b=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}b="undefined"!=typeof document?document.domain&&r?m(r):w():m(r);for(var t=s.length;t--;)delete b[c][s[t]];return b()};l[g]=!0,t.exports=Object.create||function(t,e){var i;return null!==t?(f[c]=n(t),i=new f,f[c]=null,i[g]=t):i=b(),void 0===e?i:o.f(i,e)}},79400:function(t,e,i){"use strict";var r=i(12534),n=i(81887),o=i(94982),s=i(51485),l=i(50949),a=i(15540);e.f=r&&!n?Object.defineProperties:function(t,e){s(t);for(var i,r=l(e),n=a(e),h=n.length,u=0;h>u;)o.f(t,i=n[u++],r[i]);return t}},94982:function(t,e,i){"use strict";var r=i(12534),n=i(11149),o=i(81887),s=i(51485),l=i(87843),a=TypeError,h=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c="enumerable",d="configurable",g="writable";e.f=r?o?function(t,e,i){if(s(t),e=l(e),s(i),"function"==typeof t&&"prototype"===e&&"value"in i&&g in i&&!i[g]){var r=u(t,e);r&&r[g]&&(t[e]=i.value,i={configurable:d in i?i[d]:r[d],enumerable:c in i?i[c]:r[c],writable:!1})}return h(t,e,i)}:h:function(t,e,i){if(s(t),e=l(e),s(i),n)try{return h(t,e,i)}catch(t){}if("get"in i||"set"in i)throw new a("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},85575:function(t,e,i){"use strict";var r=i(12534),n=i(55817),o=i(96787),s=i(29085),l=i(50949),a=i(87843),h=i(19472),u=i(11149),c=Object.getOwnPropertyDescriptor;e.f=r?c:function(t,e){if(t=l(t),e=a(e),u)try{return c(t,e)}catch(t){}if(h(t,e))return s(!n(o.f,t,e),t[e])}},67613:function(t,e,i){"use strict";var r=i(49852),n=i(51971).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,n)}},4531:function(t,e){"use strict";e.f=Object.getOwnPropertySymbols},50112:function(t,e,i){"use strict";var r=i(58842);t.exports=r({}.isPrototypeOf)},49852:function(t,e,i){"use strict";var r=i(58842),n=i(19472),o=i(50949),s=i(28786).indexOf,l=i(68347),a=r([].push);t.exports=function(t,e){var i,r=o(t),h=0,u=[];for(i in r)!n(l,i)&&n(r,i)&&a(u,i);for(;e.length>h;)n(r,i=e[h++])&&(~s(u,i)||a(u,i));return u}},15540:function(t,e,i){"use strict";var r=i(49852),n=i(51971);t.exports=Object.keys||function(t){return r(t,n)}},96787:function(t,e){"use strict";var i={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,n=r&&!i.call({1:2},1);e.f=n?function(t){var e=r(this,t);return!!e&&e.enumerable}:i},37908:function(t,e,i){"use strict";var r=i(46346),n=i(51485),o=i(7285);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=r(Object.prototype,"__proto__","set"))(i,[]),e=i instanceof Array}catch(t){}return function(i,r){return n(i),o(r),e?t(i,r):i.__proto__=r,i}}():void 0)},61823:function(t,e,i){"use strict";var r=i(55817),n=i(80043),o=i(56695),s=TypeError;t.exports=function(t,e){var i,l;if("string"===e&&n(i=t.toString)&&!o(l=r(i,t))||n(i=t.valueOf)&&!o(l=r(i,t))||"string"!==e&&n(i=t.toString)&&!o(l=r(i,t)))return l;throw new s("Can't convert object to primitive value")}},35191:function(t,e,i){"use strict";var r=i(35651),n=i(58842),o=i(67613),s=i(4531),l=i(51485),a=n([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(l(t)),i=s.f;return i?a(e,i(t)):e}},25121:function(t,e,i){"use strict";var r=i(94982).f;t.exports=function(t,e,i){i in t||r(t,i,{configurable:!0,get:function(){return e[i]},set:function(t){e[i]=t}})}},12924:function(t,e,i){"use strict";var r=i(86617),n=TypeError;t.exports=function(t){if(r(t))throw new n("Can't call method on "+t);return t}},50290:function(t,e,i){"use strict";var r,n=i(97738),o=i(35815),s=i(80043),l=i(71167),a=i(57960),h=i(32482),u=i(15373),c=n.Function,d=/MSIE .\./.test(a)||l&&((r=n.Bun.version.split(".")).length<3||"0"===r[0]&&(r[1]<3||"3"===r[1]&&"0"===r[2]));t.exports=function(t,e){var i=e?2:1;return d?function(r,n){var l=u(arguments.length,1)>i,a=s(r)?r:c(r),d=l?h(arguments,i):[],g=l?function(){o(a,this,d)}:a;return e?t(g,n):t(g)}:t}},80050:function(t,e,i){"use strict";var r=i(93801),n=i(97246),o=r("keys");t.exports=function(t){return o[t]||(o[t]=n(t))}},29145:function(t,e,i){"use strict";var r=i(9168),n=i(97738),o=i(43743),s="__core-js_shared__",l=t.exports=n[s]||o(s,{});(l.versions||(l.versions=[])).push({version:"3.36.0",mode:r?"pure":"global",copyright:"\xa9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.36.0/LICENSE",source:"https://github.com/zloirock/core-js"})},93801:function(t,e,i){"use strict";var r=i(29145);t.exports=function(t,e){return r[t]||(r[t]=e||{})}},24072:function(t,e,i){"use strict";var r=i(4130),n=i(44256),o=i(97738).String;t.exports=!!Object.getOwnPropertySymbols&&!n(function(){var t=Symbol("symbol detection");return!o(t)||!(Object(t) instanceof Symbol)||!Symbol.sham&&r&&r<41})},48150:function(t,e,i){"use strict";var r,n,o,s,l=i(97738),a=i(35815),h=i(39668),u=i(80043),c=i(19472),d=i(44256),g=i(91162),f=i(32482),p=i(47039),m=i(15373),w=i(44880),b=i(59174),y=l.setImmediate,C=l.clearImmediate,S=l.process,E=l.Dispatch,R=l.Function,T=l.MessageChannel,M=l.String,O=0,k={},x="onreadystatechange";d(function(){r=l.location});var I=function(t){if(c(k,t)){var e=k[t];delete k[t],e()}},A=function(t){return function(){I(t)}},N=function(t){I(t.data)},H=function(t){l.postMessage(M(t),r.protocol+"//"+r.host)};y&&C||(y=function(t){m(arguments.length,1);var e=u(t)?t:R(t),i=f(arguments,1);return k[++O]=function(){a(e,void 0,i)},n(O),O},C=function(t){delete k[t]},b?n=function(t){S.nextTick(A(t))}:E&&E.now?n=function(t){E.now(A(t))}:T&&!w?(s=(o=new T).port2,o.port1.onmessage=N,n=h(s.postMessage,s)):l.addEventListener&&u(l.postMessage)&&!l.importScripts&&r&&"file:"!==r.protocol&&!d(H)?(n=H,l.addEventListener("message",N,!1)):n=x in p("script")?function(t){g.appendChild(p("script"))[x]=function(){g.removeChild(this),I(t)}}:function(t){setTimeout(A(t),0)}),t.exports={set:y,clear:C}},70076:function(t,e,i){"use strict";var r=i(55963),n=Math.max,o=Math.min;t.exports=function(t,e){var i=r(t);return i<0?n(i+e,0):o(i,e)}},50949:function(t,e,i){"use strict";var r=i(33910),n=i(12924);t.exports=function(t){return r(n(t))}},55963:function(t,e,i){"use strict";var r=i(61325);t.exports=function(t){var e=+t;return e!=e||0===e?0:r(e)}},42510:function(t,e,i){"use strict";var r=i(55963),n=Math.min;t.exports=function(t){var e=r(t);return e>0?n(e,9007199254740991):0}},84405:function(t,e,i){"use strict";var r=i(12924),n=Object;t.exports=function(t){return n(r(t))}},61777:function(t,e,i){"use strict";var r=i(55817),n=i(56695),o=i(65375),s=i(22112),l=i(61823),a=i(25354),h=TypeError,u=a("toPrimitive");t.exports=function(t,e){if(!n(t)||o(t))return t;var i,a=s(t,u);if(a){if(void 0===e&&(e="default"),!n(i=r(a,t,e))||o(i))return i;throw new h("Can't convert object to primitive value")}return void 0===e&&(e="number"),l(t,e)}},87843:function(t,e,i){"use strict";var r=i(61777),n=i(65375);t.exports=function(t){var e=r(t,"string");return n(e)?e:e+""}},8830:function(t,e,i){"use strict";var r=i(25354)("toStringTag"),n={};n[r]="z",t.exports="[object z]"===String(n)},92455:function(t,e,i){"use strict";var r=i(99743),n=String;t.exports=function(t){if("Symbol"===r(t))throw TypeError("Cannot convert a Symbol value to a string");return n(t)}},71747:function(t){"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},97246:function(t,e,i){"use strict";var r=i(58842),n=0,o=Math.random(),s=r(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++n+o,36)}},20327:function(t,e,i){"use strict";var r=i(24072);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},81887:function(t,e,i){"use strict";var r=i(12534),n=i(44256);t.exports=r&&n(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},15373:function(t){"use strict";var e=TypeError;t.exports=function(t,i){if(t<i)throw new e("Not enough arguments");return t}},99819:function(t,e,i){"use strict";var r=i(97738),n=i(80043),o=r.WeakMap;t.exports=n(o)&&/native code/.test(String(o))},25354:function(t,e,i){"use strict";var r=i(97738),n=i(93801),o=i(19472),s=i(97246),l=i(24072),a=i(20327),h=r.Symbol,u=n("wks"),c=a?h.for||h:h&&h.withoutSetter||s;t.exports=function(t){return o(u,t)||(u[t]=l&&o(h,t)?h[t]:c("Symbol."+t)),u[t]}},33700:function(t,e,i){"use strict";var r=i(35651),n=i(19472),o=i(60549),s=i(50112),l=i(37908),a=i(70783),h=i(25121),u=i(16752),c=i(20409),d=i(15822),g=i(47865),f=i(12534),p=i(9168);t.exports=function(t,e,i,m){var w="stackTraceLimit",b=m?2:1,y=t.split("."),C=y[y.length-1],S=r.apply(null,y);if(S){var E=S.prototype;if(!p&&n(E,"cause")&&delete E.cause,!i)return S;var R=r("Error"),T=e(function(t,e){var i=c(m?e:t,void 0),r=m?new S(t):new S;return void 0!==i&&o(r,"message",i),g(r,T,r.stack,2),this&&s(E,this)&&u(r,this,T),arguments.length>b&&d(r,arguments[b]),r});if(T.prototype=E,"Error"!==C?l?l(T,R):a(T,R,{name:!0}):f&&w in S&&(h(T,S,w),h(T,S,"prepareStackTrace")),a(T,S),!p)try{E.name!==C&&o(E,"name",C),E.constructor=T}catch(t){}return T}}},47933:function(t,e,i){"use strict";var r=i(69272),n=i(84405),o=i(24464),s=i(55963),l=i(38609);r({target:"Array",proto:!0},{at:function(t){var e=n(this),i=o(e),r=s(t),l=r>=0?r:i+r;return l<0||l>=i?void 0:e[l]}}),l("at")},58563:function(t,e,i){"use strict";var r=i(69272),n=i(84405),o=i(24464),s=i(56609),l=i(53745);r({target:"Array",proto:!0,arity:1,forced:i(44256)(function(){return 4294967297!==[].push.call({length:4294967296},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=n(this),i=o(e),r=arguments.length;l(i+r);for(var a=0;a<r;a++)e[i]=arguments[a],i++;return s(e,i),i}})},21767:function(t,e,i){"use strict";i(38609)("flat")},95606:function(t,e,i){"use strict";var r=i(69272),n=i(84405),o=i(24464),s=i(56609),l=i(36138),a=i(53745);r({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}()},{unshift:function(t){var e=n(this),i=o(e),r=arguments.length;if(r){a(i+r);for(var h=i;h--;){var u=h+r;h in e?e[u]=e[h]:l(e,u)}for(var c=0;c<r;c++)e[c]=arguments[c]}return s(e,i+r)}})},57855:function(t,e,i){"use strict";var r=i(69272),n=i(97738),o=i(35815),s=i(33700),l="WebAssembly",a=n[l],h=7!==Error("e",{cause:7}).cause,u=function(t,e){var i={};i[t]=s(t,e,h),r({global:!0,constructor:!0,arity:1,forced:h},i)},c=function(t,e){if(a&&a[t]){var i={};i[t]=s(l+"."+t,e,h),r({target:l,stat:!0,constructor:!0,arity:1,forced:h},i)}};u("Error",function(t){return function(e){return o(t,this,arguments)}}),u("EvalError",function(t){return function(e){return o(t,this,arguments)}}),u("RangeError",function(t){return function(e){return o(t,this,arguments)}}),u("ReferenceError",function(t){return function(e){return o(t,this,arguments)}}),u("SyntaxError",function(t){return function(e){return o(t,this,arguments)}}),u("TypeError",function(t){return function(e){return o(t,this,arguments)}}),u("URIError",function(t){return function(e){return o(t,this,arguments)}}),c("CompileError",function(t){return function(e){return o(t,this,arguments)}}),c("LinkError",function(t){return function(e){return o(t,this,arguments)}}),c("RuntimeError",function(t){return function(e){return o(t,this,arguments)}})},92648:function(t,e,i){"use strict";var r=i(69272),n=i(35651),o=i(35815),s=i(55817),l=i(58842),a=i(44256),h=i(80043),u=i(65375),c=i(32482),d=i(44430),g=i(24072),f=String,p=n("JSON","stringify"),m=l(/./.exec),w=l("".charAt),b=l("".charCodeAt),y=l("".replace),C=l(1..toString),S=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,R=/^[\uDC00-\uDFFF]$/,T=!g||a(function(){var t=n("Symbol")("stringify detection");return"[null]"!==p([t])||"{}"!==p({a:t})||"{}"!==p(Object(t))}),M=a(function(){return'"\udf06\ud834"'!==p("\uDF06\uD834")||'"\udead"'!==p("\uDEAD")}),O=function(t,e){var i=c(arguments),r=d(e);if(!(!h(r)&&(void 0===t||u(t))))return i[1]=function(t,e){if(h(r)&&(e=s(r,this,f(t),e)),!u(e))return e},o(p,null,i)},k=function(t,e,i){var r=w(i,e-1),n=w(i,e+1);return m(E,t)&&!m(R,n)||m(R,t)&&!m(E,r)?"\\u"+C(b(t,0),16):t};p&&r({target:"JSON",stat:!0,arity:3,forced:T||M},{stringify:function(t,e,i){var r=c(arguments),n=o(T?O:p,null,r);return M&&"string"==typeof n?y(n,S,k):n}})},35214:function(t,e,i){"use strict";var r=i(69272),n=i(5040),o=i(64584);r({target:"Object",stat:!0},{fromEntries:function(t){var e={};return n(t,function(t,i){o(e,t,i)},{AS_ENTRIES:!0}),e}})},95711:function(t,e,i){"use strict";var r=i(69272),n=i(97738),o=i(48150).clear;r({global:!0,bind:!0,enumerable:!0,forced:n.clearImmediate!==o},{clearImmediate:o})},22548:function(t,e,i){"use strict";i(95711),i(70949)},70949:function(t,e,i){"use strict";var r=i(69272),n=i(97738),o=i(48150).set,s=i(50290),l=n.setImmediate?s(o,!1):o;r({global:!0,bind:!0,enumerable:!0,forced:n.setImmediate!==l},{setImmediate:l})},46022:function(t,e,i){"use strict";i.d(e,{sZ:function(){return tm}});var r=i(2265),n=i(54887),o=i(73553),s=i(3732),l=i(38015),a=i(54317),h=i(78444),u=i(36324),c=i(1518),d=i(98422),g=i(11070),f=i(51648);function p(t,e){let i=new o.Z(t,e||{},s.mc);return i.init(),i}function m(t,e,i){return e=M(e),function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw TypeError("Derived constructors may only return object or undefined");return k(t)}(t,w()?Reflect.construct(e,i||[],M(t).constructor):e.apply(t,i))}function w(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(w=function(){return!!t})()}function b(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)}return i}function y(t){var e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}function E(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,y(r.key),r)}}function R(t,e,i){return e&&E(t.prototype,e),i&&E(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function T(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O(t,e)}function M(t){return(M=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function O(t,e){return(O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function k(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}(0,u.xN)(c.n),p.editors={BaseEditor:d.Hf},p.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new o.Z(t,e,s.mc)},p.DefaultSettings=(0,l.Z)(),p.hooks=a.Z.getSingleton(),p.CellCoords=g.Z,p.CellRange=f.Z,p.packageName="handsontable",p.buildDate="16/01/2024 10:27:23",p.version="14.1.0",p.languages={dictionaryKeys:h.Zs,getLanguageDictionary:h.qG,getLanguagesDictionaries:h.vq,registerLanguageDictionary:h.MG,getTranslatedPhrase:h.vk};var I=null,A="global";function N(t,e){var i=r.Children.toArray(t),n=r.Children.count(t),o=null;return 0!==n&&(o=1===n&&i[0].props[e]?i[0]:i.find(function(t){return void 0!==t.props[e]})),o||null}function H(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function _(t,e){if(void 0===t||null===e)return null;var i=D(e.props,!1);return i.className="".concat("hot-wrapper-editor-container"," ").concat(i.className),n.createPortal(r.createElement("div",Object.assign({},i),e),t.body)}function P(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A,n=N(t,"hot-editor"),o=H(n);return n?r.cloneElement(n,{emitEditorInstance:function(t,i){e.get(o)||e.set(o,new Map),e.get(o).set(null!=i?i:A,t)},editorColumnScope:i,isEditor:!0}):null}function D(t){var e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}var L=function(){function t(){S(this,t)}return R(t,null,[{key:"getSettings",value:function(t){var e={};if(t.settings){var i=t.settings;for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}for(var n in t)"settings"!==n&&"children"!==n&&t.hasOwnProperty(n)&&(e[n]=t[n]);return e}}]),t}(),B=function(t){function e(){return S(this,e),m(this,e,arguments)}return T(e,t),R(e,[{key:"getSettingsProps",value:function(){var t=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(e){return!t.internalProps.includes(e)}).reduce(function(e,i){return e[i]=t.props[i],e},{})}},{key:"getLocalEditorElement",value:function(){return P(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var t=this.props._getChildElementByType(this.props.children,"hot-renderer"),e=this.getLocalEditorElement();this.columnSettings=L.getSettings(this.getSettingsProps()),null!==t&&(this.columnSettings.renderer=this.props._getRendererWrapper(t),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),null!==e&&(this.columnSettings.editor=this.props._getEditorClass(e,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var t=_(this.props._getOwnerDocument(),this.getLocalEditorElement());return r.createElement(r.Fragment,null,t)}}]),e}(r.Component),W=function(t){function e(){var t;return S(this,e),t=m(this,e,arguments),t.state={portals:[]},t}return T(e,t),R(e,[{key:"render",value:function(){return r.createElement(r.Fragment,null,this.state.portals)}}]),e}(r.Component);function V(t,e){return t(e={exports:{}},e.exports),e.exports}/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F="function"==typeof Symbol&&Symbol.for,j=F?Symbol.for("react.element"):60103,U=F?Symbol.for("react.portal"):60106,$=F?Symbol.for("react.fragment"):60107,z=F?Symbol.for("react.strict_mode"):60108,K=F?Symbol.for("react.profiler"):60114,G=F?Symbol.for("react.provider"):60109,Y=F?Symbol.for("react.context"):60110,X=F?Symbol.for("react.async_mode"):60111,q=F?Symbol.for("react.concurrent_mode"):60111,Z=F?Symbol.for("react.forward_ref"):60112,J=F?Symbol.for("react.suspense"):60113,Q=F?Symbol.for("react.suspense_list"):60120,tt=F?Symbol.for("react.memo"):60115,te=F?Symbol.for("react.lazy"):60116,ti=F?Symbol.for("react.block"):60121,tr=F?Symbol.for("react.fundamental"):60117,tn=F?Symbol.for("react.responder"):60118,to=F?Symbol.for("react.scope"):60119;function ts(t){if("object"===C(t)&&null!==t){var e=t.$$typeof;switch(e){case j:switch(t=t.type){case X:case q:case $:case K:case z:case J:return t;default:switch(t=t&&t.$$typeof){case Y:case Z:case te:case tt:case G:return t;default:return e}}case U:return e}}}function tl(t){return ts(t)===q}var ta={AsyncMode:X,ConcurrentMode:q,ContextConsumer:Y,ContextProvider:G,Element:j,ForwardRef:Z,Fragment:$,Lazy:te,Memo:tt,Portal:U,Profiler:K,StrictMode:z,Suspense:J,isAsyncMode:function(t){return tl(t)||ts(t)===X},isConcurrentMode:tl,isContextConsumer:function(t){return ts(t)===Y},isContextProvider:function(t){return ts(t)===G},isElement:function(t){return"object"===C(t)&&null!==t&&t.$$typeof===j},isForwardRef:function(t){return ts(t)===Z},isFragment:function(t){return ts(t)===$},isLazy:function(t){return ts(t)===te},isMemo:function(t){return ts(t)===tt},isPortal:function(t){return ts(t)===U},isProfiler:function(t){return ts(t)===K},isStrictMode:function(t){return ts(t)===z},isSuspense:function(t){return ts(t)===J},isValidElementType:function(t){return"string"==typeof t||"function"==typeof t||t===$||t===q||t===K||t===z||t===J||t===Q||"object"===C(t)&&null!==t&&(t.$$typeof===te||t.$$typeof===tt||t.$$typeof===G||t.$$typeof===Y||t.$$typeof===Z||t.$$typeof===tr||t.$$typeof===tn||t.$$typeof===to||t.$$typeof===ti)},typeOf:ts},th=V(function(t,e){});function tu(){}function tc(){}th.AsyncMode,th.ConcurrentMode,th.ContextConsumer,th.ContextProvider,th.Element,th.ForwardRef,th.Fragment,th.Lazy,th.Memo,th.Portal,th.Profiler,th.StrictMode,th.Suspense,th.isAsyncMode,th.isConcurrentMode,th.isContextConsumer,th.isContextProvider,th.isElement,th.isForwardRef,th.isFragment,th.isLazy,th.isMemo,th.isPortal,th.isProfiler,th.isStrictMode,th.isSuspense,th.isValidElementType,th.typeOf,V(function(t){t.exports=ta}),Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;var r=Object.getOwnPropertyNames(e).map(function(t){return e[t]});if("0123456789"!==r.join(""))return!1;var n={};"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}(),Function.call.bind(Object.prototype.hasOwnProperty),tc.resetWarningCache=tu;var td=function(){function t(t,e,i,r,n,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var s=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var i={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:tc,resetWarningCache:tu};return i.PropTypes=i,i},tg=V(function(t){t.exports=td()}),tf=function(t){function e(){var t;return S(this,e),t=m(this,e,arguments),t.id=null,t.__hotInstance=null,t.hotElementRef=null,t.columnSettings=[],t.renderersPortalManager=null,t.portalCacheArray=[],t.renderedCellCache=new Map,t.editorCache=new Map,t.componentRendererColumns=new Map,t}return T(e,t),R(e,[{key:"hotInstance",get:function(){return this.__hotInstance&&(!this.__hotInstance||this.__hotInstance.isDestroyed)?(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null):this.__hotInstance},set:function(t){this.__hotInstance=t}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return"undefined"!=typeof window?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(t){this.hotElementRef=t}},{key:"getRendererWrapper",value:function(t){var e=this;return function(i,o,s,l,a,h,u){var c=e.getRenderedCellCache();if(c.has("".concat(s,"-").concat(l))&&(o.innerHTML=c.get("".concat(s,"-").concat(l)).innerHTML),o&&!o.getAttribute("ghost-table")){for(var d=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document;i||(i=document),I||(I=i.createDocumentFragment());var o=i.createElement("DIV");I.appendChild(o);var s=r.cloneElement(t,function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?b(Object(i),!0).forEach(function(e){var r,n;r=e,n=i[e],(r=y(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:n.createPortal(s,o,"".concat(e.row,"-").concat(e.col,"-").concat(Math.random())),portalContainer:o}}(t,{TD:o,row:s,col:l,prop:a,value:h,cellProperties:u,isRenderer:!0},o.ownerDocument),g=d.portal,f=d.portalContainer;o.firstChild;)o.removeChild(o.firstChild);o.appendChild(f),e.portalCacheArray.push(g)}return c.set("".concat(s,"-").concat(l),o),o}}},{key:"getEditorClass",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A,r=H(t),n=null===(e=this.getEditorCache().get(r))||void 0===e?void 0:e.get(i);return this.makeEditorClass(n)}},{key:"makeEditorClass",value:function(t){var e=function(e){function i(e){var r;return S(this,i),r=m(this,i,[e]),t.hotCustomEditorInstance=k(r),r.editorComponent=t,r}return T(i,e),R(i,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}]),i}(p.editors.BaseEditor);return Object.getOwnPropertyNames(p.editors.BaseEditor.prototype).forEach(function(i){"constructor"!==i&&(e.prototype[i]=function(){for(var e,r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t[i]).call.apply(e,[t].concat(n))})}),e}},{key:"getGlobalRendererElement",value:function(){return N(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return P(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var t=L.getSettings(this.props),e=this.getGlobalRendererElement(),i=this.getGlobalEditorElement();return t.columns=this.columnSettings.length?this.columnSettings:t.columns,i?t.editor=this.getEditorClass(i,A):t.editor=this.props.editor||(this.props.settings?this.props.settings.editor:void 0),e?(t.renderer=this.getRendererWrapper(e),this.componentRendererColumns.set("global",!0)):t.renderer=this.props.renderer||(this.props.settings?this.props.settings.renderer:void 0),t}},{key:"displayAutoSizeWarning",value:function(t){var e,i;this.hotInstance&&(null!==(e=this.hotInstance.getPlugin("autoRowSize"))&&void 0!==e&&e.enabled||null!==(i=this.hotInstance.getPlugin("autoColumnSize"))&&void 0!==i&&i.enabled)&&this.componentRendererColumns.size>0&&function(){if("undefined"!=typeof console){var t;(t=console).warn.apply(t,arguments)}}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function(t,e){this.columnSettings[e]=t}},{key:"handsontableBeforeViewRender",value:function(){this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){var t,e=this;this.renderersPortalManager.setState({portals:function(t){if(Array.isArray(t))return x(t)}(t=this.portalCacheArray)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return x(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return x(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},function(){e.portalCacheArray=[]})}},{key:"updateHot",value:function(t){this.hotInstance&&this.hotInstance.updateSettings(t,!1)}},{key:"setRenderersPortalManagerRef",value:function(t){this.renderersPortalManager=t}},{key:"componentDidMount",value:function(){var t=this,e=this.createNewGlobalSettings();this.hotInstance=new p.Core(this.hotElementRef,e),this.hotInstance.addHook("beforeViewRender",function(){return t.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return t.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(e)}},{key:"componentDidUpdate",value:function(){this.clearCache();var t=this.createNewGlobalSettings();this.updateHot(t),this.displayAutoSizeWarning(t)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var t=this,e=r.Children.toArray(this.props.children).filter(function(t){return t.type===B}).map(function(e,i){return r.cloneElement(e,{_componentRendererColumns:t.componentRendererColumns,_emitColumnSettings:t.setHotColumnSettings.bind(t),_columnIndex:i,_getChildElementByType:N.bind(t),_getRendererWrapper:t.getRendererWrapper.bind(t),_getEditorClass:t.getEditorClass.bind(t),_getOwnerDocument:t.getOwnerDocument.bind(t),_getEditorCache:t.getEditorCache.bind(t),children:e.props.children})}),i=D(this.props),n=_(this.getOwnerDocument(),this.getGlobalEditorElement());return r.createElement(r.Fragment,null,r.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},i),e),r.createElement(W,{ref:this.setRenderersPortalManagerRef.bind(this)}),n)}}],[{key:"version",get:function(){return"14.1.0"}}]),e}(r.Component);tf.propTypes={style:tg.object,id:tg.string,className:tg.string};var tp=["children"],tm=r.forwardRef(function(t,e){var i,n=t.children,o=function(t,e){if(null==t)return{};var i,r,n=function(t,e){if(null==t)return{};var i,r,n={},o=Object.keys(t);for(r=0;r<o.length;r++)i=o[r],e.indexOf(i)>=0||(n[i]=t[i]);return n}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)i=o[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}(t,tp),s="function"==typeof r.useId?r.useId():void 0,l=null!==(i=o.id)&&void 0!==i?i:s;return r.createElement(tf,Object.assign({id:l},o,{ref:e}),n)});tm.version=tf.version,r.Component},90292:function(t,e,i){"use strict";i.d(e,{P:function(){return l},Q:function(){return s}});let r=/^(\r\n|\n\r|\r|\n)/,n=/^[^\t\r\n]+/,o=/^\t/;function s(t){let e;let i=[[""]];if(0===t.length)return i;let s=0,l=0;for(;t.length>0&&e!==t.length;)if(e=t.length,t.match(o))t=t.replace(o,""),s+=1,i[l][s]="";else if(t.match(r))t=t.replace(r,""),s=0,i[l+=1]=[""];else{let e="";if(t.startsWith('"')){let i=0,r=!0;for(;r;){let n=t.slice(0,1);'"'===n&&(i+=1),e+=n,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&i%2==0)&&(r=!1)}e=e.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,t=>Array(Math.floor(t.length/2)).fill('"').join(""))}else{let i=t.match(n);e=i?i[0]:"",t=t.slice(e.length)}i[l][s]=e}return i}function l(t){let e,i,r,n,o;let s="";for(e=0,i=t.length;e<i;e+=1){for(r=0,n=t[e].length;r<n;r+=1)r>0&&(s+="	"),"string"==typeof(o=t[e][r])?o.indexOf("\n")>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:null==o?s+="":s+=o;e!==i-1&&(s+="\n")}return s}},40746:function(t,e,i){"use strict";i.d(e,{Ii:function(){return r},vp:function(){return n}});let r=1,n=2},27431:function(t,e,i){"use strict";i.d(e,{E:function(){return a}}),i(58563),i(47933),i(57855);var r=i(40746);function n(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o(t,e){var i=s(t,e,"get");return i.get?i.get.call(t):i.value}function s(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var l=new WeakMap;class a{static get DEFAULT_WIDTH(){return 50}constructor(t){n(this,"count",0),n(this,"startColumn",null),n(this,"endColumn",null),n(this,"startPosition",null),n(this,"isVisibleInTrimmingContainer",!1),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:void 0}),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,s(this,l,"set"),t),this.calculate()}calculate(){let t;let{calculationType:e,overrideFn:i,scrollOffset:n,totalColumns:s,viewportWidth:a}=o(this,l),h=Math.max(o(this,l).scrollOffset,0),u=h>0?a+1:a,c=0,d=!0,g=[],f=0,p=0;for(let i=0;i<s;i++)if(t=this._getColumnWidth(i),c<=h&&e!==r.vp&&(this.startColumn=i,f=t),c>=h&&c+(e===r.vp?t:0)<=h+u&&((null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=i,f=t),this.endColumn=i),g.push(c),c+=t,p=t,e!==r.vp&&(this.endColumn=i),c>=h+a){d=!1;break}let m=e===r.vp?0:p,w=e===r.vp?f:0;if(n+a-u<-1*o(this,l).inlineStartOffset||n>g.at(-1)+m||-1*o(this,l).scrollOffset-o(this,l).viewportWidth>-1*w?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===s-1&&d)for(this.startColumn=this.endColumn;this.startColumn>0;){let i=g[this.endColumn]+t-g[this.startColumn-1];if((i<=a||e!==r.vp)&&(this.startColumn-=1),i>a)break}e===r.Ii&&null!==this.startColumn&&i&&i(this),this.startPosition=g[this.startColumn],void 0===this.startPosition&&(this.startPosition=null),s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}_getColumnWidth(t){let e=o(this,l).columnWidthFn(t);return isNaN(e)&&(e=a.DEFAULT_WIDTH),e}}},3391:function(t,e,i){"use strict";i.d(e,{U:function(){return a}}),i(58563),i(47933),i(57855);var r=i(40746);function n(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o(t,e){var i=s(t,e,"get");return i.get?i.get.call(t):i.value}function s(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var l=new WeakMap;class a{static get DEFAULT_HEIGHT(){return 23}constructor(t){n(this,"count",0),n(this,"startRow",null),n(this,"endRow",null),n(this,"startPosition",null),n(this,"isVisibleInTrimmingContainer",!1),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:void 0}),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,s(this,l,"set"),t),this.calculate()}calculate(){let t;let{calculationType:e,overrideFn:i,rowHeightFn:n,scrollOffset:s,totalRows:h,viewportHeight:u}=o(this,l),c=Math.max(o(this,l).scrollOffset,0),d=o(this,l).horizontalScrollbarHeight||0,g=0,f=!0,p=[],m=0,w=0;for(let i=0;i<h;i++)if(isNaN(t=n(i))&&(t=a.DEFAULT_HEIGHT),g<=c&&e!==r.vp&&(this.startRow=i,m=t),g>=c&&g+(e===r.vp?t:0)<=c+u-d&&(null===this.startRow&&(this.startRow=i,m=t),this.endRow=i),p.push(g),g+=t,w=t,e!==r.vp&&(this.endRow=i),g>=c+u-d){f=!1;break}let b=e===r.vp?m:0,y=e===r.vp?0:w;if(s+u-d<b||s>p.at(-1)+y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===h-1&&f)for(this.startRow=this.endRow;this.startRow>0;){let i=p[this.endRow]+t-p[this.startRow-1];if((i<=u-d||e!==r.vp)&&(this.startRow-=1),i>=u-d)break}e===r.Ii&&null!==this.startRow&&i&&i(this),this.startPosition=p[this.startRow],void 0===this.startPosition&&(this.startPosition=null),h<this.endRow&&(this.endRow=h-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}},11070:function(t,e,i){"use strict";function r(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t,e){var i=s(t,e,"get");return i.get?i.get.call(t):i.value}function o(t,e,i){var r=s(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function s(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}i(57855);var l=new WeakMap;class a{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,"row",null),r(this,"col",null),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:!1}),o(this,l,i),void 0!==t&&void 0!==e&&(this.row=t,this.col=e)}isValid(t){let{countRows:e,countCols:i,countRowHeaders:r,countColHeaders:n}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!!Number.isInteger(this.row)&&!!Number.isInteger(this.col)&&!(this.row<-n)&&!(this.col<-r)&&!(this.row>=e)&&!(this.col>=i)}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return n(this,l)}isSouthEastOf(t){return this.row>=t.row&&(n(this,l)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(n(this,l)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(n(this,l)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(n(this,l)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null==t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null==t?void 0:t.col)&&(this.col=t.col),t instanceof a&&o(this,l,t.isRtl()),this}clone(){return new a(this.row,this.col,n(this,l))}toObject(){return{row:this.row,col:this.col}}}e.Z=a},51648:function(t,e,i){"use strict";i(58563),i(57855);var r=i(11070);function n(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o(t,e){var i=s(t,e,"get");return i.get?i.get.call(t):i.value}function s(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var l=new WeakMap;class a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n(this,"highlight",null),n(this,"from",null),n(this,"to",null),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,l),l.set(this,{writable:!0,value:!1}),this.highlight=t.clone(),this.from=e.clone(),this.to=i.clone(),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,s(this,l,"set"),r)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){let{row:e,col:i}=t,r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return r.row<=e&&n.row>=e&&r.col<=i&&n.col>=i}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>i.row||t.col>i.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(i.row,t.row),Math.max(i.col,t.col)),!0)}expandByRange(t){if(this.includesRange(t)||!this.overlaps(t))return!1;let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),r=this.getDirection(),n=t.getOuterTopStartCorner(),o=t.getOuterBottomEndCorner(),s=Math.min(e.row,n.row),l=Math.min(e.col,n.col),a=Math.max(i.row,o.row),h=Math.max(i.col,o.col),u=this._createCellCoords(s,l),c=this._createCellCoords(a,h);return this.from=u,this.to=c,this.setDirection(r),this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally(),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){let t=this.getDirection();switch(t){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){let t=this.getDirection();switch(t){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return o(this,l)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return o(this,l)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return o(this,l)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return o(this,l)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return o(this,l)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return o(this,l)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return o(this,l)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return o(this,l)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof r.Z&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];let e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},r=[];return e.top===i.top&&r.push("top"),e.right===i.right&&r.push(o(this,l)?"left":"right"),e.bottom===i.bottom&&r.push("bottom"),e.left===i.left&&r.push(o(this,l)?"right":"left"),r}getInner(){let t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),i=[];for(let r=t.row;r<=e.row;r++)for(let n=t.col;n<=e.col;n++)this.from.row===r&&this.from.col===n||this.to.row===r&&this.to.col===n||i.push(this._createCellCoords(r,n));return i}getAll(){let t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),i=[];for(let r=t.row;r<=e.row;r++)for(let n=t.col;n<=e.col;n++)t.row===r&&t.col===n?i.push(t):e.row===r&&e.col===n?i.push(e):i.push(this._createCellCoords(r,n));return i}forAll(t){let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=e.row;r<=i.row;r++)for(let n=e.col;n<=i.col;n++){let e=t(r,n);if(!1===e)return}}clone(){return new a(this.highlight,this.from,this.to,o(this,l))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new r.Z(t,e,o(this,l))}}e.Z=a},58352:function(t,e,i){"use strict";i.d(e,{$7:function(){return u},AI:function(){return o},BA:function(){return h},CD:function(){return r},Nc:function(){return n},Os:function(){return a},P$:function(){return l},t8:function(){return s}});let r="active-header",n="header",o="area",s="focus",l="fill",a="row",h="column",u="custom-selection"},36324:function(t,e,i){"use strict";i.d(e,{DA:function(){return d},V1:function(){return h},xN:function(){return g}}),i(57855);var r=i(82656),n=i(57416),o=i(36903),s=i(92740);let{register:l,getItem:a,hasItem:h,getNames:u,getValues:c}=(0,r.Z)("cellTypes");function d(t){if(!h(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return a(t)}function g(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);let{editor:i,renderer:r,validator:a}=e;i&&(0,n.qm)(t,i),r&&(0,o.zn)(t,r),a&&(0,s.Ie)(t,a),l(t,e)}},1518:function(t,e,i){"use strict";i.d(e,{n:function(){return o}});var r=i(2694),n=i(49532);let o={CELL_TYPE:"text",editor:r.H,renderer:n.V}},18435:function(t,e,i){"use strict";i.d(e,{o:function(){return l}});var r=i(82659),n=i(5566),o=i(18200);function s(t){let e=t.rootDocument,i=e.createElement("input");return i.type="text",i.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&(0,n.P$)(i,[(0,o.Rn)(),(0,o.cV)()]),i}function l(t){let e;let i=e=>{if(!e)return null;let i=a(t),r=h(t);return e.col<i.col&&(e.col=i.col),e.col>r.col&&(e.col=r.col),e.row<i.row&&(e.row=i.row),e.row>r.row&&(e.row=r.row),e},{activate:n,deactivate:o}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.rootElement,r=s(t),n=s(t);return r.addEventListener("focus",()=>null==e?void 0:e.onFocusFromTop()),n.addEventListener("focus",()=>null==e?void 0:e.onFocusFromBottom()),i.firstChild.before(r),i.lastChild.after(n),{activate(){t._registerTimeout(()=>{r.tabIndex=0,n.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,n.tabIndex=-1},10)}}}(t,{onFocusFromTop(){var r;let n=null!==(r=i(e))&&void 0!==r?r:a(t);n&&(t.runHooks("modifyFocusOnTabNavigation","from_above",n),t.selectCell(n.row,n.col)),t.listen()},onFocusFromBottom(){var r;let n=null!==(r=i(e))&&void 0!==r?r:h(t);n&&(t.runHooks("modifyFocusOnTabNavigation","from_below",n),t.selectCell(n.row,n.col)),t.listen()}}),l={wrapped:!1,flipped:!1},u=!0,c=!1,d=!1;t.addHook("afterListen",()=>o()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(i,r,n,o,s)=>{if(c&&(l.wrapped&&l.flipped||d)&&(d=!1,s.value=!0),u){var a;e=null===(a=t.getSelectedRangeLast())||void 0===a?void 0:a.highlight}}),t.addHook("beforeRowWrap",(t,e,i)=>{l.wrapped=!0,l.flipped=i});let g={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:r.W,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...g,callback:()=>{let{tabNavigation:e}=t.getSettings();c=!0,t.getSelectedRangeLast()&&!e&&(u=!1),e||(d=!0)},position:"before"},{...g,callback:i=>{let{tabNavigation:r,autoWrapRow:n}=t.getSettings();if(c=!1,u=!0,!r||!t.selection.isSelected()||n&&l.wrapped&&l.flipped||!n&&l.wrapped)return n&&l.wrapped&&l.flipped&&(e=i.shiftKey?a(t):h(t)),l.wrapped=!1,l.flipped=!1,t.deselectCell(),t.unlisten(),!1;i.preventDefault()},position:"after"}])}function a(t){let{rowIndexMapper:e,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings(),n=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return(0===n&&(n=e.getVisualFromRenderableIndex(n)),0===o&&(o=i.getVisualFromRenderableIndex(o)),null===n||null===o)?null:t._createCellCoords(n,o)}function h(t){var e,i;let{rowIndexMapper:r,columnIndexMapper:n}=t,{navigableHeaders:o}=t.getSettings(),s=r.getRenderableIndexesLength()-1,l=n.getRenderableIndexesLength()-1;if(s<0){if(!o||0===t.countColHeaders())return null;s=-1}if(l<0){if(!o||0===t.countColHeaders())return null;l=-1}return t._createCellCoords(null!==(e=r.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(i=n.getVisualFromRenderableIndex(l))&&void 0!==i?i:l)}},63891:function(t,e,i){"use strict";i(58563),i(57855);var r=i(69488),n=i(77628),o=i(99440),s=i(67790),l=i(98179);function a(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}e.Z=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];a(this,"hot",void 0),a(this,"data",void 0),a(this,"dataType","array"),a(this,"colToProp",()=>{}),a(this,"propToCol",()=>{}),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){let e=[];return(0,o.Bk)(this.data,(i,r)=>{let n=this.getAtCell(r,t);e.push(n)}),e}getAtRow(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=void 0===e&&void 0===i,a=null,h=null;if(Array.isArray(a=this.modifyRowData(t)))h=[],o?a.forEach((e,i)=>{h[i]=this.getAtPhysicalCell(t,i,a)}):(0,s.q4)(e,i,i=>{h[i-e]=this.getAtPhysicalCell(t,i,a)});else if((0,r.Kn)(a)||(0,l.mf)(a)){if(h=n?[]:{},!o||n){let o=this.countFirstRowKeys()-1;(0,s.q4)(0,o,s=>{let l=this.colToProp(s);if(s>=(e||0)&&s<=(i||o)&&!Number.isInteger(l)){let e=this.getAtPhysicalCell(t,l,a);n?h.push(e):(0,r.Hn)(h,l,e)}})}else(0,r._l)(a,(e,i)=>{(0,r.Hn)(h,i,this.getAtPhysicalCell(t,i,a))})}return h}setAtCell(t,e,i){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let n=(0,r.sm)(i);this.hot.runHooks("modifySourceData",t,e,n,"set"),n.isTouched()&&(i=n.value)}Number.isInteger(e)?this.data[t][e]=i:(0,r.Hn)(this.data[t],e,i)}}getAtPhysicalCell(t,e,i){let n=null;if(i&&(n="string"==typeof e?(0,r.$s)(i,e):"function"==typeof e?e(i):i[e]),this.hot.hasHook("modifySourceData")){let i=(0,r.sm)(n);this.hot.runHooks("modifySourceData",t,e,i,"get"),i.isTouched()&&(n=i.value)}return n}getAtCell(t,e){let i=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),i)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,n=null,o=null,l=null,a=null;null===t||null===e?(r=!0,n=0,l=this.countRows()-1):(n=Math.min(t.row,e.row),o=Math.min(t.col,e.col),l=Math.max(t.row,e.row),a=Math.max(t.col,e.col));let h=[];return(0,s.q4)(n,l,t=>{h.push(r?this.getAtRow(t,void 0,void 0,i):this.getAtRow(t,o,a,i))}),h}countRows(){if(this.hot.hasHook("modifySourceLength")){let t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return(0,n.Eb)(this.data)}destroy(){this.data=null,this.hot=null}}},82230:function(t,e,i){"use strict";let r;i.d(e,{Z:function(){return E}}),i(57855);var n=i(69488),o=i(36324);function s(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r="string"==typeof e.type?(0,o.DA)(e.type):e.type;if(t._automaticallyAssignedMetaProps&&(0,n._l)(e,(e,i)=>void t._automaticallyAssignedMetaProps.delete(i)),!(0,n.Kn)(r))return;i!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);let s={};(0,n._l)(r,(e,r)=>{var o,l;"CELL_TYPE"!==r&&((null===(o=i._automaticallyAssignedMetaProps)||void 0===o?void 0:o.has(r))||!(0,n.nr)(i,r))&&(s[r]=e,null===(l=t._automaticallyAssignedMetaProps)||void 0===l||l.add(r))}),(0,n.l7)(t,s)}function l(t){return Number.isInteger(t)&&t>=0}function a(t,e){if(!t())throw Error(`Assertion failed: ${e}`)}var h=i(38015);function u(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class c{constructor(t){u(this,"metaCtor",class{}),u(this,"meta",void 0),this.meta=this.metaCtor.prototype,(0,n.l7)(this.meta,(0,h.Z)()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;(0,n.l7)(this.meta,t),s(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}class d{constructor(t){var e,i,r;i=void 0,(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="meta","string"))?r:String(r))in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i;let n=t.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(t){(0,n.l7)(this.meta,t),s(this.meta,t,t)}}i(58563);var g=i(99440);function f(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}r=Symbol.iterator;class p{constructor(t){f(this,"valueFactory",void 0),f(this,"data",[]),f(this,"index",[]),f(this,"holes",new Set),this.valueFactory=t}obtain(t){let e;a(()=>l(t),"Expecting an unsigned number.");let i=this._getStorageIndexByKey(t);if(i>=0)void 0===(e=this.data[i])&&(e=this.valueFactory(t),this.data[i]=e);else if(e=this.valueFactory(t),this.holes.size>0){let i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=e,this.index[t]=i}else this.data.push(e),this.index[t]=this.data.length-1;return e}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;a(()=>l(t)||null==t,"Expecting an unsigned number or null/undefined argument.");let i=[],r=this.data.length;for(let t=0;t<e;t++)i.push(r+t),this.data.push(void 0);let n=null==t?this.index.length:t;this.index=[...this.index.slice(0,n),...i,...this.index.slice(n)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;a(()=>l(t)||null==t,"Expecting an unsigned number or null/undefined argument.");let i=this.index.splice(null==t?this.index.length-e:t,e);for(let t=0;t<i.length;t++){let e=i[t];"number"==typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return(0,g.w7)(this.data,(t,e)=>!this.holes.has(e))[Symbol.iterator]()}entries(){let t=[];for(let e=0;e<this.data.length;e++){let i=this._getKeyByStorageIndex(e);-1!==i&&t.push([i,this.data[e]])}let e=0;return{next:()=>{if(e<t.length){let i=t[e];return e+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[r](){return this.entries()}}function m(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let w=["data","width"];class b{constructor(t){m(this,"globalMeta",void 0),m(this,"metas",new p(()=>this._createMeta())),this.globalMeta=t,this.metas=new p(()=>this._createMeta())}updateMeta(t,e){let i=this.getMeta(t);(0,n.l7)(i,e),s(i,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function i(){}(0,n.ED)(i,t);for(let t=0;t<e.length;t++)i.prototype[e[t]]=void 0;return i}(this.globalMeta.getMetaConstructor(),w).prototype}}function y(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class C{constructor(t){y(this,"columnMeta",void 0),y(this,"metas",new p(()=>this._createRow())),this.columnMeta=t}updateMeta(t,e,i){let r=this.getMeta(t,e);(0,n.l7)(r,i),s(r,i)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(t,e)}getMeta(t,e,i){let r=this.metas.obtain(t).obtain(e);return void 0===i?r:r[i]}setMeta(t,e,i,r){var n;let o=this.metas.obtain(t).obtain(e);null===(n=o._automaticallyAssignedMetaProps)||void 0===n||n.delete(i),o[i]=r}removeMeta(t,e,i){let r=this.metas.obtain(t).obtain(e);delete r[i]}getMetas(){let t=[],e=Array.from(this.metas.values());for(let i=0;i<e.length;i++)t.push(...e[i].values());return t}getMetasAtRow(t){a(()=>l(t),"Expecting an unsigned number.");let e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new p(t=>this._createMeta(t))}_createMeta(t){let e=this.columnMeta.getMetaConstructor(t);return new e}}var S=i(63437);class E{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new c(t),this.tableMeta=new d(this.globalMeta),this.columnMeta=new b(this.globalMeta),this.cellMeta=new C(this.columnMeta),i.forEach(t=>new t(this)),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,i){let{visualRow:r,visualColumn:n}=i,o=this.cellMeta.getMeta(t,e);return o.visualRow=r,o.visualCol=n,o.row=t,o.col=e,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(t,e,i){if("string"!=typeof i)throw Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,i)}setCellMeta(t,e,i,r){this.cellMeta.setMeta(t,e,i,r)}updateCellMeta(t,e,i){this.cellMeta.updateMeta(t,e,i)}removeCellMeta(t,e,i){this.cellMeta.removeMeta(t,e,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}(0,n.jB)(E,S.Z)},90243:function(t,e,i){"use strict";i.d(e,{$:function(){return l}}),i(57855);var r=i(54317),n=i(69488),o=i(98179);function s(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class l{constructor(t){s(this,"metaManager",void 0),s(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),r.Z.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(t){var e,i;let{row:r,col:s}=t;if(null!==(e=this.metaSyncMemo.get(r))&&void 0!==e&&e.has(s))return;let{visualRow:l,visualCol:a}=t,h=this.metaManager.hot,u=h.colToProp(a);t.prop=u,h.runHooks("beforeGetCellMeta",l,a,t);let c=(0,n.nr)(t,"type")?t.type:null,d=(0,o.mf)(t.cells)?t.cells(r,s,u):null;c&&(d?d.type=null!==(i=d.type)&&void 0!==i?i:c:d={type:c}),d&&this.metaManager.updateCellMeta(r,s,d),h.runHooks("afterGetCellMeta",l,a,t),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(s)}}},60045:function(t,e,i){"use strict";function r(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{_:function(){return n}}),i(57855);class n{constructor(t){r(this,"metaManager",void 0),r(this,"usageTracker",new Set),r(this,"propDescriptors",new Map([["ariaTags",{onChange(t,e,i){if(!i)throw Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){let e=this.metaManager.hot.isRtl();if(e&&"fixedColumnsLeft"===t)throw Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,e,i){if(!i)throw Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((t,e)=>{let{target:i,onChange:r=()=>{}}=t,n="string"==typeof i,o=n?i:e,s=`_${o}`;this.metaManager.globalMeta.meta[s]=this.metaManager.globalMeta.meta[o],this.installPropWatcher(e,s,r),n&&this.installPropWatcher(i,s,r)})}installPropWatcher(t,e,i){let r=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(n){let o=!r.usageTracker.has(t);r.usageTracker.add(t),i.call(r,t,n,o),this[e]=n},enumerable:!0,configurable:!0})}}},39620:function(t,e,i){"use strict";i.d(e,{o:function(){return p}}),i(58563),i(57855);var r=i(66411),n=i(98179),o=i(90292),s=i(77628),l=i(69488),a=i(99440),h=i(67790),u=i(2518);function c(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class d{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,i){c(this,"hot",void 0),c(this,"metaManager",void 0),c(this,"tableMeta",void 0),c(this,"dataSource",void 0),c(this,"duckSchema",void 0),c(this,"colToPropCache",void 0),c(this,"propToColCache",void 0),this.hot=t,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=e,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){let t;let e=this.getSchema();if(void 0===e)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let i=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,i){let r=0,n=0,o=!1;if("function"==typeof i){let t=(0,l.Q8)(e);r=t>0?t:this.countFirstRowKeys(),o=!0}else{let t=this.tableMeta.maxCols;r=Math.min(t,i.length)}for(t=0;t<r;t++){let e=o?i(t):i[t];if((0,l.Kn)(e)){if(void 0!==e.data){let i=o?n:t;this.colToPropCache[i]=e.data,this.propToColCache.set(e.data,i)}n+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return(0,s.Eb)(this.dataSource)}recursiveDuckColumns(t,e,i){let r,n=e,o=i;return void 0===n&&(n=0,o=""),"object"!=typeof t||Array.isArray(t)||(0,l._l)(t,(t,e)=>{null===t?(r=o+e,this.colToPropCache.push(r),this.propToColCache.set(r,n),n+=1):n=this.recursiveDuckColumns(t,n,`${e}.`)}),n}colToProp(t){if(!1===Number.isInteger(t))return t;let e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&(0,u.$K)(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){let e=this.propToColCache.get(t);if((0,u.$K)(e))return this.hot.toVisualColumn(e);let i=this.hot.toVisualColumn(t);return null===i?t:i}getSchema(){let t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,l.ie)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.hot.countSourceRows(),o=n,s=0,a=t;("number"!=typeof a||a>=n)&&(a=n),a<this.hot.countRows()&&(o=this.hot.toPhysicalRow(a));let u=this.hot.runHooks("beforeCreateRow",a,e,i);if(!1===u||null===o)return{delta:0};let c=this.tableMeta.maxRows,d=this.getSchema().length,g=[];for(;s<e&&n+s<c;){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=(0,l.I8)(this.getSchema()):(t=[],(0,h.q4)(d-1,()=>t.push(null))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(a+s):(t={},(0,l.ZB)(t,this.getSchema())),g.push(t),s+=1}this.hot.rowIndexMapper.insertIndexes(a,s),"below"===r&&(o=Math.min(o+1,n)),this.spliceData(o,0,g);let f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===g.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==t?this.metaManager.createRow(null,s):"auto"!==i&&this.metaManager.createRow(o,e)),this.hot.runHooks("afterCreateRow",f,s,i),this.hot.forceFullRender=!0,{delta:s,startPhysicalIndex:o}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let n=this.dataSource,o=this.tableMeta.maxCols,s=this.hot.countSourceCols(),l=t;("number"!=typeof l||l>=s)&&(l=s);let a=this.hot.runHooks("beforeCreateCol",l,e,i);if(!1===a)return{delta:0};let h=s;l<this.hot.countCols()&&(h=this.hot.toPhysicalColumn(l));let u=this.hot.countSourceRows(),c=this.hot.countCols(),d=0,g=h;"end"===r&&(g=Math.min(g+1,s));let f=g;for(;d<e&&c<o;){if("number"!=typeof l||l>=c){if(u>0)for(let t=0;t<u;t+=1)void 0===n[t]&&(n[t]=[]),n[t].push(null);else n.push([null])}else for(let t=0;t<u;t++)n[t].splice(g,0,null);d+=1,g+=1,c+=1}this.hot.columnIndexMapper.insertIndexes(l,d),d>0&&(null==t?this.metaManager.createColumn(null,d):"auto"!==i&&this.metaManager.createColumn(f,e));let p=this.hot.toVisualColumn(f);return this.hot.runHooks("afterCreateCol",p,d,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:d,startPhysicalIndex:f}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(t)?t:-e,n=this.visualRowsToPhysical(r,e),o=this.hot.countSourceRows();r=(o+r)%o;let s=this.hot.runHooks("beforeRemoveRow",r,n.length,n,i);if(!1===s)return!1;let l=n.length;if(this.filterData(r,l,n),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(n);let t=(0,u.$K)(this.tableMeta.columns)||(0,u.$K)(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===t&&this.hot.columnIndexMapper.setIndexesSequence([])}let a=n.slice(0).sort((t,e)=>e-t);return a.forEach(t=>{this.metaManager.removeRow(t,1)}),this.hot.runHooks("afterRemoveRow",r,l,n,i),this.hot.forceFullRender=!0,!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw Error("cannot remove column with object data source or columns option specified");let r="number"!=typeof t?-e:t;r=(this.hot.countCols()+r)%this.hot.countCols();let n=this.visualColumnsToPhysical(r,e),o=n.slice(0).sort((t,e)=>e-t),s=this.hot.runHooks("beforeRemoveCol",r,e,n,i);if(!1===s)return!1;let l=!0,a=o.length,h=this.dataSource;for(let t=0;t<a;t++)l&&n[0]!==n[t]-t&&(l=!1);if(l)for(let t=0,i=this.hot.countSourceRows();t<i;t++)h[t].splice(n[0],e),0===t&&this.metaManager.removeColumn(n[0],e);else for(let t=0,e=this.hot.countSourceRows();t<e;t++)for(let e=0;e<a;e++)h[t].splice(o[e],1),0===t&&this.metaManager.removeColumn(o[e],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(n),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,e,n,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(t,e,i){let r=this.hot.getDataAtCol(t),n=r.slice(e,e+i),o=r.slice(e+i);for(var s=arguments.length,l=Array(s>3?s-3:0),h=3;h<s;h++)l[h-3]=arguments[h];(0,a.g9)(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return(0,a.PI)(l),this.hot.populateFromArray(e,t,l,null,null,"spliceCol"),n}spliceRow(t,e,i){let r=this.hot.getSourceDataAtRow(t),n=r.slice(e,e+i),o=r.slice(e+i);for(var s=arguments.length,l=Array(s>3?s-3:0),h=3;h<s;h++)l[h-3]=arguments[h];(0,a.g9)(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return this.hot.populateFromArray(t,e,[l],null,null,"spliceRow"),n}spliceData(t,e,i){let r=this.hot.runHooks("beforeDataSplice",t,e,i);if(!1!==r){let e=[...this.dataSource.slice(0,t),...i,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach(t=>this.dataSource.push(t))}}filterData(t,e,i){let r=this.hot.runHooks("filterData",t,e,i);!1===Array.isArray(r)&&(r=this.dataSource.filter((t,e)=>-1===i.indexOf(e))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(t,e){let i=this.hot.toPhysicalRow(t),r=this.dataSource[i],n=this.hot.runHooks("modifyRowData",i);r=isNaN(n)?n:r;let o=null;if(r&&r.hasOwnProperty&&(0,l.nr)(r,e))o=r[e];else if("string"==typeof e&&e.indexOf(".")>-1){let t=e.split("."),i=r;if(!i)return null;for(let e=0,r=t.length;e<r;e++)if(void 0===(i=i[t[e]]))return null;o=i}else"function"==typeof e&&(o=e(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){let t=(0,l.sm)(o);this.hot.runHooks("modifyData",i,this.propToCol(e),t,"get"),t.isTouched()&&(o=t.value)}return o}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,i){let r=this.hot.toPhysicalRow(t),n=i,o=this.dataSource[r],s=this.hot.runHooks("modifyRowData",r);if(o=isNaN(s)?s:o,this.hot.hasHook("modifyData")){let t=(0,l.sm)(n);this.hot.runHooks("modifyData",r,this.propToCol(e),t,"set"),t.isTouched()&&(n=t.value)}if(o&&o.hasOwnProperty&&(0,l.nr)(o,e))o[e]=n;else if("string"==typeof e&&e.indexOf(".")>-1){let t;let i=e.split("."),r=o,s=0;for(s=0,t=i.length-1;s<t;s++)void 0===r[i[s]]&&(r[i[s]]={}),r=r[i[s]];r[i[s]]=n}else"function"==typeof e?e(this.dataSource.slice(r,r+1)[0],n):o[e]=n}visualRowsToPhysical(t,e){let i=this.hot.countSourceRows(),r=[],n=(i+t)%i,o=e;for(;n<i&&o;)r.push(this.hot.toPhysicalRow(n)),o-=1,n+=1;return r}visualColumnsToPhysical(t,e){let i=this.hot.countCols(),r=[],n=(i+t)%i,o=e;for(;n<i&&o;){let t=this.hot.toPhysicalColumn(n);r.push(t),o-=1,n+=1}return r}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){let t=this.tableMeta.maxRows,e=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t<0||0===t?0:t||1/0)}getAll(){let t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!=0||this.hot.countSourceRows()?this.getRange(t,e,d.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,i){let r,n,o;let s=[],l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];let h=i===d.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,u=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),c=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(r=Math.min(t.row,e.row);r<=u;r++){o=[];let i=r>=0?this.hot.toPhysicalRow(r):r;for(n=Math.min(t.col,e.col);n<=c&&null!==i;n++)o.push(h.call(this,r,this.colToProp(n)));null!==i&&s.push(o)}return s}getText(t,e){return(0,o.P)(this.getRange(t,e,d.DESTINATION_RENDERER))}getCopyableText(t,e){return(0,o.P)(this.getRange(t,e,d.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var g=i(5566),f=i(18200);function p(t,e,i,o){let{hotInstance:s,dataMap:a,dataSource:h,internalSource:u,source:c,metaManager:p,firstRun:m}=o,w=(0,r.ct)(u),b=s.getSettings();Array.isArray(b.dataSchema)?s.dataType="array":(0,n.mf)(b.dataSchema)?s.dataType="function":s.dataType="object",a&&a.destroy(),t=s.runHooks(`before${w}`,t,m,c);let y=new d(s,t,p);if(e(y),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else if(null===t){let e;let i=y.getSchema();t=[];let r=0,n=0;for(r=0,n=b.startRows;r<n;r++)if(("object"===s.dataType||"function"===s.dataType)&&b.dataSchema)e=(0,l.I8)(i),t.push(e);else if("array"===s.dataType)e=(0,l.I8)(i[0]),t.push(e);else{e=[];for(let t=0,i=b.startCols;t<i;t++)e.push(null);t.push(e)}}else throw Error(`${u} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(s.dataType="array"),b.data=t,y.dataSource=t,h.data=t,h.dataType=s.dataType,h.colToProp=y.colToProp.bind(y),h.propToCol=y.propToCol.bind(y),h.countCachedColumns=y.countCachedColumns.bind(y),i(y),s.runHooks(`after${w}`,t,m,c),m||(s.runHooks("afterChange",null,u),s.render()),s.getSettings().ariaTags&&(0,g.P$)(s.rootElement,[(0,f.a2)(-1),(0,f.Wv)(s.countCols()+(s.view?s.countRowHeaders():0))])}},24692:function(t,e,i){"use strict";i.d(e,{H:function(){return c}}),i(57855);var r=i(66678),n=i(27687),o=i(57416),s=i(49773),l=i(2518);function a(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function h(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function u(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let c="editorManager.navigation";var d=new WeakSet,g=new WeakSet;class f{constructor(t,e,i){a(this,g),a(this,d),h(this,"hot",void 0),h(this,"tableMeta",void 0),h(this,"selection",void 0),h(this,"eventManager",void 0),h(this,"destroyed",!1),h(this,"lock",!1),h(this,"activeEditor",void 0),h(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=i,this.eventManager=new s.Z(t),this.hot.addHook("afterDocumentKeyDown",t=>u(this,d,p).call(this,t)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",t=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",t)}),this.hot.view._wt.update("onCellDblClick",(t,e,i)=>u(this,g,m).call(this,t,e,i))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(t){this.lock||this.closeEditor(t)}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,t=>{t&&this.prepareEditor()});return}let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;let{row:i,col:r}=e,n=this.hot.runHooks("modifyGetCellCoords",i,r),s=i,l=r;if(Array.isArray(n)&&([s,l]=n),this.cellProperties=this.hot.getCellMeta(s,l),!this.isCellEditable()){this.clearActiveEditor();return}let a=this.hot.getCell(i,r,!0);if(a){let t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(l),n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),l);this.activeEditor=(0,o.Jq)(t,this.hot),this.activeEditor.prepare(i,r,e,a,n,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}closeEditor(t,e,i){this.activeEditor?this.activeEditor.finishEditing(t,e,i):i&&i(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let t=this.hot.getSelectedRangeLast();if(!t)return!1;let e=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=t.highlight,{rowIndexMapper:n,columnIndexMapper:o}=this.hot,s=n.isHidden(this.hot.toPhysicalRow(i))||o.isHidden(this.hot.toPhysicalColumn(r));return!this.cellProperties.readOnly&&!!e&&!s}moveSelectionAfterEnter(t){let e="function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;t?this.selection.transformStart(-e.row,-e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function p(t){let e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||(0,n.Ty)(t))return;let{keyCode:i}=t,o=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!(0,r.DC)(i)&&!(0,r.T2)(i)&&!o&&!this.isEditorOpened()){let e=this.hot.getShortcutManager(),i=e.getContext("editor");i.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],{runOnlyIf:()=>(0,l.$K)(this.hot.getSelected()),group:c}),this.openEditor("",t)}}function m(t,e,i){"TD"===i.nodeName&&this.openEditor(null,t,!0)}let w=new WeakMap;f.getInstance=function(t,e,i){let r=w.get(t);return r||(r=new f(t,e,i),w.set(t,r)),r},e.Z=f},98422:function(t,e,i){"use strict";i.d(e,{Hf:function(){return d},ed:function(){return u},PP:function(){return c}}),i(57855);var r=i(2518),n=i(69488),o=i(24692);i(58563);var s=i(99440);let l={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){(0,s.Bk)(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){(0,n._l)(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};(0,n.jW)(l,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var a=i(5566);function h(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let u=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),c="baseEditor";class d{static get EDITOR_TYPE(){return"base"}constructor(t){h(this,"hot",void 0),h(this,"state",u.VIRGIN),h(this,"_opened",!1),h(this,"_fullEditMode",!1),h(this,"_closeCallback",null),h(this,"TD",null),h(this,"row",null),h(this,"col",null),h(this,"prop",null),h(this,"originalValue",null),h(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,i,r,n,o){this.TD=r,this.row=t,this.col=e,this.prop=i,this.originalValue=n,this.cellProperties=o,this.state=u.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let i,n,o,s;if(e){let t=this.hot.getSelectedLast();i=Math.max(Math.min(t[0],t[2]),0),n=Math.max(Math.min(t[1],t[3]),0),o=Math.max(t[0],t[2]),s=Math.max(t[1],t[3])}else[i,n,o,s]=[this.row,this.col,null,null];let l=this.hot.runHooks("modifyGetCellCoords",i,n);Array.isArray(l)&&([i,n]=l);let a=this.hot.getShortcutManager(),h=a.getContext("editor");this.isInFullEditMode()&&h.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],{runOnlyIf:()=>(0,r.$K)(this.hot.getSelected()),group:c}),this.hot.populateFromArray(i,n,t,o,s,"edit")}beginEditing(t,e){if(this.state!==u.VIRGIN)return;let i=this.hot,n=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(i.view.scrollViewport(i._createCellCoords(n,o)),this.state=u.EDITING,this.isInFullEditMode()){let e="string"==typeof t?t:(0,r.Pz)(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(t,e,i){let r;if(i){let t=this._closeCallback;this._closeCallback=e=>{t&&t(e),i(e),this.hot.view.render()}}if(this.isWaiting())return;let n=this.hot.getShortcutManager(),s=n.getContext("editor");if(s.removeShortcutsByGroup(c),s.removeShortcutsByGroup(o.H),this.state===u.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===u.EDITING){if(t){this.cancelChanges(),this.hot.view.render();return}let i=this.getValue();r=this.cellProperties.trimWhitespace?[["string"==typeof i?String.prototype.trim.call(i||""):i]]:[[i]],this.state=u.WAITING,this.saveValue(r,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",t=>{this.state=u.FINISHED,this.discardEditor(t)}):(this.state=u.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=u.FINISHED,this.discardEditor()}discardEditor(t){if(this.state===u.FINISHED){if(!1===t&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=u.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=u.VIRGIN,this._fireCallbacks(!0);let t=this.hot.getShortcutManager();t.setActiveContextName("grid")}}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===u.WAITING}getEditedCellRect(){var t;let e=this.getEditedCell();if(!e)return;let{wtOverlays:i,wtViewport:r}=this.hot.view._wt,n=this.hot.rootWindow,o=(0,a.cv)(e),s=(0,a.iO)(e),l=(0,a.cv)(this.hot.rootElement),h=(0,a.iO)(this.hot.rootElement),u=i.topOverlay.holder,c=i.inlineStartOverlay.holder,d=u!==n?u.scrollTop:0,g=c!==n?c.scrollLeft:0,f=n.innerWidth-l.left-h,{wtTable:p}=null!==(t=i.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,m=p.name,w=["master","inline_start"].includes(m)?d:0,b=["master","top","bottom"].includes(m)?g:0,y=o.top===l.top?0:1,C=o.top-l.top-y-w,S=0;S=this.hot.isRtl()?n.innerWidth-o.left-s-f-1+b:o.left-l.left-1-b,["top","top_inline_start_corner"].includes(m)&&(C+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(S+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));let E=this.hot.hasColHeaders(),R=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),T=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),M=this.hot.rowIndexMapper.getRenderableIndexesLength(),O=M-this.hot.view._wt.getSetting("fixedRowsBottom");(E&&R<=0||R===O)&&(C+=1),T<=0&&(S+=1);let k=r.rowsRenderCalculator.startPosition,x=r.columnsRenderCalculator.startPosition,I=Math.abs(i.inlineStartOverlay.getScrollPosition()),A=i.topOverlay.getScrollPosition(),N=(0,a.np)(this.hot.rootDocument),H=e.offsetTop;if(["inline_start","master"].includes(m)&&(H+=k-A),["bottom","bottom_inline_start_corner"].includes(m)){let{wtViewport:t,wtTable:e}=i.bottomOverlay.clone;H+=t.getWorkspaceHeight()-e.getHeight()-N}let _=e.offsetLeft;this.hot.isRtl()?_=(_>=0?p.getWidth()-e.offsetLeft:Math.abs(_))+(x-I-s):["top","master","bottom"].includes(m)&&(_+=x-I);let P=(0,a.Dx)(this.TD,this.hot.rootWindow),D=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",L=parseInt(P[D],10)>0?0:1,B=parseInt(P.borderTopWidth,10)>0?0:1,W=(0,a.iO)(e)+L,V=(0,a.Pb)(e)+B,F=(0,a.do)(u)?N:0,j=(0,a.vw)(c)?N:0,U=this.hot.view.maximumVisibleElementWidth(_)-F+L,$=Math.max(this.hot.view.maximumVisibleElementHeight(H)-j+B,23);return{top:C,start:S,height:V,maxHeight:$,width:W,maxWidth:U}}getEditedCellsLayerClass(){let t=this.checkEditorSection();switch(t){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}(0,n.jB)(d,l)},57416:function(t,e,i){"use strict";i.d(e,{Jq:function(){return d},Wu:function(){return a},qm:function(){return f},y$:function(){return g}}),i(57855);var r=i(54317),n=i(82656);let o=new WeakMap,{register:s,getItem:l,hasItem:a,getNames:h,getValues:u}=(0,n.Z)("editors");function c(t){let e={};this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new t(i)),e[i.guid]},r.Z.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function d(t,e){let i;if("function"==typeof t)o.get(t)||f(null,t),i=o.get(t);else if("string"==typeof t)i=l(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!i)throw Error(`No editor registered under name "${t}"`);return i.getInstance(e)}function g(t){if("function"==typeof t)return t;if(!a(t))throw Error(`No registered editor found under "${t}" name`);return l(t).getConstructor()}function f(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);let i=new c(e);"string"==typeof t&&s(t,i),o.set(e,i)}},2694:function(t,e,i){"use strict";i.d(e,{H:function(){return b}}),i(57855);var r=i(98422),n=i(49773),o=i(2228),s=i(5566),l=i(67790);function a(t,e,i){t.addEventListener(e,i,!1)}function h(t,e,i){t.removeEventListener(e,i,!1)}function u(t){return t.ownerDocument.defaultView.getComputedStyle(t)}var c=i(2518),d=i(24692);function g(t,e){let i=(0,s.qK)(e),r=e.value.split("\n"),n=i,o=0;for(let e=0;e<r.length;e++){let s=r[e];0!==e&&(o+=r[e-1].length+1);let l=o+s.length;if("home"===t?n=o:"end"===t&&(n=l),i<=l)break}(0,s.Mq)(e,n)}var f=i(18200);function p(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let m="ht_editor_hidden",w="textEditor";class b extends r.Hf{static get EDITOR_TYPE(){return"text"}constructor(t){super(t),p(this,"eventManager",new n.Z(this)),p(this,"autoResize",function(t){let e;let i={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=t.body,n=t.createTextNode(""),o=t.createElement("span");function s(){n.textContent=e.value,o.style.position="absolute",o.style.fontSize=u(e).fontSize,o.style.fontFamily=u(e).fontFamily,o.style.whiteSpace="pre",r.appendChild(o);let t=o.clientWidth+2;r.removeChild(o);let s=e.style;s.height=`${i.minHeight}px`,i.minWidth>t?s.width=`${i.minWidth}px`:t>i.maxWidth?s.width=`${i.maxWidth}px`:s.width=`${t}px`;let l=e.scrollHeight?e.scrollHeight-1:0;i.minHeight>l?s.height=`${i.minHeight}px`:i.maxHeight<l?(s.height=`${i.maxHeight}px`,s.overflowY="visible"):s.height=`${l}px`}function l(){t.defaultView.setTimeout(s,0)}return{init:function(t,r){let h=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=t,function(t){if(t&&t.minHeight){if("inherit"===t.minHeight)i.minHeight=e.clientHeight;else{let e=parseInt(t.minHeight,10);isNaN(e)||(i.minHeight=e)}}if(t&&t.maxHeight){if("inherit"===t.maxHeight)i.maxHeight=e.clientHeight;else{let e=parseInt(t.maxHeight,10);isNaN(e)||(i.maxHeight=e)}}if(t&&t.minWidth){if("inherit"===t.minWidth)i.minWidth=e.clientWidth;else{let e=parseInt(t.minWidth,10);isNaN(e)||(i.minWidth=e)}}if(t&&t.maxWidth){if("inherit"===t.maxWidth)i.maxWidth=e.clientWidth;else{let e=parseInt(t.maxWidth,10);isNaN(e)||(i.maxWidth=e)}}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(n))}(r),"TEXTAREA"===e.nodeName&&(e.style.resize="none",e.style.overflowY="",e.style.height=`${i.minHeight}px`,e.style.minWidth=`${i.minWidth}px`,e.style.maxWidth=`${i.maxWidth}px`,e.style.overflowY="hidden"),h&&(a(e,"input",s),a(e,"keydown",l)),s()},resize:s,unObserve(){h(e,"input",s),h(e,"keydown",l)}}}(this.hot.rootDocument)),p(this,"TEXTAREA",void 0),p(this,"textareaStyle",void 0),p(this,"TEXTAREA_PARENT",void 0),p(this,"textareaParentStyle",void 0),p(this,"layerClass",void 0),this.eventManager=new n.Z(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),(0,s.yv)(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,i,n,o,s){let l=this.state;if(super.prepare(t,e,i,n,o,s),!s.readOnly){this.refreshDimensions(!0);let{allowInvalid:t}=s;t&&(this.TEXTAREA.value=""),l!==r.ed.FINISHED&&this.hideEditableElement()}}beginEditing(t,e){this.state===r.ed.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),(0,s.Mq)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),(0,s.P$)(this.TEXTAREA,[["data-hot-input",""],(0,f.Qk)(-1)]),this.hot.getSettings().ariaTags&&(0,s.P$)(this.TEXTAREA,[(0,f.cV)()]),(0,s.cn)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),(0,s.cn)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,s.pv)(this.TEXTAREA_PARENT,this.layerClass)&&(0,s.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,s.cn)(this.TEXTAREA_PARENT,m),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,o.un)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,s.IV)(this.TEXTAREA_PARENT,this.layerClass),(0,s.cn)(this.TEXTAREA_PARENT,m)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";let t=this.TEXTAREA_PARENT.childNodes,e=!1;(0,l.q4)(t.length-1,i=>{let r=t[i];if((0,s.pv)(r,"handsontableEditor"))return e=!0,!1}),(0,s.pv)(this.TEXTAREA_PARENT,m)&&(0,s.IV)(this.TEXTAREA_PARENT,m),e?this.layerClass="ht_editor_visible":this.layerClass=this.getEditedCellsLayerClass(),(0,s.cn)(this.TEXTAREA_PARENT,this.layerClass)}refreshValue(){let t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==r.ed.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD){t||this.close();return}let{top:e,start:i,width:n,maxWidth:o,height:l,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();let h=(0,s.Dx)(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;let u=(0,s.Dx)(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),d=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),g=o-c,f=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(n-c,g),minHeight:Math.min(l-d,f),maxWidth:g,maxHeight:f},!0)}bindEvents(){(0,o.gn)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===r.ed.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===r.ed.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor"),i=t.getContext("grid"),r=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:i,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[i]=e;g(i,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[i]=e;g(i,this.TEXTAREA)}}],{runOnlyIf:()=>(0,c.$K)(this.hot.getSelected()),group:w})}unregisterShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(d.H),e.removeShortcutsByGroup(w),e.removeShortcutsByGroup(r.PP)}}},49773:function(t,e,i){"use strict";i(58563),i(57855);var r=i(27687);let n=0;e.Z=class{constructor(){var t,e,i;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=void 0,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="context","string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,this.context=r||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,i){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function s(t){i.call(this,function(t){let e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),(0,r.mM)(this)},t}(t))}return this.context.eventListeners.push({element:t,event:e,callback:i,callbackProxy:s,options:o,eventManager:this}),t.addEventListener(e,s,o),n+=1,()=>{this.removeEventListener(t,e,i)}}removeEventListener(t,e,i){let r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.context.eventListeners.length;for(;s;)if(s-=1,(r=this.context.eventListeners[s]).event===e&&r.element===t){if(i&&i!==r.callback||o&&r.eventManager!==this)continue;this.context.eventListeners.splice(s,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),n-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;for(;e;){e-=1;let i=this.context.eventListeners[e];t&&i.eventManager!==this||(this.context.eventListeners.splice(e,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),n-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let i,r=t.document,n=t;r||(n=(r=t.ownerDocument?t.ownerDocument:t).defaultView);let o={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};r.createEvent?(i=r.createEvent("MouseEvents")).initMouseEvent(e,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||r.body.parentNode):i=r.createEventObject(),t.dispatchEvent?t.dispatchEvent(i):t.fireEvent(`on${e}`,i)}}},18407:function(t,e,i){"use strict";i.d(e,{I:function(){return R}}),i(57855);var r=i(24748),n=i(5566),o=i(98179);function s(t,e){a(t,e),e.add(t)}function l(t,e,i){a(t,e),e.set(t,i)}function a(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function h(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function u(t,e){var i=d(t,e,"get");return i.get?i.get.call(t):i.value}function c(t,e,i){var r=d(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function d(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}let g=Object.freeze({CELL:"cell",MIXED:"mixed"});var f=new WeakMap,p=new WeakMap,m=new WeakMap,w=new WeakMap,b=new WeakMap,y=new WeakSet,C=new WeakSet,S=new WeakSet,E=new WeakSet;class R{constructor(t){var e=this;s(this,E),s(this,S),s(this,C),s(this,y),l(this,f,{writable:!0,value:void 0}),l(this,p,{writable:!0,value:void 0}),l(this,m,{writable:!0,value:50}),l(this,w,{writable:!0,value:null}),l(this,b,{writable:!0,value:new Map});let i=t.getSettings();c(this,f,t),c(this,p,i.imeFastEdit?g.MIXED:g.CELL),u(this,f).addHook("afterUpdateSettings",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h(e,E,k).call(e,...i)}),u(this,f).addHook("afterSelection",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h(e,C,M).call(e,...i)}),u(this,f).addHook("afterSelectionEnd",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h(e,S,O).call(e,...i)})}getFocusMode(){return u(this,p)}setFocusMode(t){Object.values(g).includes(t)?c(this,p,t):(0,r.ZK)(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return u(this,m)}setRefocusDelay(t){c(this,m,t)}setRefocusElementGetter(t){c(this,w,t)}getRefocusElement(){var t;return"function"==typeof u(this,w)?u(this,w).call(this):null===(t=u(this,f).getActiveEditor())||void 0===t?void 0:t.TEXTAREA}focusOnHighlightedCell(t){let e=t=>{var e,i;let r=null===(e=u(this,f).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!r)return;let n=u(this,f).runHooks("modifyFocusedElement",r.row,r.col,t);n instanceof HTMLElement||(n=t),n&&!(null!==(i=u(this,f).getActiveEditor())&&void 0!==i&&i.isOpened())&&n.focus({preventScroll:!0})};t?e(t):h(this,y,T).call(this,t=>e(t))}refocusToEditorTextarea(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u(this,m),i=this.getRefocusElement();u(this,f).getSettings().imeFastEdit&&!(null!==(t=u(this,f).getActiveEditor())&&void 0!==t&&t.isOpened())&&i&&(u(this,b).has(e)||u(this,b).set(e,(0,o.Ds)(()=>{i.select()},e)),u(this,b).get(e)())}}function T(t){var e;let i=null===(e=u(this,f).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!i||!u(this,f).selection.isCellVisible(i)){t(null);return}let r=u(this,f).getCell(i.row,i.col,!0);null===r?u(this,f).addHookOnce("afterScroll",()=>{t(u(this,f).getCell(i.row,i.col,!0))}):t(r)}function M(){h(this,y,T).call(this,t=>{let{activeElement:e}=u(this,f).rootDocument;e&&(0,n.pV)(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function O(){h(this,y,T).call(this,t=>{this.getFocusMode()===g.MIXED&&"TD"===t.nodeName&&this.refocusToEditorTextarea()})}function k(t){t.imeFastEdit&&this.getFocusMode()!==g.MIXED?this.setFocusMode(g.MIXED):t.imeFastEdit||this.getFocusMode()===g.CELL||this.setFocusMode(g.CELL)}},18200:function(t,e,i){"use strict";i.d(e,{Ak:function(){return P},Ct:function(){return a},DT:function(){return F},Ez:function(){return W},JV:function(){return I},LO:function(){return g},Ng:function(){return h},Nl:function(){return p},Nr:function(){return y},Pn:function(){return _},Pp:function(){return b},QK:function(){return C},Qk:function(){return r},Qz:function(){return s},Rn:function(){return o},Up:function(){return V},Wv:function(){return O},a2:function(){return M},a6:function(){return f},cV:function(){return S},d:function(){return L},d5:function(){return k},f3:function(){return u},fv:function(){return T},gw:function(){return E},iJ:function(){return w},iL:function(){return l},jH:function(){return j},l_:function(){return A},nO:function(){return n},nT:function(){return B},qt:function(){return R},rQ:function(){return d},tm:function(){return c},w1:function(){return H},wt:function(){return m},yz:function(){return x},zR:function(){return N},zV:function(){return D}});let r=t=>["tabindex",t],n=()=>["role","treegrid"],o=()=>["role","presentation"],s=()=>["role","gridcell"],l=()=>["role","rowheader"],a=()=>["role","rowgroup"],h=()=>["role","columnheader"],u=()=>["role","row"],c=()=>["role","menu"],d=()=>["role","menuitem"],g=()=>["role","combobox"],f=()=>["role","listbox"],p=()=>["role","option"],m=()=>["role","checkbox"],w=()=>["scope","col"],b=()=>["scope","row"],y=()=>["type","text"],C=t=>["aria-label",t],S=()=>["aria-hidden","true"],E=()=>["aria-disabled","true"],R=()=>["aria-multiselectable","true"],T=t=>["aria-haspopup",t],M=t=>["aria-rowcount",t],O=t=>["aria-colcount",t],k=t=>["aria-rowindex",t],x=t=>["aria-colindex",t],I=t=>["aria-expanded",t],A=t=>["aria-sort",t],N=()=>["aria-readonly","true"],H=()=>["aria-invalid","true"],_=t=>["aria-checked",t],P=()=>["aria-selected","true"],D=()=>["aria-autocomplete","list"],L=t=>["aria-controls",t],B=t=>["aria-activedescendant",t],W=t=>["aria-live",t],V=t=>["aria-relevant",t],F=t=>["aria-setsize",t],j=t=>["aria-posinset",t]},99440:function(t,e,i){"use strict";function r(t){let e=t.length,i=0;for(;i<e;)t[i]=[t[i]],i+=1}function n(t,e){let i=e.length,r=0;for(;r<i;)t.push(e[r]),r+=1}function o(t){let e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;let i=t.length,r=t[0].length;for(let n=0;n<i;n++)for(let i=0;i<r;i++)e[i]||(e[i]=[]),e[i][n]=t[n][i];return e}function s(t,e,i,r){let n=-1,o=t,s=i;Array.isArray(t)||(o=Array.from(t));let l=o.length;for(r&&l&&(n+=1,s=o[n]),n+=1;n<l;)s=e(s,o[n],n,o),n+=1;return s}function l(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length,o=[],s=-1;for(;i<n;){let t=r[i];e(t,i,r)&&(o[s+=1]=t),i+=1}return o}function a(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length,o=[],s=-1;for(;i<n;){let t=r[i];o[s+=1]=e(t,i,r),i+=1}return o}function h(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length;for(;i<n&&!1!==e(r[i],i,r);)i+=1;return t}function u(t){let e=[];return h(t,t=>{-1===e.indexOf(t)&&e.push(t)}),e}function c(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let[r,...n]=[...e],o=r;return h(n,t=>{o=o.filter(e=>!t.includes(e))}),o}function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}i.d(e,{Bk:function(){return h},PI:function(){return r},Sc:function(){return a},W7:function(){return d},g9:function(){return n},jz:function(){return o},k$:function(){return s},o0:function(){return c},uW:function(){return u},w7:function(){return l}}),i(58563)},2228:function(t,e,i){"use strict";i.d(e,{E6:function(){return h},G6:function(){return d},K1:function(){return f},L:function(){return m},eE:function(){return b},gn:function(){return p},i7:function(){return a},iF:function(){return c},uM:function(){return w},un:function(){return g},vU:function(){return u}});var r=i(69488),n=i(60973);let o=t=>{let e={value:!1};return e.test=(i,r)=>{e.value=t(i,r)},e},s={chrome:o((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:o(t=>/CriOS/.test(t)),edge:o(t=>/Edge/.test(t)),edgeWebKit:o(t=>/EdgiOS/.test(t)),firefox:o(t=>/Firefox/.test(t)),firefoxWebKit:o(t=>/FxiOS/.test(t)),mobile:o(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:o((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},l={mac:o(t=>/^Mac/.test(t)),win:o(t=>/^Win/.test(t)),linux:o(t=>/^Linux/.test(t)),ios:o(t=>/iPhone|iPad|iPod/i.test(t))};function a(){return s.chrome.value}function h(){return s.chromeWebKit.value}function u(){return s.firefox.value}function c(){return s.firefoxWebKit.value}function d(){return s.safari.value}function g(){return s.edge.value}function f(){return s.mobile.value}function p(){return l.ios.value}function m(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&l.mac.value}function w(){return l.win.value}function b(){return l.mac.value}(0,n.o6)()&&(!function(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r._l)(s,i=>{let{test:r}=i;r(t,e)})}(),function(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r._l)(l,e=>{let{test:i}=e;i(t)})}())},24748:function(t,e,i){"use strict";i.d(e,{ZK:function(){return n},vU:function(){return o}});var r=i(2518);function n(){(0,r.$K)(console)&&console.warn(...arguments)}function o(){(0,r.$K)(console)&&console.error(...arguments)}},77628:function(t,e,i){"use strict";i.d(e,{Eb:function(){return s},Jr:function(){return l},Pj:function(){return a},Yl:function(){return n},ec:function(){return o}}),i(58563);var r=i(69488);function n(t){let e,i=t+1,r="";for(;i>0;)r=String.fromCharCode(65+(e=(i-1)%26))+r,i=parseInt((i-e)/26,10);return r}function o(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t,r=[];return Array.isArray(t)&&Array.isArray(t[0])||(i=[t]),i.forEach((t,i)=>{Array.isArray(t)?t.forEach((t,n)=>{r.push([i+e,n,t])}):Object.keys(t).forEach(n=>{r.push([i+e,n,t[n]])})}),r}function s(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&(0,r.Kn)(t[0])&&(e=(0,r.Q8)(t[0]))),e}function l(t){return!!(Array.isArray(t)&&t.length&&t.every(t=>Array.isArray(t)))}function a(t){return!!(Array.isArray(t)&&t.length&&t.every(t=>"object"==typeof t&&!Array.isArray(t)&&null!==t))}},5566:function(t,e,i){"use strict";let r;i.d(e,{$g:function(){return N},AQ:function(){return O},C2:function(){return H},DZ:function(){return k},Dx:function(){return _},G_:function(){return s},I2:function(){return K},IV:function(){return b},Kz:function(){return d},MO:function(){return c},Mq:function(){return j},P$:function(){return y},Pb:function(){return D},TT:function(){return Z},W6:function(){return u},WH:function(){return G},WS:function(){return L},Wu:function(){return function t(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){let i=e.childNodes;for(let e=i.length-1;e>=0;e--)t(i[e])}}},a7:function(){return F},cS:function(){return S},cn:function(){return w},cv:function(){return M},cx:function(){return x},d$:function(){return C},dD:function(){return A},do:function(){return $},f5:function(){return a},iO:function(){return P},kg:function(){return V},l2:function(){return J},lq:function(){return tt},mK:function(){return g},np:function(){return U},oq:function(){return h},pV:function(){return X},pn:function(){return function t(e){let i=e.ownerDocument.documentElement,r=e;for(;r!==i;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(!r.host)return!1;if(r.host.impl)return t(r.host.impl);if(r.host)return t(r.host);throw Error("Lost in Web Components world")}if("none"===_(r).display)return!1;r=r.parentNode}return!0}},pv:function(){return m},qK:function(){return W},tT:function(){return T},u7:function(){return Y},uS:function(){return R},vj:function(){return I},vw:function(){return z},x9:function(){return B},yY:function(){return Q},yv:function(){return l},z4:function(){return q}}),i(58563),i(57855);var n=i(66411),o=i(18200);function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=-1,r=null,n=t;for(;null!==n;){if(i===e){r=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(i+=1,n=n.parentNode)}return r}function l(t,e){let i=t.closest(".handsontable");return!!i&&(i.parentNode===e||i===e)}function a(t){return Object.getPrototypeOf(t.parent)&&t.frameElement&&t.parent}function h(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:n}=Node,o=t;for(;null!=o&&o!==i;){let{nodeType:t,nodeName:i}=o;if(t===r&&(e.includes(i)||e.includes(o)))return o;let{host:s}=o;o=s&&t===n?s:o.parentNode}return null}function u(t,e,i){let r=[],n=t;for(;n&&(n=h(n,e,i))&&(!i||i.contains(n));)r.push(n),n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode;let o=r.length;return o?r[o-1]:null}function c(t,e){let i=t.parentNode,r=[];for("string"==typeof e?r=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);null!==i;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function d(t){let e=0,i=t;if(i.previousSibling)for(;i=i.previousSibling;)e+=1;return e}function g(t,e,i){let r=i.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function f(t){return t&&t.length?t.filter(t=>!!t):[]}function p(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];let i=[],r=[];return r.push(...t.filter(t=>{let r=t instanceof RegExp;return r&&e&&i.push(t),!r})),e?{regexFree:r,regexes:i}:r}function m(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)}function w(t,e){"string"==typeof e&&(e=e.split(" ")),(e=f(e)).length>0&&t.classList.add(...e)}function b(t,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:i,regexes:r}=p(e,!0);(i=f(i)).length>0&&t.classList.remove(...i),r.forEach(e=>{t.classList.forEach(i=>{e.test(i)&&t.classList.remove(i)})})}function y(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,i]]),e.forEach(e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)})}function C(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:i,regexes:r}=p(e,!0);i.forEach(e=>{""!==e&&t.removeAttribute(e)}),r.forEach(e=>{t.getAttributeNames().forEach(i=>{e.test(i)&&t.removeAttribute(i)})})}function S(t){let e;for(;e=t.lastChild;)t.removeChild(e)}let E=/(<(.*)>|&(.*);)/;function R(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];E.test(e)?t.innerHTML=i?(0,n.Nw)(e):e:T(t,e)}function T(t,e){let i=t.firstChild;i&&3===i.nodeType&&null===i.nextSibling?i.textContent=e:(S(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function M(t){let e,i,r;let n=t.ownerDocument,o=n.defaultView,s=n.documentElement,l=t;for(e=l.offsetLeft,i=l.offsetTop,r=l;(l=l.offsetParent)&&l!==n.body&&("offsetLeft"in l);)e+=l.offsetLeft,i+=l.offsetTop,r=l;return r&&"fixed"===r.style.position&&(e+=o.pageXOffset||s.scrollLeft,i+=o.pageYOffset||s.scrollTop),{left:e,top:i}}function O(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollY}function k(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollX}function x(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?O(e):t.scrollTop}function I(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?k(e):t.scrollLeft}function A(t){let e=t.ownerDocument,i=e?e.defaultView:void 0;e||(i=(e=t.document?t.document:t).defaultView);let r=["auto","scroll"],n=t.parentNode;for(;n&&n.style&&e.body!==n;){let{overflow:t,overflowX:e,overflowY:o}=n.style;if([t,e,o].includes("scroll")||({overflow:t,overflowX:e,overflowY:o}=i.getComputedStyle(n),r.includes(t)||r.includes(e)||r.includes(o))||n.clientHeight<=n.scrollHeight+1&&(r.includes(o)||r.includes(t))||n.clientWidth<=n.scrollWidth+1&&(r.includes(e)||r.includes(t)))return n;n=n.parentNode}return i}function N(t){let e=t.ownerDocument,i=e.defaultView,r=t.parentNode;for(;r&&r.style&&e.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;let t=_(r,i),e=["scroll","hidden","auto"],n=t.getPropertyValue("overflow"),o=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(n)||e.includes(o)||e.includes(s))return r;r=r.parentNode}return i}function H(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===i)return"width"===e?`${i.innerWidth}px`:"height"===e?`${i.innerHeight}px`:void 0;let r=t.style[e];if(""!==r&&void 0!==r)return r;let n=_(t,i);if(""!==n[e]&&void 0!==n[e])return n[e]}function _(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function P(t){return t.offsetWidth}function D(t){return t.offsetHeight}function L(t){return t.clientHeight||t.innerHeight}function B(t){return t.clientWidth||t.innerWidth}function W(t){return t.selectionStart?t.selectionStart:0}function V(t){return t.selectionEnd?t.selectionEnd:0}function F(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function j(t,e,i){if(void 0===i&&(i=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,i)}catch(o){let r=t.parentNode,n=r.style.display;r.style.display="block",t.setSelectionRange(e,i),r.style.display=n}}}function U(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===r&&(r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";let i=t.createElement("div");i.style.boxSizing="content-box",i.style.height="150px",i.style.left="0px",i.style.overflow="hidden",i.style.position="absolute",i.style.top="0px",i.style.width="200px",i.style.visibility="hidden",i.appendChild(e),(t.body||t.documentElement).appendChild(i);let r=e.offsetWidth;i.style.overflow="scroll";let n=e.offsetWidth;return r===n&&(n=i.clientWidth),(t.body||t.documentElement).removeChild(i),r-n}(t)),r}function $(t){return t.offsetWidth!==t.clientWidth}function z(t){return t.offsetHeight!==t.clientHeight}function K(t,e,i){t.style.transform=`translate3d(${e},${i},0)`}function G(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function Y(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function X(t){return Y(t)&&!1===t.hasAttribute("data-hot-input")}function q(t){return!t.parentNode}function Z(t,e){let i=new IntersectionObserver((i,r)=>{i.forEach(i=>{i.isIntersecting&&null!==t.offsetParent&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body});i.observe(t)}function J(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.ownerDocument,n=r.createRange(),s=r.defaultView.getSelection();y(t,"contenteditable",!0),i&&y(t,...(0,o.cV)()),e&&w(t,"invisibleSelection"),n.selectNodeContents(t),s.removeAllRanges(),s.addRange(n)}function Q(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),i.removeAllRanges(),e&&b(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function tt(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];J(t,i),e(),Q(t,i)}},27687:function(t,e,i){"use strict";function r(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function n(t){return!1===t.isImmediatePropagationEnabled}function o(t){return 2===t.button}function s(t){return 0===t.button}function l(t,e){let i={x:t.offsetX,y:t.offsetY},r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return i;for(;r!==e;)i.x+=r.offsetLeft,i.y+=r.offsetTop,r=r.offsetParent;return i}i.d(e,{Ty:function(){return n},Zb:function(){return l},dO:function(){return o},mM:function(){return r},pW:function(){return s}})},60973:function(t,e,i){"use strict";let r;function n(t){return window.requestAnimationFrame(t)}function o(t){window.cancelAnimationFrame(t)}function s(){return"ontouchstart"in window}function l(){return"undefined"!=typeof window}function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r||(r="object"==typeof Intl?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1)}i.d(e,{JS:function(){return s},U7:function(){return n},Wx:function(){return o},o6:function(){return l},sx:function(){return a}})},98179:function(t,e,i){"use strict";i.d(e,{$Z:function(){return a},Ds:function(){return o},WA:function(){return l},mf:function(){return n},r$:function(){return s}});var r=i(2518);function n(t){return"function"==typeof t}function o(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(()=>{e=t.apply(this,o)},i),e}}function s(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.apply(this,i.concat(r))}}function l(t){let e=t.length;return function i(r){return function(){for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];let l=r.concat(o);return l.length>=e?t.apply(this,l):i(l)}}([])}function a(t,e,i,n,o,s,l,a){return(0,r.$K)(a)?t.call(e,i,n,o,s,l,a):(0,r.$K)(l)?t.call(e,i,n,o,s,l):(0,r.$K)(s)?t.call(e,i,n,o,s):(0,r.$K)(o)?t.call(e,i,n,o):(0,r.$K)(n)?t.call(e,i,n):(0,r.$K)(i)?t.call(e,i):t.call(e)}},2518:function(t,e,i){"use strict";i.d(e,{$K:function(){return s},Kj:function(){return h},Pz:function(){return o},ge:function(){return S},o8:function(){return l},xb:function(){return a}});var r=i(62067),n=i(32836);function o(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function s(t){return void 0!==t}function l(t){return void 0===t}function a(t){return null===t||""===t||l(t)}function h(t){return"[object RegExp]"===Object.prototype.toString.call(t)}let u="length",c=t=>parseInt(t,16),d=t=>parseInt(t,10),g=(t,e,i)=>t.substr(e,i),f=t=>t.codePointAt(0)-65,p=t=>`${t}`.replace(/\-/g,""),m=t=>c(g(p(t),c("12"),f("F")))/(c(g(p(t),f("B"),~~![][u]))||9),w=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),b=!1,y={invalid:()=>n.e`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:i}=t;return n.e`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${i}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>n.e`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},C={invalid:()=>n.e`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:i}=t;return n.e`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${i}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>n.e`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function S(t,e){let i;let n=!a(t),o="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),s="14.1.0",l="invalid",h="invalid";t=p(t||"");let S=function(t){let e=[][u],i=e;if(t[u]!==f("Z"))return!1;for(let e="",r="B<H4P+".split(""),n=f(r.shift());n;n=f(r.shift()||"A"))--n<""[u]?i|=(d(`${d(c(e)+(c(g(t,Math.abs(n),2))+[]).padStart(2,"0"))}`)%97||2)>>1:e=g(t,n,n?1===r[u]?9:8:6);return i===e}(t);if(n||o||S){if(S){let e=r("16/01/2024","DD/MM/YYYY"),n=Math.floor(e.toDate().getTime()/864e5),o=m(t);i=r((o+1)*864e5,"x").format("MMMM DD, YYYY"),n>o?(l="expired",h="expired"):(l="valid",h="valid")}else o?(l="non_commercial",h="valid"):(l="invalid",h="invalid")}else l="missing",h="missing";if(w()&&(l="valid",h="valid"),!b&&"valid"!==l){let t=y[l]({keyValidityDate:i,hotVersion:s});t&&console["non_commercial"===l?"info":"warn"](y[l]({keyValidityDate:i,hotVersion:s})),b=!0}if("valid"!==h&&e.parentNode){let t=C[h]({keyValidityDate:i,hotVersion:s});if(t){let t=document.createElement("div");t.className="hot-display-license-info",t.innerHTML=C[h]({keyValidityDate:i,hotVersion:s}),e.parentNode.insertBefore(t,e.nextSibling)}}}},67790:function(t,e,i){"use strict";function r(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=typeof t;if("number"===i)return!isNaN(t)&&isFinite(t);if("string"===i){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);let i=Array.from(new Set([".",...e])).map(t=>`\\${t}`).join("|");return RegExp(`^[+-]?\\s*(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===i&&!!t&&"number"==typeof t.valueOf()&&!(t instanceof Date)}function n(t){return r(t,[","])}function o(t,e,i){let r=-1;for("function"==typeof e?(i=e,e=t):r=t-1;++r<=e&&!1!==i(r););}function s(t,e,i){let r=t+1;for("function"==typeof e&&(i=e,e=0);--r>=e&&!1!==i(r););}function l(t,e){return parseInt(t*(e=isNaN(e=parseInt(e.toString().replace("%",""),10))?0:e)/100,10)}function a(t,e,i){return Math.min(t,e)===t?e:Math.max(t,i)===t?i:t}i.d(e,{N1:function(){return l},TR:function(){return n},kE:function(){return r},q4:function(){return o},uZ:function(){return a},yh:function(){return s}})},69488:function(t,e,i){"use strict";i.d(e,{$s:function(){return g},ED:function(){return n},Hn:function(){return f},I8:function(){return s},Kn:function(){return u},Q8:function(){return p},Z1:function(){return h},ZB:function(){return function t(e,i){d(i,(r,n)=>{i[n]&&"object"==typeof i[n]?(e[n]||(Array.isArray(i[n])?e[n]=[]:"[object Date]"===Object.prototype.toString.call(i[n])?e[n]=i[n]:e[n]={}),t(e[n],i[n])):e[n]=i[n]})}},_l:function(){return d},d9:function(){return l},ie:function(){return function t(e){let i;return Array.isArray(e)?i=e.length?Array(e.length).fill(null):[]:(i={},d(e,(e,r)=>{"__children"!==r&&(e&&"object"==typeof e&&!Array.isArray(e)?i[r]=t(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?i[r]=[t(e[0])]:i[r]=[]:i[r]=null)})),i}},jB:function(){return a},jW:function(){return c},l7:function(){return o},nr:function(){return w},sm:function(){return m}}),i(92648),i(58563),i(57855);var r=i(99440);function n(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function o(t,e,i){let r=Array.isArray(i);return d(e,(e,n)=>{(!1===r||i.includes(n))&&(t[n]=e)}),t}function s(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function l(t){let e={};return d(t,(t,i)=>{e[i]=t}),e}function a(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return(0,r.Bk)(i,e=>{t.MIXINS.push(e.MIXIN_NAME),d(e,(e,i)=>{if(void 0!==t.prototype[i])throw Error(`Mixin conflict. Property '${i}' already exist and cannot be overwritten.`);"function"==typeof e?t.prototype[i]=e:Object.defineProperty(t.prototype,i,{get:function(t,e){let i=`_${t}`,r=t=>{let e=t;return(Array.isArray(e)||u(e))&&(e=s(e)),e};return function(){return void 0===this[i]&&(this[i]=r(e)),this[i]}}(i,e),set:function(t){let e=`_${t}`;return function(t){this[e]=t}}(i),configurable:!0})})}),t}function h(t,e){return JSON.stringify(t)===JSON.stringify(e)}function u(t){return"[object Object]"===Object.prototype.toString.call(t)}function c(t,e,i,r){r.value=i,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(t,e,r)}function d(t,e){for(let i in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,i))&&!1===e(t[i],i,t))break;return t}function g(t,e){let i=e.split("."),r=t;return d(i,t=>{if(void 0===(r=r[t]))return r=void 0,!1}),r}function f(t,e,i){let r=e.split("."),n=t;r.forEach((t,e)=>{e!==r.length-1?(w(n,t)||(n[t]={}),n=n[t]):n[t]=i})}function p(t){if(!u(t))return 0;let e=function(t){let i=0;return u(t)?d(t,(t,r)=>{"__children"!==r&&(i+=e(t))}):i+=1,i};return e(t)}function m(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",i=`_${e}`,r={_touched:!1,[i]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[i]},set(t){this._touched=!0,this[i]=t},enumerable:!0,configurable:!0}),r}function w(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},66411:function(t,e,i){"use strict";i.d(e,{Nw:function(){return h},O1:function(){return o},ct:function(){return n},ng:function(){return l},oN:function(){return a},wK:function(){return s}}),i(58563);var r=i(43571);function n(t){return t[0].toUpperCase()+t.substr(1)}function o(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function s(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,i)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[i]?"":e[i])}function a(t){return h(`${t}`,{ALLOWED_TAGS:[]})}function h(t,e){return r.sanitize(t,e)}},32836:function(t,e,i){"use strict";i.d(e,{e:function(){return n}});var r=i(99440);function n(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];let o=(0,r.k$)(t,(t,e,r)=>{let n=e.replace(/\r?\n\s*/g,""),o=i[r]?i[r]:"";return t+n+o},"");return o.trim()}},66678:function(t,e,i){"use strict";i.d(e,{DC:function(){return a},EA:function(){return l},T2:function(){return h},nx:function(){return o},ot:function(){return u}}),i(58563);var r=i(99440),n=i(2228);let o={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,n.vU)()?182:174,AUDIO_MUTE:(0,n.vU)()?181:173,AUDIO_UP:(0,n.vU)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},s=[o.ALT,o.ARROW_DOWN,o.ARROW_LEFT,o.ARROW_RIGHT,o.ARROW_UP,o.AUDIO_DOWN,o.AUDIO_MUTE,o.AUDIO_UP,o.BACKSPACE,o.CAPS_LOCK,o.DELETE,o.END,o.ENTER,o.ESCAPE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.F13,o.F14,o.F15,o.F16,o.F17,o.F18,o.F19,o.HOME,o.INSERT,o.MEDIA_NEXT,o.MEDIA_PLAY_PAUSE,o.MEDIA_PREV,o.MEDIA_STOP,o.NULL,o.NUM_LOCK,o.PAGE_DOWN,o.PAGE_UP,o.PAUSE,o.SCROLL_LOCK,o.SHIFT,o.TAB];function l(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function a(t){return s.includes(t)}function h(t){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(t)}function u(t,e){let i=e.split("|"),n=!1;return(0,r.Bk)(i,e=>{if(t===o[e])return n=!0,!1}),n}},52855:function(t,e,i){"use strict";i.r(e),i.d(e,{CHECKBOX_CHECKED:function(){return tA},CHECKBOX_RENDERER_NAMESPACE:function(){return tI},CHECKBOX_UNCHECKED:function(){return tN},CONTEXTMENU_ITEMS_ADD_COMMENT:function(){return T},CONTEXTMENU_ITEMS_ALIGNMENT:function(){return x},CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:function(){return D},CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:function(){return A},CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:function(){return H},CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:function(){return I},CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:function(){return P},CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:function(){return N},CONTEXTMENU_ITEMS_ALIGNMENT_TOP:function(){return _},CONTEXTMENU_ITEMS_BORDERS:function(){return L},CONTEXTMENU_ITEMS_BORDERS_BOTTOM:function(){return V},CONTEXTMENU_ITEMS_BORDERS_LEFT:function(){return F},CONTEXTMENU_ITEMS_BORDERS_RIGHT:function(){return W},CONTEXTMENU_ITEMS_BORDERS_TOP:function(){return B},CONTEXTMENU_ITEMS_CLEAR_COLUMN:function(){return f},CONTEXTMENU_ITEMS_COPY:function(){return p},CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:function(){return b},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:function(){return w},CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:function(){return m},CONTEXTMENU_ITEMS_CUT:function(){return y},CONTEXTMENU_ITEMS_EDIT_COMMENT:function(){return M},CONTEXTMENU_ITEMS_FREEZE_COLUMN:function(){return C},CONTEXTMENU_ITEMS_HIDE_COLUMN:function(){return z},CONTEXTMENU_ITEMS_HIDE_ROW:function(){return G},CONTEXTMENU_ITEMS_INSERT_LEFT:function(){return l},CONTEXTMENU_ITEMS_INSERT_RIGHT:function(){return a},CONTEXTMENU_ITEMS_MERGE_CELLS:function(){return E},CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:function(){return $},CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:function(){return U},CONTEXTMENU_ITEMS_NO_ITEMS:function(){return n},CONTEXTMENU_ITEMS_READ_ONLY:function(){return g},CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:function(){return k},CONTEXTMENU_ITEMS_REDO:function(){return d},CONTEXTMENU_ITEMS_REMOVE_BORDERS:function(){return j},CONTEXTMENU_ITEMS_REMOVE_COLUMN:function(){return u},CONTEXTMENU_ITEMS_REMOVE_COMMENT:function(){return O},CONTEXTMENU_ITEMS_REMOVE_ROW:function(){return h},CONTEXTMENU_ITEMS_ROW_ABOVE:function(){return o},CONTEXTMENU_ITEMS_ROW_BELOW:function(){return s},CONTEXTMENU_ITEMS_SHOW_COLUMN:function(){return K},CONTEXTMENU_ITEMS_SHOW_ROW:function(){return Y},CONTEXTMENU_ITEMS_UNDO:function(){return c},CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:function(){return S},CONTEXTMENU_ITEMS_UNMERGE_CELLS:function(){return R},CONTEXT_MENU_ITEMS_NAMESPACE:function(){return r},FILTERS_BUTTONS_CANCEL:function(){return tM},FILTERS_BUTTONS_CLEAR:function(){return tR},FILTERS_BUTTONS_OK:function(){return tT},FILTERS_BUTTONS_PLACEHOLDER_SEARCH:function(){return tO},FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:function(){return tx},FILTERS_BUTTONS_PLACEHOLDER_VALUE:function(){return tk},FILTERS_BUTTONS_SELECT_ALL:function(){return tE},FILTERS_CONDITIONS_AFTER:function(){return tg},FILTERS_CONDITIONS_BEFORE:function(){return tf},FILTERS_CONDITIONS_BEGINS_WITH:function(){return ti},FILTERS_CONDITIONS_BETWEEN:function(){return tc},FILTERS_CONDITIONS_BY_VALUE:function(){return ts},FILTERS_CONDITIONS_CONTAINS:function(){return tn},FILTERS_CONDITIONS_EMPTY:function(){return J},FILTERS_CONDITIONS_ENDS_WITH:function(){return tr},FILTERS_CONDITIONS_EQUAL:function(){return tt},FILTERS_CONDITIONS_GREATER_THAN:function(){return tl},FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:function(){return ta},FILTERS_CONDITIONS_LESS_THAN:function(){return th},FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:function(){return tu},FILTERS_CONDITIONS_NAMESPACE:function(){return q},FILTERS_CONDITIONS_NONE:function(){return Z},FILTERS_CONDITIONS_NOT_BETWEEN:function(){return td},FILTERS_CONDITIONS_NOT_CONTAIN:function(){return to},FILTERS_CONDITIONS_NOT_EMPTY:function(){return Q},FILTERS_CONDITIONS_NOT_EQUAL:function(){return te},FILTERS_CONDITIONS_TODAY:function(){return tp},FILTERS_CONDITIONS_TOMORROW:function(){return tm},FILTERS_CONDITIONS_YESTERDAY:function(){return tw},FILTERS_DIVS_FILTER_BY_CONDITION:function(){return tv},FILTERS_DIVS_FILTER_BY_VALUE:function(){return tb},FILTERS_LABELS_CONJUNCTION:function(){return ty},FILTERS_LABELS_DISJUNCTION:function(){return tC},FILTERS_NAMESPACE:function(){return X},FILTERS_VALUES_BLANK_CELLS:function(){return tS}});let r="ContextMenu:items",n=`${r}.noItems`,o=`${r}.insertRowAbove`,s=`${r}.insertRowBelow`,l=`${r}.insertColumnOnTheLeft`,a=`${r}.insertColumnOnTheRight`,h=`${r}.removeRow`,u=`${r}.removeColumn`,c=`${r}.undo`,d=`${r}.redo`,g=`${r}.readOnly`,f=`${r}.clearColumn`,p=`${r}.copy`,m=`${r}.copyWithHeaders`,w=`${r}.copyWithGroupHeaders`,b=`${r}.copyHeadersOnly`,y=`${r}.cut`,C=`${r}.freezeColumn`,S=`${r}.unfreezeColumn`,E=`${r}.mergeCells`,R=`${r}.unmergeCells`,T=`${r}.addComment`,M=`${r}.editComment`,O=`${r}.removeComment`,k=`${r}.readOnlyComment`,x=`${r}.align`,I=`${r}.align.left`,A=`${r}.align.center`,N=`${r}.align.right`,H=`${r}.align.justify`,_=`${r}.align.top`,P=`${r}.align.middle`,D=`${r}.align.bottom`,L=`${r}.borders`,B=`${r}.borders.top`,W=`${r}.borders.right`,V=`${r}.borders.bottom`,F=`${r}.borders.left`,j=`${r}.borders.remove`,U=`${r}.nestedHeaders.insertChildRow`,$=`${r}.nestedHeaders.detachFromParent`,z=`${r}.hideColumn`,K=`${r}.showColumn`,G=`${r}.hideRow`,Y=`${r}.showRow`,X="Filters:",q=`${X}conditions`,Z=`${q}.none`,J=`${q}.isEmpty`,Q=`${q}.isNotEmpty`,tt=`${q}.isEqualTo`,te=`${q}.isNotEqualTo`,ti=`${q}.beginsWith`,tr=`${q}.endsWith`,tn=`${q}.contains`,to=`${q}.doesNotContain`,ts=`${q}.byValue`,tl=`${q}.greaterThan`,ta=`${q}.greaterThanOrEqualTo`,th=`${q}.lessThan`,tu=`${q}.lessThanOrEqualTo`,tc=`${q}.isBetween`,td=`${q}.isNotBetween`,tg=`${q}.after`,tf=`${q}.before`,tp=`${q}.today`,tm=`${q}.tomorrow`,tw=`${q}.yesterday`,tv=`${X}labels.filterByCondition`,tb=`${X}labels.filterByValue`,ty=`${X}labels.conjunction`,tC=`${X}labels.disjunction`,tS=`${X}values.blankCells`,tE=`${X}buttons.selectAll`,tR=`${X}buttons.clear`,tT=`${X}buttons.ok`,tM=`${X}buttons.cancel`,tO=`${X}buttons.placeholder.search`,tk=`${X}buttons.placeholder.value`,tx=`${X}buttons.placeholder.secondValue`,tI="CheckboxRenderer:",tA=`${tI}checked`,tN=`${tI}unchecked`},78444:function(t,e,i){"use strict";i.d(e,{Zs:function(){return d},qG:function(){return y},vq:function(){return S},vk:function(){return E},gr:function(){return R},RY:function(){return C},MG:function(){return b}});var r=i(69488),n=i(99440),o=i(2518),s=i(31870),l=i(82656);let{register:a,getValues:h}=(0,l.Z)("phraseFormatters");a("pluralize",function(t,e){let i=Array.isArray(t)&&Number.isInteger(e);return i?t[e]:t});var u=i(52855);/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */let c={languageCode:"en-US",[u.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[u.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[u.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[u.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[u.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[u.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[u.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[u.CONTEXTMENU_ITEMS_UNDO]:"Undo",[u.CONTEXTMENU_ITEMS_REDO]:"Redo",[u.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[u.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[u.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[u.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[u.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[u.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[u.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[u.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[u.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[u.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[u.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[u.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[u.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[u.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[u.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[u.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[u.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[u.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[u.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[u.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[u.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[u.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[u.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[u.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[u.CONTEXTMENU_ITEMS_COPY]:"Copy",[u.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[u.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[u.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[u.CONTEXTMENU_ITEMS_CUT]:"Cut",[u.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[u.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[u.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[u.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[u.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[u.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[u.FILTERS_CONDITIONS_NONE]:"None",[u.FILTERS_CONDITIONS_EMPTY]:"Is empty",[u.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[u.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[u.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[u.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[u.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[u.FILTERS_CONDITIONS_CONTAINS]:"Contains",[u.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[u.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[u.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[u.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[u.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[u.FILTERS_CONDITIONS_BETWEEN]:"Is between",[u.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[u.FILTERS_CONDITIONS_AFTER]:"After",[u.FILTERS_CONDITIONS_BEFORE]:"Before",[u.FILTERS_CONDITIONS_TODAY]:"Today",[u.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[u.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[u.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[u.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[u.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[u.FILTERS_LABELS_CONJUNCTION]:"And",[u.FILTERS_LABELS_DISJUNCTION]:"Or",[u.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[u.FILTERS_BUTTONS_CLEAR]:"Clear",[u.FILTERS_BUTTONS_OK]:"OK",[u.FILTERS_BUTTONS_CANCEL]:"Cancel",[u.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[u.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[u.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[u.CHECKBOX_CHECKED]:"Checked",[u.CHECKBOX_UNCHECKED]:"Unchecked"},d=u,g=c.languageCode,{register:f,getItem:p,hasItem:m,getValues:w}=(0,l.Z)("languagesDictionaries");function b(t,e){var i,n;let o=t,l=e;return(0,r.Kn)(t)&&(o=(l=t).languageCode),i=o,n=l,i!==g&&(0,s.eb)(n,p(g)),f(o,(0,r.I8)(l)),(0,r.I8)(l)}function y(t){return m(t)?(0,r.I8)(p(t)):null}function C(t){return m(t)}function S(){return w()}function E(t,e,i){let r;let s=y(t);if(null===s)return null;let l=s[e];if((0,o.o8)(l))return null;let a=(r=l,(0,n.Bk)(h(),t=>{r=t(l,i)}),r);return Array.isArray(a)?a[0]:a}function R(t){let e=(0,s.TH)(t);return m(e)||(e=g,(0,s.Vn)(t)),e}b(c)},31870:function(t,e,i){"use strict";i.d(e,{TH:function(){return a},Vn:function(){return h},eb:function(){return l}});var r=i(2518),n=i(69488),o=i(24748),s=i(32836);function l(t,e){return(0,n._l)(e,(e,i)=>{(0,r.o8)(t[i])&&(t[i]=e)}),t}function a(t){let e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?`${e[1].toLowerCase()}-${e[2].toUpperCase()}`:t}function h(t){(0,r.$K)(t)&&(0,o.vU)(s.e`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}},63437:function(t,e,i){"use strict";i(58563);var r=i(69488),n=i(98179);let o={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,i,r,o,s,l){if(this._localHooks[t]){let a=this._localHooks[t].length;for(let h=0;h<a;h++)(0,n.$Z)(this._localHooks[t][h],this,e,i,r,o,s,l)}},clearLocalHooks(){return this._localHooks={},this}};(0,r.jW)(o,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1}),e.Z=o},54317:function(t,e,i){"use strict";i(58563),i(57855);var r=i(99440),n=i(69488),o=i(66411),s=i(24748),l=i(32836),a=i(98179);let h=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],u=l.e`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,c=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),d=new Map([[]]);class g{static getSingleton(){return f}constructor(){var t,e,i;e=void 0,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="globalBucket","string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){let t=Object.create(null);return(0,r.Bk)(h,e=>t[e]=[]),t}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=this.createEmptyBucket()),t.pluginHookBucket):this.globalBucket}add(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(e))(0,r.Bk)(e,e=>this.add(t,e,i));else{c.has(t)&&(0,s.ZK)((0,o.ng)(u,{hookName:t,removedInVersion:c.get(t)})),d.has(t)&&(0,s.ZK)(d.get(t));let n=this.getBucket(i);if(void 0===n[t]&&(this.register(t),n[t]=[]),e.skip=!1,-1===n[t].indexOf(e)){let i=!1;e.initialHook&&(0,r.Bk)(n[t],(r,o)=>{if(r.initialHook)return n[t][o]=e,i=!0,!1}),i||n[t].push(e)}}return this}once(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(e)?(0,r.Bk)(e,e=>this.once(t,e,i)):(e.runOnce=!0,this.add(t,e,i))}remove(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(i);return!!(void 0!==r[t]&&r[t].indexOf(e)>=0)&&(e.skip=!0,!0)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this.getBucket(e);return!!(void 0!==i[t]&&i[t].length)}run(t,e,i,r,n,o,s,l){{let h=this.globalBucket[e],u=h?h.length:0,c=0;if(u)for(;c<u;){if(!h[c]||h[c].skip){c+=1;continue}let u=(0,a.$Z)(h[c],t,i,r,n,o,s,l);void 0!==u&&(i=u),h[c]&&h[c].runOnce&&this.remove(e,h[c]),c+=1}}{let h=this.getBucket(t)[e],u=h?h.length:0,c=0;if(u)for(;c<u;){if(!h[c]||h[c].skip){c+=1;continue}let u=(0,a.$Z)(h[c],t,i,r,n,o,s,l);void 0!==u&&(i=u),h[c]&&h[c].runOnce&&this.remove(e,h[c],t),c+=1}}return i}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,n._l)(this.getBucket(t),(t,e,i)=>i[e].length=0)}register(t){this.isRegistered(t)||h.push(t)}deregister(t){this.isRegistered(t)&&h.splice(h.indexOf(t),1)}isDeprecated(t){return d.has(t)||c.has(t)}isRegistered(t){return h.indexOf(t)>=0}getRegistered(){return h}}let f=new g;e.Z=g},55915:function(t,e,i){"use strict";i.d(e,{s3:function(){return m},a9:function(){return p},_j:function(){return w},fo:function(){return b}}),i(57855);var r=i(66411),n=i(67790),o=i(98179);let s=new Map([["asc",[-1,1]],["desc",[1,-1]]]),l=t=>`The priority '${t}' is already declared in a map.`,a=t=>`The priority '${t}' is not a number.`;var h=i(2488);let u=t=>`'${t}' value is already declared in a unique set.`,c=t=>`There is already registered "${t}" plugin.`,d=function(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=new Map;return t=(0,o.mf)(t)?t:l,e=(0,o.mf)(e)?e:a,{addItem:function(r,o){if(!(0,n.kE)(r))throw Error(e(r));if(i.has(r))throw Error(t(r));i.set(r,o)},getItems:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",[e,r]=s.get(t)||s.get("asc");return[...i].sort((t,i)=>t[0]<i[0]?e:r).map(t=>t[1])}}}({errorPriorityExists:t=>`There is already registered plugin on priority "${t}".`,errorPriorityNaN:t=>`The priority "${t}" is not a number.`}),g=function(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Set;return t=(0,o.mf)(t)?t:u,{addItem:function(i){if(e.has(i))throw Error(t(i));e.add(i)},clear:function(){e.clear()},getItems:function(){return[...e]}}}({errorItemExists:c}),f=(0,h.I)({errorIdExists:c});function p(){return[...d.getItems(),...g.getItems()]}function m(t){let e=(0,r.ct)(t);return f.getItem(e)}function w(t){return!!m(t)}function b(t,e,i){var n,o,s;[t,e,i]=(n=t,o=e,s=i,"function"==typeof n&&(n=(o=n).PLUGIN_KEY,s=o.PLUGIN_PRIORITY),[n,o,s]),void 0===m(t)&&function(t,e,i){let n=(0,r.ct)(t);if(f.hasItem(n))throw Error(c(n));void 0===i?g.addItem(n):d.addItem(i,n),f.addItem(n,e)}(t,e,i)}},90158:function(t,e,i){"use strict";i.d(e,{t9:function(){return vy}}),i(58563),i(57855);var r=i(2694),n=i(5566),o=i(27687),s=i(69488),l=i(24692);let a="handsontableEditor";class h extends r.H{static get EDITOR_TYPE(){return"handsontable"}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,n.Mq)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(t,e,i,r,n,o){super.prepare(t,e,i,r,n,o);let l=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(t,e){let i=this.getSourceData(e.row,e.col);void 0!==i&&l.setValue(i),l.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&(0,s.l7)(a,o.handsontable),this.htOptions=a}beginEditing(t,e){let i=this.hot.getSettings().onBeginEditing;i&&!1===i()||super.beginEditing(t,e)}createElements(){super.createElements();let t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){let t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,i)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor");super.registerShortcuts();let i={group:a,relativeToGroup:l.H,position:"before"},r=(t,e)=>{let i=this.htEditor;if(void 0!==t&&(t<0||i.flipped&&t>i.countRows()-1?i.deselectCell():i.selectCell(t,0),i.getData().length))return e.preventDefault(),(0,o.mM)(e),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{let e;let i=this.htEditor;return!i.getSelectedLast()&&i.flipped?e=i.countRows()-1:i.getSelectedLast()&&(e=i.flipped?Math.max(0,i.getSelectedLast()[0]-1):i.getSelectedLast()[0]-1),r(e,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{let e;let i=this.htEditor;if(i.getSelectedLast()||i.flipped){if(i.getSelectedLast()){if(i.flipped)e=i.getSelectedLast()[0]+1;else if(!i.flipped){let t=i.countRows()-1;e=Math.min(t,i.getSelectedLast()[0]+1)}}}else e=0;return r(e,t)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts();let t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(a)}}var u=i(99440),c=i(2518),d=i(66411),g=i(66678),f=i(2228),p=i(49532),m=i(18200);function w(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function b(t,e){var i=function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return e.get(t)}(t,e,0);return i.get?i.get.call(t):i.value}var y=new WeakMap;class C extends h{constructor(){var t;super(...arguments),w(this,"query",null),w(this,"strippedChoices",[]),w(this,"rawChoices",[]),t={writable:!0,value:this.hot.guid.slice(0,9)},function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,y),y.set(this,t),w(this,"sortByRelevance",function(t,e,i){let r,n,o,s;let l=[],a=[],h=t.length,u=e.length;if(0===h){for(o=0;o<u;o++)a.push(o);return a}for(o=0;o<u;o++){if(n=(0,d.oN)((0,c.Pz)(e[o])),i)s=n.indexOf(t);else{let e=this.cellProperties.locale;s=n.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==s&&(r=n.length-s-h,l.push({baseIndex:o,index:s,charsLeft:r,value:n}))}for(l.sort((t,e)=>{if(-1===e.index)return -1;if(-1===t.index)return 1;if(t.index<e.index)return -1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return -1;if(t.charsLeft>e.charsLeft)return 1}return 0}),o=0,u=l.length;o<u;o++)a.push(l[o].baseIndex);return a})}static get EDITOR_TYPE(){return"autocomplete"}getValue(){let t=this.rawChoices.find(t=>{let e=this.stripValueIfNeeded(t);return e===this.TEXTAREA.value});return(0,c.$K)(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),(0,n.cn)(this.htContainer,"autocompleteEditor"),(0,n.cn)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&(0,n.P$)(this.TEXTAREA,[(0,m.Nr)(),(0,m.LO)(),(0,m.fv)("listbox"),(0,m.zV)()])}prepare(t,e,i,r,o,s){super.prepare(t,e,i,r,o,s),this.hot.getSettings().ariaTags&&(0,n.P$)(this.TEXTAREA,[(0,m.JV)("false"),(0,m.d)(`${b(this,y)}-listbox-${t}-${e}`)])}open(){super.open();let t=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,e=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=null==i?void 0:i.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let l=(0,n.np)();0===l&&(0,f.eE)()&&(l+=15),this.addHook("beforeKeyDown",t=>this.onBeforeKeyDown(t)),this.htEditor.updateSettings({colWidths:t?[(0,n.iO)(this.TEXTAREA)-2]:void 0,width:t?(0,n.iO)(this.TEXTAREA)+l:void 0,autoColumnSize:!0,renderer:(t,o,s,l,a,h,u)=>{let d,g;(0,p.V)(t,o,s,l,a,h,u);let{filteringCaseSensitive:f,allowHtml:w,locale:b}=this.cellProperties,y=this.query,C=(0,c.Pz)(h);C&&!w&&-1!==(d=!0===f?C.indexOf(y):C.toLocaleLowerCase(b).indexOf(y.toLocaleLowerCase(b)))&&(g=C.substr(d,y.length),C=C.replace(g,`<strong>${g}</strong>`)),e&&(0,n.P$)(o,[(0,m.Nl)(),...i?[(0,m.DT)(r)]:[],...i?[(0,m.jH)(i.indexOf(h)+1)]:[],["id",`${this.htEditor.rootElement.id}_${s}-${l}`]]),o.innerHTML=C},afterSelection:(t,i)=>{if(e){let e=this.htEditor.getCell(t,i,!0);(0,n.P$)(e,[(0,m.Ak)()]),(0,n.P$)(this.TEXTAREA,...(0,m.nT)(e.id))}}}),e&&((0,n.P$)(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...(0,m.Rn)()),(0,n.P$)(this.htEditor.rootElement,[(0,m.a6)(),(0,m.Ez)("polite"),(0,m.Up)("text"),["id",`${b(this,y)}-listbox-${o}-${s}`]]),(0,n.P$)(this.TEXTAREA,...(0,m.JV)("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&(0,n.P$)(this.TEXTAREA,[(0,m.JV)("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){let e=this.cellProperties.source;this.query=t,"function"==typeof e?e.call(this.cellProperties,t,t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))}):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){let e=(0,n.qK)(this.TEXTAREA),i=(0,n.kg)(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,s=null,l=null,a=t;r&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),a,this.cellProperties.filteringCaseSensitive));let h=Array.isArray(s)?s.length:0;if(!1===o)h&&(l=s[0]);else{let t=[];for(let e=0,i=a.length;e<i&&(!r||!(h<=e));e++)h?t.push(a[s[e]]):t.push(a[e]);l=0,a=t}this.strippedChoices=a,this.htEditor.loadData((0,u.jz)([a])),0===a.length?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(l)),this.hot.listen(),(0,n.Mq)(this.TEXTAREA,e,e===i?void 0:i)}flipDropdownIfNeeded(){let t=(0,n.$g)(this.hot.view._wt.wtTable.TABLE),e=t===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(e||!e&&(i||"horizontal"===i))return!1;let r=(0,n.cv)(this.TEXTAREA),o=(0,n.Pb)(this.TEXTAREA),s=this.getDropdownHeight(),l=t.scrollTop,a=(0,n.Pb)(this.hot.view._wt.wtTable.THEAD),h=(0,n.cv)(t),u=r.top-h.top-a+l,c=t.scrollHeight-u-a-o,d=s>c&&u>c;return d?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(d?u:c,s),d}limitDropdownIfNeeded(t,e){if(e>t){let i=0,r=0,n=0,o=null;do i+=n=this.htEditor.getRowHeight(r)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=1;while(i<t);o=i-n,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+e-o}px`),this.setDropdownHeight(i-n)}}flipDropdown(t){let e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-t}px`,this.htEditor.flipped=!0}unflipDropdown(){let t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){let t=this.htEditor.getColWidth(0)+(0,n.np)(this.hot.rootDocument)+2,e=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:e?void 0:t}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t})}highlightBestMatchingChoice(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){let t=this.htEditor.getRowHeight(0)||23,e=this.cellProperties.visibleRows;return this.strippedChoices.length>=e?e*t:this.strippedChoices.length*t+8}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){let{allowHtml:e}=this.cellProperties,i=(0,u.Sc)(t,t=>(0,c.Pz)(t)),r=(0,u.Sc)(i,t=>e?t:(0,d.oN)(t));return r}allowKeyEventPropagation(t){let e=this.htEditor.getSelectedRangeLast(),i={row:e?e.from.row:-1},r=!1;return t===g.nx.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),t===g.nx.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(t){if((0,g.EA)(t.keyCode)||t.keyCode===g.nx.BACKSPACE||t.keyCode===g.nx.DELETE||t.keyCode===g.nx.INSERT){let e=10;t.keyCode===g.nx.C&&(t.ctrlKey||t.metaKey)||(this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},e))}}}var S=i(98422);class E extends S.Hf{static get EDITOR_TYPE(){return"checkbox"}beginEditing(t,e){if(e&&"mouseup"===e.type){let t=this.TD.querySelector('input[type="checkbox"]');(0,n.pv)(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var R=i(62067);/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */let T=()=>window,M=()=>window.document,O=(t,e)=>window.setTimeout(t,e),k=function(t,e,i,r){t.addEventListener(e,i,!!r)},x=function(t,e,i,r){t.removeEventListener(e,i,!!r)},I=function(t,e){return -1!==(" "+t.className+" ").indexOf(" "+e+" ")},A=function(t,e){I(t,e)||(t.className=""===t.className?e:t.className+" "+e)},N=function(t,e){var i;t.className=(i=(" "+t.className+" ").replace(" "+e+" "," ")).trim?i.trim():i.replace(/^\s+|\s+$/g,"")},H=function(t){return/Array/.test(Object.prototype.toString.call(t))},_=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},P=function(t){let e=t.getDay();return 0===e||6===e},D=function(t,e){return[31,t%4==0&&t%100!=0||t%400==0?29:28,31,30,31,30,31,31,30,31,30,31][e]},L=function(t){_(t)&&t.setHours(0,0,0,0)},B=function(t,e){return t.getTime()===e.getTime()},W=function(t,e,i){let r,n;for(r in e)(n=void 0!==t[r])&&"object"==typeof e[r]&&null!==e[r]&&void 0===e[r].nodeName?_(e[r])?i&&(t[r]=new Date(e[r].getTime())):H(e[r])?i&&(t[r]=e[r].slice(0)):t[r]=W({},e[r],i):(i||!n)&&(t[r]=e[r]);return t},V=function(t,e,i){let r=M().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=W(r,i),t.dispatchEvent(r)},F=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},j={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},U=function(t,e,i){for(e+=t.firstDay;e>=7;)e-=7;return i?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},$=function(t){let e=[],i="false";if(t.isEmpty){if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled")}return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),i="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+i+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},z=function(t,e){t.setHours(0,0,0,0);let i=t.getDate(),r=t.getDay(),n=e-1,o=function(t){return(t+7-1)%7};t.setDate(i+n-o(r));let s=new Date(t.getFullYear(),0,e);return 1+Math.round(((t.getTime()-s.getTime())/864e5-n+o(s.getDay()))/7)},K=function(t,e,i,r,n){let o=new Date(r,i,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():z(o,n))+"</td>"},G=function(t){let e,i=[];for(t.showWeekNumber&&i.push("<th></th>"),e=0;e<7;e++)i.push('<th scope="col"><abbr title="'+U(t,e)+'">'+U(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?i.reverse():i).join("")+"</tr></thead>"},Y=function(t,e,i,r,n,o){let s,l,a,h=t._o,u=i===h.minYear,c=i===h.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',g,f,p=!0,m=!0;for(a=[],s=0;s<12;s++)a.push('<option value="'+(i===n?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(u&&s<h.minMonth||c&&s>h.maxMonth?' disabled="disabled"':"")+">"+h.i18n.months[s]+"</option>");for(g='<div class="pika-label">'+h.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+a.join("")+"</select></div>",H(h.yearRange)?(s=h.yearRange[0],l=h.yearRange[1]+1):(s=i-h.yearRange,l=1+i+h.yearRange),a=[];s<l&&s<=h.maxYear;s++)s>=h.minYear&&a.push('<option value="'+s+'"'+(s===i?' selected="selected"':"")+">"+s+"</option>");return f='<div class="pika-label">'+i+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+a.join("")+"</select></div>",h.showMonthAfterYear?d+=f+g:d+=g+f,u&&(0===r||h.minMonth>=r)&&(p=!1),c&&(11===r||h.maxMonth<=r)&&(m=!1),0===e&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),d+"</div>"};function X(t){let e=this,i=e.config(t);e._onMouseDown=function(t){if(!e._v)return;let r=(t=t||T().event).target||t.srcElement;if(r){if(!I(r,"is-disabled")&&(!I(r,"pika-button")||I(r,"is-empty")||I(r.parentNode,"is-disabled")?I(r,"pika-prev")?e.prevMonth():I(r,"pika-next")&&e.nextMonth():(e.setDate(new Date(r.getAttribute("data-pika-year"),r.getAttribute("data-pika-month"),r.getAttribute("data-pika-day"))),i.bound&&O(function(){e.hide(),i.blurFieldOnSelect&&i.field&&i.field.blur()},100))),I(r,"pika-select"))e._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}}},e._onChange=function(t){let i=(t=t||T().event).target||t.srcElement;i&&(I(i,"pika-select-month")?e.gotoMonth(i.value):I(i,"pika-select-year")&&e.gotoYear(i.value))},e._onKeyChange=function(t){if(t=t||T().event,e.isVisible())switch(t.keyCode){case 13:case 27:i.field&&i.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null)}},e._parseFieldValue=function(){if(i.parse)return i.parse(i.field.value,i.format);if(!this.hasMoment)return new Date(Date.parse(i.field.value));{let t=this.moment(i.field.value,i.format,i.formatStrict);return t&&t.isValid()?t.toDate():null}},e._onInputChange=function(t){let i;t.firedBy!==e&&(i=e._parseFieldValue(),_(i)&&e.setDate(i),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let t=M().activeElement;do if(I(t,"pika-single"))return;while(t=t.parentNode);e._c||(e._b=O(function(){e.hide()},50)),e._c=!1},e._onClick=function(t){let r=(t=t||T().event).target||t.srcElement,n=r;if(r){!hasEventListeners&&I(r,"pika-select")&&!r.onchange&&(r.setAttribute("onchange","return;"),k(r,"change",e._onChange));do if(I(n,"pika-single")||n===i.trigger)return;while(n=n.parentNode);e._v&&r!==i.trigger&&n!==i.trigger&&e.hide()}},e.el=M().createElement("div"),e.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:""),k(e.el,"mousedown",e._onMouseDown,!0),k(e.el,"touchend",e._onMouseDown,!0),k(e.el,"change",e._onChange),i.keyboardInput&&k(M(),"keydown",e._onKeyChange),i.field&&(i.container?i.container.appendChild(e.el):i.bound?M().body.appendChild(e.el):i.field.parentNode.insertBefore(e.el,i.field.nextSibling),k(i.field,"change",e._onInputChange),i.defaultDate||(i.defaultDate=e._parseFieldValue(),i.setDefaultDate=!0));let r=i.defaultDate;_(r)?i.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),i.bound?(this.hide(),e.el.className+=" is-bound",k(i.trigger,"click",e._onInputClick),k(i.trigger,"focus",e._onInputFocus),k(i.trigger,"blur",e._onInputBlur)):this.show()}function q(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}X.prototype={config:function(t){this._o||(this._o=W({},j,!0));let e=W(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;let i=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=i>4?4:i,_(e.minDate)||(e.minDate=!1),_(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),H(e.yearRange)){let t=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||j.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return(t=t||this._o.format,_(this._d))?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return _(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",V(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),!_(t))return;let i=this._o.minDate,r=this._o.maxDate;_(i)&&t<i?t=i:_(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),L(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),V(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(_(t)){if(this.calendars){let i=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),n=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=n<i.getTime()||r.getTime()<n}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let i,r=this.getDate()||new Date,n=864e5*parseInt(e);"add"===t?i=new Date(r.valueOf()+n):"subtract"===t&&(i=new Date(r.valueOf()-n)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=F(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=F({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(L(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=j.minDate,this._o.minYear=j.minYear,this._o.minMonth=j.minMonth,this._o.startRange=j.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(L(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=j.maxDate,this._o.maxYear=j.maxYear,this._o.maxMonth=j.maxMonth,this._o.endRange=j.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,i=e.minYear,r=e.maxYear,n=e.minMonth,o=e.maxMonth,s="",l;this._y<=i&&(this._y=i,!isNaN(n)&&this._m<n&&(this._m=n)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let t=0;t<e.numberOfMonths;t++)l="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Y(this,t,this.calendars[t].year,this.calendars[t].month,this.calendars[0].year,l)+this.render(this.calendars[t].year,this.calendars[t].month,l)+"</div>";this.el.innerHTML=s,e.bound&&"hidden"!==e.field.type&&O(function(){e.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,i,r,n,o,s,l,a,h,u;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,i=this.el.offsetHeight,r=T().innerWidth||M().documentElement.clientWidth,n=T().innerHeight||M().documentElement.clientHeight,o=M().body.scrollTop||M().documentElement.scrollTop,h=!0,u=!0,s=(a=t.getBoundingClientRect()).left+T().pageXOffset,l=a.bottom+T().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,h=!1),(this._o.reposition&&l+i>n+o||this._o.position.indexOf("top")>-1&&l-i-t.offsetHeight>0)&&(l=l-i-t.offsetHeight,u=!1),s<0&&(s=0),l<0&&(l=0),this.el.style.left=s+"px",this.el.style.top=l+"px",A(this.el,h?"left-aligned":"right-aligned"),A(this.el,u?"bottom-aligned":"top-aligned"),N(this.el,h?"right-aligned":"left-aligned"),N(this.el,u?"top-aligned":"bottom-aligned"))},render:function(t,e,i){var r,n;let o=this._o,s=new Date,l=D(t,e),a=new Date(t,e,1).getDay(),h=[],u=[];L(s),o.firstDay>0&&(a-=o.firstDay)<0&&(a+=7);let c=0===e?11:e-1,d=11===e?0:e+1,g=0===e?t-1:t,f=11===e?t+1:t,p=D(g,c),m=l+a,w=m;for(;w>7;)w-=7;m+=7-w;let b=!1;for(let i=0,w=0;i<m;i++){let m=new Date(t,e,1+(i-a)),y=!!_(this._d)&&B(m,this._d),C=B(m,s),S=-1!==o.events.indexOf(m.toDateString()),E=i<a||i>=l+a,R=1+(i-a),T=e,M=t,O=o.startRange&&B(o.startRange,m),k=o.endRange&&B(o.endRange,m),x=o.startRange&&o.endRange&&o.startRange<m&&m<o.endRange,I=o.minDate&&m<o.minDate||o.maxDate&&m>o.maxDate||o.disableWeekends&&P(m)||o.disableDayFn&&o.disableDayFn(m);E&&(i<a?(R=p+R,T=c,M=g):(R-=l,T=d,M=f));let A={day:R,month:T,year:M,hasEvent:S,isSelected:y,isToday:C,isDisabled:I,isEmpty:E,isStartRange:O,isEndRange:k,isInRange:x,showDaysInNextAndPreviousMonths:o.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:o.enableSelectionDaysInNextAndPreviousMonths};o.pickWholeWeek&&y&&(b=!0),u.push($(A)),7==++w&&(o.showWeekNumber&&u.unshift(K(this,i-a,e,t,o.firstWeekOfYearMinDays)),h.push((r=u,n=o.isRTL,'<tr class="pika-row'+(o.pickWholeWeek?" pick-whole-week":"")+(b?" is-selected":"")+'">'+(n?r.reverse():r).join("")+"</tr>")),u=[],w=0,b=!1)}return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+i+'">'+G(o)+"<tbody>"+h.join("")+"</tbody></table>"},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),N(this.el,"is-hidden"),this._o.bound&&(k(M(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let t=this._v;!1!==t&&(this._o.bound&&x(M(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),A(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),x(this.el,"mousedown",this._onMouseDown,!0),x(this.el,"touchend",this._onMouseDown,!0),x(this.el,"change",this._onChange),t.keyboardInput&&x(M(),"keydown",this._onKeyChange),t.field&&(x(t.field,"change",this._onInputChange),t.bound&&(x(t.trigger,"click",this._onInputClick),x(t.trigger,"focus",this._onInputFocus),x(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};let Z="date",J="dateEditor";class Q extends r.H{constructor(){super(...arguments),q(this,"defaultDateFormat","DD/MM/YYYY"),q(this,"parentDestroyed",!1),q(this,"$datePicker",null)}static get EDITOR_TYPE(){return Z}init(){if("function"!=typeof R)throw Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),(0,n.cn)(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",t=>{(0,n.pv)(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})}destroyElements(){let t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,i,r,n,o){super.prepare(t,e,i,r,n,o)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.hot.getShortcutManager(),i=e.getContext("editor");super.open(),this.showDatepicker(t),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:J})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()});let e=this.hot.getShortcutManager(),i=e.getContext("editor");i.removeShortcutsByGroup(J),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(t,e)}showDatepicker(t){let e;let i=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.hot.view.isMouseDown(),s=!!t&&(0,g.DC)(t.keyCode);this.datePicker.style.display="block",this.$datePicker=new X(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(R),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+i.top+(0,n.Pb)(this.TD)}px`;let l=this.hot.rootWindow.pageXOffset;l=this.hot.isRtl()?i.right-(0,n.iO)(this.datePicker):i.left,this.datePickerStyle.left=`${l}px`,this.originalValue?(R(e=this.originalValue,r,!0).isValid()&&this.$datePicker.setMoment(R(e,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),s||o||this.setValue("")):this.cellProperties.defaultDate?(R(e=this.cellProperties.defaultDate,r,!0).isValid()&&this.$datePicker.setMoment(R(e,r),!0),s||o||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){let t=this.TEXTAREA,e={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,s.ZB)(e,this.cellProperties.datePickerConfig);let i=e.onSelect,r=e.onClose;return e.field=t,e.trigger=t,e.container=this.datePicker,e.bound=!1,e.keyboardInput=!1,e.format=e.format||this.defaultDateFormat,e.reposition=e.reposition||!1,e.isRTL=!1,e.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=R(e).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(e),i&&i()},e.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),r&&r()},e}}var tt=i(54317);class te extends C{static get EDITOR_TYPE(){return"dropdown"}prepare(t,e,i,r,n,o){super.prepare(t,e,i,r,n,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}tt.Z.getSingleton().add("beforeValidate",function(t,e,i){let r=this.getCellMeta(e,this.propToCol(i));r.editor===te&&void 0===r.strict&&(r.filter=!1,r.strict=!0)});class ti extends r.H{static get EDITOR_TYPE(){return"numeric"}}class tr extends r.H{static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&(0,n.P$)(this.TEXTAREA,[(0,m.cV)()]),(0,n.cS)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}let tn="ht_editor_visible",to="selectEditor";class ts extends S.Hf{static get EDITOR_TYPE(){return"select"}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",(0,n.cn)(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";let t=this.hot.getShortcutManager();t.setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",(0,n.pv)(this.select,tn)&&(0,n.IV)(this.select,tn),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(t,e,i,r,o,l){let a;super.prepare(t,e,i,r,o,l);let h=this.cellProperties.selectOptions;a="function"==typeof h?this.prepareOptions(h(this.row,this.col,this.prop)):this.prepareOptions(h),(0,n.cS)(this.select),(0,s._l)(a,(t,e)=>{let i=this.hot.rootDocument.createElement("OPTION");i.value=e,(0,n.uS)(i,t),this.select.appendChild(i)})}prepareOptions(t){let e={};if(Array.isArray(t))for(let i=0,r=t.length;i<r;i++)e[t[i]]=t[i];else"object"==typeof t&&(e=t);return e}refreshValue(){let t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==S.ed.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}let{top:t,start:e,width:i,height:r}=this.getEditedCellRect(),o=this.select.style;o.height=`${r}px`,o.width=`${i}px`,o.top=`${t}px`,o[this.hot.isRtl()?"right":"left"]=`${e}px`,o.margin="0px",(0,n.cn)(this.select,tn)}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor"),i=t.getContext("grid");!1!==this.isInFullEditMode()&&e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:i,callback:()=>{}},{keys:[["ArrowUp"]],callback:()=>{let t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{let t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],{group:to})}unregisterShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("editor");e.removeShortcutsByGroup(to)}}class tl extends r.H{static get EDITOR_TYPE(){return"time"}prepare(t,e,i,r,n,o){super.prepare(t,e,i,r,n,o),this.TEXTAREA.dir="ltr"}}var ta=i(57416),th=i(51774);function tu(t,e,i,r,o,s,l){th.Z.apply(this,[t,e,i,r,o,s,l]),(0,n.uS)(e,null==s?"":s,!1)}tu.RENDERER_TYPE="html";var tc=i(49773);function td(t,e,i,r,o,s,l){let{rootDocument:a}=t,h=l.allowHtml?tu:p.V,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...(0,m.cV)()),u.appendChild(a.createTextNode(String.fromCharCode(9660))),h.apply(this,[t,e,i,r,o,s,l]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(u,e.firstChild),(0,n.cn)(e,"htAutocomplete"),!t.acArrowListener){let o=new tc.Z(t);t.acArrowListener=function(o){(0,n.pv)(o.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(i,r),e)},o.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{o.destroy()})}}function tg(t,e,i,r,n,o,s){td.apply(this,[t,e,i,r,n,o,s])}td.RENDERER_TYPE="autocomplete",tg.RENDERER_TYPE="dropdown";var tf=i(82659),tp=i(52855);let tm=new WeakMap,tw=new WeakMap,tv="data-row",tb="data-col",ty="checkbox";function tC(t,e,i,r,o,s,l){let{rootDocument:a}=t,h=t.getSettings().ariaTags;th.Z.apply(this,[t,e,i,r,o,s,l]),function(t){let e=tw.get(t);if(!e){let{rootElement:i}=t;(e=new tc.Z(t)).addEventListener(i,"click",e=>(function(t,e){let{target:i}=t;if(!tS(i)||!i.hasAttribute(tv)||!i.hasAttribute(tb))return;let r=parseInt(i.getAttribute(tv),10),n=parseInt(i.getAttribute(tb),10),o=e.getCellMeta(r,n);o.readOnly&&t.preventDefault()})(e,t)),e.addEventListener(i,"mouseup",e=>(function(t,e){let{target:i}=t;tS(i)&&i.hasAttribute(tv)&&i.hasAttribute(tb)&&setTimeout(e.listen,10)})(e,t)),e.addEventListener(i,"change",e=>(function(t,e){let{target:i}=t;if(!tS(i)||!i.hasAttribute(tv)||!i.hasAttribute(tb))return;let r=parseInt(i.getAttribute(tv),10),n=parseInt(i.getAttribute(tb),10),o=e.getCellMeta(r,n);if(!o.readOnly){let i=null;i=t.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,e.setDataAtCell(r,n,i)}})(e,t)),tw.set(t,e)}}(t);let u=function(t){let e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(a),d=l.label,g=!1;if(void 0===l.checkedTemplate&&(l.checkedTemplate=!0),void 0===l.uncheckedTemplate&&(l.uncheckedTemplate=!1),(0,n.cS)(e),s===l.checkedTemplate||(0,c.Pz)(s).toLocaleLowerCase(l.locale)===(0,c.Pz)(l.checkedTemplate).toLocaleLowerCase(l.locale)?u.checked=!0:s===l.uncheckedTemplate||(0,c.Pz)(s).toLocaleLowerCase(l.locale)===(0,c.Pz)(l.uncheckedTemplate).toLocaleLowerCase(l.locale)?u.checked=!1:(0,c.xb)(s)?(0,n.cn)(u,"noValue"):(u.style.display="none",(0,n.cn)(u,"htBadValue"),g=!0),(0,n.P$)(u,[[tv,i],[tb,r]]),h&&(0,n.P$)(u,[(0,m.QK)(u.checked?t.getTranslatedPhrase(tp.CHECKBOX_CHECKED):t.getTranslatedPhrase(tp.CHECKBOX_UNCHECKED)),(0,m.Pn)(u.checked),(0,m.wt)()]),!g&&d){let n="";if(d.value)n="function"==typeof d.value?d.value.call(this,i,r,o,s):d.value;else if(d.property){let e=t.getDataAtRowProp(i,d.property);n=null!==e?e:""}let l=function(t,e,i){let r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${i?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}(a,n,!0!==d.separated);"before"===d.position?d.separated?(e.appendChild(l),e.appendChild(u)):(l.appendChild(u),u=l):d.position&&"after"!==d.position||(d.separated?(e.appendChild(u),e.appendChild(l)):(l.insertBefore(u,l.firstChild),u=l))}function f(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=t.getSelectedRange();if(i)for(let r=0;r<i.length;r++){let{row:n,col:o}=i[r].getTopStartCorner(),{row:s,col:l}=i[r].getBottomEndCorner(),a=[];for(let i=n;i<=s;i+=1)for(let r=o;r<=l;r+=1){let n=t.getCellMeta(i,r);if("checkbox"!==n.type)return;if(!0===n.readOnly)continue;void 0===n.checkedTemplate&&(n.checkedTemplate=!0),void 0===n.uncheckedTemplate&&(n.uncheckedTemplate=!1);let o=t.getDataAtCell(i,r);!1===e?[n.checkedTemplate,n.checkedTemplate.toString()].includes(o)?a.push([i,r,n.uncheckedTemplate]):[n.uncheckedTemplate,n.uncheckedTemplate.toString(),null,void 0].includes(o)&&a.push([i,r,n.checkedTemplate]):a.push([i,r,n.uncheckedTemplate])}a.length>0&&t.setDataAtCell(a)}}function p(){let e=t.getSelectedRange();if(e){for(let i=0;i<e.length;i++){let r=e[i].getTopStartCorner(),n=e[i].getBottomEndCorner();for(let e=r.row;e<=n.row;e++)for(let i=r.col;i<=n.col;i++){let r=t.getCellMeta(e,i);if("checkbox"!==r.type)return!1;let n=t.getCell(e,i);if(null==n)return!0;{let t=n.querySelectorAll("input[type=checkbox]");if(t.length>0&&!r.readOnly)return!0}}}return!1}}d&&(!d||d.separated)||e.appendChild(u),g&&e.appendChild(a.createTextNode("#bad-value#")),tm.has(t)||(tm.set(t,!0),function(){let e=t.getShortcutManager(),i=e.getContext("grid");i.addShortcuts([{keys:[["space"]],callback:()=>(f(),!p())},{keys:[["enter"]],callback:()=>(f(),!p()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!p()),relativeToGroup:tf.I,position:"before"}],{group:"checkboxRenderer"})}())}function tS(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}function tE(t,e,i,r,n,o,s){td.apply(this,[t,e,i,r,n,o,s])}tt.Z.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,i){let{label:r,type:n,row:o,column:s,prop:l}=e;if(n===ty){if(r){let{value:e,property:n}=r,a=i;if(e)a="function"==typeof e?e(o,s,l,i):e;else if(n){let t=this.getDataAtRowProp(o,n);a=null!==t?t:i}t=a}return t}}),tC.RENDERER_TYPE=ty,tE.RENDERER_TYPE="handsontable";var tR=i(84695),tT=i(67790);function tM(t,e,i,r,n,o,s){let l=o;if((0,tT.kE)(l)){let t=s.numericFormat,i=t&&t.culture||"-",r=t&&t.pattern,n=s.className||"",o=n.length?n.split(" "):[];if(void 0!==i&&!tR.languages()[i]){let t=i.replace("-",""),e=tR.allLanguages?tR.allLanguages[i]:tR[t];e&&tR.registerLanguage(e)}tR.setLanguage(i),l=tR(l).format(r||"0"),0>o.indexOf("htLeft")&&0>o.indexOf("htCenter")&&0>o.indexOf("htRight")&&0>o.indexOf("htJustify")&&o.push("htRight"),0>o.indexOf("htNumeric")&&o.push("htNumeric"),s.className=o.join(" "),e.dir="ltr"}(0,p.V)(t,e,i,r,n,l,s)}function tO(t,e,i,r,o,s,l){p.V.apply(this,[t,e,i,r,o,s,l]);let a=l.hashLength||e.innerHTML.length,h=l.hashSymbol||"*",u="";(0,tT.q4)(a-1,()=>{u+=h}),(0,n.uS)(e,u)}function tk(t,e,i,r,n,o,s){p.V.apply(this,[t,e,i,r,n,o,s])}function tx(t,e,i,r,n,o,s){p.V.apply(this,[t,e,i,r,n,o,s]),e.dir="ltr"}tM.RENDERER_TYPE="numeric",tO.RENDERER_TYPE="password",tk.RENDERER_TYPE="select",tx.RENDERER_TYPE="time";var tI=i(36903);function tA(t,e){let i=t;if(null==i&&(i=""),this.allowEmpty&&""===i){e(!0);return}this.strict&&this.source?"function"==typeof this.source?this.source(i,tN(i,e)):tN(i,e)(this.source):e(!0)}function tN(t,e){return function(i){let r=!1;for(let e=0,n=i.length;e<n;e++)if(t===i[e]){r=!0;break}e(r)}}function tH(t,e){let i=(0,ta.Jq)(Z,this.instance),r=t,n=!0;null==r&&(r="");let o=R(r,this.dateFormat||i.defaultDateFormat,!0).isValid(),s=R(new Date(r)).isValid()||o;if(this.allowEmpty&&""===r&&(s=!0,o=!0),s||(n=!1),!s&&o&&(n=!0),s&&!o){if(!0===this.correctFormat){let t=function(t,e){let i=R(function(t){let e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}(t)),r=R(t,e),n=t.search(/[A-z]/g)>-1;return(i.isValid()&&i.format("x")===r.format("x")||!r.isValid()||n?i:r).format(e)}(r,this.dateFormat),e=this.instance.toVisualRow(this.row),i=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,i,t,"dateValidator"),n=!0}else n=!1}e(n)}function t_(t,e){tA.apply(this,[t,e])}function tP(t,e){let i=t;null==i&&(i=""),e(!!this.allowEmpty&&""===i||""!==i&&(0,tT.kE)(t))}tA.VALIDATOR_TYPE="autocomplete",tH.VALIDATOR_TYPE="date",t_.VALIDATOR_TYPE="dropdown",tP.VALIDATOR_TYPE="numeric";let tD=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function tL(t,e){let i=this.timeFormat||"h:mm:ss a",r=!0,n=t;null===n&&(n=""),n=/^\d{3,}$/.test(n)?parseInt(n,10):n;let o=/^\d{1,2}$/.test(n);o&&(n+=":00");let s=R(n,tD,!0).isValid()?R(n):R(n,i),l=s.isValid(),a=R(n,i,!0).isValid()&&!o;if(this.allowEmpty&&""===n&&(l=!0,a=!0),l||(r=!1),!l&&a&&(r=!0),l&&!a){if(!0===this.correctFormat){let t=s.format(i),e=this.instance.toVisualRow(this.row),n=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(e,n,t,"timeValidator"),r=!0}else r=!1}e(r)}tL.VALIDATOR_TYPE="time";var tB=i(92740);let tW={CELL_TYPE:"autocomplete",editor:C,renderer:td,validator:tA},tV={CELL_TYPE:"checkbox",editor:E,renderer:tC};function tF(t,e,i,r,n,o,s){td.apply(this,[t,e,i,r,n,o,s])}tF.RENDERER_TYPE="date";let tj={CELL_TYPE:"date",editor:Q,renderer:tF,validator:tH},tU={CELL_TYPE:"dropdown",editor:te,renderer:tg,validator:t_},t$={CELL_TYPE:"handsontable",editor:h,renderer:tE},tz={CELL_TYPE:"numeric",editor:ti,renderer:tM,validator:tP,dataType:"number"},tK={CELL_TYPE:"password",editor:tr,renderer:tO,copyable:!1},tG={CELL_TYPE:"select",editor:ts,renderer:tk};var tY=i(1518);let tX={CELL_TYPE:"time",editor:tl,renderer:tx,validator:tL};var tq=i(36324),tZ=i(55915);function tJ(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function tQ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function t0(t,e){var i=function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return e.get(t)}(t,e,0);return i.get?i.get.call(t):i.value}let t1=new Map([["plugin",tZ._j],["cell-type",tq.V1],["editor",ta.Wu],["renderer",tI.Y3],["validator",tB.oh]]),t2=[],t4=null;var t5=new WeakMap,t8=new WeakSet;class t9{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(t){tJ(this,t8),t8.add(this),tQ(this,"eventManager",new tc.Z(this)),tQ(this,"pluginName",null),tQ(this,"pluginsInitializedCallbacks",[]),tQ(this,"isPluginsReady",!1),tQ(this,"enabled",!1),tQ(this,"initialized",!1),tJ(this,t5),t5.set(this,{writable:!0,value:{}}),(0,s.jW)(this,"hot",t,{writable:!1}),t4=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);let t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){let t=[];if(e.forEach(e=>{let[i,r]=e.split(":");if(!t1.has(i))throw Error(`Unknown plugin dependency type "${i}" was found.`);t1.get(i)(r)||t.push(` - ${r} (${i})`)}),t.length>0){let e=`The ${this.pluginName} plugin requires the following modules:
${t.join("\n")}
`;t2.push(e)}}t4||(t4=(0,tZ.a9)()),t4.indexOf("UndoRedo")>=0&&t4.splice(t4.indexOf("UndoRedo"),1),t4.indexOf(this.pluginName)>=0&&t4.splice(t4.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()});let i=0===t4.length;if(i){if(t2.length>0){let t=`${t2.join("\n")}
You have to import and register them manually.`;throw Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}addHook(t,e){t0(this,t5)[t]=t0(this,t5)[t]||[];let i=t0(this,t5)[t];this.hot.addHook(t,e),i.push(e),t0(this,t5)[t]=i}removeHooks(t){(0,u.Bk)(t0(this,t5)[t]||[],e=>{this.hot.removeHook(t,e)})}clearHooks(){let t=t0(this,t5);(0,s._l)(t,(t,e)=>this.removeHooks(e)),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){(0,u.Bk)(this.pluginsInitializedCallbacks,t=>t()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){let e=(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,t8,t3).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),(0,s._l)(this,(t,e)=>{"hot"!==e&&(this[e]=null)}),delete this.t,delete this.hot}}function t3(t){if(!t)return!1;let e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(let i=0;i<e.length;i++)if(void 0!==t[e[i]])return!0;return!1}var t7=i(60973);function t6(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var et=class{constructor(t){t6(this,"hot",null),t6(this,"container",null),t6(this,"injected",!1),t6(this,"rows",[]),t6(this,"columns",[]),t6(this,"samples",null),t6(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={row:t};this.rows.push(i),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(t){let e=this.hot.getColHeader(0);if(null!=e){let e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={col:t};this.columns.push(i),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(t){this.injected||this.injectTable(),(0,u.Bk)(this.rows,e=>{t(e.row,(0,n.Pb)(e.table)-1)})}getWidths(t){this.injected||this.injectTable(),(0,u.Bk)(this.columns,e=>{let{width:i}=e.table.getBoundingClientRect();t(e.col,Math.ceil(i))})}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){let e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{(0,u.Bk)(i.strings,i=>{e.appendChild(this.createColElement(i.col,t))})}),e}createRow(t){let{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,r),i.appendChild(r)),this.samples.forEach(r=>{(0,u.Bk)(r.strings,r=>{let n=r.col,o=this.hot.getCellMeta(t,n);o.col=n,o.row=t;let s=this.hot.getCellRenderer(o),l=e.createElement("td");l.setAttribute("ghost-table",1),s(this.hot,l,t,n,this.hot.colToProp(n),r.value,o),i.appendChild(l)})}),i}appendColumnHeadersRow(){let{rootDocument:t}=this.hot,e=t.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){let r=t.createElement("th");i.push([-1,r]),e.appendChild(r)}this.samples.forEach(r=>{(0,u.Bk)(r.strings,r=>{let n=r.col,o=t.createElement("th");i.push([n,o]),e.appendChild(o)})}),this.table.tHead.appendChild(e),(0,u.Bk)(i,t=>{let[e,i]=t;this.hot.view.appendColHeader(e,i)})}createCol(t){let{rootDocument:e}=this.hot,i=e.createDocumentFragment();return this.samples.forEach(r=>{(0,u.Bk)(r.strings,r=>{let n=r.row,o=this.hot.getCellMeta(n,t);o.col=t,o.row=n;let s=this.hot.getCellRenderer(o),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),s(this.hot,l,n,t,this.hot.colToProp(t),r.value,o),a.appendChild(l),i.appendChild(a)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){let i=this.hot.rootDocument.createElement("col"),r=0;e>=0&&t>=0&&(r=this.hot.getCellMeta(e,t).colspan);let n=this.hot.view._wt.wtTable.getStretchedColumnWidth(t);if(r>1)for(let e=t+1;e<t+r;e++)n+=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);return i.style.width=`${n}px`,i}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("table"),o=e.createElement("thead"),s=e.createElement("tbody"),l=e.createElement("colgroup"),a=e.createElement("tr"),h=e.createElement("th");return this.isVertical()&&r.appendChild(l),this.isHorizontal()&&(a.appendChild(h),o.appendChild(a),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&s.appendChild(a),r.appendChild(s),(0,n.cn)(r,t),i.appendChild(r),{fragment:i,table:r,tHead:o,tBody:s,colGroup:l,tr:a,th:h}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("div"),o=`htGhostTable htAutoSize ${t.trim()}`;return(0,n.cn)(r,o),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function ee(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ei{static get SAMPLE_COUNT(){return 3}constructor(t){ee(this,"samples",null),ee(this,"dataFactory",null),ee(this,"customSampleCount",null),ee(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:ei.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,i){let r=new Map,{from:n,to:o}="number"==typeof i?{from:i,to:i}:i;return(0,tT.q4)(n,o,i=>{let n=this.generateSample(t,e,i);r.set(i,n)}),r}generateSample(t,e,i){if("row"!==t&&"col"!==t)throw Error("Unsupported sample type");let r=new Map,n="row"===t?"col":"row",o=[];return(0,tT.q4)(e.from,e.to,e=>{let l;let a="row"===t?this.dataFactory(i,e):this.dataFactory(e,i);if(!1===a)return;let{value:h,bundleSeed:u}=a,d="string"==typeof u&&u.length>0;l=d?u:(0,s.Kn)(h)?`${Object.keys(h).length}`:Array.isArray(h)?`${h.length}`:`${(0,c.Pz)(h).length}`,r.has(l)||r.set(l,{needed:this.getSampleCount(),strings:[]});let g=r.get(l);if(g.needed){let t=o.indexOf(h)>-1;(!t||this.allowDuplicates||d)&&(g.strings.push({value:h,[n]:e}),o.push(h),g.needed-=1)}}),r}}var er=i(27431),en=i(45843);function eo(t,e){es(t,e),e.add(t)}function es(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function el(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ea(t,e){var i=eh(t,e,"get");return i.get?i.get.call(t):i.value}function eh(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function eu(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}tt.Z.getSingleton().register("modifyAutoColumnSizeSeed");let ec="autoColumnSize";var ed=new WeakMap,eg=new WeakSet,ef=new WeakSet,ep=new WeakSet,em=new WeakSet,ew=new WeakSet,ev=new WeakSet;class eb extends t9{static get PLUGIN_KEY(){return ec}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),eo(this,ev),eo(this,ew),eo(this,em),eo(this,ep),eo(this,ef),eo(this,eg),el(this,"ghostTable",new et(this.hot)),el(this,"samplesGenerator",new ei((t,e)=>{let i=this.hot.getCellMeta(t,e),r="";i.spanned||(r=this.hot.getDataAtCell(t,e));let n="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(n=this.hot.runHooks("modifyAutoColumnSizeSeed",n,i,r)),{value:r,bundleSeed:n}})),el(this,"firstCalculation",!0),el(this,"inProgress",!1),el(this,"measuredColumns",0),el(this,"columnWidthsMap",new en.L),es(this,ed),ed.set(this,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(t,e,i)=>eu(this,em,eE).call(this,t,e,i))}isEnabled(){return!1!==this.hot.getSettings()[ec]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[ec];e&&null!==e.useHeaders&&void 0!==e.useHeaders&&this.ghostTable.setSetting("useHeaders",e.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return eu(t,ef,eC).call(t,...i)}),this.addHook("beforeChangeRender",t=>eu(this,ep,eS).call(this,t)),this.addHook("afterFormulasValuesUpdate",t=>eu(this,ev,eT).call(this,t)),this.addHook("beforeViewRender",t=>eu(this,eg,ey).call(this,t)),this.addHook("modifyColWidth",(t,e)=>this.getColumnWidth(e,t)),this.addHook("afterInit",()=>eu(this,ew,eR).call(this)),super.enablePlugin()}updatePlugin(){let t=this.findColumnsWhereHeaderWasChanged();t.length&&(this.clearCache(t),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(t,e,i)=>eu(this,em,eE).call(this,t,e,i))}calculateVisibleColumnsWidth(){let t=this.hot.countRows();if(!t)return;let e=this.hot.renderCall,i=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();-1!==i&&-1!==r&&this.calculateColumnsWidth({from:i,to:r},void 0,e)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof t?{from:t,to:t}:t,n="number"==typeof e?{from:e,to:e}:e;(0,tT.q4)(r.from,r.to,t=>{let e=this.hot.toPhysicalColumn(t);if(null===e&&(e=t),i||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e)){let e=this.samplesGenerator.generateColumnSamples(t,n);(0,u.Bk)(e,t=>{let[e,i]=t;return this.ghostTable.addColumn(e,i)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{let i=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(i,e)})},!0),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=0,i=this.hot.countCols()-1,r=null;this.inProgress=!0;let n=()=>{if(!this.hot){(0,t7.Wx)(r),this.inProgress=!1;return}this.calculateColumnsWidth({from:e,to:Math.min(e+eb.CALCULATION_STEP,i)},t),(e=e+eb.CALCULATION_STEP+1)<i?r=(0,t7.U7)(n):((0,t7.Wx)(r),this.inProgress=!1,this.hot.view.adjustElementsSize())},o=this.getSyncCalculationLimit();this.firstCalculation&&o>=0&&(this.calculateColumnsWidth({from:0,to:o},t),this.firstCalculation=!1,e=o+1),e<i?n():this.inProgress=!1}setSamplingOptions(){let t=this.hot.getSettings()[ec],e=t&&(0,s.nr)(t,"samplingRatio")?t.samplingRatio:void 0,i=t&&(0,s.nr)(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){let t=this.hot.getSettings()[ec],e=eb.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return(0,s.Kn)(t)&&(e=t.syncLimit,(0,d.wK)(e)?e=(0,tT.N1)(i,e):e>>=0),Math.min(e,i)}getColumnWidth(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=e;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),i&&"number"==typeof r&&(r=Math.max(r,er.E.DEFAULT_WIDTH))),r}getFirstVisibleColumn(){let t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){let e=t.wtTable.getFirstVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){let e=t.wtTable.getFirstRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return -1}getLastVisibleColumn(){let t=this.hot.view._wt;if(t.wtViewport.columnsVisibleCalculator){let e=t.wtTable.getLastVisibleColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}if(t.wtViewport.columnsRenderCalculator){let e=t.wtTable.getLastRenderedColumn();if(-1!==e)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(e)}return -1}findColumnsWhereHeaderWasChanged(){let t=this.hot.getColHeader(),e=(0,u.k$)(t,(t,e,i)=>{let r=ea(this,ed).length;return(r-1<i||ea(this,ed)[i]!==e)&&t.push(i),r-1<i?ea(this,ed).push(e):ea(this,ed)[i]=e,t},[]);return e}clearCache(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];t.length?this.hot.batchExecution(()=>{(0,u.Bk)(t,t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!(0,u.w7)(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),t=>null===t).length}destroy(){this.ghostTable.clean(),super.destroy()}}function ey(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function eC(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function eS(t){let e=(0,u.Sc)(t,t=>{let[,e]=t;return this.hot.toPhysicalColumn(this.hot.propToCol(e))});this.clearCache(Array.from(new Set(e)))}function eE(t,e,i){let r=t;return i&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function eR(){var t;t=this.hot.getColHeader(),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,eh(this,ed,"set"),t)}function eT(t){let e=(0,u.w7)(t,t=>{var e;return(0,c.$K)(null===(e=t.address)||void 0===e?void 0:e.col)}),i=(0,u.Sc)(e,t=>t.address.col);this.clearCache(Array.from(new Set(i)))}let eM={horizontal:"horizontal",vertical:"vertical"};function eO(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function ek(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ex(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}tt.Z.getSingleton().register("modifyAutofillRange"),tt.Z.getSingleton().register("beforeAutofill"),tt.Z.getSingleton().register("afterAutofill");let eI="autofill",eA=["fillHandle"];var eN=new WeakSet,eH=new WeakSet,e_=new WeakSet,eP=new WeakSet,eD=new WeakSet;class eL extends t9{constructor(){super(...arguments),eO(this,eD),eO(this,eP),eO(this,e_),eO(this,eH),eO(this,eN),ek(this,"addingStarted",!1),ek(this,"mouseDownOnCellCorner",!1),ek(this,"mouseDragOutside",!1),ek(this,"handleDraggedCells",0),ek(this,"directions",[]),ek(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return eI}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[eI,...eA]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",t=>ex(this,eH,eW).call(this,t)),this.addHook("afterOnCellCornerDblClick",t=>ex(this,eN,eB).call(this,t)),this.addHook("beforeOnCellMouseOver",(t,e)=>ex(this,e_,eV).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let t=this.hot.getSelectedRangeLast(),{row:e,col:i}=t.getTopStartCorner(),{row:r,col:n}=t.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:i,endRow:r,endCol:n}]),s=[],l=[],a=[];return(0,u.Bk)(o,t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===s.indexOf(e)&&s.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===l.indexOf(e)&&l.push(e)}),(0,u.Bk)(s,t=>{let e=[];(0,u.Bk)(l,i=>{e.push(this.hot.getCopyableData(t,i))}),a.push(e)}),a}fillIn(){var t;let e,i,r;if(this.hot.selection.highlight.getFill().isEmpty())return!1;let[n,o,s,l]=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.getSelectedRangeLast(),h=a.getTopStartCorner(),u=a.getBottomEndCorner();this.resetSelectionOfDraggedArea();let c=[h.row,h.col,u.row,u.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,n),Math.min(h.col,o),Math.max(u.row,s),Math.max(u.col,l)],c),{directionOfDrag:g,startOfDragCoords:f,endOfDragCoords:p}=(t=(t,e)=>this.hot._createCellCoords(t,e),d[0]===c[0]&&d[1]<c[1]?(r="left",e=t(d[0],d[1]),i=t(d[2],c[1]-1)):d[2]===c[2]&&d[0]===c[0]&&d[3]>c[3]?(r="right",e=t(d[0],c[3]+1),i=t(d[2],d[3])):d[0]<c[0]&&d[1]===c[1]?(r="up",e=t(d[0],d[1]),i=t(c[0]-1,d[3])):d[2]>c[2]&&d[1]===c[1]&&(r="down",e=t(c[2]+1,d[1]),i=t(d[2],d[3])),e&&e.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:e,endOfDragCoords:i});if(f&&f.row>-1&&f.col>-1){let t=this.getSelectionData(),e=a.clone(),i=this.hot._createCellRange(f,f,p),r=this.hot.runHooks("beforeAutofill",t,e,i,g);if(!1===r)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let n=r;if(["up","left"].indexOf(g)>-1&&!(1===r.length&&0===r[0].length)){if(n=[],"up"===g){let t=p.row-f.row+1,e=t%r.length;for(let i=0;i<t;i++)n.push(r[(i+(r.length-e))%r.length])}else{let t=p.col-f.col+1,e=t%r[0].length;for(let i=0;i<r.length;i++){n.push([]);for(let o=0;o<t;o++)n[i].push(r[i][(o+(r[i].length-e))%r[i].length])}}}this.hot.populateFromArray(f.row,f.col,n,p.row,p.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",n,e,i,g),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){let e=this.hot.getSelectedRangeLast(),i=e.getBottomEndCorner(),r=t;if(this.directions.includes(eM.vertical)&&this.directions.includes(eM.horizontal)){let n=e.getTopStartCorner();(i.col<=t.col||n.col>=t.col)&&(r=this.hot._createCellCoords(i.row,t.col)),(i.row<t.row||n.row>t.row)&&(r=this.hot._createCellCoords(t.row,i.col))}else if(this.directions.includes(eM.vertical))r=this.hot._createCellCoords(t.row,i.col);else{if(!this.directions.includes(eM.horizontal))return;r=this.hot._createCellCoords(i.row,t.col)}return this.reduceSelectionAreaIfNeeded(r)}showBorder(t){let e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){let t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();t[2]<i-1&&e[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){let e;let i=this.hot.getData(),r=this.hot.countRows();for(let n=t[2]+1;n<r;n++){for(let e=t[1];e<=t[3];e++){let t=i[n][e];if(t)return -1}let r=i[n][t[1]-1],o=i[n][t[3]+1];(r||o)&&(e=n)}return e}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...(0,u.Sc)(t,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){let t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return -1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){let{documentElement:e}=this.hot.rootDocument,i=(0,n.cv)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+(0,n.Pb)(this.hot.table),r=(0,n.cv)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+(0,n.iO)(this.hot.table);return t.clientY>i&&t.clientX<=r}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",()=>ex(this,eP,eF).call(this)),this.eventManager.addEventListener(t,"mousemove",t=>ex(this,eD,ej).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){let t=function(t){let e={};return!0===t?(e.directions=Object.keys(eM),e.autoInsertRow=!0):(0,s.Kn)(t)?((0,c.$K)(t.autoInsertRow)?t.direction===eM.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,(0,c.$K)(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(eM)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}function eB(){let t=this.selectAdjacent();t&&this.fillIn()}function eW(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function eV(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function eF(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function ej(t){let e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function eU(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function e$(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ez(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let eK="autoRowSize";var eG=new WeakSet,eY=new WeakSet,eX=new WeakSet,eq=new WeakSet;class eZ extends t9{static get PLUGIN_KEY(){return eK}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),eU(this,eq),eU(this,eX),eU(this,eY),eU(this,eG),e$(this,"headerHeight",null),e$(this,"ghostTable",new et(this.hot)),e$(this,"samplesGenerator",new ei((t,e)=>{let i;if(t>=0&&e>=0){let i=this.hot.getCellMeta(t,e);if(i.hidden)return!1}return t>=0?i=this.hot.getDataAtCell(t,e):-1===t&&(i=this.hot.getColHeader(e)),{value:i}})),e$(this,"firstCalculation",!0),e$(this,"inProgress",!1),e$(this,"measuredRows",0),e$(this,"rowHeightsMap",new en.L),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",(t,e,i)=>ez(this,eY,eQ).call(this,t,e,i))}isEnabled(){let t=this.hot.getSettings()[eK];return!0===t||(0,s.Kn)(t)}enablePlugin(){var t=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ez(t,eX,e0).call(t,...i)}),this.addHook("beforeChangeRender",t=>ez(this,eq,e1).call(this,t)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",t=>ez(this,eG,eJ).call(this,t)),this.addHook("modifyRowHeight",(t,e)=>this.getRowHeight(e,t)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(t,e,i)=>ez(this,eY,eQ).call(this,t,e,i))}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof t?{from:t,to:t}:t,n="number"==typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){let t=this.samplesGenerator.generateRowSamples(-1,n);this.ghostTable.addColumnHeadersRow(t.get(-1))}(0,tT.q4)(r.from,r.to,t=>{if(i||null===this.rowHeightsMap.getValueAtIndex(t)){let e=this.samplesGenerator.generateRowSamples(t,n);(0,u.Bk)(e,t=>{let[e,i]=t;return this.ghostTable.addRow(e,i)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=0,i=this.hot.countRows()-1,r=null;this.inProgress=!0;let n=()=>{if(!this.hot){(0,t7.Wx)(r),this.inProgress=!1;return}this.calculateRowsHeight({from:e,to:Math.min(e+eZ.CALCULATION_STEP,i)},t),(e=e+eZ.CALCULATION_STEP+1)<i?r=(0,t7.U7)(n):((0,t7.Wx)(r),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},o=this.getSyncCalculationLimit();this.firstCalculation&&o>=0&&(this.calculateRowsHeight({from:0,to:o},t),this.firstCalculation=!1,e=o+1),e<i?n():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){let t=this.hot.getSettings()[eK],e=t&&(0,s.nr)(t,"samplingRatio")?t.samplingRatio:void 0,i=t&&(0,s.nr)(t,"allowSampleDuplicates")?t.allowSampleDuplicates:void 0;e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),i&&this.samplesGenerator.setAllowDuplicates(i)}recalculateAllRowsHeight(){(0,n.pn)(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){let t=this.hot.getSettings()[eK],e=eZ.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return(0,s.Kn)(t)&&(e=t.syncLimit,(0,d.wK)(e)?e=(0,tT.N1)(i,e):e>>=0),Math.min(e,i)}getRowHeight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t)),r=e;return null!==i&&i>(e||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){let t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getFirstVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){let t=this.hot.view._wt;return t.wtViewport.rowsVisibleCalculator?t.wtTable.getLastVisibleRow():t.wtViewport.rowsRenderCalculator?t.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(t){let{from:e,to:i}="number"==typeof t?{from:t,to:t}:t;this.hot.batchExecution(()=>{(0,tT.q4)(Math.min(e,i),Math.max(e,i),t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0)}isNeedRecalculate(){return!!(0,u.w7)(this.rowHeightsMap.getValues().slice(0,this.measuredRows),t=>null===t).length}destroy(){this.ghostTable.clean(),super.destroy()}}function eJ(){let t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,i=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(-1!==i&&-1!==r){if(this.calculateRowsHeight({from:i,to:r},void 0,t),e){let t=this.hot.countRows()-1;this.calculateRowsHeight({from:t-e,to:t})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function eQ(t,e,i){let r=t;return i&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function e0(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function e1(t){let e=null;1===t.length?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),null!==e&&this.clearCacheByRange(e)}var e2=i(97362),e4=i(5354);let e5=new Map([["indexesSequence",{getListWithInsertedItems:e2.S,getListWithRemovedItems:e2.t}],["physicallyIndexed",{getListWithInsertedItems:e4.S,getListWithRemovedItems:e4.t}]]),e8=t=>{if(!1===e5.has(t))throw Error(`Alter strategy with ID '${t}' does not exist.`);return e5.get(t)};var e9=i(16301),e3=i(65724);let{getListWithInsertedItems:e7,getListWithRemovedItems:e6}=e8("physicallyIndexed");class it extends e9.n{constructor(){super(t=>t)}insert(t,e){let i=(0,e3.X)(this.indexedValues,e);this.indexedValues=e7(i,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){let e=e6(this.indexedValues,t);this.indexedValues=(0,e3.i)(e,t),super.remove(t)}}let{getListWithInsertedItems:ie,getListWithRemovedItems:ii}=e8("physicallyIndexed");class ir extends e9.n{constructor(){super(t=>t)}insert(t,e){this.indexedValues=ie(this.indexedValues,t,e,(t,e)=>this.getNextValue(e)),super.insert(t,e)}remove(t){this.indexedValues=ii(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}}let io="bindRowsWithHeaders",is=new Map([["loose",it],["strict",ir]]);var il=new WeakSet;class ia extends t9{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,il),il.add(this),(t="symbol"==typeof(e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="headerIndexes","string"))?e:String(e))in this?Object.defineProperty(this,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[t]=null}static get PLUGIN_KEY(){return io}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[io]}enablePlugin(){if(this.enabled)return;let t=this.hot.getSettings()[io];"string"!=typeof t&&(t="loose");let e=is.get(t);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",t=>(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,il,ih).call(this,t)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function ih(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}var iu=i(24748);function ic(t,e){id(t,e),e.add(t)}function id(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ig(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ip(t,e){var i=iv(t,e,"get");return i.get?i.get.call(t):i.value}function im(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function iw(t,e,i){var r=iv(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function iv(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}let ib="collapsibleColumns",iy=["nestedHeaders"],iC="collapsibleIndicator",iS=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var iE=new WeakMap,iR=new WeakSet,iT=new WeakSet,iM=new WeakSet,iO=new WeakSet;class ik extends t9{constructor(){super(...arguments),ic(this,iO),ic(this,iM),ic(this,iT),ic(this,iR),ig(this,"nestedHeadersPlugin",null),ig(this,"headerStateManager",null),id(this,iE),iE.set(this,{writable:!0,value:null})}static get PLUGIN_KEY(){return ib}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[ib,...iy]}isEnabled(){return!!this.hot.getSettings()[ib]}enablePlugin(){var t=this;if(this.enabled)return;let{nestedHeaders:e}=this.hot.getSettings();e||(0,iu.ZK)("You need to configure the Nested Headers plugin in order to use collapsible headers."),iw(this,iE,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>im(this,iM,iA).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return im(t,iO,iN).call(t,...i)}),this.addHook("afterGetColHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return im(t,iR,ix).call(t,...i)}),this.addHook("beforeOnCellMouseDown",(t,e,i)=>im(this,iT,iI).call(this,t,e,i)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){let{collapsibleColumns:t}=this.hot.getSettings();"boolean"==typeof t?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(t)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),iw(this,iE,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;let{row:e,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:n,columnIndex:o}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,i))&&void 0!==t?t:{};r&&(n?this.expandSection({row:e,col:o}):this.collapseSection({row:e,col:o}))},runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},group:ib})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ib)}clearButtons(){if(!this.hot.view)return;let t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,n=function(t){t&&t.parentNode.removeChild(t)};(0,tT.q4)(0,t-1,t=>{let o=e.childNodes[t],s=i.childNodes[t],l=r?r.childNodes[t]:null;(0,tT.q4)(0,o.childNodes.length-1,t=>{let e=o.childNodes[t].querySelector(`.${iC}`);n(e),s&&s.childNodes[t]&&n(e=s.childNodes[t].querySelector(`.${iC}`)),r&&l&&l.childNodes[t]&&n(e=l.childNodes[t].querySelector(`.${iC}`))})},!0)}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){let e=this.headerStateManager.mapNodes(e=>{let{collapsible:i,origColspan:r,headerLevel:n,columnIndex:o,isCollapsed:s}=e;if(!0===i&&r>1&&(s&&"expand"===t||!s&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(n),col:o}});this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!iS.has(e))throw Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;let i=(0,u.w7)(t,t=>{let{row:e}=t;return e<0}),r=i.length>0;(0,u.Bk)(i,t=>{var i;let{row:n,col:o}=t,{collapsible:s,isCollapsed:l}=null!==(i=this.headerStateManager.getHeaderSettings(n,o))&&void 0!==i?i:{};if(!s||l&&"collapse"===e||!l&&"expand"===e)return r=!1,!1});let n=[],o=[];r&&(0,u.Bk)(i,t=>{let{row:i,col:r}=t,{colspanCompensation:s,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(e,i,r);s>0&&(o.push(...l),n.push(a))});let s=this.getCollapsedColumns(),l=[];"collapse"===e?l=(0,u.uW)([...s,...o]):"expand"===e&&(l=(0,u.w7)(s,t=>!o.includes(t)));let a=iS.get(e),h=this.hot.runHooks(a.beforeHook,s,l,r);if(!1===h){(0,u.Bk)(n,t=>{t()});return}this.hot.batchExecution(()=>{(0,u.Bk)(o,t=>{ip(this,iE).setValueAtIndex(this.hot.toPhysicalColumn(t),a.hideColumn)})},!0);let c=this.getCollapsedColumns().length!==s.length;this.hot.runHooks(a.afterHook,s,l,r,c),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return ip(this,iE).getHiddenIndexes()}destroy(){iw(this,iE,null),super.destroy()}}function ix(t,e,i){var r,o;let{collapsible:s,origColspan:l,isCollapsed:a}=null!==(r=this.headerStateManager.getHeaderSettings(i,t))&&void 0!==r?r:{},h=s&&l>1&&t>=this.hot.getSettings().fixedColumnsStart,u=this.hot.getSettings().ariaTags,c=e.querySelector(`.${iC}`);(0,n.d$)(e,[(0,m.JV)("")[0]]),h?(c||(c=this.hot.rootDocument.createElement("div"),(0,n.cn)(c,iC),e.querySelector("div:first-child").appendChild(c)),(0,n.IV)(c,["collapsed","expanded"]),a?((0,n.cn)(c,"collapsed"),(0,n.tT)(c,"+"),u&&(0,n.P$)(e,...(0,m.JV)(!1))):((0,n.cn)(c,"expanded"),(0,n.tT)(c,"-"),u&&(0,n.P$)(e,...(0,m.JV)(!0))),u&&(0,n.P$)(c,...(0,m.cV)())):null===(o=c)||void 0===o||o.remove()}function iI(t,e){(0,n.pv)(t.target,iC)&&((0,n.pv)(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):(0,n.pv)(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),(0,o.mM)(t))}function iA(){this.updatePlugin()}function iN(t,e){e||this.updatePlugin()}var iH=i(98179),i_=i(42457),iP=i(537);function iD(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let iL=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class iB{constructor(t,e){iD(this,"hot",void 0),iD(this,"sortingStates",new iP.A),iD(this,"sortEmptyCells",!1),iD(this,"indicator",!0),iD(this,"headerAction",!0),iD(this,"compareFunctionFactory",void 0),iD(this,"mapName",void 0),this.hot=t,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){(0,s.Kn)(t)&&(0,s._l)(t,(t,e)=>{iL.includes(e)&&(this[e]=t)})}getAllColumnsProperties(){let t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex(e=>{let[i]=e;return i===t})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return(0,s.Kn)(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){if(null===this.sortingStates)return[];let t=this.sortingStates.getEntries();return t.map(t=>{let[e,i]=t;return{column:this.hot.toVisualColumn(e),...i}})}getColumnSortState(t){let e=this.getSortOrderOfColumn(t);if((0,c.$K)(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}let iW="desc",iV="colHeader";function iF(t){return t===iW?void 0:"asc"===t?iW:"asc"}function ij(t){let e=t.querySelector(`.${iV}`);return e}function iU(t,e){if(t<0||!e.parentNode)return!1;let i=e.parentNode.parentNode.childNodes,r=Array.from(i).indexOf(e.parentNode)-i.length;return -1===r}function i$(t,e,i){return -1===t&&e>=0&&!1===(0,o.dO)(i)}let iz="indicatorDisabled",iK="columnSorting",iG="sortAction",iY=new Map([["asc","ascending"],[iW,"descending"]]);function iX(t,e,i){let r=e.locale;return function(e,n){let{sortEmptyCells:o}=i;return("string"==typeof e&&(e=e.toLocaleLowerCase(r)),"string"==typeof n&&(n=n.toLocaleLowerCase(r)),e===n)?0:(0,c.xb)(e)?(0,c.xb)(n)?0:o&&"asc"===t?-1:1:(0,c.xb)(n)?o&&"asc"===t?1:-1:isNaN(e)&&!isNaN(n)?"asc"===t?1:-1:!isNaN(e)&&isNaN(n)?"asc"===t?-1:1:(isNaN(e)||isNaN(n)||(e=parseFloat(e),n=parseFloat(n)),e<n)?"asc"===t?-1:1:e>n?"asc"===t?1:-1:0}}let iq="default";var iZ=i(82656);let{register:iJ,getItem:iQ,hasItem:i0}=(0,iZ.Z)("sorting.compareFunctionFactory"),{register:i1,getItem:i2}=(0,iZ.Z)("sorting.mainSortComparator");function i4(t){return i0(t)?iQ(t):iQ(iq)}function i5(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function i8(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function i9(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}iJ("numeric",function(t,e,i){return function(e,r){let n=parseFloat(e),o=parseFloat(r),{sortEmptyCells:s}=i;if(n===o||isNaN(n)&&isNaN(o))return 0;if(s){if((0,c.xb)(e))return"asc"===t?-1:1;if((0,c.xb)(r))return"asc"===t?1:-1}return isNaN(n)?1:isNaN(o)?-1:n<o?"asc"===t?-1:1:n>o?"asc"===t?1:-1:0}}),iJ("checkbox",function(t,e,i){let r=e.checkedTemplate,n=e.uncheckedTemplate,{sortEmptyCells:o}=i;return function(s,l){let a=(0,c.xb)(s),h=(0,c.xb)(l),u=a?n:s,d=h?n:l,g=u===n||u===r,f=d===n||d===r;if(!1===o){if(a&&!1===h)return 1;if(!1===a&&h)return -1}return!1===g&&f?"asc"===t?-1:1:g&&!1===f?"asc"===t?1:-1:!1===g&&!1===f?iX(t,e,i)(s,l):u===n&&d===r?"asc"===t?-1:1:u===r&&d===n?"asc"===t?1:-1:0}}),iJ("date",function(t,e,i){return function(r,n){let{sortEmptyCells:o}=i;if(r===n)return 0;if((0,c.xb)(r))return(0,c.xb)(n)?0:o&&"asc"===t?-1:1;if((0,c.xb)(n))return o&&"asc"===t?1:-1;let s=e.dateFormat,l=R(r,s),a=R(n,s);return l.isValid()?a.isValid()?a.isAfter(l)?"asc"===t?-1:1:a.isBefore(l)?"asc"===t?1:-1:0:-1:1}}),iJ(iq,iX);let i3="columnSorting",i7="append";i1(i3,function(t,e){return function(i,r){let[,...n]=i,[,...o]=r;return function(i){let r=t[i],s=e[i],l=n[i],a=o[i],h=s.columnSorting,u=h.compareFunctionFactory?h.compareFunctionFactory:i4(s.type),c=u(r,s,h)(l,a);return c}(0)}}),tt.Z.getSingleton().register("beforeColumnSort"),tt.Z.getSingleton().register("afterColumnSort");var i6=new WeakSet,rt=new WeakSet,re=new WeakSet,ri=new WeakSet;class rr extends t9{constructor(){super(...arguments),i5(this,ri),i5(this,re),i5(this,rt),i5(this,i6),i8(this,"columnStatesManager",null),i8(this,"columnMetaCache",null),i8(this,"pluginKey",i3),i8(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return i3}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t=this;this.enabled||(this.columnStatesManager=new iB(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new en.L(t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,e)=>i9(this,rt,ro).call(this,t,e)),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return i9(t,ri,rl).call(t,...i)}),this.addHook("afterOnCellMouseDown",(t,e)=>this.onAfterOnCellMouseDown(t,e)),this.addHook("afterInit",()=>i9(this,i6,rn).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return i9(t,re,rs).call(t,...i)}),this.hot.view&&i9(this,i6,rn).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){let t=(t,e)=>{let i=ij(e);!1!==iU(t,e)&&null!==i&&this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",t)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();-1===t.row&&t.col>=0&&this.sort(this.getColumnNextConfig(t.col))},runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()},group:i3})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(i3)}sort(t){let e=this.getSortConfig(),i=this.getNormalizedSortConfigs(t),r=this.areValidSortConfigs(i),n=this.hot.runHooks("beforeColumnSort",e,i,r);!1!==n&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new i_.b),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",e,r?i:e,r),r&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return(0,c.$K)(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){let e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){let e=this.hot.countCols();return function(t){if(t.some(t=>!1===function(t){if(!1===(0,s.Kn)(t))return!1;let{column:e,sortOrder:i}=t;return Number.isInteger(e)&&["asc",iW].includes(i)}(t)))return!1;let e=t.map(t=>{let{column:e}=t;return e});return new Set(e).size===e.length}(t)&&t.every(t=>{let{column:i}=t;return i<=e&&i>=0})}saveAllSortSettings(t){let e=this.columnStatesManager.getAllColumnsProperties();e.initialConfig=(0,u.Sc)(t,t=>{let{column:e,...i}=t;return{column:this.hot.toPhysicalColumn(e),...i}}),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){let t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);let e=t.value;return(0,c.$K)(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=(0,u.Sc)(e.initialConfig,t=>{let{column:e,...i}=t;return{column:this.hot.toVisualColumn(e),...i}})),e}getColumnNextConfig(t){let e=this.columnStatesManager.getSortOrderOfColumn(t);if((0,c.$K)(e)){let i=iF(e);return(0,c.$K)(i)?{column:t,sortOrder:i}:void 0}let i=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<i)return{column:t,sortOrder:iF()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i7,i=this.columnStatesManager.getIndexOfColumnInSortQueue(t),r=-1!==i,n=this.getSortConfig(),o=this.getColumnNextConfig(t);if(r){if((0,c.o8)(o))return[...n.slice(0,i),...n.slice(i+1)];if(e===i7)return[...n.slice(0,i),...n.slice(i+1),o];if("replace"===e)return[...n.slice(0,i),o,...n.slice(i+1)]}return(0,c.$K)(o)?n.concat(o):n}getPluginColumnConfig(t){if((0,s.Kn)(t)){let e=t[this.pluginKey];if((0,s.Kn)(e))return e}return{}}getMergedPluginSettings(t){let e=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,t),n=Object.getPrototypeOf(r);return Array.isArray(n.columns)?Object.assign(i,e,this.getPluginColumnConfig(n.columns[t])):(0,iH.mf)(n.columns)?Object.assign(i,e,this.getPluginColumnConfig(n.columns(t))):Object.assign(i,e)}getFirstCellSettings(t){let e=this.hot.getCellMeta(0,t),i=Object.create(e);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),i}getNumberOfRowsToSort(t){let e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(0===t.length){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}let e=[],i=this.hot.countRows(),r=e=>(0,u.Sc)(t,t=>this.hot.getDataAtCell(e,t.column));for(let t=0;t<this.getNumberOfRowsToSort(i);t+=1)e.push([this.hot.toPhysicalRow(t)].concat(r(t)));let n=(0,u.Sc)(e,t=>t[0]);!function(t,e){let i=i2(e);for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];t.sort(i(...n))}(e,this.pluginKey,(0,u.Sc)(t,t=>t.sortOrder),(0,u.Sc)(t,t=>this.getFirstCellSettings(t.column)));for(let t=e.length;t<i;t+=1)e.push([t].concat(r(t)));let o=(0,u.Sc)(e,t=>t[0]),s=new Map((0,u.Sc)(n,(t,e)=>[t,o[e]])),l=(0,u.Sc)(this.hot.rowIndexMapper.getIndexesSequence(),t=>s.has(t)?s.get(t):t);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(t){if((0,s.Kn)(t)){this.columnStatesManager.updateAllColumnsProperties(t);let e=t.initialConfig;(Array.isArray(e)||(0,s.Kn)(e))&&this.sort(e)}else this.hot.render()}updateHeaderClasses(t){if((0,n.IV)(t,Array.from(iY.values()).concat(iG,iz,iK)),!1!==this.enabled){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];(0,n.cn)(t,function(t,e,i,r){let n=[iK];if(r&&n.push(iG),!1===i)return n.push(iz),n;let o=t.getSortOrderOfColumn(e);return(0,c.$K)(o)&&n.push(iY.get(o)),n}(...i))}}onUpdateSettings(t){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),(0,c.$K)(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}wasClickableHeaderClicked(t,e){let i=this.getFirstCellSettings(e)[this.pluginKey],r=i.headerAction;return r&&(0,n.pv)(t.target,iV)}onAfterOnCellMouseDown(t,e){!1!==i$(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col)),this.sort(this.getColumnNextConfig(e.col)))}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}function rn(){let t=this.getAllSavedSortSettings();if((0,s.Kn)(t))this.sortBySettings(t);else{let t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function ro(t,e){let i=ij(e);if(!1===iU(t,e)||null===i)return;let r=this.getFirstCellSettings(t)[this.pluginKey],o=r.indicator,s=r.headerAction;if(this.updateHeaderClasses(i,this.columnStatesManager,t,o,s),this.hot.getSettings().ariaTags){let i=this.columnStatesManager.getSortOrderOfColumn(t);(0,n.P$)(e,...(0,m.l_)(i?`${i}ending`:"none"))}}function rs(t){!0===t&&this.hot.view&&i9(this,i6,rn).call(this)}function rl(t,e,i,r){!1!==i$(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function ra(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var rh=class{constructor(t,e){ra(this,"plugin",void 0),ra(this,"hot",void 0),ra(this,"endpoints",[]),ra(this,"settings",void 0),ra(this,"settingsType","array"),ra(this,"currentEndpoint",null),ra(this,"cellsToSetCache",[]),this.plugin=t,this.hot=this.plugin.hot,this.settings=e}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){let e=[],i=t;if(!i&&"function"==typeof this.settings){this.settingsType="function";return}return i||(i=this.settings),(0,u.Bk)(i,t=>{let i={};this.assignSetting(t,i,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,i,"reversedRowCoords",!1),this.assignSetting(t,i,"destinationRow",Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(t,i,"destinationColumn",Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(t,i,"sourceColumn",t.destinationColumn),this.assignSetting(t,i,"type","sum"),this.assignSetting(t,i,"forceNumeric",!1),this.assignSetting(t,i,"suppressDataTypeErrors",!0),this.assignSetting(t,i,"customFunction",null),this.assignSetting(t,i,"readOnly",!0),this.assignSetting(t,i,"roundFloat",!1),e.push(i)}),e}assignSetting(t,e,i,r){if("ranges"===i&&void 0===t[i]){e[i]=r;return}if("ranges"!==i||0!==t[i].length){if(void 0===t[i]){if(r instanceof Error)throw r;e[i]=r}else"destinationRow"===i&&e.reversedRowCoords?e[i]=this.hot.countRows()-t[i]-1:e[i]=t[i]}}resetSetupBeforeStructureAlteration(t,e,i){if("function"!==this.settingsType)return;let r=t.indexOf("row")>-1?"row":"col",n=this.getAllEndpoints();(0,u.Bk)(n,n=>{"row"===r&&n.destinationRow>=e&&("insert_row"===t?n.alterRowOffset=i:"remove_row"===t&&(n.alterRowOffset=-1*i)),"col"===r&&n.destinationColumn>=e&&("insert_col"===t?n.alterColumnOffset=i:"remove_col"===t&&(n.alterColumnOffset=-1*i))}),this.resetAllEndpoints(n,!1)}resetSetupAfterStructureAlteration(t,e,i,r,n){let o=!(arguments.length>5)||void 0===arguments[5]||arguments[5];if("function"===this.settingsType){let t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",t);return}let s=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===t.indexOf("move_row");(0,u.Bk)(a,t=>{"row"===s&&t.destinationRow>=e&&(t.alterRowOffset=l*i),"col"===s&&t.destinationColumn>=e&&(t.alterColumnOffset=l*i)}),this.resetAllEndpoints(a,!h),h?(0,u.Bk)(a,t=>{this.extendEndpointRanges(t,e,r[0],r.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}):(0,u.Bk)(a,t=>{this.shiftEndpointCoordinates(t,e)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,i,r){(0,u.Bk)(t.ranges,t=>{t[1]&&(e>=t[0]&&e<=t[1]?i>t[1]?t[1]+=r:i<t[0]&&(t[0]-=r):i>=t[0]&&i<=t[1]&&(t[1]-=r,e<=t[0]&&(t[0]+=1,t[1]+=1)))})}recreatePhysicalRanges(t){let e=t.ranges,i=[],r=[];(0,u.Bk)(e,t=>{let e=[];if(t[1])for(let i=t[0];i<=t[1];i++)e.push(this.hot.toPhysicalRow(i));else e.push(this.hot.toPhysicalRow(t[0]));r.push(e)}),(0,u.Bk)(r,t=>{let e=[];(0,u.Bk)(t,(r,n)=>{0===n?e.push(r):t[n]!==t[n-1]+1&&(e.push(t[n-1]),i.push(e),(e=[]).push(r)),n===t.length-1&&(e.push(r),i.push(e))})}),t.ranges=i}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,(0,u.Bk)(t.ranges,i=>{(0,u.Bk)(i,(r,n)=>{r>=e&&(i[n]+=t.alterRowOffset||0)})})):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=t.some(t=>{let e=t.alterRowOffset||0,i=t.alterColumnOffset||0;return!!(t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+i>=this.hot.countCols())});i||(this.cellsToSetCache=[],(0,u.Bk)(t,t=>{this.resetEndpointValue(t,e)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],(0,u.Bk)(this.getAllEndpoints(),t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){let e=[];this.cellsToSetCache=[],(0,u.Bk)(t,(t,i,r)=>{`${t[2]||""}`!=`${t[3]}`&&(0,u.Bk)(this.getAllEndpoints(),(t,n)=>{this.hot.propToCol(r[i][1])===t.sourceColumn&&-1===e.indexOf(n)&&e.push(n)})}),(0,u.Bk)(e,t=>{this.refreshEndpoint(this.getEndpoint(t))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=t.alterRowOffset||0,r=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?i:0)),this.hot.toVisualColumn(t.destinationColumn+(e?r:0)),""])}setEndpointValue(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}let n=this.hot.toVisualRow(t.destinationRow);if(null!==n){let i=this.hot.getCellMeta(n,t.destinationColumn);("init"===e||i.readOnly!==t.readOnly)&&(i.readOnly=t.readOnly,i.className="columnSummaryResult")}if((!0===t.roundFloat||Number.isInteger(t.roundFloat))&&!isNaN(t.result)){let e=t.roundFloat,i=0;Number.isInteger(e)&&(i=Math.min(Math.max(0,e),100)),t.result=t.result.toFixed(i)}i?this.hot.setDataAtCell(r,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){(0,iu.ZK)("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}},ru=i(32836);function rc(t){return null==t||isNaN(t)}function rd(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function rg(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let rf="columnSummary";var rp=new WeakSet,rm=new WeakSet,rw=new WeakSet;class rv extends t9{constructor(){var t,e;super(...arguments),rd(this,rw),rd(this,rm),rd(this,rp),(t="symbol"==typeof(e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="endpoints","string"))?e:String(e))in this?Object.defineProperty(this,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[t]=null}static get PLUGIN_KEY(){return rf}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[rf]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[rf],this.endpoints=new rh(this,this.settings),this.addHook("afterInit",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return rg(t,rp,rb).call(t,...i)}),this.addHook("afterChange",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return rg(t,rm,ry).call(t,...i)}),this.addHook("beforeCreateRow",(t,e,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,i)),this.addHook("beforeCreateCol",(t,e,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,i)),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(t,e,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,i)),this.addHook("afterCreateCol",(t,e,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,i)),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return rg(t,rw,rC).call(t,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}calculateSum(t){let e=0;return(0,s._l)(t.ranges,i=>{e+=this.getPartialSum(i,t.sourceColumn)}),e}getPartialSum(t,e){let i=0,r=t[1]||t[0],n=null,o=0;do{if(null!==(n=rc(n=this.getCellValue(r,e))?null:n)){let t=(`${n}`.split(".")[1]||[]).length||1;t>o&&(o=t)}i+=n||0,r-=1}while(r>=t[0]);return Math.round(i*10**o)/10**o}calculateMinMax(t,e){let i=null;return(0,s._l)(t.ranges,r=>{let n=this.getPartialMinMax(r,t.sourceColumn,e);if(null===i&&null!==n&&(i=n),null!==n)switch(e){case"min":i=Math.min(i,n);break;case"max":i=Math.max(i,n)}}),null===i?"Not enough data":i}getPartialMinMax(t,e,i){let r,n=null,o=t[1]||t[0];do{if(r=rc(r=this.getCellValue(o,e))?null:r,null===n)n=r;else if(null!==r)switch(i){case"min":n=Math.min(n,r);break;case"max":n=Math.max(n,r)}o-=1}while(o>=t[0]);return n}countEmpty(t,e){let i;let r=0,n=t[1]||t[0];do null===(i=rc(i=this.getCellValue(n,e))?null:i)&&(r+=1),n-=1;while(n>=t[0]);return r}countEntries(t){let e=0,i=t.ranges;return(0,s._l)(i,i=>{let r=void 0===i[1]?1:i[1]-i[0]+1,n=this.countEmpty(i,t.sourceColumn);e+=r,e-=n}),e}calculateAverage(t){let e=this.calculateSum(t),i=this.countEntries(t);return e/i}getCellValue(t,e){let i=this.hot.toVisualRow(t),r=this.hot.toVisualColumn(e),n=this.hot.getSourceDataAtCell(t,e),o="";if(null!==i&&null!==r&&(o=this.hot.getCellMeta(i,r).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof n&&(n=n.replace(/,/,".")),n=parseFloat(n)),isNaN(n)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw Error(ru.e`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return n}}function rb(){this.endpoints.initEndpoints()}function ry(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}function rC(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function rS(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class rE{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){rS(this,"rootDocument",void 0),rS(this,"isRtl",!1),rS(this,"container",null),rS(this,"editor",void 0),rS(this,"editorStyle",void 0),rS(this,"hidden",!0),this.rootDocument=t,this.isRtl=e,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(t,e){this.editorStyle.left=`${t}px`,this.editorStyle.top=`${e}px`}setSize(t,e){if(t&&e){let i=this.getInputElement();i.style.width=`${t}px`,i.style.height=`${e}px`}}getSize(){return{width:(0,n.iO)(this.getInputElement()),height:(0,n.Pb)(this.getInputElement())}}resetSize(){let t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){let e=this.getInputElement();e.readOnly=t}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return"block"===this.editorStyle.display}setValue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.getInputElement().value=t||""}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){let t=this.rootDocument.createElement("div"),e=this.rootDocument.createElement("textarea");return t.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),(0,n.cn)(this.container,rE.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),(0,n.cn)(t,rE.CLASS_EDITOR),(0,n.cn)(e,rE.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),this.container.appendChild(t),t}getInputElement(){return this.editor.querySelector(`.${rE.CLASS_INPUT}`)}destroy(){let t=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,t&&t.removeChild(this.container)}}var rR=i(63437);function rT(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class rM{constructor(t){rT(this,"wasLastActionShow",!0),rT(this,"showDebounced",null),rT(this,"hidingTimer",null),this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},250)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=(0,iH.Ds)(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},t)}destroy(){this.clearLocalHooks()}}(0,s.jB)(rM,rR.Z);let rO="---------";function rk(t,e){let i={};return(0,u.Bk)(t,t=>{t.forAll((t,r)=>{t>=0&&r>=0&&(i[t]||(i[t]=[]),i[t][r]=e(t,r))})}),i}function rx(t,e,i,r,n){(0,u.Bk)(t,t=>{t.forAll((t,o)=>{t>=0&&o>=0&&function(t,e,i,r,n,o){let s=n(t,e),l=r;s.className&&(l="vertical"===i?function(t,e){if(-1!==t.indexOf(e))return t;let i=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${i} ${e}`}(s.className,r):function(t,e){if(-1!==t.indexOf(e))return t;let i=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${i} ${e}`}(s.className,r)),o(t,e,"className",l)}(t,o,e,i,r,n)})})}function rI(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function rA(t,e){let i=!1;return Array.isArray(t)&&(0,u.Bk)(t,t=>(t.forAll((t,r)=>{if(t>=0&&r>=0&&e(t,r))return i=!0,!1}),i)),i}function rN(t,e){let i={top:0,left:0};if(e!==t.ownerDocument){let{frameElement:t}=e.defaultView,{top:r,left:n}=t.getBoundingClientRect();i.top=r,i.left=n}return i}function rH(t,e){rP(t,e),e.add(t)}function r_(t,e,i){rP(t,e),e.set(t,i)}function rP(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function rD(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function rL(t,e,i){var r=rW(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function rB(t,e){var i=rW(t,e,"get");return i.get?i.get.call(t):i.value}function rW(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}let rV="comments",rF="comment",rj="value",rU="style",r$="readOnly",rz=`plugin:${rV}`;var rK=new WeakMap,rG=new WeakMap,rY=new WeakMap,rX=new WeakMap,rq=new WeakMap,rZ=new WeakMap,rJ=new WeakMap,rQ=new WeakSet,r0=new WeakSet,r1=new WeakSet,r2=new WeakSet,r4=new WeakSet,r5=new WeakSet,r8=new WeakSet,r9=new WeakSet,r3=new WeakSet,r7=new WeakSet;class r6 extends t9{constructor(){var t,e,i;super(...arguments),rH(this,r7),rH(this,r3),rH(this,r9),rH(this,r8),rH(this,r5),rH(this,r4),rH(this,r2),rH(this,r1),rH(this,r0),rH(this,rQ),e={},(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="range","string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,r_(this,rK,{writable:!0,value:null}),r_(this,rG,{writable:!0,value:null}),r_(this,rY,{writable:!0,value:!1}),r_(this,rX,{writable:!0,value:!1}),r_(this,rq,{writable:!0,value:{}}),r_(this,rZ,{writable:!0,value:null}),r_(this,rJ,{writable:!0,value:""})}static get PLUGIN_KEY(){return rV}static get PLUGIN_PRIORITY(){return 60}isEnabled(){return!!this.hot.getSettings()[rV]}enablePlugin(){this.enabled||(rB(this,rK)||rL(this,rK,new rE(this.hot.rootDocument,this.hot.isRtl())),rB(this,rG)||rL(this,rG,new rM(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,e,i,r,n,o)=>rD(this,r2,nr).call(this,t,o)),this.addHook("afterScroll",()=>rD(this,r7,nh).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>rD(this,r3,na).call(this,t)),rB(this,rG).addLocalHook("hide",()=>this.hide()),rB(this,rG).addLocalHook("show",(t,e)=>this.showAtCell(t,e)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){rB(this,rG).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("grid"),i=t.addContext(rz);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{let e=this.hot.getSelectedRangeLast();rL(this,rX,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(rz),this.hot._registerTimeout(()=>{rL(this,rX,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&!rB(this,rK).isVisible()},group:rV}),i.addShortcut({keys:[["Escape"]],callback:()=>{rB(this,rK).setValue(rB(this,rJ)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&rB(this,rK).isVisible()},group:rV}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>{var t;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell())&&rB(this,rK).isVisible()},group:rV})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rV)}registerListeners(){let{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",t=>rD(this,r0,ne).call(this,t)),this.eventManager.addEventListener(t,"mousedown",t=>rD(this,rQ,nt).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>rD(this,r1,ni).call(this)),this.eventManager.addEventListener(e,"focus",()=>rD(this,r5,no).call(this)),this.eventManager.addEventListener(e,"blur",()=>rD(this,r4,nn).call(this)),this.eventManager.addEventListener(e,"mousedown",t=>rD(this,r8,ns).call(this,t)),this.eventManager.addEventListener(e,"mouseup",t=>rD(this,r9,nl).call(this,t))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){let e=(0,n.oq)(t.target,"TD","TBODY");return!!(e&&(0,n.pv)(e,"htCommentCell")&&(0,n.oq)(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let e=rB(this,rK).getValue(),i="";null!=t?i=t:null!=e&&(i=e);let r=this.range.from.row,n=this.range.from.col;this.updateCommentMeta(r,n,{[rj]:i}),this.hot.render()}setCommentAtCell(t,e,i){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(i)}removeComment(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,rF),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(i)}getComment(){let t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,rj)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,rj)}show(){var t;if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let{from:{row:e,col:i}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;let r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return rB(this,rG).cancelHiding(),rB(this,rK).setValue(null!==(t=r[rF]?r[rF][rj]:null)&&void 0!==t?t:""),rB(this,rK).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){rB(this,rK).hide()}refreshEditor(){var t,e;let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!i&&(!this.range.from||!rB(this,rK).isVisible()))return;let{rowIndexMapper:r,columnIndexMapper:o}=this.hot,{row:s,col:l}=this.range.from,a=r.getRenderableFromVisualIndex(s),h=o.getRenderableFromVisualIndex(l),u=null===a;rB(this,rK).setPosition(0,0),null===a&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,-1))),null===h&&(h=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(l,-1)));let c=null===a,d=null===h;a=null!==(t=a)&&void 0!==t?t:0,h=null!==(e=h)&&void 0!==e?e:0;let{rootWindow:g,view:{_wt:f}}=this.hot,{wtTable:p}=f,m=f.getCell({row:a,col:h},!0),w=this.getCommentMeta(s,l,rU);w?rB(this,rK).setSize(w.width,w.height):rB(this,rK).resetSize();let b=d?0:p.getStretchedColumnWidth(h),y=u&&!c?(0,n.Pb)(m):0,{left:C,top:S,width:E,height:R}=m.getBoundingClientRect(),{width:T,height:M}=rB(this,rK).getSize(),{innerWidth:O,innerHeight:k}=this.hot.rootWindow,x=this.hot.rootDocument.documentElement,I=C+g.scrollX+b,A=S+g.scrollY+y;this.hot.isRtl()&&(I-=T+b),this.hot.isLtr()&&C+E+T>O?I=C+g.scrollX-T-1:this.hot.isRtl()&&I<-(x.scrollWidth-x.clientWidth)&&(I=C+g.scrollX+b+1),S+M>k&&(A-=M-R+1),rB(this,rK).setPosition(I,A),rB(this,rK).setReadOnlyState(this.getCommentMeta(s,l,r$))}focusEditor(){rB(this,rK).focus()}updateCommentMeta(t,e,i){let r;let n=this.hot.getCellMeta(t,e)[rF];n?(r=(0,s.I8)(n),(0,s.ZB)(r,i)):r=i,this.hot.setCellMeta(t,e,rF,r)}getCommentMeta(t,e,i){let r=this.hot.getCellMeta(t,e);if(r[rF])return r[rF][i]}addToContextMenu(t){var e,i,r;t.items.push({name:rO},(e=this,{key:"commentsAddEdit",name(){var t;let i=null===(t=this.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return null!=i&&i.isCell()&&e.getCommentAtCell(i.row,i.col)?this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){let t=this.getSelectedRangeLast();this.deselectCell(),e.setRange(t),e.show(),e.focusEditor()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}),(i=this,{key:"commentsRemove",name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){let t=this.getSelectedRangeLast();t.forAll((t,e)=>{t>=0&&e>=0&&i.removeCommentAtCell(t,e,!1)}),this.render()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}),(r=this,{key:"commentsReadOnly",name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT),e=rA(this.getSelectedRange(),(t,e)=>r.getCommentMeta(t,e,r$));return e?rI(t):t},callback(){let t=this.getSelectedRangeLast();t.forAll((t,e)=>{if(t>=0&&e>=0){let i=!!r.getCommentMeta(t,e,r$);r.updateCommentMeta(t,e,{[r$]:!i})}})},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||!r.getCommentAtCell(t.highlight.row,t.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}))}getDisplayDelaySetting(){let t=this.hot.getSettings()[rV];if((0,s.Kn)(t))return t.displayDelay}getEditorInputElement(){return rB(this,rK).getInputElement()}destroy(){rB(this,rK)&&rB(this,rK).destroy(),rB(this,rG)&&rB(this,rG).destroy(),super.destroy()}}function nt(t){if(this.hot.view&&this.hot.view._wt&&!rB(this,rY)&&!this.targetIsCommentTextArea(t)){let e=(0,n.oq)(t.target,"TD","TBODY"),i=null;e&&(i=this.hot.getCoords(e)),(!e||this.range.from&&i&&(this.range.from.row!==i.row||this.range.from.col!==i.col))&&this.hide()}}function ne(t){let{rootDocument:e}=this.hot;if(!(rB(this,rY)||rB(this,rK).isFocused()||(0,n.pv)(t.target,"wtBorder"))&&rB(this,rZ)!==t.target&&rB(this,rK)){if(rL(this,rZ,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){let e=this.hot._createCellRange(this.hot.getCoords(t.target));rB(this,rG).show(e)}else(0,n.MO)(t.target,e)&&!this.targetIsCommentTextArea(t)&&rB(this,rG).hide()}}function ni(){rL(this,rY,!1)}function nr(t,e){e[rF]&&e[rF][rj]&&(0,n.cn)(t,e.commentedCellClassName)}function nn(){rL(this,rJ,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function no(){rL(this,rJ,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(rz)}function ns(t){rL(this,rq,{width:(0,n.iO)(t.target),height:(0,n.Pb)(t.target)})}function nl(t){let e=(0,n.iO)(t.target),i=(0,n.Pb)(t.target);(e!==rB(this,rq).width+1||i!==rB(this,rq).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[rU]:{width:e,height:i}})}function na(t){rB(this,rK).isVisible()&&(0,o.mM)(t)}function nh(){rB(this,rX)||this.hide()}function nu(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i(95606);class nc{constructor(t){nu(this,"hot",void 0),nu(this,"commands",{}),nu(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){let e;for(var i,r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];let l=t.split(":"),a=l[0],h=2===l.length?l[1]:null,c=this.commands[a];if(!c)throw Error(`Menu command '${a}' not exists.`);if(h&&c.submenu&&(i=c.submenu.items,(0,u.Bk)(i,t=>{let i=t.key?t.key.split(":"):null;if(Array.isArray(i)&&i[1]===h)return e=t,!1}),c=e),!0===c.disabled||"function"==typeof c.disabled&&!0===c.disabled.call(this.hot)||(0,s.nr)(c,"submenu"))return;let d=[];"function"==typeof c.callback&&d.push(c.callback),"function"==typeof this.commonCallback&&d.push(this.commonCallback),n.unshift(l.join(":")),(0,u.Bk)(d,t=>t.apply(this.hot,n))}}let nd="alignment",ng="clear_column",nf="col_left",np="col_right",nm="make_read_only",nw="redo";var nv=i(30855);let nb="remove_col",ny="remove_row",nC="row_above",nS="row_below",nE="no_items",nR="undo",nT=[nC,nS,nf,np,ng,ny,nb,nR,nw,nm,nd,rO,nE],nM={[rO]:function(){return{name:rO}},[nE]:function(){return{key:nE,name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}},[nC]:function(){return{key:nC,name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){let t=this.countRows();return 0===t}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}},[nS]:function(){return{key:nS,name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){let t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[nf]:function(){return{key:nf,name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){let t=this.countCols();return 0===t}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}},[np]:function(){return{key:np,name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){let t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[ng]:function(){return{key:ng,name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(t,e){let i=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,i,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()&&t.highlight.col<0)||!this.selection.isSelectedByColumnHeader()}}},[ny]:function(){return{key:ny,name(){let t=this.getSelected(),e=0;if(t){if(t.length>1)e=1;else{let[i,,r]=t[0];i-r!=0&&(e=1)}}return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback(){this.alter("remove_row",(0,nv.I8)(this),1,"ContextMenu.removeRow")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;let e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}},[nb]:function(){return{key:nb,name(){let t=this.getSelected(),e=0;if(t){if(t.length>1)e=1;else{let[,i,,r]=t[0];i-r!=0&&(e=1)}}return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback(){this.alter("remove_col",(0,nv.X8)(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;let e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}},[nR]:function(){return{key:nR,name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_UNDO)},callback(){this.undo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[nw]:function(){return{key:nw,name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_REDO)},callback(){this.redo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[nm]:function(){return{key:nm,name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_READ_ONLY),e=rA(this.getSelectedRange(),(t,e)=>this.getCellMeta(t,e).readOnly);return e&&(t=rI(t)),t},callback(){let t=this.getSelectedRange(),e=rA(t,(t,e)=>this.getCellMeta(t,e).readOnly);(0,u.Bk)(t,t=>{t.forAll((t,i)=>{t>=0&&i>=0&&this.setCellMeta(t,i,"readOnly",!e)})}),this.render()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner())||0===this.countRows()||0===this.countCols()||!this.getSelectedRange()||0===this.getSelectedRange().length}}},[nd]:function(){return{key:nd,name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader())||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${nd}:left`,name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT),e=rA(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htLeft"))return!0});return e&&(t=rI(t)),t},callback(){let t=this.getSelectedRange(),e=rk(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,i,r),rx(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${nd}:center`,name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER),e=rA(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htCenter"))return!0});return e&&(t=rI(t)),t},callback(){let t=this.getSelectedRange(),e=rk(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,i,r),rx(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${nd}:right`,name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT),e=rA(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htRight"))return!0});return e&&(t=rI(t)),t},callback(){let t=this.getSelectedRange(),e=rk(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,i,r),rx(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${nd}:justify`,name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY),e=rA(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htJustify"))return!0});return e&&(t=rI(t)),t},callback(){let t=this.getSelectedRange(),e=rk(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,i,r),rx(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{name:rO},{key:`${nd}:top`,name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ALIGNMENT_TOP),e=rA(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htTop"))return!0});return e&&(t=rI(t)),t},callback(){let t=this.getSelectedRange(),e=rk(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,i,r),rx(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${nd}:middle`,name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE),e=rA(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htMiddle"))return!0});return e&&(t=rI(t)),t},callback(){let t=this.getSelectedRange(),e=rk(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,i,r),rx(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${nd}:bottom`,name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM),e=rA(this.getSelectedRange(),(t,e)=>{let i=this.getCellMeta(t,e).className;if(i&&-1!==i.indexOf("htBottom"))return!0});return e&&(t=rI(t)),t},callback(){let t=this.getSelectedRange(),e=rk(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,i,r),rx(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1}]}}}};function nO(){let t={};return(0,s._l)(nM,(e,i)=>{t[i]=e()}),t}function nk(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class nx{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;nk(this,"hot",void 0),nk(this,"predefinedItems",nO()),nk(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){let e={};this.defaultOrderPattern.length=0,(0,s._l)(t,(t,i)=>{let r="";t.name===rO?(e[rO]=t,r=rO):(isNaN(parseInt(i,10))?(t.key=void 0===t.key?i:t.key,e[i]=t):e[t.key]=t,r=t.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],n=t;return n&&n.items?n=n.items:Array.isArray(n)||(n=e),(0,s.Kn)(n)?(0,s._l)(n,(t,e)=>{let n=i["string"==typeof t?t:e];n||(n=t),(0,s.Kn)(t)?(0,s.l7)(n,t):"string"==typeof n&&(n={name:n}),void 0===n.key&&(n.key=e),r.push(n)}):(0,u.Bk)(n,(t,e)=>{let n=i[t];!n&&nT.indexOf(t)>=0||(n||(n={name:t,key:`${e}`}),(0,s.Kn)(t)&&(0,s.l7)(n,t),void 0===n.key&&(n.key=e),r.push(n))}),r}(t,this.defaultOrderPattern,this.predefinedItems)}}function nI(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class nA{constructor(t,e){let i,r,n,o,s,l;nI(this,"top",void 0),nI(this,"topRelative",void 0),nI(this,"left",void 0),nI(this,"leftRelative",void 0),nI(this,"scrollTop",void 0),nI(this,"scrollLeft",void 0),nI(this,"cellHeight",void 0),nI(this,"cellWidth",void 0);let a=e.scrollY,h=e.scrollX;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),n=parseInt(t.left,10),s=t.height||0,l=t.width||0,r=i,o=n,i+=a,n+=h):"event"===this.type&&(i=parseInt(t.pageY,10),n=parseInt(t.pageX,10),s=t.target.clientHeight,l=t.target.clientWidth,r=i-a,o=n-h),this.top=i,this.topRelative=r,this.left=n,this.leftRelative=o,this.scrollTop=a,this.scrollLeft=h,this.cellHeight=s,this.cellWidth=l}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function nN(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function nH(t,e){var i=nP(t,e,"get");return i.get?i.get.call(t):i.value}function n_(t,e,i){var r=nP(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function nP(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var nD=new WeakMap,nL=new WeakMap,nB=new WeakMap,nW=new WeakMap,nV=new WeakMap;class nF{constructor(t){nN(this,nD,{writable:!0,value:void 0}),nN(this,nL,{writable:!0,value:void 0}),nN(this,nB,{writable:!0,value:void 0}),nN(this,nW,{writable:!0,value:!1}),nN(this,nV,{writable:!0,value:{above:0,below:0,left:0,right:0}}),n_(this,nW,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return nH(this,nV)[t]=e,this}setElement(t){return n_(this,nD,t),this}setParentElement(t){return n_(this,nL,t),this}updatePosition(t){n_(this,nB,new nA(t,nH(this,nD).ownerDocument.defaultView)),nH(this,nW)?(nH(this,nB).fitsBelow(nH(this,nD))?this.setPositionBelowCursor():nH(this,nB).fitsAbove(nH(this,nD))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===nH(this,nD).dir?nH(this,nB).fitsOnLeft(nH(this,nD))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():nH(this,nB).fitsOnRight(nH(this,nD))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=nH(this,nV).above+nH(this,nB).top-nH(this,nD).offsetHeight;nH(this,nL)&&(t=nH(this,nB).top+nH(this,nB).cellHeight-nH(this,nD).offsetHeight+3),nH(this,nD).style.top=`${t}px`}setPositionBelowCursor(){let t=nH(this,nV).below+nH(this,nB).top+1;nH(this,nL)&&(t=nH(this,nB).top-1),nH(this,nD).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=nH(this,nB).left;if(nH(this,nL)){let{right:e}=nH(this,nL).getBoundingClientRect();t+=nH(this,nB).cellWidth+e-(nH(this,nB).left+nH(this,nB).cellWidth)}else t+=nH(this,nV).right;nH(this,nD).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=nH(this,nV).left+nH(this,nB).left-nH(this,nD).offsetWidth;if(nH(this,nL)){let{left:e}=nH(this,nL).getBoundingClientRect();t-=nH(this,nB).left-e}nH(this,nD).style.left=`${t}px`}}function nj(t){let{initialPage:e=-1,size:i=()=>0,onItemSelect:r=()=>{},onClear:n=()=>{}}=t,o=new Set,s=(0,tT.uZ)(e,-1,a()-1);function l(t,e){let i=a()-1;if(t<0&&(t=i),t>i&&(t=0),o.has(t))return -1;o.add(t);let n=r(t,!1);return!1===n&&(t=l(1===e?++t:--t,e)),t}function a(){return Math.max(i(),0)}return{setCurrentPage:function(t){t>-1&&t<a()&&!1!==r(t,!0)&&(s=t)},getCurrentPage:function(){return s},toFirstItem:function(){a()>0&&(o.clear(),s=l(0,1))},toLastItem:function(){a()>0&&(o.clear(),s=l(a()-1,-1))},toNextItem:function(){a()>0&&(o.clear(),s=l(++s,1))},toPreviousItem:function(){a()>0&&(o.clear(),s=l(--s,-1))},getSize:a,clear:function(){o.clear(),s=e,n()}}}function nU(t){return(0,s.nr)(t,"submenu")}function n$(t){return RegExp(rO,"i").test(t.name)}function nz(t,e){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(e)}function nK(t){return(0,s.nr)(t,"disableSelection")}function nG(t,e){let i=t.slice(0);for(;0<i.length;)if(i[0].name===e)i.shift();else break;return i}let nY="menu";function nX(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function nq(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function nZ(t,e,i){var r=nQ(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function nJ(t,e){var i=nQ(t,e,"get");return i.get?i.get.call(t):i.value}function nQ(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var n0=new WeakMap,n1=new WeakMap;class n2{constructor(t,e){var i=this;nq(this,"hot",void 0),nq(this,"options",void 0),nq(this,"eventManager",new tc.Z(this)),nq(this,"container",void 0),nq(this,"positioner",void 0),nq(this,"hotMenu",null),nq(this,"hotSubMenus",{}),nq(this,"parentMenu",void 0),nq(this,"menuItems",null),nq(this,"origOutsideClickDeselects",null),nX(this,n0,{writable:!0,value:void 0}),nX(this,n1,{writable:!0,value:void 0}),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new nF(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.parentMenu.runLocalHooks("afterSelectionChange",...e)})}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(t.document,"contextmenu",t=>this.onDocumentContextMenu(t)),t=(0,n.f5)(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return nJ(this,n0)}getKeyboardShortcutsCtrl(){return nJ(this,n1)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){var t,e;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";let i=(0,iH.Ds)(t=>this.openSubMenu(t),300),r=this.options.minWidth||215,s=!1,l=(0,u.w7)(this.menuItems,t=>{var e;return t.key===nE&&(s=!0),e=this.hot,!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))});if(l.length<1&&!s)l.push(nO()[nE]);else if(0===l.length)return;l=function(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rO,r=t.slice(0);return(e=(r=nG(r,i)).slice(0)).reverse(),(e=nG(e,i)).reverse(),r=function(t){let e=[];return(0,u.Bk)(t,(t,i)=>{i>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}(r=e)}(l,rO);let a=!1,h={data:l,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:t=>(0,c.$K)(t)&&t<r?r:t,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(t=this.hot,(e,i,r,o,s,l)=>{if(i.hasAttribute("ghost-table"))return;let a=e.getSourceDataAtRow(r),h=t.rootDocument.createElement("div"),u="function"==typeof l?l.call(t):l;if((0,n.cS)(i),(0,n.cn)(h,"htItemWrapper"),t.getSettings().ariaTags){let e=!nz(a,t)&&!nK(a)&&!n$(a);(0,n.P$)(i,[(0,m.rQ)(),(0,m.QK)(u),...e?[(0,m.Qk)(-1)]:[],...nz(a,t)?[(0,m.gw)()]:[],...nU(a)?[(0,m.JV)(!1)]:[]])}i.className="",i.appendChild(h),n$(a)?(0,n.cn)(i,"htSeparator"):"function"==typeof a.renderer?((0,n.cn)(i,"htCustomMenuRenderer"),i.appendChild(a.renderer(e,h,r,o,s,u))):(0,n.uS)(h,u),nz(a,t)?(0,n.cn)(i,"htDisabled"):nK(a)?(0,n.cn)(i,"htSelectionDisabled"):nU(a)&&(0,n.cn)(i,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(t,e)=>{nJ(this,n0).setCurrentPage(e.row)},afterOnCellMouseOver:(t,e)=>{this.isAllSubMenusClosed()?i(e.row):this.openSubMenu(e.row)},rowHeights:t=>l[t].name===rO?1:23,afterOnCellContextMenu:t=>{t.preventDefault(),(0,f.uM)()&&a&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,i,r,n)=>{this.hotMenu.view.isMouseDown()&&(n.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(a=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{(!(0,f.uM)()||!(0,o.dO)(t))&&a&&this.hasSelectedItem()&&((0,f.K1)()||(0,f.L)()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,h),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),nZ(this,n0,(e=this.hotMenu,nj({size:()=>e.countRows(),onItemSelect(t,i){let r=e.getCell(t,0);if(!r||(0,n.pv)(r,"htSeparator")||(0,n.pv)(r,"htDisabled")||(0,n.pv)(r,"htSelectionDisabled"))return!1;e.selectCell(t,0,...i?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}}))),nZ(this,n1,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];function r(t,e){s(e).addShortcuts(t,{group:nY})}function n(t,e){let n=s(e);t.forEach(t=>{let{keys:e}=t;e.forEach(t=>n.removeShortcutsByKeys(t))}),i.push({shortcuts:t,contextName:e}),r(t,e)}function o(t){return t?`${nY}:${t}`:nY}function s(e){var i;let r=t.hotMenu.getShortcutManager(),n=o(e);return null!==(i=r.getContext(n))&&void 0!==i?i:r.addContext(n)}return r([{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{let e=t.hotMenu.getSelectedLast();if(e){let i=t.openSubMenu(e[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{let e=t.hotMenu.getSelectedLast();e&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{let i=t.hotMenu.getSelectedLast();i&&(t.hotMenu.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{let e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{let e=t.hotMenu.getSelectedLast();e?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]),e.forEach(t=>{let{shortcuts:e,contextName:i}=t;n(e,i)}),{addCustomShortcuts:n,getCustomShortcuts:function(){return[...i]},getContext:s,listen:function(e){t.hotMenu.getShortcutManager().setActiveContextName(o(e))}}}(this)),nJ(this,n1).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened()){if(t&&this.isSubMenu())this.parentMenu.close();else if(nJ(this,n0).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){let t=this.parentMenu.hotMenu.getSelectedLast();if(t){let e=this.parentMenu.hotMenu.getCell(t[0],0);(0,n.P$)(e,[(0,m.JV)(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(t){if(!this.hotMenu)return!1;let e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!(0,n.pv)(e,"htSubmenu"))return!1;let i=this.hotMenu.getSourceDataAtRow(t),r=new n2(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(e.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&(0,n.P$)(e,[(0,m.JV)(!0)]),r}closeSubMenu(t){let e=this.hotMenu.getSourceDataAtRow(t),i=this.hotSubMenus[e.key];if(i){i.destroy(),delete this.hotSubMenus[e.key];let r=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&(0,n.P$)(r,[(0,m.JV)(!1)])}}closeAllSubMenus(){(0,u.Bk)(this.hotMenu.getData(),(t,e)=>this.closeSubMenu(e))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){let t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;let e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;let i=this.hot.getSelectedRange(),r=i?(0,u.Sc)(i,t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})):[];this.runLocalHooks("executeCommand",e.key,r,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,r,t)}isCommandPassive(t){return!1===t.isCommand||n$(t)||nz(t,this.hot)||nU(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}createContainer(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.options.container.ownerDocument,r=e;return r&&((0,iH.mf)(r)&&(r=null===(r=r.call(this.hot))||(0,c.o8)(r)?"":r.toString()),r=`${this.options.className}Sub_${r=r.replace(/[^A-z0-9]/g,"_")}`,t=i.querySelector(`.${this.options.className}.${r}`)),t||(t=i.createElement("div"),(0,n.cn)(t,`htMenu ${this.options.className}`),r&&(0,n.cn)(t,r),this.options.container.appendChild(t)),t}onAfterInit(){let{wtTable:t}=this.hotMenu.view._wt,e=this.hotMenu.getSettings().data,i=t.hider.style,r=t.holder.style,o=parseInt(i.width,10),s=(0,u.k$)(e,(t,e)=>t+(e.name===rO?1:26),0);r.width=`${o+3}px`,r.height=`${s+3}px`,i.height=r.height,this.hot.getSettings().ariaTags&&(0,n.P$)(this.hotMenu.rootElement,[(0,m.tm)(),(0,m.Qk)(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!(0,n.MO)(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,n.MO)(t.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&(0,n.pv)(t.target,"htCore")&&(0,n.MO)(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}function n4(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function n5(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n8(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}(0,s.jB)(n2,rR.Z);let n9="contextMenu";tt.Z.getSingleton().register("afterContextMenuDefaultOptions"),tt.Z.getSingleton().register("beforeContextMenuShow"),tt.Z.getSingleton().register("afterContextMenuShow"),tt.Z.getSingleton().register("afterContextMenuHide"),tt.Z.getSingleton().register("afterContextMenuExecute");var n3=new WeakSet,n7=new WeakSet,n6=new WeakSet,ot=new WeakSet;class oe extends t9{constructor(){super(...arguments),n4(this,ot),n4(this,n6),n4(this,n7),n4(this,n3),n5(this,"commandExecutor",new nc(this.hot)),n5(this,"itemsFactory",null),n5(this,"menu",null)}static get PLUGIN_KEY(){return n9}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[nC,nS,rO,nf,np,rO,ny,nb,rO,nR,nw,rO,nm,rO,nd]}isEnabled(){return!!this.hot.getSettings()[n9]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[n9];"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new n2(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>n8(this,n7,or).call(this)),this.menu.addLocalHook("afterOpen",()=>n8(this,n6,on).call(this)),this.menu.addLocalHook("afterClose",()=>n8(this,ot,oo).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.executeCommand.call(t,...i)}),this.addHook("afterOnCellContextMenu",t=>n8(this,n3,oi).call(this,t)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();let e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),i=rN(this.menu.container,this.hot.rootDocument);this.open({left:e.left+i.left,top:e.top+i.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:n9})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(n9)}open(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.prepareMenuItems(),this.menu.open(),(0,s._l)(i,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];this.commandExecutor.execute(t,...i)}prepareMenuItems(){this.itemsFactory=new nx(this.hot,oe.DEFAULT_ITEMS);let t=this.hot.getSettings()[n9],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);let i=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),(0,u.Bk)(i,t=>this.commandExecutor.registerCommand(t.key,t))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function oi(t){let e=this.hot.getSettings(),i=e.rowHeaders,r=e.colHeaders,o=t.target;if(this.close(),(0,n.pv)(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(i||r)&&!("TD"===o.nodeName||"TD"===o.parentNode.nodeName)&&!((0,n.pv)(o,"current")&&(0,n.pv)(o,"wtBorder"))))return;let s=rN(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function or(){this.hot.runHooks("beforeContextMenuShow",this)}function on(){this.hot.runHooks("afterContextMenuShow",this)}function oo(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}oe.SEPARATOR={name:rO};var os=i(90292);class ol{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class oa{constructor(){this.clipboardData=new ol}}function oh(t,e){oc(t,e),e.add(t)}function ou(t,e,i){oc(t,e),e.set(t,i)}function oc(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function od(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function og(t,e){var i=op(t,e,"get");return i.get?i.get.call(t):i.value}function of(t,e,i){var r=op(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function op(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var om=new WeakMap,ow=new WeakMap,ov=new WeakMap,ob=new WeakMap,oy=new WeakMap,oC=new WeakMap,oS=new WeakSet,oE=new WeakSet;class oR{constructor(t){let{countRows:e,countColumns:i,rowsLimit:r,columnsLimit:n,countColumnHeaders:o}=t;oh(this,oE),oh(this,oS),ou(this,om,{writable:!0,value:void 0}),ou(this,ow,{writable:!0,value:void 0}),ou(this,ov,{writable:!0,value:void 0}),ou(this,ob,{writable:!0,value:void 0}),ou(this,oy,{writable:!0,value:void 0}),ou(this,oC,{writable:!0,value:void 0}),of(this,ow,e),of(this,ov,i),of(this,ob,r),of(this,oy,n),of(this,oC,o)}setSelectedRange(t){of(this,om,t)}getCellsRange(){if(0===og(this,ow).call(this)||0===og(this,ov).call(this))return null;let{row:t,col:e}=og(this,om).getTopStartCorner(),{row:i,col:r}=og(this,om).getBottomEndCorner(),n=od(this,oE,oM).call(this,t,i),o=od(this,oS,oT).call(this,e,r),s=i!==n||r!==o;return{isRangeTrimmed:s,startRow:t,startCol:e,endRow:n,endCol:o}}getMostBottomColumnHeadersRange(){if(0===og(this,ov).call(this)||0===og(this,oC).call(this))return null;let{col:t}=og(this,om).getTopStartCorner(),{col:e}=og(this,om).getBottomEndCorner(),i=od(this,oS,oT).call(this,t,e),r=e!==i;return{isRangeTrimmed:r,startRow:-1,startCol:t,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(0===og(this,ov).call(this)||0===og(this,oC).call(this))return null;let{col:t}=og(this,om).getTopStartCorner(),{col:e}=og(this,om).getBottomEndCorner(),i=od(this,oS,oT).call(this,t,e),r=e!==i;return{isRangeTrimmed:r,startRow:-og(this,oC).call(this),startCol:t,endRow:-1,endCol:i}}}function oT(t,e){return Math.min(e,Math.max(t+og(this,oy).call(this)-1,t))}function oM(t,e){return Math.min(e,Math.max(t+og(this,ob).call(this)-1,t))}function oO(t){let e=[],i=[];return(0,u.Bk)(t,t=>{let r=Math.min(t.startRow,t.endRow),n=Math.max(t.startRow,t.endRow);(0,tT.q4)(r,n,t=>{-1===e.indexOf(t)&&e.push(t)});let o=Math.min(t.startCol,t.endCol),s=Math.max(t.startCol,t.endCol);(0,tT.q4)(o,s,t=>{-1===i.indexOf(t)&&i.push(t)})}),{rows:e,columns:i}}var ok=i(84350);function ox(t,e){oA(t,e),e.add(t)}function oI(t,e,i){oA(t,e),e.set(t,i)}function oA(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function oN(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function oH(t,e){var i=oD(t,e,"get");return i.get?i.get.call(t):i.value}function o_(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function oP(t,e,i){var r=oD(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function oD(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}tt.Z.getSingleton().register("afterCopyLimit"),tt.Z.getSingleton().register("modifyCopyableRange"),tt.Z.getSingleton().register("beforeCut"),tt.Z.getSingleton().register("afterCut"),tt.Z.getSingleton().register("beforePaste"),tt.Z.getSingleton().register("afterPaste"),tt.Z.getSingleton().register("beforeCopy"),tt.Z.getSingleton().register("afterCopy");let oL="copyPaste",oB=["fragmentSelection"],oW='<meta name="generator" content="Handsontable"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>';var oV=new WeakMap,oF=new WeakMap,oj=new WeakMap,oU=new WeakMap,o$=new WeakMap,oz=new WeakMap,oK=new WeakMap,oG=new WeakMap,oY=new WeakSet,oX=new WeakSet,oq=new WeakSet,oZ=new WeakSet,oJ=new WeakSet,oQ=new WeakSet,o0=new WeakSet,o1=new WeakSet,o2=new WeakSet,o4=new WeakSet;class o5 extends t9{constructor(){super(...arguments),ox(this,o4),ox(this,o2),ox(this,o1),ox(this,o0),ox(this,oQ),ox(this,oJ),ox(this,oZ),ox(this,oq),ox(this,oX),ox(this,oY),oN(this,"columnsLimit",1/0),oN(this,"rowsLimit",1/0),oN(this,"pasteMode","overwrite"),oN(this,"uiContainer",this.hot.rootDocument.body),oI(this,oV,{writable:!0,value:!1}),oI(this,oF,{writable:!0,value:!1}),oI(this,oj,{writable:!0,value:!1}),oI(this,oU,{writable:!0,value:"cells-only"}),oI(this,o$,{writable:!0,value:!1}),oI(this,oz,{writable:!0,value:!1}),oI(this,oK,{writable:!0,value:new oR({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),oI(this,oG,{writable:!0,value:!1}),oN(this,"copyableRanges",[])}static get PLUGIN_KEY(){return oL}static get SETTING_KEYS(){return[oL,...oB]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[oL]}enablePlugin(){var t,e,i=this;if(this.enabled)return;let{[oL]:r}=this.hot.getSettings();"object"==typeof r&&(this.pasteMode=null!==(t=r.pasteMode)&&void 0!==t?t:this.pasteMode,this.rowsLimit=isNaN(r.rowsLimit)?this.rowsLimit:r.rowsLimit,this.columnsLimit=isNaN(r.columnsLimit)?this.columnsLimit:r.columnsLimit,oP(this,oV,!!r.copyColumnHeaders),oP(this,oF,!!r.copyColumnGroupHeaders),oP(this,oj,!!r.copyColumnHeadersOnly),this.uiContainer=null!==(e=r.uiContainer)&&void 0!==e?e:this.uiContainer),this.addHook("afterContextMenuDefaultOptions",t=>o_(this,oJ,o6).call(this,t)),this.addHook("afterSelection",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return o_(i,oQ,st).call(i,...e)}),this.addHook("afterSelectionEnd",()=>o_(this,o0,se).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),(0,f.G6)()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return o_(i,o1,si).call(i,...e)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return o_(i,o2,sr).call(i,...e)}),this.addHook("afterSelection",()=>o_(this,o4,sn).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";oP(this,oU,t),oP(this,o$,!0),o_(this,oY,o8).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){oP(this,oz,!0),o_(this,oY,o8).call(this,"cut")}getRangedCopyableData(t){return(0,os.P)(this.getRangedData(t))}getRangedData(t){let e=[],{rows:i,columns:r}=oO(t);return(0,u.Bk)(i,t=>{let i=[];(0,u.Bk)(r,e=>{t<0?i.push(this.hot.getColHeader(e,t)):i.push(this.hot.getCopyableData(t,e))}),e.push(i)}),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;let i=new oa;t&&i.clipboardData.setData("text/plain",t),e&&i.clipboardData.setData("text/html",e),this.onPaste(i)}setCopyableText(){let t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader()){this.copyableRanges=[];return}oH(this,oK).setSelectedRange(t);let e=new Map([["headers",null],["cells",null]]);"column-headers-only"===oH(this,oU)?e.set("headers",oH(this,oK).getMostBottomColumnHeadersRange()):("with-column-headers"===oH(this,oU)?e.set("headers",oH(this,oK).getMostBottomColumnHeadersRange()):"with-column-group-headers"===oH(this,oU)&&e.set("headers",oH(this,oK).getAllColumnHeadersRange()),e.set("cells",oH(this,oK).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter(t=>null!==t).map(t=>{let{startRow:e,startCol:i,endRow:r,endCol:n}=t;return{startRow:e,startCol:i,endRow:r,endCol:n}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);let i=e.get("cells");if(null!==i&&i.isRangeTrimmed){let{startRow:t,startCol:e,endRow:r,endCol:n}=i;this.hot.runHooks("afterCopyLimit",r-t+1,n-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;let i=t.length,r=t[0].length,n=[],{row:o,col:s}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner(),h=o,u=s,c=o,d=s;for(;n.length<i||h<=l;){let{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(h,s);if(h=l+1,!0===e)continue;c=l,u=s;let g=[],f=n.length%i;for(;g.length<r||u<=a;){let{skipColumnOnPaste:e,visualCol:i}=this.hot.getCellMeta(o,u);if(u=i+1,!0===e)continue;d=i;let n=g.length%r;g.push(t[f][n])}n.push(g)}return oP(this,oG,!0),this.hot.populateFromArray(o,s,n,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,s,c,d]}onCopy(t){if(!this.hot.isListening()&&!oH(this,o$)||this.isEditorOpened())return;this.setCopyableText(),oP(this,o$,!1);let e=this.getRangedData(this.copyableRanges),i=o_(this,oX,o9).call(this,this.copyableRanges),r=!!this.hot.runHooks("beforeCopy",e,this.copyableRanges,i);if(r){let r=(0,os.P)(e);if(t&&t.clipboardData){let i=(0,ok.bt)(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",r),t.clipboardData.setData("text/html",[oW,i].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.runHooks("afterCopy",e,this.copyableRanges,i)}oP(this,oU,"cells-only"),t.preventDefault()}onCut(t){if(!this.hot.isListening()&&!oH(this,oz)||this.isEditorOpened())return;this.setCopyableText(),oP(this,oz,!1);let e=this.getRangedData(this.copyableRanges),i=!!this.hot.runHooks("beforeCut",e,this.copyableRanges);if(i){let i=(0,os.P)(e);if(t&&t.clipboardData){let r=(0,ok.bt)(e,this.hot.rootDocument);t.clipboardData.setData("text/plain",i),t.clipboardData.setData("text/html",[oW,r].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",e,this.copyableRanges)}t.preventDefault()}onPaste(t){let e;if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;if(t&&t.preventDefault&&t.preventDefault(),t&&void 0!==t.clipboardData){let i=(0,d.Nw)(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(i&&/(<table)|(<TABLE)/g.test(i)){let t=(0,ok.BU)(i,this.hot.rootDocument);e=t.data}else e=t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof e&&(e=(0,os.Q)(e)),void 0===e||e&&0===e.length||!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;let[i,r,n,o]=this.populateValues(e);this.hot.selectCell(i,r,Math.min(this.hot.countRows()-1,n),Math.min(this.hot.countCols()-1,o)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}destroy(){super.destroy()}}function o8(t){if((0,f.G6)()){let e=this.hot.getSelectedRangeLast();if(e){let{row:i,col:r}=e.highlight,o=this.hot.getCell(i,r,!0);o&&(0,n.lq)(o,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function o9(t){let{rows:e}=oO(t),i=0;for(let t=0;t<e.length&&!(e[t]>=0);t++)i+=1;return{columnHeadersCount:i}}function o3(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:i}=t.highlight,r=this.hot.getCell(e,i,!0);r&&(0,n.l2)(r)}}}function o7(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:i}=t.highlight,r=this.hot.getCell(e,i,!0);null!=r&&r.hasAttribute("contenteditable")&&(0,n.yY)(r)}}}function o6(t){var e,i,r,n,o;t.items.push({name:"---------"},(e=this,{key:"copy",name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_COPY)},callback(){e.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),oH(this,oV)&&t.items.push((i=this,{key:"copy_with_column_headers",name(){let t=this.getSelectedRangeLast(),e=t?(0,tT.uZ)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,e)},callback(){i.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),oH(this,oF)&&t.items.push((r=this,{key:"copy_with_column_group_headers",name(){let t=this.getSelectedRangeLast(),e=t?(0,tT.uZ)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,e)},callback(){r.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),oH(this,oj)&&t.items.push((n=this,{key:"copy_column_headers_only",name(){let t=this.getSelectedRangeLast(),e=t?(0,tT.uZ)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,e)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1})),t.items.push((o=this,{key:"cut",name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_CUT)},callback(){o.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||e.length>1},hidden:!1}))}function st(t,e,i,r,n){oH(this,oG)&&(n.value=!0),oP(this,oG,!1)}function se(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function si(){o_(this,oZ,o7).call(this)}function sr(){o_(this,oq,o3).call(this)}function sn(){o_(this,oZ,o7).call(this)}function so(t,e){return`border_row${t}col${e}`}function ss(){return{width:1,color:"#000"}}function sl(){return{hide:!0}}function sa(t){var e,i;return((0,c.$K)(t.start)||(0,c.$K)(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left),((0,c.$K)(t.end)||(0,c.$K)(t.right))&&(t.end=null!==(i=t.end)&&void 0!==i?i:t.right),delete t.left,delete t.right,t}function sh(t){return(0,c.$K)(t.start)&&(t.left=t.start),(0,c.$K)(t.end)&&(t.right=t.end),t}function su(t,e){return{id:so(t,e),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:e,top:sl(),bottom:sl(),start:sl(),end:sl()}}function sc(t,e){let i=!1;return(0,u.Bk)(t.getSelectedRange(),r=>{r.forAll((r,n)=>{if(r<0||n<0)return;let o=t.getCellMeta(r,n).borders;if(o&&(!e||!(0,s.nr)(o[e],"hide")||!1===o[e].hide))return i=!0,!1})}),i}function sd(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}let sg=new Map([["left","start"],["right","end"]]);function sf(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function sp(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let sm="customBorders";var sw=new WeakSet,sv=new WeakSet;class sb extends t9{constructor(){var t,e,i;super(...arguments),sf(this,sv),sf(this,sw),e=[],(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="savedBorders","string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}static get PLUGIN_KEY(){return sm}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[sm]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",t=>sp(this,sw,sy).call(this,t)),this.addHook("init",()=>sp(this,sv,sC).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let i=["top","bottom","start","end"],r=null;e&&(this.checkSettingsCohesion([e]),i=Object.keys(e),r=sa(e));let n=(0,nv.AV)(t),o=(0,nv.S5)(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});(0,u.Bk)(t,t=>{o(t).forAll((t,e)=>{(0,u.Bk)(i,i=>{var n;this.prepareBorderFromCustomAdded(t,e,r,null!==(n=sg.get(i))&&void 0!==n?n:i)})})}),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;let e=(0,nv.AV)(t),i=(0,nv.S5)(e,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return(0,u.Bk)(t,t=>{i(t).forAll((t,e)=>{(0,u.Bk)(this.savedBorders,i=>{i.row===t&&i.col===e&&r.push(sh(i))})})}),r}clearBorders(t){t?this.setBorders(t):((0,u.Bk)(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){let i=this.checkSavedBorders(t);i||this.savedBorders.push(t);let r=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col)),n=this.checkCustomSelections(t,r,e);n||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:r})}prepareBorderFromCustomAdded(t,e,i,r){let n=this.hot.countRows(),o=this.hot.countCols();if(t>=n||e>=o)return;let l=su(t,e);if(i){var a;a=l,(0,s.nr)(i,"border")&&i.border&&(a.border=i.border),(0,s.nr)(i,"top")&&(0,c.$K)(i.top)&&(i.top?(0,s.Kn)(i.top)||(i.top=ss()):i.top=sl(),a.top=i.top),(0,s.nr)(i,"bottom")&&(0,c.$K)(i.bottom)&&(i.bottom?(0,s.Kn)(i.bottom)||(i.bottom=ss()):i.bottom=sl(),a.bottom=i.bottom),(0,s.nr)(i,"start")&&(0,c.$K)(i.start)&&(i.start?(0,s.Kn)(i.start)||(i.start=ss()):i.start=sl(),a.start=i.start),(0,s.nr)(i,"end")&&(0,c.$K)(i.end)&&(i.end?(0,s.Kn)(i.end)||(i.end=ss()):i.end=sl(),a.end=i.end),l=a,(0,u.Bk)(this.hot.selection.highlight.customSelections,t=>{if(l.id===t.settings.id)return Object.assign(t.settings,i),l.id=t.settings.id,l.top=t.settings.top,l.bottom=t.settings.bottom,l.start=t.settings.start,l.end=t.settings.end,!1})}this.hot.setCellMeta(t,e,"borders",sh(l)),this.insertBorderIntoSettings(l,r)}prepareBorderFromCustomAddedRange(t,e){let i=Math.min(t.to.row,this.hot.countRows()-1),r=Math.min(t.to.col,this.hot.countCols()-1);(0,tT.q4)(t.from.row,i,i=>{(0,tT.q4)(t.from.col,r,r=>{let n=su(i,r),o=0;i===t.from.row&&(0,s.nr)(e,"top")&&(o+=1,n.top=e.top),i===t.to.row&&(0,s.nr)(e,"bottom")&&(o+=1,n.bottom=e.bottom),r===t.from.col&&(0,s.nr)(e,"start")&&(o+=1,n.start=e.start),r===t.to.col&&(0,s.nr)(e,"end")&&(o+=1,n.end=e.end),o>0&&(this.hot.setCellMeta(i,r,"borders",sh(n)),this.insertBorderIntoSettings(n))})})}removeAllBorders(t,e){let i=so(t,e);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,i,r){let n=this.hot.getCellMeta(t,e).borders;if(n=n&&void 0!==n.border?sa(n):su(t,e),r){n[i]=sl();let o=this.countHide(n);if(4===o)this.removeAllBorders(t,e);else{let o=this.checkCustomSelectionsFromContextMenu(n,i,r);o||this.insertBorderIntoSettings(n),this.hot.setCellMeta(t,e,"borders",sh(n))}}else{n[i]=ss();let o=this.checkCustomSelectionsFromContextMenu(n,i,r);o||this.insertBorderIntoSettings(n),this.hot.setCellMeta(t,e,"borders",sh(n))}}prepareBorder(t,e,i){(0,u.Bk)(t,t=>{let{start:r,end:n}=t;if(r.row===n.row&&r.col===n.col)"noBorders"===e?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,e,i);else switch(e){case"noBorders":(0,tT.q4)(r.col,n.col,t=>{(0,tT.q4)(r.row,n.row,e=>{this.removeAllBorders(e,t)})});break;case"top":(0,tT.q4)(r.col,n.col,t=>{this.setBorder(r.row,t,e,i)});break;case"bottom":(0,tT.q4)(r.col,n.col,t=>{this.setBorder(n.row,t,e,i)});break;case"start":(0,tT.q4)(r.row,n.row,t=>{this.setBorder(t,r.col,e,i)});break;case"end":(0,tT.q4)(r.row,n.row,t=>{this.setBorder(t,n.col,e,i)})}})}createCustomBorders(t){(0,u.Bk)(t,t=>{let e=sa(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)})}countHide(t){let{top:e,bottom:i,start:r,end:n}=t,o=[e,i,r,n];return(0,u.k$)(o,(t,e)=>{let i=t;return e&&e.hide&&(i+=1),i},0)}clearBordersFromSelectionSettings(t){let e=(0,u.Sc)(this.hot.selection.highlight.customSelections,t=>t.settings.id).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){(0,u.Bk)(this.hot.selection.highlight.customSelections,(t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1})}hideBorders(){(0,u.Bk)(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()})}spliceBorder(t){let e=(0,u.Sc)(this.savedBorders,t=>t.id).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1,i=this.countHide(t);return 4===i?(this.spliceBorder(t.id),e=!0):(0,u.Bk)(this.savedBorders,(i,r)=>{if(t.id===i.id)return this.savedBorders[r]=t,e=!0,!1}),e}checkCustomSelectionsFromContextMenu(t,e,i){let r=!1;return(0,u.Bk)(this.hot.selection.highlight.customSelections,n=>{if(t.id===n.settings.id){let t=this.hot.view._wt.selectionManager.getBorderInstances(n);return(0,u.Bk)(t,t=>{t.toggleHiddenClass(e,i)}),r=!0,!1}}),r}checkCustomSelections(t,e,i){let r=this.countHide(t),n=!1;return 4===r?(this.removeAllBorders(t.row,t.col),n=!0):(0,u.Bk)(this.hot.selection.highlight.customSelections,r=>{if(t.id===r.settings.id){if(r.visualCellRange=e,r.commit(),i){let e=this.hot.view._wt.selectionManager.getBorderInstances(r);(0,u.Bk)(e,e=>{e.changeBorderStyle(i,t)})}return n=!0,!1}}),n}changeBorderSettings(){let t=this.hot.getSettings()[sm];if(Array.isArray(t)){let e=(0,s.I8)(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){let e=t.some(t=>(0,c.$K)(t.left)||(0,c.$K)(t.right)),i=t.some(t=>(0,c.$K)(t.start)||(0,c.$K)(t.end));if(e&&i)throw Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function sy(t){var e,i,r;this.hot.getSettings()[sm]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_BORDERS)},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader())||this.selection.isSelectedByCorner()},submenu:{items:[(e=this,{key:"borders:top",name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_BORDERS_TOP),e=sc(this,"top");return e&&(t=sd(t)),t},callback(t,i){let r=sc(this,"top");e.prepareBorder(i,"top",r)}}),function(t){let e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_BORDERS_RIGHT),i=sc(this,e);return i&&(t=sd(t)),t},callback(i,r){let n=sc(this,e);t.prepareBorder(r,e,n)}}}(this),(i=this,{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_BORDERS_BOTTOM),e=sc(this,"bottom");return e&&(t=sd(t)),t},callback(t,e){let r=sc(this,"bottom");i.prepareBorder(e,"bottom",r)}}),function(t){let e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_BORDERS_LEFT),i=sc(this,e);return i&&(t=sd(t)),t},callback(i,r){let n=sc(this,e);t.prepareBorder(r,e,n)}}}(this),(r=this,{key:"borders:no_borders",name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(t,e){r.prepareBorder(e,"noBorders")},disabled(){return!sc(this)}})]}})}function sC(){this.changeBorderSettings()}function sS(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function sE(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let sR="dragToScroll";var sT=new WeakSet;class sM extends t9{constructor(){super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,sT),sT.add(this),sS(this,"boundaries",null),sS(this,"callback",null),sS(this,"listening",!1)}static get PLUGIN_KEY(){return sR}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[sR]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",t=>sE(this,sT,sO).call(this,t)),this.addHook("afterOnCellCornerMouseDown",t=>sE(this,sT,sO).call(this,t)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let i=0,r=0;e<this.boundaries.top?r=e-this.boundaries.top:e>this.boundaries.bottom&&(r=e-this.boundaries.bottom),t<this.boundaries.left?i=t-this.boundaries.left:t>this.boundaries.right&&(i=t-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){let{rootWindow:t}=this.hot,e=t;for(;e;)this.eventManager.addEventListener(e.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(e.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(e.document,"mousemove",t=>this.onMouseMove(t)),e=(0,n.f5)(e)}unregisterEvents(){this.eventManager.clear()}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}function sO(t){if((0,o.dO)(t))return;let e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,i)=>{var r,n;let o=null!==(r=e.scrollLeft)&&void 0!==r?r:e.scrollX,s=null!==(n=e.scrollTop)&&void 0!==n?n:e.scrollY;e.scroll(o+50*Math.sign(t),s+20*Math.sign(i))}),this.listen()}function sk(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function sx(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function sI(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}tt.Z.getSingleton().register("afterDropdownMenuDefaultOptions"),tt.Z.getSingleton().register("beforeDropdownMenuShow"),tt.Z.getSingleton().register("afterDropdownMenuShow"),tt.Z.getSingleton().register("afterDropdownMenuHide"),tt.Z.getSingleton().register("afterDropdownMenuExecute");let sA="dropdownMenu",sN="changeType";var sH=new WeakSet,s_=new WeakSet,sP=new WeakSet,sD=new WeakSet,sL=new WeakSet,sB=new WeakSet,sW=new WeakSet;class sV extends t9{static get PLUGIN_KEY(){return sA}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[nf,np,rO,nb,rO,ng,rO,nm,rO,nd]}constructor(t){super(t),sk(this,sW),sk(this,sB),sk(this,sL),sk(this,sD),sk(this,sP),sk(this,s_),sk(this,sH),sx(this,"commandExecutor",new nc(this.hot)),sx(this,"itemsFactory",null),sx(this,"menu",null),this.hot.addHook("afterGetColHeader",(t,e)=>sI(this,sP,sU).call(this,t,e))}isEnabled(){return this.hot.getSettings()[sA]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new nx(this.hot,sV.DEFAULT_ITEMS);let e=this.hot.getSettings()[sA],i={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);let r=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new n2(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>sI(this,sD,s$).call(this)),this.menu.addLocalHook("afterOpen",()=>sI(this,sL,sz).call(this)),this.menu.addLocalHook("afterSubmenuOpen",t=>sI(this,sB,sK).call(this,t)),this.menu.addLocalHook("afterClose",()=>sI(this,sW,sG).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.executeCommand.call(t,...i)}),(0,u.Bk)(r,t=>this.commandExecutor.registerCommand(t.key,t))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("grid"),e=()=>{let{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);let{from:e}=this.hot.getSelectedRangeLast(),i=rN(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,e.col,!0),n=r.getBoundingClientRect();this.open({left:n.left+i.left,top:n.top+r.offsetHeight+i.top},{left:n.width}),this.menu.getNavigator().toFirstItem()}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:sA},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:sA}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sA)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",t=>sI(this,s_,sj).call(this,t))}open(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),(0,s._l)(i,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];this.commandExecutor.execute(t,...i)}setListening(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function sF(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function sj(t){if(t.stopPropagation(),(0,n.pv)(t.target,sN)){let e=rN(this.menu.container,this.hot.rootDocument),i=t.target.getBoundingClientRect();this.open({left:i.left+e.left,top:i.top+t.target.offsetHeight+3+e.top},{left:i.width})}}function sU(t,e){let i=e.parentNode;if(!i)return;let r=i.parentNode.childNodes,o=Array.prototype.indexOf.call(r,i);if(t<0||o!==r.length-1)return;let s=e.querySelector(`.${sN}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}let l=this.hot.rootDocument.createElement("button");l.className=sN,l.type="button",l.tabIndex=-1,this.hot.getSettings().ariaTags&&((0,n.P$)(l,[(0,m.cV)(),(0,m.QK)(" ")]),(0,n.P$)(e,[(0,m.fv)("menu")])),l.onclick=function(){return!1},e.firstChild.insertBefore(l,e.firstChild.firstChild)}function s$(){this.hot.runHooks("beforeDropdownMenuShow",this)}function sz(){this.hot.runHooks("afterDropdownMenuShow",this),sI(this,sH,sF).call(this,this.menu)}function sK(t){sI(this,sH,sF).call(this,t)}function sG(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function sY(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}sV.SEPARATOR={name:rO};var sX=class{constructor(t){sY(this,"hot",void 0),sY(this,"options",{}),this.hot=t}setOptions(t){this.options=t}getData(){let{startRow:t,startCol:e,endRow:i,endCol:r}=this._getDataRange(),n=this.options,o=[];return(0,tT.q4)(t,i,t=>{let i=[];!n.exportHiddenRows&&this._isHiddenRow(t)||((0,tT.q4)(e,r,e=>{!n.exportHiddenColumns&&this._isHiddenColumn(e)||i.push(this.hot.getDataAtCell(t,e))}),o.push(i))}),o}getRowHeaders(){let t=[];if(this.options.rowHeaders){let{startRow:e,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();(0,tT.q4)(e,i,e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(r[e])})}return t}getColumnHeaders(){let t=[];if(this.options.columnHeaders){let{startCol:e,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();(0,tT.q4)(e,i,e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(r[e])})}return t}_getDataRange(){let t=this.hot.countCols()-1,e=this.hot.countRows()-1,[i=0,r=0,n=e,o=t]=this.options.range;return i=Math.max(i,0),{startRow:i,startCol:r=Math.max(r,0),endRow:n=Math.min(n,e),endCol:o=Math.min(o,t)}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}};function sq(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class sZ{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){sq(this,"dataProvider",void 0),sq(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=(0,s.d9)(this.constructor.DEFAULT_OPTIONS),i=new Date;return e=(0,s.l7)((0,s.d9)(sZ.DEFAULT_OPTIONS),e),(e=(0,s.l7)(e,t)).filename=(0,d.ng)(e.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),e}}var sJ=sZ,sQ=class extends sJ{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){let t=this.options,e=this.dataProvider.getData(),i=this.dataProvider.getColumnHeaders(),r=i.length>0,n=this.dataProvider.getRowHeaders(),o=n.length>0,s=t.bom?String.fromCharCode(65279):"";return r&&(i=(0,u.Sc)(i,t=>this._escapeCell(t,!0)),o&&(s+=t.columnDelimiter),s+=i.join(t.columnDelimiter)+t.rowDelimiter),(0,u.Bk)(e,(e,i)=>{i>0&&(s+=t.rowDelimiter),o&&(s+=this._escapeCell(n[i])+t.columnDelimiter),s+=e.map(t=>this._escapeCell(t)).join(t.columnDelimiter)}),s}_escapeCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=(0,c.Pz)(t);return""!==i&&(e||i.indexOf("\r")>=0||i.indexOf('"')>=0||i.indexOf("\n")>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=`"${i=i.replace(RegExp('"',"g"),'""')}"`),i}};let s0={csv:sQ};class s1 extends t9{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{rootDocument:i,rootWindow:r}=this.hot,n=this._createTypeFormatter(t,e),o=this._createBlob(n),s=r.URL||r.webkitURL,l=i.createElement("a"),a=`${n.options.filename}.${n.options.fileExtension}`;if(void 0!==l.download){let t=s.createObjectURL(o);l.style.display="none",l.setAttribute("href",t),l.setAttribute("download",a),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{s.revokeObjectURL(t)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,a)}_createTypeFormatter(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!s0[t])throw Error(`Export format type "${t}" is not supported.`);return e=new sX(this.hot),"function"==typeof s0[t]?new s0[t](e,i):null}_createBlob(t){let e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}function s2(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i(21767);class s4{constructor(t,e){let{id:i,stateless:r=!0}=e;s2(this,"hot",void 0),s2(this,"id",void 0),s2(this,"elements",[]),s2(this,"hidden",!1),s2(this,"stateId",""),s2(this,"state",void 0),this.hot=t,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new iP.A)}getElements(){return this.elements}reset(){(0,u.Bk)(this.elements,t=>t.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,u.Bk)(this.elements,t=>t.destroy()),this.state=null,this.elements=null,this.hot=null}}(0,s.jB)(s4,rR.Z);let s5={};function s8(t,e){if(!s5[t])throw Error(`Filter condition "${t}" does not exist.`);let{condition:i,descriptor:r}=s5[t],n=e;return r.inputValuesDecorator&&(n=r.inputValuesDecorator(n)),function(t){return i.apply(t.meta.instance,[].concat([t],[n]))}}function s9(t){if(!s5[t])throw Error(`Filter condition "${t}" does not exist.`);return s5[t].descriptor}function s3(t,e,i){i.key=t,s5[t]={condition:e,descriptor:i}}let s7="none";s3(s7,function(){return!0},{name:tp.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});let s6="empty";s3(s6,function(t){return(0,c.xb)(t.value)},{name:tp.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});let lt="not_empty";s3(lt,function(t,e){return!s8(s6,e)(t)},{name:tp.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0}),s3("eq",function(t,e){let[i]=e;return(0,c.Pz)(t.value).toLocaleLowerCase(t.meta.locale)===(0,c.Pz)(i)},{name:tp.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0}),s3("neq",function(t,e){return!s8("eq",e)(t)},{name:tp.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0}),s3("gt",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value>r},{name:tp.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0}),s3("gte",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value>=r},{name:tp.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0}),s3("lt",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value<r},{name:tp.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0}),s3("lte",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value<=r},{name:tp.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});let le="date_after";s3(le,function(t,e){let[i]=e,r=R(t.value,t.meta.dateFormat),n=R(i,t.meta.dateFormat);return!!(r.isValid()&&n.isValid())&&r.diff(n)>=0},{name:tp.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});let li="date_before";s3(li,function(t,e){let[i]=e,r=R(t.value,t.meta.dateFormat),n=R(i,t.meta.dateFormat);return!!(r.isValid()&&n.isValid())&&0>=r.diff(n)},{name:tp.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});let lr="between";s3(lr,function(t,e){let[i,r]=e,n=i,o=r;if("numeric"===t.meta.type){let t=parseFloat(n,10),e=parseFloat(o,10);n=Math.min(t,e),o=Math.max(t,e)}else if("date"===t.meta.type){let e=s8(li,[o]),i=s8(le,[n]);return e(t)&&i(t)}return t.value>=n&&t.value<=o},{name:tp.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});let ln="not_between";s3(ln,function(t,e){return!s8(lr,e)(t)},{name:tp.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});let lo="begins_with";s3(lo,function(t,e){let[i]=e;return(0,c.Pz)(t.value).toLocaleLowerCase(t.meta.locale).startsWith((0,c.Pz)(i))},{name:tp.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});let ls="ends_with";s3(ls,function(t,e){let[i]=e;return(0,c.Pz)(t.value).toLocaleLowerCase(t.meta.locale).endsWith((0,c.Pz)(i))},{name:tp.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});let ll="contains";s3(ll,function(t,e){let[i]=e;return(0,c.Pz)(t.value).toLocaleLowerCase(t.meta.locale).indexOf((0,c.Pz)(i))>=0},{name:tp.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});let la="not_contains";s3(la,function(t,e){return!s8(ll,e)(t)},{name:tp.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});let lh="date_tomorrow";s3(lh,function(t){let e=R(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(R().subtract(-1,"days").startOf("day"),"d")},{name:tp.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});let lu="date_today";s3(lu,function(t){let e=R(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(R().startOf("day"),"d")},{name:tp.FILTERS_CONDITIONS_TODAY,inputsCount:0});let lc="date_yesterday";s3(lc,function(t){let e=R(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(R().subtract(1,"days").startOf("day"),"d")},{name:tp.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});let ld="text",lg={numeric:[s7,rO,s6,lt,rO,"eq","neq",rO,"gt","gte","lt","lte",lr,ln],[ld]:[s7,rO,s6,lt,rO,"eq","neq",rO,lo,ls,rO,ll,la],date:[s7,rO,s6,lt,rO,"eq","neq",rO,li,le,lr,rO,lh,lu,lc]};function lf(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let lp="built",lm="building",lw=["click","input","keydown","keypress","keyup","focus","blur","change"];class lv{static get DEFAULTS(){return(0,s.d9)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){lf(this,"hot",void 0),lf(this,"eventManager",new tc.Z(this)),lf(this,"options",void 0),lf(this,"_element",void 0),lf(this,"buildState",void 0),this.hot=t,this.options=(0,s.l7)(lv.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===lm||(this.buildState===lp?this.update():(this.buildState=lm,this.build(),this.buildState=lp)),this._element}isBuilt(){return this.buildState===lp}translateIfPossible(t){return"string"==typeof t&&t.startsWith(tp.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(t):t}build(){let t=(t,e)=>{this.eventManager.addEventListener(t,e,t=>this.runLocalHooks(e,t,this))};if(this.buildState||(this.buildState=lm),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&(0,n.cn)(this._element,this.options.className),this.options.children.length)(0,u.Bk)(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){let e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),(0,s._l)(this.options,(t,i)=>{void 0!==e[i]&&"className"!==i&&"tagName"!==i&&"children"!==i&&(e[i]=this.translateIfPossible(t))}),this._element.appendChild(e),(0,u.Bk)(lw,i=>t(e,i))}else(0,u.Bk)(lw,e=>t(this._element,e))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function lb(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ly(t,e){var i=lC(t,e,"get");return i.get?i.get.call(t):i.value}function lC(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}(0,s.jB)(lv,rR.Z);var lS=new WeakMap,lE=new WeakSet;class lR extends lv{static get DEFAULTS(){return(0,s.d9)({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){super(t,(0,s.l7)(lR.DEFAULTS,e)),lb(this,lE),lE.add(this),lb(this,lS),lS.set(this,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",t=>(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,lE,lT).call(this,t))}build(){var t;super.build();let e=this.hot.rootDocument.createElement("div");t=this._element.firstChild,function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,lC(this,lS,"set"),t),(0,n.cn)(this._element,"htUIInput"),(0,n.cn)(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ly(this,lS).type=this.options.type,ly(this,lS).placeholder=this.translateIfPossible(this.options.placeholder),ly(this,lS).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&ly(this,lS).focus()}}function lT(t){this.options.value=t.target.value}function lM(t,e){lk(t,e),e.add(t)}function lO(t,e,i){lk(t,e),e.set(t,i)}function lk(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function lx(t,e,i){var r=lN(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function lI(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function lA(t,e){var i=lN(t,e,"get");return i.get?i.get.call(t):i.value}function lN(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var lH=new WeakMap,l_=new WeakMap,lP=new WeakMap,lD=new WeakMap,lL=new WeakMap,lB=new WeakSet,lW=new WeakSet,lV=new WeakSet;class lF extends lv{static get DEFAULTS(){return(0,s.d9)({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){super(t,(0,s.l7)(lF.DEFAULTS,e)),lM(this,lV),lM(this,lW),lM(this,lB),lO(this,lH,{writable:!0,value:null}),lO(this,l_,{writable:!0,value:[]}),lO(this,lP,{writable:!0,value:void 0}),lO(this,lD,{writable:!0,value:void 0}),lO(this,lL,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return lA(this,lH)}registerHooks(){this.addLocalHook("click",()=>lI(this,lV,l$).call(this))}setItems(t){lx(this,l_,this.translateNames(t)),lA(this,lH)&&lA(this,lH).setMenuItems(lA(this,l_))}translateNames(t){return(0,u.Bk)(t,t=>{t.name=this.translateIfPossible(t.name)}),t}build(){super.build(),lx(this,lH,new n2(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),lA(this,lH).setMenuItems(lA(this,l_));let t=new lv(this.hot,{className:"htUISelectCaption"}),e=new lv(this.hot,{className:"htUISelectDropdown"});lx(this,lP,t),lx(this,lD,t.element),lx(this,lL,e),this.hot.getSettings().ariaTags&&((0,n.P$)(e.element,[(0,m.cV)()]),(0,n.P$)(this._element,[(0,m.a6)()])),(0,u.Bk)([t,e],t=>this._element.appendChild(t.element)),lA(this,lH).addLocalHook("select",t=>lI(this,lB,lj).call(this,t)),lA(this,lH).addLocalHook("afterClose",()=>lI(this,lW,lU).call(this)),this.update()}update(){let t;this.isBuilt()&&(t=this.options.value?this.options.value.name:lA(this,lH).hot.getTranslatedPhrase(tp.FILTERS_CONDITIONS_NONE),lA(this,lD).textContent=t,super.update())}openOptions(){let t=this.element.getBoundingClientRect();lA(this,lH)&&(lA(this,lH).open(),lA(this,lH).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),lA(this,lH).getNavigator().toFirstItem(),lA(this,lH).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){lA(this,lH)&&lA(this,lH).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){lA(this,lH)&&(lA(this,lH).destroy(),lx(this,lH,null)),lA(this,lP)&&lA(this,lP).destroy(),lA(this,lL)&&lA(this,lL).destroy(),super.destroy()}}function lj(t){t.name!==rO&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function lU(){this.runLocalHooks("afterClose")}function l$(){this.openOptions()}function lz(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function lK(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function lG(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}var lY=new WeakSet,lX=new WeakSet;class lq extends s4{constructor(t,e){super(t,{id:e.id,stateless:!1}),lz(this,lX),lz(this,lY),lK(this,"name",""),lK(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new lF(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new lR(this.hot,{placeholder:tp.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new lR(this.hot,{placeholder:tp.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",t=>lG(this,lY,lZ).call(this,t)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",t=>this.runLocalHooks("selectTabKeydown",t)),(0,u.Bk)(this.getInputElements(),t=>{t.addLocalHook("keydown",t=>lG(this,lX,lJ).call(this,t))})}setState(t){if(this.reset(),!t)return;let e=(0,s.d9)(t.command);e.name.startsWith(tp.FILTERS_CONDITIONS_NAMESPACE)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),(0,u.Bk)(t.args,(t,i)=>{if(i>e.inputsCount-1)return!1;let r=this.getInputElement(i);r.setValue(t),r[e.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>r.focus(),10)})}getState(){let t=this.getSelectElement().getValue()||s9(s7),e=[];return(0,u.Bk)(this.getInputElements(),(i,r)=>{t.inputsCount>r&&e.push(i.getValue())}),{command:t,args:e}}updateState(t,e){let i=t?s9(t.name):s9(s7);this.state.setValueAtIndex(e,{command:i,args:t?t.args:[]}),t||(0,u.Bk)(this.getInputElements(),t=>t.setValue(null))}getSelectElement(){return this.elements.filter(t=>t instanceof lF)[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter(t=>t instanceof lR)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,i,r,o,s)=>{(0,n.cn)(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,n.cn)(e.parentNode,"border");let l=this.hot.rootDocument.createElement("div");return(0,n.cn)(l,"htFiltersMenuLabel"),l.textContent=s,e.appendChild(l),(0,u.Bk)(this.elements,t=>e.appendChild(t.element)),e}}}reset(){let t=this.hot.getPlugin("filters").getSelectedColumn(),e=[s9(s7)];if(null!==t){let{visualIndex:i}=t;e=function(t){let e=[],i=t;return lg[i]||(i=ld),(0,u.Bk)(lg[i],t=>{let i;i=t===rO?{name:rO}:(0,s.d9)(s9(t)),e.push(i)}),e}(this.hot.getDataType(0,i,this.hot.countRows(),i))}(0,u.Bk)(this.getInputElements(),t=>t.hide()),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function lZ(t){(0,u.Bk)(this.getInputElements(),(e,i)=>{e[t.inputsCount>i?"show":"hide"](),0===i&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function lJ(t){(0,g.ot)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,o.mM)(t))}let lQ={};function l0(t,e,i){lQ[t]={name:e,func:i}}let l1="conjunction",l2=tp.FILTERS_LABELS_CONJUNCTION;l0(l1,l2,function(t,e){return t.every(t=>t.func(e))});let l4="disjunction",l5=tp.FILTERS_LABELS_DISJUNCTION;l0(l4,l5,function(t,e){return t.some(t=>t.func(e))});let l8="disjunctionWithExtraCondition",l9=tp.FILTERS_LABELS_DISJUNCTION;function l3(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function l7(t,e){var i=at(t,e,"get");return i.get?i.get.call(t):i.value}function l6(t,e,i){var r=at(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function at(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}l0(l8,l9,function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(t=>t.func(e))&&t[t.length-1].func(e)});var ae=new WeakMap,ai=new WeakMap;class ar extends lv{static get DEFAULTS(){return(0,s.d9)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,(0,s.l7)(ar.DEFAULTS,e)),l3(this,ae,{writable:!0,value:void 0}),l3(this,ai,{writable:!0,value:void 0})}build(){super.build();let t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),l6(this,ai,t),l6(this,ae,this._element.firstChild),l7(this,ae).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(l7(this,ai).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&l7(this,ae).checked}setChecked(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.isBuilt()&&(l7(this,ae).checked=t)}focus(){this.isBuilt()&&l7(this,ae).focus()}}var an=new WeakSet;class ao extends s4{constructor(t,e){var i,r;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,an),an.add(this),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="name","string"))?r:String(r))in this?Object.defineProperty(this,i,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[i]="",this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>((0,n.cn)(e.parentNode,"htFiltersMenuOperators"),(0,u.Bk)(this.elements,t=>e.appendChild(t.element)),e)}}buildOperatorsElement(){let t=[l1,l4];(0,u.Bk)(t,e=>{let i=new ar(this.hot,{name:"operator",label:{htmlFor:e,textContent:lQ[e].name},value:e,checked:e===t[0],id:e});i.addLocalHook("change",t=>(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,an,as).call(this,t)),this.elements.push(i)})}setChecked(t){if(this.elements.length<t)throw Error(ru.e`Radio button with index ${t} doesn't exist.`);(0,u.Bk)(this.elements,(e,i)=>{e.setChecked(i===t)})}getActiveOperationId(){let t=this.elements.find(t=>t instanceof ar&&t.isChecked());return t?t.getValue():l1}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&(0,u.Bk)(this.elements,e=>{e.setChecked(e.getValue()===t)})}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l1,e=arguments.length>1?arguments[1]:void 0,i=t;i===l8&&(i=l4),this.state.setValueAtIndex(e,i)}reset(){this.setChecked(0)}}function as(t){this.setState(t.target.value)}(0,t7.sx)();let al=new Set([1]).has(1),aa=al&&"function"==typeof Array.from;function ah(t){let e=t;return al&&(e=new Set(e)),function(t){return al?e.has(t):!!~e.indexOf(t)}}function au(t){return null==t?"":t}function ac(t){let e=t;return(e=aa?Array.from(new Set(e)):(0,u.uW)(e)).sort((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1)}function ad(t,e,i,r){let n;let o=[],s=t===e;return s||(n=ah(e)),(0,u.Bk)(t,t=>{let e,l=!1;(s||n(t))&&(l=!0);let a={checked:l,value:t,visualValue:(""===(e=t)&&(e=`(${i})`),e)};r&&r(a),o.push(a)}),o}var ag=i(77628);function af(t,e){var i=ap(t,e,"get");return i.get?i.get.call(t):i.value}function ap(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var am=new WeakMap;class aw extends lv{static get DEFAULTS(){return(0,s.d9)({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,(0,s.l7)(aw.DEFAULTS,e)),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,am),am.set(this,{writable:!0,value:void 0})}build(){var t;super.build(),t=this._element.firstChild,function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,ap(this,am,"set"),t)}update(){this.isBuilt()&&(af(this,am).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&af(this,am).focus()}activate(){af(this,am).click()}}function av(t,e){ay(t,e),e.add(t)}function ab(t,e,i){ay(t,e),e.set(t,i)}function ay(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function aC(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function aS(t,e){var i=aR(t,e,"get");return i.get?i.get.call(t):i.value}function aE(t,e,i){var r=aR(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function aR(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}let aT="multipleSelect.itemBox";var aM=new WeakMap,aO=new WeakMap,ak=new WeakMap,ax=new WeakMap,aI=new WeakMap,aA=new WeakMap,aN=new WeakSet,aH=new WeakSet,a_=new WeakSet,aP=new WeakSet;class aD extends lv{static get DEFAULTS(){return(0,s.d9)({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,(0,s.l7)(aD.DEFAULTS,e)),av(this,aP),av(this,a_),av(this,aH),av(this,aN),ab(this,aM,{writable:!0,value:[]}),ab(this,aO,{writable:!0,value:void 0}),ab(this,ak,{writable:!0,value:void 0}),ab(this,ax,{writable:!0,value:void 0}),ab(this,aI,{writable:!0,value:void 0}),ab(this,aA,{writable:!0,value:void 0}),aE(this,ax,new lR(this.hot,{placeholder:tp.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),aE(this,aI,new aw(this.hot,{textContent:tp.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),aE(this,aA,new aw(this.hot,{textContent:tp.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return aS(this,aO)}registerHooks(){aS(this,ax).addLocalHook("keydown",t=>aC(this,aH,aB).call(this,t)),aS(this,ax).addLocalHook("input",t=>aC(this,aN,aL).call(this,t)),aS(this,aI).addLocalHook("click",t=>aC(this,a_,aW).call(this,t)),aS(this,aA).addLocalHook("click",t=>aC(this,aP,aV).call(this,t))}setItems(t){aE(this,aM,t),aS(this,aO)&&aS(this,aO).loadData(aS(this,aM))}setLocale(t){aE(this,ak,t)}getLocale(){return aS(this,ak)}getItems(){return[...aS(this,aM)]}getValue(){return function(t){let e=[];return(0,u.Bk)(t,t=>{t.checked&&e.push(t.value)}),e}(aS(this,aM))}getSearchInputElement(){return aS(this,ax)}getSelectAllElement(){return aS(this,aI)}getClearAllElement(){return aS(this,aA)}isSelectedAllValues(){return aS(this,aM).length===this.getValue().length}build(){super.build();let{rootDocument:t}=this.hot,e=t.createElement("div"),i=new lv(this.hot,{className:"htUISelectionControls",children:[aS(this,aI),aS(this,aA)]});this._element.appendChild(aS(this,ax).element),this._element.appendChild(i.element),this._element.appendChild(e);let r=e=>{if(!this._element)return;aS(this,aO)&&aS(this,aO).destroy(),(0,n.cn)(e,"htUIMultipleSelectHot"),aE(this,aO,new this.hot.constructor(e,{data:aS(this,aM),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,i,r,n,o)=>{t.title=o.instance.getDataAtRowProp(e,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{aS(this,aO).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>aS(this,aO).container.scrollWidth-(0,n.np)(t),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),aS(this,aO).init();let i=aS(this,aO).getShortcutManager(),r=i.getContext("grid");r.removeShortcutsByKeys(["Tab"]),r.removeShortcutsByKeys(["Shift","Tab"]),r.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:aT}),r.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{aS(this,aO).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:aT})};r(e),this.hot._registerTimeout(()=>r(e),100)}focus(){this.isBuilt()&&aS(this,aO).listen()}reset(){aS(this,ax).reset(),aS(this,aI).reset(),aS(this,aA).reset()}update(){this.isBuilt()&&(aS(this,aO).loadData(function(t,e){let i=ah(e);return(0,u.Sc)(t,t=>(t.checked=i(t.value),t))}(aS(this,aM),this.options.value)),super.update())}destroy(){aS(this,aO)&&aS(this,aO).destroy(),aS(this,ax).destroy(),aS(this,aA).destroy(),aS(this,aI).destroy(),aE(this,ax,null),aE(this,aA,null),aE(this,aI,null),aE(this,aO,null),aE(this,aM,null),super.destroy()}}function aL(t){let e;let i=t.target.value.toLocaleLowerCase(this.getLocale());e=""===i?[...aS(this,aM)]:(0,u.w7)(aS(this,aM),t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(i)>=0),aS(this,aO).loadData(e)}function aB(t){this.runLocalHooks("keydown",t,this);let e=(0,iH.r$)(g.ot,t.keyCode);e("ARROW_DOWN")&&(t.preventDefault(),(0,o.mM)(t),aS(this,aO).listen(),aS(this,aO).selectCell(0,0))}function aW(t){let e=[];t.preventDefault(),(0,u.Bk)(aS(this,aO).getSourceData(),(t,i)=>{t.checked=!0,e.push((0,ag.ec)(t,i)[0])}),aS(this,aO).setSourceDataAtCell(e)}function aV(t){let e=[];t.preventDefault(),(0,u.Bk)(aS(this,aO).getSourceData(),(t,i)=>{t.checked=!1,e.push((0,ag.ec)(t,i)[0])}),aS(this,aO).setSourceDataAtCell(e)}let aF="by_value";s3(aF,function(t,e){let[i]=e;return i(t.value)},{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[ah(e)]},showOperators:!1});var aj=new WeakSet;class aU extends s4{constructor(t,e){var i,r;super(t,{id:e.id,stateless:!1}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,aj),aj.add(this),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="name","string"))?r:String(r))in this?Object.defineProperty(this,i,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[i]="",this.name=e.name,this.elements.push(new aD(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",t=>(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,aj,a$).call(this,t)).addLocalHook("listTabKeydown",t=>this.runLocalHooks("listTabKeydown",t))}getElements(){let t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===aF){let e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){let t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?s7:aF},args:[t.getValue()],itemsSnapshot:e}}updateState(t){let e=(e,i,r,n,o)=>{let[s]=(0,u.w7)(i,t=>t.name===aF),l={},a=this.hot.getTranslatedPhrase(tp.FILTERS_VALUES_BLANK_CELLS);if(s){let i=ac((0,u.Sc)(n(e,o),t=>t.value));r&&(s.args[0]=r);let h=[],c=ad(i,s.args[0],a,t=>{t.checked&&h.push(t.value)}),d=t.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,d).locale,l.args=[h],l.command=s9(aF),l.itemsSnapshot=c}else l.args=[],l.command=s9(s7);this.state.setValueAtIndex(e,l)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(t=>t instanceof aD)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,i,r,o,s)=>{(0,n.cn)(e.parentNode,"htFiltersMenuValue");let l=this.hot.rootDocument.createElement("div");return(0,n.cn)(l,"htFiltersMenuLabel"),l.textContent=s,e.appendChild(l),(0,u.Bk)(this.elements,t=>e.appendChild(t.element)),e}}}reset(){let t=this.hot.getTranslatedPhrase(tp.FILTERS_VALUES_BLANK_CELLS),e=ac(this._getColumnVisibleValues()),i=ad(e,e,t);this.getMultipleSelectElement().setItems(i),super.reset(),this.getMultipleSelectElement().setValue(e);let r=this.hot.getPlugin("filters").getSelectedColumn();null!==r&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,r.visualIndex).locale)}_getColumnVisibleValues(){let t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:(0,u.Sc)(this.hot.getDataAtCol(t.visualIndex),t=>au(t))}}function a$(t){(0,g.ot)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,o.mM)(t))}var az=new WeakSet;class aK extends s4{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){var i,r;super(t,{id:e.id,stateless:!0}),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,az),az.add(this),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="name","string"))?r:String(r))in this?Object.defineProperty(this,i,{value:"",enumerable:!0,configurable:!0,writable:!0}):this[i]="",this.name=e.name,this.elements.push(new lR(this.hot,{type:"button",value:tp.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:aK.BUTTON_OK})),this.elements.push(new lR(this.hot,{type:"button",value:tp.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:aK.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,u.Bk)(this.elements,t=>{t.addLocalHook("click",(t,e)=>(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,az,aG).call(this,t,e))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>((0,n.cn)(e.parentNode,"htFiltersMenuActionBar"),(0,u.Bk)(this.elements,t=>e.appendChild(t.element)),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function aG(t,e){e.options.identifier===aK.BUTTON_OK?this.accept():this.cancel()}function aY(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let aX="ConditionCollection.filteringStates";class aq{constructor(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];aY(this,"hot",void 0),aY(this,"isMapRegistrable",void 0),aY(this,"filteringStates",new iP.A),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(aX,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var i;let r=this.filteringStates.getValueAtIndex(e),n=null!==(i=null==r?void 0:r.conditions)&&void 0!==i?i:[],o=null==r?void 0:r.operation;return this.isMatchInConditions(n,t,o)}isMatchInConditions(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l1;return!t.length||(function(t){if(!lQ[t])throw Error(`Operation with id "${t}" does not exist.`);let e=lQ[t].func;return function(t,i){return e(t,i)}})(i)(t,e)}addCondition(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l1,r=arguments.length>3?arguments[3]:void 0,n=this.hot.getCellMeta(0,t).locale,o=(0,u.Sc)(e.args,t=>"string"==typeof t?t.toLocaleLowerCase(n):t),s=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);let l=this.getOperation(t);if(l){if(l!==i)throw Error(ru.e`The column of index ${t} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,c.o8)(lQ[i]))throw Error(ru.e`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);let a=this.getConditions(t);0===a.length?this.filteringStates.setValueAtIndex(t,{operation:i,conditions:[{name:s,args:o,func:s8(s,o)}]},r):a.push({name:s,args:o,func:s8(s,o)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,i;return null!==(e=null===(i=this.filteringStates.getValueAtIndex(t))||void 0===i?void 0:i.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(t=>{let[e]=t;return e})}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return(0,u.k$)(this.filteringStates.getEntries(),(t,e)=>{let[i,{operation:r,conditions:n}]=e;return t.push({column:i,operation:r,conditions:(0,u.Sc)(n,t=>{let{name:e,args:i}=t;return{name:e,args:i}})}),t},[])}importAllConditions(t){this.clean(),(0,u.Bk)(t,t=>{(0,u.Bk)(t.conditions,e=>this.addCondition(t.column,e))})}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){let i=this.getConditions(t);return e?i.some(t=>t.name===e):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(aX),this.filteringStates=null,this.clearLocalHooks()}}function aZ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,s.jB)(aq,rR.Z);var aJ=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];aZ(this,"conditionCollection",void 0),aZ(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return(0,u.Bk)(this.conditionCollection.getFilteredColumns(),(e,i)=>{let r=this.columnDataFactory(e);i&&(r=this._getIntersectData(r,t)),t=this.filterByColumn(e,r)}),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return(0,u.Bk)(e,e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&i.push(e)}),i}_getIntersectData(t,e){let i=[];return(0,u.Bk)(e,e=>{let r=e.meta.visualRow;void 0!==t[r]&&(i[r]=t[r])}),i}};function aQ(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function a0(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a1(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}var a2=new WeakSet,a4=new WeakSet,a5=new WeakSet;class a8{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];aQ(this,a5),aQ(this,a4),aQ(this,a2),a0(this,"hot",void 0),a0(this,"conditionCollection",void 0),a0(this,"columnDataFactory",void 0),a0(this,"changes",[]),a0(this,"grouping",!1),a0(this,"latestEditedColumnPosition",-1),a0(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",t=>a1(this,a2,a9).call(this,t)),this.conditionCollection.addLocalHook("afterRemove",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("afterAdd",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("beforeClean",()=>a1(this,a4,a3).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>a1(this,a5,a7).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,(0,u.Bk)(this.changes,t=>{this.updateStatesAtColumn(t)}),this.changes.length=0}updateStatesAtColumn(t,e){var i=this;if(this.grouping){-1===this.changes.indexOf(t)&&this.changes.push(t);return}let r=this.conditionCollection.exportAllConditions(),n=this.conditionCollection.getColumnStackPosition(t);-1===n&&(n=this.latestEditedColumnPosition);let o=r.slice(0,n),s=r.slice(n);s.length&&s[0].column===t&&s.shift();let l=(0,iH.WA)(function(t,e){let r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new aq(i.hot,!1),s=[].concat(t,n);o.importAllConditions(s);let l=i.columnDataFactory(e);r=o.isEmpty()?l:new aJ(o,t=>i.columnDataFactory(t)).filter(),r=(0,u.Sc)(r,t=>t.meta.visualRow);let a=ah(r);return o.destroy(),(0,u.w7)(l,t=>a(t.meta.visualRow))})(o),a=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:a},dependentConditionStacks:s,filteredRowsFactory:l,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),(0,s._l)(this,(t,e)=>{this[e]=null})}}function a9(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function a3(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function a7(){(0,u.Bk)(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}(0,s.jB)(a8,rR.Z);let a6="filters";var ht=i(96592);function he(t,e){hi(t,e),e.add(t)}function hi(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function hr(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function hn(t,e){var i=ho(t,e,"get");return i.get?i.get.call(t):i.value}function ho(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function hs(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let hl="filters";var ha=new WeakMap,hh=new WeakSet,hu=new WeakSet,hc=new WeakSet,hd=new WeakSet,hg=new WeakSet,hf=new WeakSet,hp=new WeakSet,hm=new WeakSet,hw=new WeakSet;class hv extends t9{static get PLUGIN_KEY(){return hl}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){super(t),he(this,hw),he(this,hm),he(this,hp),he(this,hf),he(this,hg),he(this,hd),he(this,hc),he(this,hu),he(this,hh),hr(this,"dropdownMenuPlugin",null),hr(this,"conditionCollection",null),hr(this,"conditionUpdateObserver",null),hr(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),hr(this,"filtersRowsMap",null),hi(this,ha),ha.set(this,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(t,e)=>hs(this,hm,hM).call(this,t,e))}isEnabled(){return!!this.hot.getSettings()[hl]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new ht.n),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");let t=this.hot.getSettings().dropdownMenu,e=t&&t.uiContainer||this.hot.rootDocument.body,i=t=>(t.addLocalHook("accept",()=>hs(this,hg,hE).call(this,"accept")),t.addLocalHook("cancel",()=>hs(this,hg,hE).call(this,"cancel")),t.addLocalHook("change",e=>hs(this,hf,hR).call(this,t,e)),t);if(!this.components.get("filter_by_condition")){let t=new lq(this.hot,{id:"filter_by_condition",name:()=>`${this.hot.getTranslatedPhrase(tp.FILTERS_DIVS_FILTER_BY_CONDITION)}:`,addSeparator:!1,menuContainer:e});t.addLocalHook("afterClose",()=>hs(this,hp,hT).call(this)),this.components.set("filter_by_condition",i(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new ao(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){let t=new lq(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:e});t.addLocalHook("afterClose",()=>hs(this,hp,hT).call(this)),this.components.set("filter_by_condition2",i(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",i(new aU(this.hot,{id:"filter_by_value",name:()=>`${this.hot.getTranslatedPhrase(tp.FILTERS_DIVS_FILTER_BY_VALUE)}:`}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",i(new aK(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new aq(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new a8(this.hot,this.conditionCollection,t=>this.getDataMapAtColumn(t)),this.conditionUpdateObserver.addLocalHook("update",t=>hs(this,hw,hO).call(this,t))),this.components.forEach(t=>t.show()),this.addHook("afterDropdownMenuDefaultOptions",t=>hs(this,hd,hS).call(this,t)),this.addHook("afterDropdownMenuShow",()=>hs(this,hu,hy).call(this)),this.addHook("afterDropdownMenuHide",()=>hs(this,hc,hC).call(this)),this.addHook("afterChange",t=>hs(this,hh,hb).call(this,t)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!hn(this,ha)&&this.dropdownMenuPlugin.enabled){var r;let t=this.dropdownMenuPlugin.menu,e=[{focus:()=>{let e=t.getNavigator(),i=hn(this,ha).getLastMenuPage();t.focus(),i>0?e.setCurrentPage(i):e.toFirstItem()}},...Array.from(this.components).map(t=>{let[,e]=t;return e.getElements()}).flat()];r=function(t,e){let i=-1,r=function(t){let e=nj({initialPage:0,size:()=>t.length,onItemSelect:(e,i)=>{let r=t[e];return r instanceof aD?i:(!r.element||!!(0,n.pn)(r.element))&&void r.focus()}});return e}(e),o=i=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(a6),r.setCurrentPage(e.indexOf(i))};function s(n){let o=t.getKeyboardShortcutsCtrl(),s=n.getKeyboardShortcutsCtrl();r.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o.getContext(a6),callback:()=>{n.isSubMenu()&&n.close(),o.listen(a6)}}]),n.isSubMenu()||o.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{let n=t.getNavigator();n.getCurrentPage()>-1&&(i=n.getCurrentPage()),n.clear(),e.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{let i=e[r.getCurrentPage()];i instanceof lF&&(i.openOptions(),t.preventDefault()),i instanceof aw&&(i.activate(),t.preventDefault()),i instanceof lv||t.preventDefault()}}],a6)}return e.forEach(t=>{t instanceof lv&&(t.addLocalHook("click",o(t)),t.addLocalHook("focus",o(t)),t.addLocalHook("afterClose",o(t)))}),t.addLocalHook("afterSelectionChange",t=>{t.key.startsWith("filter_")||r.clear()}),t.addLocalHook("afterSubmenuOpen",s),t.addLocalHook("afterOpen",s),{...r,listen:function(){t.focus(),t.getKeyboardShortcutsCtrl().listen(a6)},getLastMenuPage:function(){return i}}}(t,e),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,ho(this,ha,"set"),r);let i=t=>{hn(this,ha).listen(),t.preventDefault(),(0,g.ot)(t.keyCode,"TAB")&&(t.shiftKey?hn(this,ha).toPreviousItem():hn(this,ha).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",i),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",i)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var t;null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,e)=>{t.destroy(),this.components.set(e,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{let t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:hl})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hl)}addCondition(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l1,n=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(n,{command:{key:e},args:i},r)}removeConditions(t){let e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{let e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}filter(){let{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),i=!this.conditionCollection.isEmpty(),r=[],n=this.conditionCollection.exportAllConditions(),o=this.hot.runHooks("beforeFilter",n);if(!1!==o){if(i){let i=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=(0,u.Sc)(e.filter(),t=>t.meta.visualRow);let t=ah(r);(0,tT.q4)(this.hot.countSourceRows()-1,e=>{t(e)||i.push(e)}),(0,u.Bk)(i,t=>{this.filtersRowsMap.setValueAtIndex(t,!0)})},!0),t||r.length||this.hot.deselectCell()}else this.filtersRowsMap.clear()}this.hot.runHooks("afterFilter",n),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){let e=this.hot.toVisualColumn(t),i=[];return(0,u.Bk)(this.hot.getSourceDataAtCol(e),(t,r)=>{var n;let{row:o,col:s,visualCol:l,visualRow:a,type:h,instance:u,dateFormat:c,locale:d}=this.hot.getCellMeta(r,e),g=null!==(n=this.hot.getDataAtCell(this.hot.toVisualRow(r),e))&&void 0!==n?n:t;i.push({meta:{row:o,col:s,visualCol:l,visualRow:a,type:h,instance:u,dateFormat:c,locale:d},value:au(g)})}),i}updateValueComponentCondition(t){let e=this.hot.getDataAtCol(t),i=ac(e);this.conditionUpdateObserver.updateStatesAtColumn(t,i)}restoreComponents(t){var e;let i=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach(t=>{t.isHidden()||t.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,i,r){let n=t;return n===l4&&e.command.key!==s7&&i.command.key!==s7&&r.command.key!==s7?n=l8:r.command.key!==s7&&(e.command.key===s7||i.command.key===s7)&&(n=l1),n}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){let t=this.components.get("filter_by_condition"),{command:e}=t.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new aJ(t,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){let t=[];if(!this.dropdownMenuPlugin)return t;let e=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];return(0,u.Bk)(r,i=>{(0,u.Bk)(e.menuItems,(e,r)=>{e.key===i.getMenuItemDescriptor().key&&t.push(r)})}),t}changeComponentsVisibility(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.dropdownMenuPlugin)return;let e=this.dropdownMenuPlugin.menu,i=e.hotMenu,r=i.getPlugin("hiddenRows");for(var n=arguments.length,o=Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];let l=this.getIndexesOfComponents(...o);t?r.showRows(l):r.hideRows(l),i.render()}hideComponents(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function hb(t){t&&(0,u.Bk)(t,t=>{let[,e]=t,i=this.hot.propToCol(e);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function hy(){this.restoreComponents(Array.from(this.components.values()))}function hC(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function hS(t){t.items.push({name:rO}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function hE(t){var e,i;if("accept"===t){let t=this.getSelectedColumn();if(null===t){null===(i=this.dropdownMenuPlugin)||void 0===i||i.close();return}let{physicalIndex:e}=t,r=this.components.get("filter_by_condition").getState(),n=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,n,o);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),r.command.key!==s7&&(this.conditionCollection.addCondition(e,r,s,l),n.command.key!==s7&&this.conditionCollection.addCondition(e,n,s,l)),o.command.key!==s7&&this.conditionCollection.addCondition(e,o,s,l),this.conditionUpdateObserver.flush(),this.components.forEach(t=>t.saveState(e)),this.filtersRowsMap.clear(),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function hR(t,e){this.updateDependentComponentsVisibility(),t.constructor!==lq||e.inputsCount||this.setListeningDropdownMenu()}function hT(){this.setListeningDropdownMenu()}function hM(t,e){let i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)?(0,n.cn)(e,"htFiltersActive"):(0,n.IV)(e,"htFiltersActive")}function hO(t){var e;if(!(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled))return;let{editedConditionStack:{conditions:i,column:r}}=t,n=i.filter(t=>t.name===aF),o=i.filter(t=>t.name!==aF);if(n.length>=2||o.length>=3)(0,iu.ZK)(ru.e`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{let e=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(e,r),this.components.get("filter_by_value").updateState(t)}}i(92648);let hk="internal-use-in-handsontable",hx={licenseKey:hk,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function hI(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[uu])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function hA(t){return Object.keys(t).reduce((e,i)=>("hyperformula"!==i&&(e[i]=t[i]),e),{})}function hN(){let t="engine_relationship",e=(0,iZ.Z)(uu);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function hH(){let t="shared_engine_usage",e=(0,iZ.Z)(uu);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function h_(t){var e;let i=hN(),r=0===i.size?[]:Array.from(null!==(e=i.get(t))&&void 0!==e?e:[]);return new Map(r.map(t=>[t.getPlugin("formulas").sheetId,t]))}function hP(t,e){if(t){let i=hN(),r=i.get(t),n=hH(),o=n.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),0===r.length&&i.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),0===o.length&&(n.delete(t),t.destroy()))}}let hD="DD/MM/YYYY";function hL(t){return"string"==typeof t&&"'"===t.charAt(0)&&"="===t.charAt(1)}function hB(t,e){return"string"==typeof t&&"date"===e}function hW(t,e){return R(t,e,!0).isValid()}function hV(t,e){return R(t,e,!0).format(hD)}function hF(t,e){let i=new Date(Date.UTC(0,0,t+-1));return R(i).format(e)}function hj(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function hU(t,e){var i=hz(t,e,"get");return i.get?i.get.call(t):i.value}function h$(t,e,i){var r=hz(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function hz(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var hK=new WeakMap,hG=new WeakMap,hY=new WeakMap,hX=new WeakMap,hq=new WeakMap,hZ=new WeakMap,hJ=new WeakMap,hQ=class{constructor(t,e,i){hj(this,hK,{writable:!0,value:void 0}),hj(this,hG,{writable:!0,value:void 0}),hj(this,hY,{writable:!0,value:void 0}),hj(this,hX,{writable:!0,value:[]}),hj(this,hq,{writable:!0,value:[]}),hj(this,hZ,{writable:!0,value:void 0}),hj(this,hJ,{writable:!0,value:[]}),h$(this,hK,t),h$(this,hG,e),h$(this,hY,i)}setRemovedHfIndexes(t){return h$(this,hJ,t.map(t=>{let e=hU(this,hG).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)})),hU(this,hJ)}getRemovedHfIndexes(){return hU(this,hJ)}getHfIndexFromVisualIndex(t){let e=hU(this,hG).getIndexesSequence(),i=hU(this,hG).getNotTrimmedIndexes();return e.indexOf(i[t])}syncMoves(t){let e=`move${(0,d.ct)(hU(this,hK))}s`;hU(this,hY).getEngine().batch(()=>{t.forEach(t=>{let i=t.from!==t.to,r=t.from+1!==t.to;i&&r&&hU(this,hY).getEngine()[e](hU(this,hY).getSheetId(),t.from,1,t.to)})})}storeMovesInformation(t,e,i){!1!==i&&(h$(this,hq,t.map(t=>this.getHfIndexFromVisualIndex(t))),h$(this,hZ,this.getHfIndexFromVisualIndex(e)))}getMoveLine(t,e){let i=hU(this,hG).getNumberOfIndexes(),r=Array.from(Array(i).keys()).filter(e=>!1===t.includes(e));if(0===e){var n;return null!==(n=r[e])&&void 0!==n?n:0}return r[e-1]+1}getInitiallyCalculatedMoves(t,e){let i=this.getMoveLine(t,e),r=[];return t.forEach(t=>{let e={from:t,to:i};r.forEach(t=>{let i=t.from>t.to,r=t.to<=e.from,n=t.from>e.from;n&&r&&i&&(e.from+=1)}),e.from>=i&&(i+=1),r.push(e)}),r}adjustedCalculatedMoves(t){return t.forEach((e,i)=>{let r=t.slice(i+1);r.forEach(t=>{let i=t.from<t.to;t.from>e.from&&i&&(t.from-=1)})}),t}calculateAndSyncMoves(t,e){if(hU(this,hY).isPerformingUndoRedo()||!1===t||!1===e)return;let i=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(hU(this,hq),hU(this,hZ)));null===hU(this,hY).getSheetId()?hU(this,hY).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){let t=`set${(0,d.ct)(hU(this,hK))}Order`;return e=>{if(hU(this,hY).isPerformingUndoRedo())return;let i=hU(this,hG).getIndexesSequence();if("update"===e){let e;let r=hU(this,hX).map(t=>i.indexOf(t)),n=hU(this,hY).getEngine().getSheetDimensions(hU(this,hY).getSheetId());e="row"===hU(this,hK)?n.height:n.width;let o=r.length;for(let t=o;t<e;t+=1)r.push(t);hU(this,hY).getEngine()[t](hU(this,hY).getSheetId(),r)}h$(this,hX,i)}}init(){h$(this,hX,hU(this,hG).getIndexesSequence())}};function h0(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function h1(t,e){var i=h4(t,e,"get");return i.get?i.get.call(t):i.value}function h2(t,e,i){var r=h4(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function h4(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var h5=new WeakMap,h8=new WeakMap,h9=new WeakMap,h3=new WeakMap,h7=new WeakMap,h6=new WeakMap,ut=new WeakMap,ue=class{constructor(t,e,i){h0(this,h5,{writable:!0,value:void 0}),h0(this,h8,{writable:!0,value:void 0}),h0(this,h9,{writable:!0,value:void 0}),h0(this,h3,{writable:!0,value:!1}),h0(this,h7,{writable:!0,value:!1}),h0(this,h6,{writable:!0,value:null}),h0(this,ut,{writable:!0,value:null}),h2(this,h5,new hQ("row",t,this)),h2(this,h8,new hQ("column",e,this)),h2(this,h9,i)}getForAxis(t){return"row"===t?h1(this,h5):h1(this,h8)}setPerformUndo(t){h2(this,h3,t)}setPerformRedo(t){h2(this,h7,t)}isPerformingUndoRedo(){return h1(this,h3)||h1(this,h7)}getSheetId(){return h1(this,ut)}getEngine(){return h1(this,h6)}getPostponeAction(){return h1(this,h9)}setupSyncEndpoint(t,e){h2(this,h6,t),h2(this,ut,e),h1(this,h5).init(),h1(this,h8).init()}};function ui(t,e){uo(t,e),e.add(t)}function ur(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function un(t,e,i){uo(t,e),e.set(t,i)}function uo(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function us(t,e,i){var r=ua(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function ul(t,e){var i=ua(t,e,"get");return i.get?i.get.call(t):i.value}function ua(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function uh(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let uu="formulas",uc=["maxRows","maxColumns","language"];tt.Z.getSingleton().register("afterNamedExpressionAdded"),tt.Z.getSingleton().register("afterNamedExpressionRemoved"),tt.Z.getSingleton().register("afterSheetAdded"),tt.Z.getSingleton().register("afterSheetRemoved"),tt.Z.getSingleton().register("afterSheetRenamed"),tt.Z.getSingleton().register("afterFormulasValuesUpdate");let ud=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var ug=new WeakMap,uf=new WeakMap,up=new WeakMap,um=new WeakSet,uw=new WeakSet,uv=new WeakSet,ub=new WeakSet,uy=new WeakSet,uC=new WeakSet,uS=new WeakSet,uE=new WeakSet,uR=new WeakSet,uT=new WeakSet,uM=new WeakSet,uO=new WeakSet,uk=new WeakSet,ux=new WeakSet,uI=new WeakSet,uA=new WeakSet,uN=new WeakSet,uH=new WeakSet,u_=new WeakSet,uP=new WeakSet,uD=new WeakSet,uL=new WeakSet,uB=new WeakSet,uW=new WeakSet;class uV extends t9{constructor(){var t;super(...arguments),t=this,ui(this,uW),ui(this,uB),ui(this,uL),ui(this,uD),ui(this,uP),ui(this,u_),ui(this,uH),ui(this,uN),ui(this,uA),ui(this,uI),ui(this,ux),ui(this,uk),ui(this,uO),ui(this,uM),ui(this,uT),ui(this,uR),ui(this,uE),ui(this,uS),ui(this,uC),ui(this,uy),ui(this,ub),ui(this,uv),ui(this,uw),ui(this,um),un(this,ug,{writable:!0,value:!1}),un(this,uf,{writable:!0,value:!1}),un(this,up,{writable:!0,value:[["valuesUpdated",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return uh(t,u_,u8).call(t,...i)}],["namedExpressionAdded",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return uh(t,uP,u9).call(t,...i)}],["namedExpressionRemoved",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return uh(t,uD,u3).call(t,...i)}],["sheetAdded",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return uh(t,uL,u7).call(t,...i)}],["sheetRenamed",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return uh(t,uB,u6).call(t,...i)}],["sheetRemoved",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return uh(t,uW,ct).call(t,...i)}]]}),ur(this,"staticRegister",(0,iZ.Z)("formulas")),ur(this,"engine",null),ur(this,"sheetName",null),ur(this,"indexSyncer",null),ur(this,"rowAxisSyncer",null),ur(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return uu}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[uu,...uc]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[uu]}enablePlugin(){var t,e=this;if(!this.enabled){if(this.engine=null!==(t=function(t){let e=t.getSettings(),i=e[uu],r=null==i?void 0:i.engine;if(!0===i||(0,c.o8)(r))return null;if("function"==typeof r.hyperformula||"function"==typeof r){var n;return function(t,e,i){var r,n;let o=e[uu],s=function(t){var e;let i=t[uu],r=hA(null!=i&&null!==(e=i.engine)&&void 0!==e&&e.hyperformula?i.engine:{}),n=hI(t);return{...hx,...r,...n}}(e),l=hN(),a=hH();(r=o.functions)&&r.forEach(e=>{let{name:i,plugin:r,translations:n}=e;try{t.registerFunction(i,r,n)}catch(t){(0,iu.ZK)(t.message)}}),function(t,e){if(e){let{langCode:i}=e;try{t.registerLanguage(i,e)}catch(t){(0,iu.ZK)(t.message)}}}(t,o.language);let h=t.buildEmpty(s);return l.set(h,[i]),a.set(h,[i.guid]),(n=o.namedExpressions)&&(h.suspendEvaluation(),n.forEach(t=>{let{name:e,expression:i,scope:r,options:n}=t;try{h.addNamedExpression(e,i,r,n)}catch(t){(0,iu.ZK)(t.message)}}),h.resumeEvaluation()),h.on("sheetAdded",()=>{h.rebuildAndRecalculate()}),h.on("sheetRemoved",()=>{h.rebuildAndRecalculate()}),h}(null!==(n=r.hyperformula)&&void 0!==n?n:r,e,t)}if("object"==typeof r&&(0,c.o8)(r.hyperformula)){let e=hN(),i=hH().get(r);return e.has(r)||e.set(r,[]),e.get(r).push(t),i&&i.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:hk}),(r.getConfig().leapYear1900!==hx.leapYear1900||!1===(0,s.Z1)(r.getConfig().nullDate,hx.nullDate))&&(0,iu.ZK)(ru.e`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}(this.hot))&&void 0!==t?t:this.engine,!this.engine){(0,iu.ZK)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){let t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&(this.sheetName=t)}this.addHook("beforeLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uv,uU).call(e,...i)}),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uy,uz).call(e,...i)}),this.addHook("beforeUpdateData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uv,uU).call(e,...i)}),this.addHook("afterUpdateData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uy,uz).call(e,...i)}),this.addHook("modifyData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uC,uK).call(e,...i)}),this.addHook("modifySourceData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uS,uG).call(e,...i)}),this.addHook("beforeValidate",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,um,uF).call(e,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uR,uX).call(e,...i)}),this.addHook("afterSetDataAtCell",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uE,uY).call(e,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uE,uY).call(e,...i)}),this.addHook("beforeCreateRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uT,uq).call(e,...i)}),this.addHook("beforeCreateCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uM,uZ).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,ux,u0).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uI,u1).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uO,uJ).call(e,...i)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uk,uQ).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uA,u2).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uN,u4).call(e,...i)}),this.indexSyncer=new ue(this.hot.rowIndexMapper,this.hot.columnIndexMapper,t=>{this.hot.addHookOnce("init",()=>{t()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(t,e,i,r)=>{this.rowAxisSyncer.storeMovesInformation(t,e,r)}),this.hot.addHook("beforeColumnMove",(t,e,i,r)=>{this.columnAxisSyncer.storeMovesInformation(t,e,r)}),this.hot.addHook("afterRowMove",(t,e,i,r,n)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,n)}),this.hot.addHook("afterColumnMove",(t,e,i,r,n)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,n)}),this.hot.addHook("beforeColumnFreeze",(t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)}),this.hot.addHook("afterColumnFreeze",(t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)}),this.hot.addHook("beforeColumnUnfreeze",(t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)}),this.hot.addHook("afterColumnUnfreeze",(t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)}),this.addHook("afterCellMetaReset",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,ub,u$).call(e,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uH,u5).call(e,...i)}),this.addHook("beforeAutofill",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uh(e,uw,uj).call(e,...i)}),ul(this,up).forEach(t=>{let[e,i]=t;return this.engine.on(e,i)}),super.enablePlugin()}}disablePlugin(){ul(this,up).forEach(t=>{let[e,i]=t;return this.engine.off(e,i)}),hP(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){var e;let i=function(t){var e;let i=t[uu],r=hA(null!=i&&null!==(e=i.engine)&&void 0!==e&&e.hyperformula?i.engine:{}),n=hI(t);return{...r,...n}}(this.hot.getSettings());e=this.engine.getConfig(),Object.keys(i).some(t=>void 0!==i[t]&&i[t]!==e[t])&&this.engine.updateConfig(i);let r=this.hot.getSettings()[uu];if((0,c.$K)(r)&&(0,c.$K)(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!t.data&&null===this.sheetName){let t=this.hot.getSettings()[uu].sheetName;t&&this.engine.doesSheetExist(t)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!=t?t:void 0,this.hot.getSourceDataArray())}super.updatePlugin(t)}destroy(){ul(this,up).forEach(t=>{var e;let[i,r]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(i,r)}),us(this,up,null),hP(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if((0,c.$K)(e)&&!(0,ag.Jr)(e))return(0,iu.ZK)("The provided data should be an array of arrays."),!1;if(null!=t&&this.engine.doesSheetExist(t))return(0,iu.ZK)("Sheet with the provided name already exists."),!1;try{let i=this.engine.addSheet(null!=t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(i),e),i}catch(t){return(0,iu.ZK)(t.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t)){(0,iu.vU)(`The sheet named \`${t}\` does not exist, switch aborted.`);return}this.sheetName=t;let e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${(0,d.ct)(uu)}.switchSheet`)}getCellType(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(t),n=this.hot.toPhysicalColumn(e);return null!==r&&null!==n?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=new Set;t.forEach(t=>{var e;let r=null==t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0===r||i.has(r)||i.add(r)}),h_(this.engine).forEach((t,r)=>{if((e||r!==this.sheetId)&&i.has(r)){var n;t.render(),null===(n=t.view)||void 0===n||n.adjustElementsSize()}})}validateDependentCells(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=t=>{var e;let{row:i,col:r,sheet:n}=null!==(e=null==t?void 0:t.address)&&void 0!==e?e:{};return(0,c.$K)(n)?`${n}:${i}x${r}`:""},r=new Set(e.map(t=>i(t)));t.forEach(t=>{var e,n;let{row:o,col:s}=null!==(e=t.address)&&void 0!==e?e:{};if(!1===(0,c.$K)(o)||!1===(0,c.$K)(s)||o>=this.hot.countRows()||s>=this.hot.countCols())return;let l=null==t||null===(n=t.address)||void 0===n?void 0:n.sheet,a=i(t);if(void 0!==l&&!r.has(a)){let t=h_(this.engine).get(l);if(!t)return;t.validateCell(t.getDataAtCell(o,s),t.getCellMeta(o,s),()=>{})}})}syncChangeWithEngine(t,e,i){let r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){(0,iu.ZK)(`Not possible to set cell data at ${JSON.stringify(r)}`);return}let n=this.hot.getCellMeta(t,e);if(hB(i,n.type)){if(hW(i,n.dateFormat))i=hV(i,n.dateFormat);else{var o;!1===("string"==typeof(o=i)&&o.startsWith("="))&&(i=`'${i}`)}}return this.engine.setCellContents(r,i)}}function uF(t,e,i){let r=this.hot.propToCol(i);if(this.isFormulaCellType(e,r)){let t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},i=this.hot.getCellMeta(e,r),n=this.engine.getCellValue(t);return"date"===i.type&&(0,tT.kE)(n)&&(n=hF(n,i.dateFormat)),"object"==typeof n&&null!==n?n.value:n}return t}function uj(t,e,i){let{row:r,col:n}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:l,col:a}=i.getTopStartCorner(),{row:h,col:u}=i.getBottomEndCorner(),c={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;let g=this.engine.getFillRangeData(c,d),{row:f,col:p}=c.start,{row:m,col:w}=c.end,b=m-f+1,y=w-p+1;for(let t=0;t<g.length;t+=1)for(let e=0;e<g[t].length;e+=1){let i=g[t][e],r=t%b,n=e%y,o=this.hot.getCellMeta(r,n);if(hB(i,o.type)){if(i.startsWith("'"))g[t][e]=i.slice(1);else if(!1===this.isFormulaCellType(r,n,this.sheetId)){var C;g[t][e]=(C=o.dateFormat,R(i,hD,!0).format(C))}}}return g}function uU(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";i.includes((0,d.ct)(uu))||us(this,uf,(0,c.o8)(this.hot.getSettings().data))}function u$(){let t=this.hot.getSourceDataArray(),e=!1;t.forEach((i,r)=>{i.forEach((i,n)=>{let o=this.hot.getCellMeta(r,n),s=o.dateFormat;hB(i,o.type)&&(e=!0,hW(i,s)?t[r][n]=hV(i,s):!1===this.isFormulaCellType(r,n)&&(t[r][n]=`'${i}`))})}),!0===e&&(us(this,ug,!0),this.engine.setSheetContent(this.sheetId,t),us(this,ug,!1))}function uz(t,e){var i,r;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!n.includes((0,d.ct)(uu))){if(this.sheetName=(i=this.engine,r=this.hot.getSettings()[uu].sheetName,((0,c.o8)(r)||!i.doesSheetExist(r))&&(r=i.addSheet(r)),r),ul(this,uf))this.switchSheet(this.sheetName);else{let t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){us(this,ug,!0);let e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),us(this,ug,!1)}}}}function uK(t,e,i,r){if("get"!==r||ul(this,ug)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;let n=this.hot.toVisualRow(t);if(null===n||null===e)return;let o=this.isFormulaCellType(n,e);if(!o){let t=this.getCellType(n,e);if("ARRAY"!==t){if(hL(i.value)){var s;i.value=hL(s=i.value)?s.substr(1):s}return}}let l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId},a=this.engine.getCellValue(l),h=this.hot.getCellMeta(n,e);"date"===h.type&&(0,tT.kE)(a)&&(a=hF(a,h.dateFormat));let u="object"==typeof a&&null!==a?a.value:a;i.value=u}function uG(t,e,i,r){if("get"!==r||ul(this,ug)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;let n=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(null===n||null===o)return;let s=this.isFormulaCellType(n,o);if(!s){let t=this.getCellType(n,o);if("ARRAY"!==t)return}let l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===l.width&&0===l.height)return;let a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};i.value=this.engine.getCellSerialized(a)}function uY(t,e){if(ud(e))return;let i=[],r=[],n=this.engine.batch(()=>{t.forEach(t=>{let[e,n,,o]=t,s=this.hot.propToCol(n),l=this.hot.toPhysicalRow(e),a=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(e,s,o):i.push([e,s,o]),r.push({address:h})})});i.length&&this.hot.addHookOnce("afterChange",()=>{let t=this.engine.batch(()=>{i.forEach(t=>{let[e,i,r]=t;this.syncChangeWithEngine(e,i,r)})});this.renderDependentSheets(t,!0)}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function uX(t,e){if(ud(e))return;let i=[],r=[];t.forEach(t=>{let[e,n,,o]=t,s=this.hot.propToCol(n);if(!(0,tT.kE)(s))return;let l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){(0,iu.ZK)(`Not possible to set source cell data at ${JSON.stringify(l)}`);return}r.push({address:l}),i.push(...this.engine.setCellContents(l,o))}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function uq(t,e){let i=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(i=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[i,e]))return!1}function uZ(t,e){let i=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(i=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[i,e]))return!1}function uJ(t,e,i){let r=this.rowAxisSyncer.setRemovedHfIndexes(i),n=r.every(t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1]));return!1!==n&&void 0}function uQ(t,e,i){let r=this.columnAxisSyncer.setRemovedHfIndexes(i),n=r.every(t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1]));return!1!==n&&void 0}function u0(t,e,i){if(ud(i))return;let r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function u1(t,e,i){if(ud(i))return;let r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function u2(t,e,i,r){if(ud(r))return;let n=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{n.forEach(t=>{this.engine.removeRows(this.sheetId,[t,1])})});this.renderDependentSheets(o)}function u4(t,e,i,r){if(ud(r))return;let n=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{n.forEach(t=>{this.engine.removeColumns(this.sheetId,[t,1])})});this.renderDependentSheets(o)}function u5(t,e,i){var r;us(this,ug,!0);let n=this.hot.getSourceDataArray(i,0,i+((null===(r=e.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());us(this,ug,!1),n.forEach((t,e)=>{t.forEach((t,r)=>{this.engine.setCellContents({col:r,row:i+e,sheet:this.sheetId},[[t]])})})}function u8(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function u9(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function u3(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function u7(t){this.hot.runHooks("afterSheetAdded",t)}function u6(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function ct(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}var ce=i(27392);function ci(t,e){cn(t,e),e.add(t)}function cr(t,e,i){cn(t,e),e.set(t,i)}function cn(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function co(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function cs(t,e){var i=ca(t,e,"get");return i.get?i.get.call(t):i.value}function cl(t,e,i){var r=ca(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function ca(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}tt.Z.getSingleton().register("beforeHideColumns"),tt.Z.getSingleton().register("afterHideColumns"),tt.Z.getSingleton().register("beforeUnhideColumns"),tt.Z.getSingleton().register("afterUnhideColumns");let ch="hiddenColumns";var cu=new WeakMap,cc=new WeakMap,cd=new WeakSet,cg=new WeakSet,cf=new WeakSet,cp=new WeakSet,cm=new WeakSet,cw=new WeakSet;class cv extends t9{constructor(){super(...arguments),ci(this,cw),ci(this,cm),ci(this,cp),ci(this,cf),ci(this,cg),ci(this,cd),cr(this,cu,{writable:!0,value:{}}),cr(this,cc,{writable:!0,value:null})}static get PLUGIN_KEY(){return ch}static get PLUGIN_PRIORITY(){return 310}isEnabled(){return!!this.hot.getSettings()[ch]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[ch];(0,s.Kn)(e)&&(cl(this,cu,e),(0,c.o8)(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),cl(this,cc,new ce.o),cs(this,cc).addLocalHook("init",()=>co(this,cw,cR).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,cs(this,cc)),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return co(t,cm,cE).call(t,...i)}),this.addHook("afterGetCellMeta",(t,e,i)=>co(this,cg,cy).call(this,t,e,i)),this.addHook("modifyColWidth",(t,e)=>co(this,cd,cb).call(this,t,e)),this.addHook("afterGetColHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return co(t,cp,cS).call(t,...i)}),this.addHook("modifyCopyableRange",t=>co(this,cf,cC).call(this,t)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),cl(this,cu,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(t){let e=this.getHiddenColumns(),i=this.isValidConfig(t),r=e,n=cs(this,cc).getValues().slice(),o=t.length>0;if(i&&o){let e=t.map(t=>this.hot.toPhysicalColumn(t));(0,u.Bk)(e,t=>{n[t]=!1}),r=(0,u.k$)(n,(t,e,i)=>(e&&t.push(this.hot.toVisualColumn(i)),t),[])}let s=this.hot.runHooks("beforeUnhideColumns",e,r,i&&o);!1!==s&&(i&&o&&cs(this,cc).setValues(n),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,r,i&&o,i&&r.length<e.length))}showColumn(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.showColumns(e)}hideColumns(t){let e=this.getHiddenColumns(),i=this.isValidConfig(t),r=e;i&&(r=Array.from(new Set(e.concat(t))));let n=this.hot.runHooks("beforeHideColumns",e,r,i);!1!==n&&(i&&this.hot.batchExecution(()=>{(0,u.Bk)(t,t=>{cs(this,cc).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)})},!0),this.hot.runHooks("afterHideColumns",e,r,i,i&&r.length>e.length))}hideColumn(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.hideColumns(e)}getHiddenColumns(){return(0,u.Sc)(cs(this,cc).getHiddenIndexes(),t=>this.hot.toVisualColumn(t))}isHidden(t){return cs(this,cc).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){let e=this.hot.countCols();return!!Array.isArray(t)&&t.length>0&&t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}resetCellsMeta(){(0,u.Bk)(this.hot.getCellsMeta(),t=>{t&&(t.skipColumnOnPaste=!1)})}destroy(){cl(this,cu,null),cl(this,cc,null),super.destroy()}}function cb(t,e){return this.isHidden(e)?0:cs(this,cu).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"==typeof t&&this.hot.hasColHeaders()?t+15:void 0}function cy(t,e,i){if(!1===cs(this,cu).copyPasteEnabled&&this.isHidden(e)&&(i.skipColumnOnPaste=!0),this.isHidden(e-1))i.className=i.className||"",-1===i.className.indexOf("afterHiddenColumn")&&(i.className+=" afterHiddenColumn");else if(i.className){let t=i.className.split(" ");if(t.length>0){let e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),i.className=t.join(" ")}}}function cC(t){if(cs(this,cu).copyPasteEnabled)return t;let e=[],i=(t,i,r,n)=>{e.push({startRow:t,endRow:i,startCol:r,endCol:n})};return(0,u.Bk)(t,t=>{let e=!0,r=0;(0,tT.q4)(t.startCol,t.endCol,n=>{this.isHidden(n)?(e||i(t.startRow,t.endRow,r,n-1),e=!0):(e&&(r=n),n===t.endCol&&i(t.startRow,t.endRow,r,n),e=!1)})}),e}function cS(t,e){if(!cs(this,cu).indicators||t<0)return;let i=[];t>=1&&this.isHidden(t-1)&&i.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&i.push("beforeHiddenColumn"),(0,n.cn)(e,i)}function cE(t){var e;t.items.push({name:rO},(e=this,{key:"hidden_columns_hide",name(){let t=this.getSelectedLast(),e=0;if(Array.isArray(t)){let[,i,,r]=t;i-r!=0&&(e=1)}return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_HIDE_COLUMN,e)},callback(){let{from:t,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(t.col,i.col),0),n=Math.max(t.col,i.col),o=[];for(let t=r;t<=n;t+=1)o.push(t);e.hideColumns(o);let s=o[o.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(t){let e=[];return{key:"hidden_columns_show",name(){let t=e.length>1?1:0;return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_SHOW_COLUMN,t)},callback(){var i,r;if(0===e.length)return;let n=e[0],o=e[e.length-1];n=null!==(i=this.columnIndexMapper.getNearestNotHiddenIndex(n-1,-1))&&void 0!==i?i:0,o=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0);let s=o-n+1===this.countCols();s||this.selectColumns(n,o)},disabled:!1,hidden(){let i=(0,u.Sc)(t.getHiddenColumns(),t=>this.toPhysicalColumn(t));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),n=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(n),a=s.getRenderableFromVisualIndex(o),h=s.getNotTrimmedIndexes(),c=[];if(n!==o){let t=o-n+1;if(t>a-l+1){let t=h.slice(n,o+1);c.push(...t.filter(t=>i.includes(t)))}}else if(0===l&&l<n)c.push(...h.slice(0,n));else if(null===l)c.push(...h.slice(0,this.countCols()));else{let t=this.countCols()-1,e=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1));a===e&&t>o&&c.push(...h.slice(o+1))}return(0,u.Bk)(c,t=>{e.push(this.toVisualColumn(t))}),0===e.length}}}(this))}function cR(){Array.isArray(cs(this,cu).columns)&&this.hideColumns(cs(this,cu).columns)}function cT(t,e){cO(t,e),e.add(t)}function cM(t,e,i){cO(t,e),e.set(t,i)}function cO(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ck(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function cx(t,e){var i=cA(t,e,"get");return i.get?i.get.call(t):i.value}function cI(t,e,i){var r=cA(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function cA(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}tt.Z.getSingleton().register("beforeHideRows"),tt.Z.getSingleton().register("afterHideRows"),tt.Z.getSingleton().register("beforeUnhideRows"),tt.Z.getSingleton().register("afterUnhideRows");let cN="hiddenRows";var cH=new WeakMap,c_=new WeakMap,cP=new WeakSet,cD=new WeakSet,cL=new WeakSet,cB=new WeakSet,cW=new WeakSet,cV=new WeakSet;class cF extends t9{constructor(){super(...arguments),cT(this,cV),cT(this,cW),cT(this,cB),cT(this,cL),cT(this,cD),cT(this,cP),cM(this,cH,{writable:!0,value:{}}),cM(this,c_,{writable:!0,value:null})}static get PLUGIN_KEY(){return cN}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[cN]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[cN];(0,s.Kn)(e)&&(cI(this,cH,e),(0,c.o8)(e.copyPasteEnabled)&&(e.copyPasteEnabled=!0)),cI(this,c_,new ce.o),cx(this,c_).addLocalHook("init",()=>ck(this,cV,cG).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,cx(this,c_)),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ck(t,cW,cK).call(t,...i)}),this.addHook("afterGetCellMeta",(t,e,i)=>ck(this,cD,cU).call(this,t,e,i)),this.addHook("modifyRowHeight",(t,e)=>ck(this,cP,cj).call(this,t,e)),this.addHook("afterGetRowHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ck(t,cB,cz).call(t,...i)}),this.addHook("modifyCopyableRange",t=>ck(this,cL,c$).call(this,t)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),cI(this,cH,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(t){let e=this.getHiddenRows(),i=this.isValidConfig(t),r=e,n=cx(this,c_).getValues().slice(),o=t.length>0;if(i&&o){let e=t.map(t=>this.hot.toPhysicalRow(t));(0,u.Bk)(e,t=>{n[t]=!1}),r=(0,u.k$)(n,(t,e,i)=>(e&&t.push(this.hot.toVisualRow(i)),t),[])}let s=this.hot.runHooks("beforeUnhideRows",e,r,i&&o);!1!==s&&(i&&o&&cx(this,c_).setValues(n),this.hot.runHooks("afterUnhideRows",e,r,i&&o,i&&r.length<e.length))}showRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.showRows(e)}hideRows(t){let e=this.getHiddenRows(),i=this.isValidConfig(t),r=e;i&&(r=Array.from(new Set(e.concat(t))));let n=this.hot.runHooks("beforeHideRows",e,r,i);!1!==n&&(i&&this.hot.batchExecution(()=>{(0,u.Bk)(t,t=>{cx(this,c_).setValueAtIndex(this.hot.toPhysicalRow(t),!0)})},!0),this.hot.runHooks("afterHideRows",e,r,i,i&&r.length>e.length))}hideRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.hideRows(e)}getHiddenRows(){return(0,u.Sc)(cx(this,c_).getHiddenIndexes(),t=>this.hot.toVisualRow(t))}isHidden(t){return cx(this,c_).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){let e=this.hot.countRows();return!!Array.isArray(t)&&t.length>0&&t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}resetCellsMeta(){(0,u.Bk)(this.hot.getCellsMeta(),t=>{t&&(t.skipRowOnPaste=!1)})}destroy(){cI(this,cH,null),cI(this,c_,null),super.destroy()}}function cj(t,e){return this.isHidden(e)?0:t}function cU(t,e,i){if(!1===cx(this,cH).copyPasteEnabled&&this.isHidden(t)&&(i.skipRowOnPaste=!0),this.isHidden(t-1))i.className=i.className||"",-1===i.className.indexOf("afterHiddenRow")&&(i.className+=" afterHiddenRow");else if(i.className){let t=i.className.split(" ");if(t.length>0){let e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),i.className=t.join(" ")}}}function c$(t){if(cx(this,cH).copyPasteEnabled)return t;let e=[],i=(t,i,r,n)=>{e.push({startRow:t,endRow:i,startCol:r,endCol:n})};return(0,u.Bk)(t,t=>{let e=!0,r=0;(0,tT.q4)(t.startRow,t.endRow,n=>{this.isHidden(n)?(e||i(r,n-1,t.startCol,t.endCol),e=!0):(e&&(r=n),n===t.endRow&&i(r,n,t.startCol,t.endCol),e=!1)})}),e}function cz(t,e){if(!cx(this,cH).indicators||t<0)return;let i=[];t>=1&&this.isHidden(t-1)&&i.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&i.push("beforeHiddenRow"),(0,n.cn)(e,i)}function cK(t){var e;t.items.push({name:rO},(e=this,{key:"hidden_rows_hide",name(){let t=this.getSelectedLast(),e=0;if(Array.isArray(t)){let[i,,r]=t;i-r!=0&&(e=1)}return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_HIDE_ROW,e)},callback(){let{from:t,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(t.row,i.row),0),n=Math.max(t.row,i.row),o=[];for(let t=r;t<=n;t+=1)o.push(t);e.hideRows(o);let s=o[o.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(t){let e=[];return{key:"hidden_rows_show",name(){let t=e.length>1?1:0;return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_SHOW_ROW,t)},callback(){var i,r;if(0===e.length)return;let n=e[0],o=e[e.length-1];n=null!==(i=this.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1))&&void 0!==i?i:0,o=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0);let s=o-n+1===this.countRows();s||this.selectRows(n,o)},disabled:!1,hidden(){let i=(0,u.Sc)(t.getHiddenRows(),t=>this.toPhysicalRow(t));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),n=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(n),a=s.getRenderableFromVisualIndex(o),h=s.getNotTrimmedIndexes(),c=[];if(n!==o){let t=o-n+1;if(t>a-l+1){let t=h.slice(n,o+1);c.push(...t.filter(t=>i.includes(t)))}}else if(0===l&&l<n)c.push(...h.slice(0,n));else if(null===l)c.push(...h.slice(0,this.countRows()));else{let t=this.countRows()-1,e=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1));a===e&&t>o&&c.push(...h.slice(o+1))}return(0,u.Bk)(c,t=>{e.push(this.toVisualRow(t))}),0===e.length}}}(this))}function cG(){Array.isArray(cx(this,cH).rows)&&this.hideRows(cx(this,cH).rows)}function cY(t,e){cX(t,e),e.add(t)}function cX(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function cq(t,e){var i=cJ(t,e,"get");return i.get?i.get.call(t):i.value}function cZ(t,e,i){var r=cJ(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function cJ(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function cQ(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}tt.Z.getSingleton().register("beforeColumnFreeze"),tt.Z.getSingleton().register("afterColumnFreeze"),tt.Z.getSingleton().register("beforeColumnUnfreeze"),tt.Z.getSingleton().register("afterColumnUnfreeze");let c0="manualColumnFreeze";var c1=new WeakMap,c2=new WeakSet,c4=new WeakSet;class c5 extends t9{constructor(){super(...arguments),cY(this,c4),cY(this,c2),cX(this,c1),c1.set(this,{writable:!0,value:!1})}static get PLUGIN_KEY(){return c0}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[c0]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",t=>cQ(this,c2,c8).call(this,t)),this.addHook("beforeColumnMove",(t,e)=>cQ(this,c4,c9).call(this,t,e)),super.enablePlugin())}disablePlugin(){cZ(this,c1,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){let e=this.hot.getSettings(),i=e.fixedColumnsStart<this.hot.countCols()&&t>e.fixedColumnsStart-1;cq(this,c1)||cZ(this,c1,!0);let r=this.hot.runHooks("beforeColumnFreeze",t,i);!1!==r&&(i&&(this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart),e._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,i))}unfreezeColumn(t){let e=this.hot.getSettings(),i=e.fixedColumnsStart>0&&t<=e.fixedColumnsStart-1;cq(this,c1)||cZ(this,c1,!0);let r=this.hot.runHooks("beforeColumnUnfreeze",t,i);!1!==r&&(i&&(e._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,i))}}function c8(t){var e,i;t.items.push({name:"---------"},(e=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(t,i){let[{start:{col:r}}]=i;e.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){let t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}),(i=this,{key:"unfreeze_column",name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(t,e){let[{start:{col:r}}]=e;i.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){let t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}))}function c9(t,e){if(cq(this,c1)){let i=this.hot.getSettings().fixedColumnsStart;if(e<i||t.some(t=>t<i))return!1}}function c3(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c7=class{constructor(t){c3(this,"hot",void 0),c3(this,"_element",null),c3(this,"state",0),c3(this,"inlineProperty",void 0),this.hot=t,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){(0,tT.kE)(t)&&(this._element.style.top=t+"px"),(0,tT.kE)(e)&&(this._element.style[this.inlineProperty]=e+"px")}getPosition(){let t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){(0,tT.kE)(t)&&(this._element.style.width=t+"px"),(0,tT.kE)(e)&&(this._element.style.height=e+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){(0,tT.kE)(t)&&(this._element.style.marginTop=t+"px"),(0,tT.kE)(e)&&(this._element.style[`margin${(0,d.ct)(this.inlineProperty)}`]=e+"px")}getOffset(){let t=this._element.style,e=`margin${(0,d.ct)(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}},c6=class extends c7{build(){super.build(),(0,n.cn)(this._element,"ht__manualColumnMove--backlight")}},dt=class extends c7{build(){super.build(),(0,n.cn)(this._element,"ht__manualColumnMove--guideline")}};function de(t,e){dr(t,e),e.add(t)}function di(t,e,i){dr(t,e),e.set(t,i)}function dr(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function dn(t,e,i){var r=dl(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function ds(t,e){var i=dl(t,e,"get");return i.get?i.get.call(t):i.value}function dl(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function da(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}tt.Z.getSingleton().register("beforeColumnMove"),tt.Z.getSingleton().register("afterColumnMove");let dh="manualColumnMove",du="ht__manualColumnMove",dc="show-ui",dd="on-moving--columns",dg="after-selection--columns";var df=new WeakMap,dp=new WeakMap,dm=new WeakMap,dw=new WeakMap,dv=new WeakMap,db=new WeakMap,dy=new WeakMap,dC=new WeakMap,dS=new WeakMap,dE=new WeakMap,dR=new WeakMap,dT=new WeakSet,dM=new WeakSet,dO=new WeakSet,dk=new WeakSet,dx=new WeakSet,dI=new WeakSet;class dA extends t9{constructor(){super(...arguments),de(this,dI),de(this,dx),de(this,dk),de(this,dO),de(this,dM),de(this,dT),di(this,df,{writable:!0,value:new c6(this.hot)}),di(this,dp,{writable:!0,value:new dt(this.hot)}),di(this,dm,{writable:!0,value:[]}),di(this,dw,{writable:!0,value:0}),di(this,dv,{writable:!0,value:!1}),di(this,db,{writable:!0,value:{}}),di(this,dy,{writable:!0,value:void 0}),di(this,dC,{writable:!0,value:void 0}),di(this,dS,{writable:!0,value:void 0}),di(this,dE,{writable:!0,value:void 0}),di(this,dR,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return dh}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[dh]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return da(t,dT,dN).call(t,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return da(t,dO,d_).call(t,...i)}),this.addHook("afterScrollVertically",()=>da(this,dx,dD).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return da(t,dI,dL).call(t,...i)}),this.buildPluginUI(),this.registerEvents(),(0,n.cn)(this.hot.rootElement,du),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,n.IV)(this.hot.rootElement,du),this.unregisterEvents(),ds(this,df).destroy(),ds(this,dp).destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){let i=ds(this,dy),r=this.isMovePossible(t,e),n=this.hot.runHooks("beforeColumnMove",t,e,i,r);if(dn(this,dy,void 0),!1===n)return;r&&this.hot.columnIndexMapper.moveIndexes(t,e);let o=r&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,i,r,o),o}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){let i=this.countFinalIndex(t,e);return dn(this,dy,e),this.moveColumns(t,i)}isMovePossible(t,e){let i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>i,n=t.some(t=>t<0),o=t.some(t=>t>=i);return!r&&!(e<0)&&!n&&!o}isColumnOrderChanged(t,e){return t.some((t,i)=>t-i!==e)}countFinalIndex(t,e){let i=(0,u.k$)(t,(t,i)=>(i<e&&(t+=1),t),0);return e-i}getColumnsWidth(t,e){let i=this.hot.columnIndexMapper,r=0;for(let n=t;n<=e;n+=1){let t=i.getRenderableFromVisualIndex(n);n<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(r+=this.hot.view._wt.wtTable.getStretchedColumnWidth(t)||0)}return r}moveBySettingsOrLoad(){let t=this.hot.getSettings()[dh];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){let t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){let t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){let i=[];return(0,tT.q4)(t,e,t=>{i.push(t)}),i}refreshPositions(){let t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ds(this,dC))&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});let e=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r="number"==typeof i.scrollX?i.scrollX:i.scrollLeft,o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ds(this,dC)-1),s=e.hider.offsetWidth,l=e.TBODY.offsetLeft,a=ds(this,df).getOffset().start,h=ds(this,df).getSize().width,u=0,c=0;if(this.hot.isRtl()){let t=this.hot.rootWindow,e=(0,n.iO)(this.hot.rootElement),o=t.innerWidth-ds(this,dS)-e;c=t.innerWidth-ds(this,db).eventPageX-o-(void 0===i.scrollX?r:0)}else c=ds(this,db).eventPageX-(ds(this,dS)-(void 0===i.scrollX?r:0));if(ds(this,dE)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ds(this,dC))&&(o+=r),o+=u,0>ds(this,dC))ds(this,dR)>0?ds(this,db).col=0:ds(this,db).col=t>0?t-1:t;else if(ds(this,db).TD.offsetWidth/2+o<=c){let t=ds(this,dC)>=ds(this,dw)?ds(this,dw)-1:ds(this,dC);ds(this,db).col=t+1,o+=ds(this,db).TD.offsetWidth}else ds(this,db).col=ds(this,dC);let d=c,g=o;c+h+a>=s?d=s-h-a:c+a<l+u&&(d=l+u+Math.abs(a)),o>=s-1?g=s-1:0===g?g=1:void 0!==i.scrollX&&ds(this,dC)<ds(this,dR)&&(g-=ds(this,dS)<=i.scrollX?ds(this,dS):0),ds(this,df).setPosition(null,d),ds(this,dp).setPosition(null,g)}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",t=>da(this,dM,dH).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>da(this,dk,dP).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ds(this,df).build(),ds(this,dp).build()}destroy(){ds(this,df).destroy(),ds(this,dp).destroy(),super.destroy()}}function dN(t,e,i,r){let s=this.hot.view._wt.wtTable,l=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),h=(0,n.pv)(t.target,"sortAction");if(!a||!l||ds(this,dv)||0!==t.button||h){dn(this,dv,!1),ds(this,dm).length=0,(0,n.IV)(this.hot.rootElement,[dd,dc]);return}let u=ds(this,dp).isBuilt()&&!ds(this,dp).isAppended(),c=ds(this,df).isBuilt()&&!ds(this,df).isAppended();u&&c&&(ds(this,dp).appendTo(s.hider),ds(this,df).appendTo(s.hider));let{from:d,to:g}=a,f=Math.min(d.col,g.col),p=Math.max(d.col,g.col);if(e.row<0&&e.col>=f&&e.col<=p){r.column=!0,dn(this,dv,!0);let l=i.firstChild?(0,o.Zb)(t,i.firstChild).x:t.offsetX;ds(this,db).eventPageX=t.pageX,dn(this,dC,e.col),ds(this,db).TD=i,ds(this,db).col=e.col,dn(this,dm,this.prepareColumnsToMoving(f,p)),dn(this,dE,!!this.hot.getSettings().rowHeaders),dn(this,dw,this.hot.countCols()),dn(this,dR,this.hot.getSettings().fixedColumnsStart),dn(this,dS,(0,n.cv)(this.hot.rootElement).left);let a=ds(this,dE)?-1:0,h=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,u=e.col<ds(this,dR),c=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),d=Math.abs(l-(this.hot.isRtl()?i.offsetWidth:0)),g=this.getColumnsWidth(f,e.col-1)+d,m=this.getColumnsWidth(a,f-1)+(u?c:0)+g;ds(this,df).setPosition(h,m),ds(this,df).setSize(this.getColumnsWidth(f,p),s.hider.offsetHeight-h),ds(this,df).setOffset(null,-g),(0,n.cn)(this.hot.rootElement,dd)}else(0,n.IV)(this.hot.rootElement,dg),dn(this,dv,!1),ds(this,dm).length=0}function dH(t){ds(this,dv)&&(ds(this,db).eventPageX=t.pageX,this.refreshPositions())}function d_(t,e,i,r){let o=this.hot.getSelectedRangeLast();o&&ds(this,dv)&&(ds(this,dm).indexOf(e.col)>-1?(0,n.IV)(this.hot.rootElement,dc):(0,n.cn)(this.hot.rootElement,dc),r.row=!0,r.column=!0,r.cell=!0,dn(this,dC,e.col),ds(this,db).TD=i)}function dP(){let t=ds(this,db).col,e=ds(this,dm).length;if(dn(this,dC,void 0),dn(this,dv,!1),(0,n.IV)(this.hot.rootElement,[dd,dc,dg]),this.hot.selection.isSelectedByColumnHeader()&&(0,n.cn)(this.hot.rootElement,dg),e<1||void 0===t)return;let i=ds(this,dm)[0],r=this.hot.toPhysicalColumn(i),o=this.dragColumns(ds(this,dm),t);if(ds(this,dm).length=0,!0===o){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);let t=this.hot.toVisualColumn(r),i=t+e-1;this.hot.selectColumns(t,i)}}function dD(){let t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,i=t.holder.scrollTop,r=e+i;ds(this,df).setPosition(r),ds(this,df).setSize(null,t.hider.offsetHeight-r)}function dL(){this.moveBySettingsOrLoad()}function dB(t,e){dV(t,e),e.add(t)}function dW(t,e,i){dV(t,e),e.set(t,i)}function dV(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function dF(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function dj(t,e,i){var r=d$(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function dU(t,e){var i=d$(t,e,"get");return i.get?i.get.call(t):i.value}function d$(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}let dz="manualColumnResize",dK="manualColumnWidths";var dG=new WeakMap,dY=new WeakMap,dX=new WeakMap,dq=new WeakMap,dZ=new WeakMap,dJ=new WeakMap,dQ=new WeakMap,d0=new WeakMap,d1=new WeakMap,d2=new WeakMap,d4=new WeakMap,d5=new WeakMap,d8=new WeakMap,d9=new WeakMap,d3=new WeakMap,d7=new WeakMap,d6=new WeakSet,gt=new WeakSet,ge=new WeakSet,gi=new WeakSet,gr=new WeakSet,gn=new WeakSet,go=new WeakSet,gs=new WeakSet,gl=new WeakSet;class ga extends t9{static get PLUGIN_KEY(){return dz}static get PLUGIN_PRIORITY(){return 130}constructor(t){super(t),dB(this,gl),dB(this,gs),dB(this,go),dB(this,gn),dB(this,gr),dB(this,gi),dB(this,ge),dB(this,gt),dB(this,d6),dW(this,dG,{writable:!0,value:null}),dW(this,dY,{writable:!0,value:null}),dW(this,dX,{writable:!0,value:[]}),dW(this,dq,{writable:!0,value:null}),dW(this,dZ,{writable:!0,value:null}),dW(this,dJ,{writable:!0,value:null}),dW(this,dQ,{writable:!0,value:null}),dW(this,d0,{writable:!0,value:null}),dW(this,d1,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),dW(this,d2,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),dW(this,d4,{writable:!0,value:null}),dW(this,d5,{writable:!0,value:!1}),dW(this,d8,{writable:!0,value:0}),dW(this,d9,{writable:!0,value:null}),dW(this,d3,{writable:!0,value:void 0}),dW(this,d7,{writable:!0,value:void 0}),(0,n.cn)(dU(this,d1),"manualColumnResizer"),(0,n.cn)(dU(this,d2),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[dz]}enablePlugin(){this.enabled||(dj(this,d3,new en.L),dU(this,d3).addLocalHook("init",()=>dF(this,d6,gh).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,dU(this,d3)),this.addHook("modifyColWidth",(t,e)=>dF(this,go,gp).call(this,t,e)),this.addHook("beforeStretchingColumnWidth",(t,e)=>dF(this,gs,gm).call(this,t,e)),this.addHook("beforeColumnResize",(t,e,i)=>dF(this,gl,gw).call(this,t,e,i)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){dj(this,d7,dU(this,d3).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",dK,dU(this,d3).getValues())}loadManualColumnWidths(){let t={};return this.hot.runHooks("persistentStateLoad",dK,t),t.value}setManualSize(t,e){let i=Math.max(e,20),r=this.hot.toPhysicalColumn(t);return dU(this,d3).setValueAtIndex(r,i),i}clearManualSize(t){let e=this.hot.toPhysicalColumn(t);dU(this,d3).setValueAtIndex(e,null)}setupHandlePosition(t){let e;if(!t.parentNode)return;dj(this,dG,t);let{_wt:i}=this.hot.view,r=i.wtTable.getCoords(dU(this,dG)),o=r.col;if(o<0)return;let s=(0,n.Pb)(dU(this,dG)),l=dU(this,dG).getBoundingClientRect(),a=o<i.getSetting("fixedColumnsStart");a&&(e=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(dU(this,dG),r.row,r.col)),e||(e=i.wtOverlays.topOverlay.getRelativeCellPosition(dU(this,dG),r.row,r.col)),dj(this,dY,this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)),dj(this,dX,[]);let h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&h){let t=this.hot.getSelectedRange();(0,u.Bk)(t,t=>{let e=t.getTopStartCorner().col,i=t.getBottomEndCorner().col;(0,tT.q4)(e,i,t=>{dU(this,dX).includes(t)||dU(this,dX).push(t)})})}dU(this,dX).includes(dU(this,dY))||dj(this,dX,[dU(this,dY)]),dj(this,d0,e.start-6),dj(this,dQ,parseInt(l.width,10)),dU(this,d1).style.top=`${e.top}px`,dU(this,d1).style[this.inlineDir]=`${dU(this,d0)+dU(this,dQ)}px`,dU(this,d1).style.height=`${s}px`,this.hot.rootElement.appendChild(dU(this,d1))}refreshHandlePosition(){dU(this,d1).style[this.inlineDir]=`${dU(this,d0)+dU(this,dq)}px`}setupGuidePosition(){let t=parseInt((0,n.Pb)(dU(this,d1)),10),e=parseInt(dU(this,d1).style.top,10)+t,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);(0,n.cn)(dU(this,d1),"active"),(0,n.cn)(dU(this,d2),"active"),dU(this,d2).style.top=`${e}px`,this.refreshGuidePosition(),dU(this,d2).style.height=`${i-t}px`,this.hot.rootElement.appendChild(dU(this,d2))}refreshGuidePosition(){dU(this,d2).style[this.inlineDir]=dU(this,d1).style[this.inlineDir]}hideHandleAndGuide(){(0,n.IV)(dU(this,d1),"active"),(0,n.IV)(dU(this,d2),"active")}checkIfColumnHeader(t){let e=(0,n.oq)(t,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}afterMouseDownTimeout(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,i)=>{let r=this.hot.runHooks("beforeColumnResize",dU(this,dZ),e,!0);void 0!==r&&dj(this,dZ,r),"all"===this.hot.getSettings().stretchH?this.clearManualSize(e):this.setManualSize(e,dU(this,dZ)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",dU(this,dZ),e,!0),i&&t()};if(dU(this,d8)>=2){let i=dU(this,dX).length;i>1?((0,u.Bk)(dU(this,dX),t=>{e(t)}),t()):(0,u.Bk)(dU(this,dX),t=>{e(t,!0)})}dj(this,d8,0),dj(this,d9,null)}bindEvents(){let{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",t=>dF(this,gt,gu).call(this,t)),this.eventManager.addEventListener(e,"mousedown",t=>dF(this,ge,gc).call(this,t)),this.eventManager.addEventListener(t,"mousemove",t=>dF(this,gi,gd).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>dF(this,gr,gg).call(this)),this.eventManager.addEventListener(dU(this,d1),"contextmenu",()=>dF(this,gn,gf).call(this))}destroy(){super.destroy()}}function gh(){let t=this.hot.getSettings()[dz],e=this.loadManualColumnWidths();void 0!==e?this.hot.batchExecution(()=>{e.forEach((t,e)=>{dU(this,d3).setValueAtIndex(e,t)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((t,e)=>{dU(this,d3).setValueAtIndex(e,t)})},!0),dj(this,d7,t)):!0===t&&Array.isArray(dU(this,d7))&&this.hot.batchExecution(()=>{dU(this,d7).forEach((t,e)=>{dU(this,d3).setValueAtIndex(e,t)})},!0)}function gu(t){if(!(0,n.z4)(t.target)&&!0!==dU(this,d5)&&this.checkIfColumnHeader(t.target)){let e=this.getClosestTHParent(t.target);if(!e)return;let i=e.getAttribute("colspan");e&&(null===i||"1"===i)&&!dU(this,d4)&&this.setupHandlePosition(e)}}function gc(t){(0,n.pv)(t.target,"manualColumnResizer")&&(this.setupHandlePosition(dU(this,dG)),this.setupGuidePosition(),dj(this,d4,!0),null===dU(this,d9)&&(dj(this,d9,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(dU(this,d9))),dj(this,d8,dU(this,d8)+1),this.startX=t.pageX,dj(this,dZ,dU(this,dQ)))}function gd(t){if(dU(this,d4)){let e=(t.pageX-this.startX)*this.hot.getDirectionFactor();dj(this,dq,dU(this,dQ)+e),(0,u.Bk)(dU(this,dX),t=>{dj(this,dZ,this.setManualSize(t,dU(this,dq)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function gg(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,i)=>{this.hot.runHooks("beforeColumnResize",dU(this,dZ),e,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",dU(this,dZ),e,!1)};if(dU(this,d4)){if(this.hideHandleAndGuide(),dj(this,d4,!1),dU(this,dZ)!==dU(this,dQ)){let i=dU(this,dX).length;i>1?((0,u.Bk)(dU(this,dX),t=>{e(t)}),t()):(0,u.Bk)(dU(this,dX),t=>{e(t,!0)})}this.setupHandlePosition(dU(this,dG))}}function gf(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(dU(this,d1)),this.hot.rootElement.removeChild(dU(this,d2)),dj(this,d4,!1),dj(this,d5,!0),this.hot._registerImmediate(()=>{dj(this,d5,!1)})}function gp(t,e){let i=t;if(this.enabled){let t=this.hot.toPhysicalColumn(e),r=dU(this,d3).getValueAtIndex(t);this.hot.getSettings()[dz]&&r&&(i=r)}return i}function gm(t,e){let i=dU(this,d3).getValueAtIndex(e);return null===i&&(i=t),i}function gw(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function gv(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var gb=class{constructor(t){gv(this,"hot",void 0),gv(this,"_element",null),gv(this,"state",0),this.hot=t}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){void 0!==t&&(this._element.style.top=t+"px"),void 0!==e&&(this._element.style.left=e+"px")}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+"px"),e&&(this._element.style.height=e+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+"px"),e&&(this._element.style.marginLeft=e+"px")}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},gy=class extends gb{build(){super.build(),(0,n.cn)(this._element,"ht__manualRowMove--backlight")}},gC=class extends gb{build(){super.build(),(0,n.cn)(this._element,"ht__manualRowMove--guideline")}};function gS(t,e){gR(t,e),e.add(t)}function gE(t,e,i){gR(t,e),e.set(t,i)}function gR(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function gT(t,e,i){var r=gO(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function gM(t,e){var i=gO(t,e,"get");return i.get?i.get.call(t):i.value}function gO(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function gk(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}tt.Z.getSingleton().register("beforeRowMove"),tt.Z.getSingleton().register("afterRowMove");let gx="manualRowMove",gI="ht__manualRowMove",gA="show-ui",gN="on-moving--rows",gH="after-selection--rows";var g_=new WeakMap,gP=new WeakMap,gD=new WeakMap,gL=new WeakMap,gB=new WeakMap,gW=new WeakMap,gV=new WeakSet,gF=new WeakSet,gj=new WeakSet,gU=new WeakSet,g$=new WeakSet,gz=new WeakSet;class gK extends t9{constructor(){super(...arguments),gS(this,gz),gS(this,g$),gS(this,gU),gS(this,gj),gS(this,gF),gS(this,gV),gE(this,g_,{writable:!0,value:new gy(this.hot)}),gE(this,gP,{writable:!0,value:new gC(this.hot)}),gE(this,gD,{writable:!0,value:[]}),gE(this,gL,{writable:!0,value:void 0}),gE(this,gB,{writable:!0,value:{}}),gE(this,gW,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return gx}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[gx]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gk(t,gV,gG).call(t,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gk(t,gj,gX).call(t,...i)}),this.addHook("afterScrollHorizontally",()=>gk(this,g$,gZ).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gk(t,gz,gJ).call(t,...i)}),this.buildPluginUI(),this.registerEvents(),(0,n.cn)(this.hot.rootElement,gI),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,n.IV)(this.hot.rootElement,gI),this.unregisterEvents(),gM(this,g_).destroy(),gM(this,gP).destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){let i=gM(this,gW),r=this.isMovePossible(t,e),n=this.hot.runHooks("beforeRowMove",t,e,i,r);if(gT(this,gW,void 0),!1===n)return;r&&this.hot.rowIndexMapper.moveIndexes(t,e);let o=r&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,i,r,o),o}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){let i=this.countFinalIndex(t,e);return gT(this,gW,e),this.moveRows(t,i)}isMovePossible(t,e){let i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>i,n=t.some(t=>t<0),o=t.some(t=>t>=i);return!r&&!(e<0)&&!n&&!o}isRowOrderChanged(t,e){return t.some((t,i)=>t-i!==e)}countFinalIndex(t,e){let i=(0,u.k$)(t,(t,i)=>(i<e&&(t+=1),t),0);return e-i}getRowsHeight(t,e){let i=this.hot.rowIndexMapper,r=0;for(let n=t;n<=e;n++){let t=i.getRenderableFromVisualIndex(n);null!==t&&(r+=this.hot.view._wt.wtTable.getRowHeight(t)||23)}return r}moveBySettingsOrLoad(){let t=this.hot.getSettings()[gx];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){let t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){let t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){let t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;let{from:i,to:r}=t,n=Math.min(i.row,r.row),o=Math.max(i.row,r.row);return(0,tT.q4)(n,o,t=>{e.push(t)}),e}refreshPositions(){let t=gM(this,gB).coords,e=this.hot.view.getFirstFullyVisibleRow(),i=this.hot.view.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(t.row)&&e>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(e-1,-1)),this.isFixedRowBottom(t.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);let o=this.hot.view._wt.wtTable,s=gM(this,gB).TD,l=this.hot.rootElement,a=(0,n.cv)(l),h=(0,n.$g)(l),u=o.holder.scrollTop,c=this.hot.rootWindow!==h?h.scrollTop:0,d=a.top-c,g=gM(this,gB).eventPageY-d+u,f=o.hider.offsetHeight,p=o.TBODY.offsetTop,m=gM(this,g_).getOffset().top,w=gM(this,g_).getSize().height,b=s.offsetHeight/2,y=s.offsetHeight,C=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1),S=g>=C+b;this.isFixedRowTop(t.row)&&(C+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?gM(this,gB).row=e>0?e-1:e:S?(gM(this,gB).row=t.row+1,C+=0===t.row?y-1:y):gM(this,gB).row=t.row;let E=g,R=C;g+w+m>=f?E=f-w-m:g+m<p&&(E=p+Math.abs(m)),C>=f-1&&(R=f-1),gM(this,g_).setPosition(E),gM(this,gP).setPosition(R)}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",t=>gk(this,gF,gY).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>gk(this,gU,gq).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){gM(this,g_).build(),gM(this,gP).build()}destroy(){gM(this,g_).destroy(),gM(this,gP).destroy(),super.destroy()}}function gG(t,e,i,r){let{wtTable:o,wtViewport:s}=this.hot.view._wt,l=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!l||gM(this,gL)||0!==t.button){gT(this,gL,!1),gM(this,gD).length=0,(0,n.IV)(this.hot.rootElement,[gN,gA]);return}let h=gM(this,gP).isBuilt()&&!gM(this,gP).isAppended(),u=gM(this,g_).isBuilt()&&!gM(this,g_).isAppended();h&&u&&(gM(this,gP).appendTo(o.hider),gM(this,g_).appendTo(o.hider));let{from:c,to:d}=a,g=Math.min(c.row,d.row),f=Math.max(c.row,d.row);if(e.col<0&&e.row>=g&&e.row<=f){r.row=!0,gT(this,gL,!0),gM(this,gB).eventPageY=t.pageY,gM(this,gB).coords=e,gM(this,gB).TD=i,gT(this,gD,this.prepareRowsToMoving());let l=o.holder.scrollLeft+s.getRowHeaderWidth(),a=this.getRowsHeight(g,e.row-1)+t.offsetY;gM(this,g_).setPosition(null,l),gM(this,g_).setSize(o.hider.offsetWidth-l,this.getRowsHeight(g,f)),gM(this,g_).setOffset(-a,null),(0,n.cn)(this.hot.rootElement,gN),this.refreshPositions()}else(0,n.IV)(this.hot.rootElement,gH),gT(this,gL,!1),gM(this,gD).length=0}function gY(t){gM(this,gL)&&(gM(this,gB).eventPageY=t.pageY,this.refreshPositions())}function gX(t,e,i,r){let o=this.hot.getSelectedRangeLast();o&&gM(this,gL)&&(gM(this,gD).indexOf(e.row)>-1?(0,n.IV)(this.hot.rootElement,gA):(0,n.cn)(this.hot.rootElement,gA),r.row=!0,r.column=!0,r.cell=!0,gM(this,gB).coords=e,gM(this,gB).TD=i)}function gq(){let t=gM(this,gB).row,e=gM(this,gD).length;if(gT(this,gL,!1),(0,n.IV)(this.hot.rootElement,[gN,gA,gH]),this.hot.selection.isSelectedByRowHeader()&&(0,n.cn)(this.hot.rootElement,gH),e<1||void 0===t)return;let i=gM(this,gD)[0],r=this.hot.toPhysicalRow(i),o=this.dragRows(gM(this,gD),t);if(gM(this,gD).length=0,!0===o){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);let t=this.hot.toVisualRow(r),i=t+e-1;this.hot.selectRows(t,i)}}function gZ(){let t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),i=t.holder.scrollLeft,r=e+i;gM(this,g_).setPosition(null,r),gM(this,g_).setSize(t.hider.offsetWidth-r)}function gJ(){this.moveBySettingsOrLoad()}var gQ=i(3391);function g0(t,e){g2(t,e),e.add(t)}function g1(t,e,i){g2(t,e),e.set(t,i)}function g2(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function g4(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function g5(t,e,i){var r=g9(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function g8(t,e){var i=g9(t,e,"get");return i.get?i.get.call(t):i.value}function g9(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}let g3="manualRowResize",g7="manualRowHeights";var g6=new WeakMap,ft=new WeakMap,fe=new WeakMap,fi=new WeakMap,fr=new WeakMap,fn=new WeakMap,fo=new WeakMap,fs=new WeakMap,fl=new WeakMap,fa=new WeakMap,fh=new WeakMap,fu=new WeakMap,fc=new WeakMap,fd=new WeakMap,fg=new WeakMap,ff=new WeakMap,fp=new WeakSet,fm=new WeakSet,fw=new WeakSet,fv=new WeakSet,fb=new WeakSet,fy=new WeakSet,fC=new WeakSet;class fS extends t9{static get PLUGIN_KEY(){return g3}static get PLUGIN_PRIORITY(){return 30}constructor(t){super(t),g0(this,fC),g0(this,fy),g0(this,fb),g0(this,fv),g0(this,fw),g0(this,fm),g0(this,fp),g1(this,g6,{writable:!0,value:null}),g1(this,ft,{writable:!0,value:null}),g1(this,fe,{writable:!0,value:[]}),g1(this,fi,{writable:!0,value:null}),g1(this,fr,{writable:!0,value:null}),g1(this,fn,{writable:!0,value:null}),g1(this,fo,{writable:!0,value:null}),g1(this,fs,{writable:!0,value:null}),g1(this,fl,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),g1(this,fa,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),g1(this,fh,{writable:!0,value:!1}),g1(this,fu,{writable:!0,value:!1}),g1(this,fc,{writable:!0,value:0}),g1(this,fd,{writable:!0,value:null}),g1(this,fg,{writable:!0,value:void 0}),g1(this,ff,{writable:!0,value:void 0}),(0,n.cn)(g8(this,fl),"manualRowResizer"),(0,n.cn)(g8(this,fa),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[g3]}enablePlugin(){this.enabled||(g5(this,fg,new en.L),g8(this,fg).addLocalHook("init",()=>g4(this,fC,fx).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,g8(this,fg)),this.addHook("modifyRowHeight",(t,e)=>g4(this,fy,fk).call(this,t,e)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){g5(this,ff,g8(this,fg).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",g7,g8(this,fg).getValues())}loadManualRowHeights(){let t={};return this.hot.runHooks("persistentStateLoad",g7,t),t.value}setManualSize(t,e){let i=this.hot.toPhysicalRow(t),r=Math.max(e,gQ.U.DEFAULT_HEIGHT);return g8(this,fg).setValueAtIndex(i,r),r}setupHandlePosition(t){let e;g5(this,g6,t);let{view:i}=this.hot,{_wt:r}=i,o=r.wtTable.getCoords(g8(this,g6)),s=o.row;if(s<0)return;let l=(0,n.iO)(g8(this,g6)),a=g8(this,g6).getBoundingClientRect(),h=s<r.getSetting("fixedRowsTop"),c=s>=i.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");h?e=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(g8(this,g6),o.row,o.col):c&&(e=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(g8(this,g6),o.row,o.col)),e||(e=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(g8(this,g6),o.row,o.col)),g5(this,ft,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),g5(this,fe,[]);let d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){let t=this.hot.getSelectedRange();(0,u.Bk)(t,t=>{let e=t.getTopStartCorner().row,i=t.getBottomStartCorner().row;(0,tT.q4)(e,i,t=>{g8(this,fe).includes(t)||g8(this,fe).push(t)})})}g8(this,fe).includes(g8(this,ft))||g5(this,fe,[g8(this,ft)]),g5(this,fs,e.top-6),g5(this,fo,parseInt(a.height,10)),g8(this,fl).style.top=`${g8(this,fs)+g8(this,fo)}px`,g8(this,fl).style[this.inlineDir]=`${e.start}px`,g8(this,fl).style.width=`${l}px`,this.hot.rootElement.appendChild(g8(this,fl))}refreshHandlePosition(){g8(this,fl).style.top=`${g8(this,fs)+g8(this,fi)}px`}setupGuidePosition(){let t=parseInt((0,n.iO)(g8(this,fl)),10),e=parseInt(g8(this,fl).style[this.inlineDir],10)+t,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);(0,n.cn)(g8(this,fl),"active"),(0,n.cn)(g8(this,fa),"active"),g8(this,fa).style.top=g8(this,fl).style.top,g8(this,fa).style[this.inlineDir]=`${e}px`,g8(this,fa).style.width=`${i-t}px`,this.hot.rootElement.appendChild(g8(this,fa))}refreshGuidePosition(){g8(this,fa).style.top=g8(this,fl).style.top}hideHandleAndGuide(){(0,n.IV)(g8(this,fl),"active"),(0,n.IV)(g8(this,fa),"active")}checkIfRowHeader(t){let e=(0,n.oq)(t,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){let e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&g8(this,fr)<e?e:g8(this,fr)}afterMouseDownTimeout(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,i)=>{let r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==r&&g5(this,fr,r),this.setManualSize(e,g8(this,fr)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),i&&t()};if(g8(this,fc)>=2){let i=g8(this,fe).length;i>1?((0,u.Bk)(g8(this,fe),t=>{e(t)}),t()):(0,u.Bk)(g8(this,fe),t=>{e(t,!0)})}g5(this,fc,0),g5(this,fd,null)}bindEvents(){let{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",t=>g4(this,fp,fE).call(this,t)),this.eventManager.addEventListener(t,"mousedown",t=>g4(this,fm,fR).call(this,t)),this.eventManager.addEventListener(e,"mousemove",t=>g4(this,fw,fT).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>g4(this,fv,fM).call(this)),this.eventManager.addEventListener(g8(this,fl),"contextmenu",()=>g4(this,fb,fO).call(this))}destroy(){super.destroy()}}function fE(t){if(!(0,n.z4)(t.target)&&!0!==g8(this,fu)&&this.checkIfRowHeader(t.target)){let e=this.getClosestTHParent(t.target);e&&!g8(this,fh)&&this.setupHandlePosition(e)}}function fR(t){(0,n.pv)(t.target,"manualRowResizer")&&(this.setupHandlePosition(g8(this,g6)),this.setupGuidePosition(),g5(this,fh,!0),null===g8(this,fd)&&(g5(this,fd,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(g8(this,fd))),g5(this,fc,g8(this,fc)+1),g5(this,fn,t.pageY),g5(this,fr,g8(this,fo)))}function fT(t){g8(this,fh)&&(g5(this,fi,g8(this,fo)+(t.pageY-g8(this,fn))),(0,u.Bk)(g8(this,fe),t=>{g5(this,fr,this.setManualSize(t,g8(this,fi)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function fM(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(e,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};if(g8(this,fh)){if(this.hideHandleAndGuide(),g5(this,fh,!1),g8(this,fr)!==g8(this,fo)){let i=g8(this,fe).length;i>1?((0,u.Bk)(g8(this,fe),t=>{e(t)}),t()):(0,u.Bk)(g8(this,fe),t=>{e(t,!0)})}this.setupHandlePosition(g8(this,g6))}}function fO(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(g8(this,fl)),this.hot.rootElement.removeChild(g8(this,fa)),g5(this,fh,!1),g5(this,fu,!0),this.hot._registerImmediate(()=>{g5(this,fu,!1)})}function fk(t,e){let i=t;if(this.enabled){let t=this.hot.toPhysicalRow(e),r=g8(this,fg).getValueAtIndex(t);this.hot.getSettings()[g3]&&r&&(i=r)}return i}function fx(){let t=this.hot.getSettings()[g3],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{void 0!==e?e.forEach((t,e)=>{g8(this,fg).setValueAtIndex(e,t)}):Array.isArray(t)?(t.forEach((t,e)=>{g8(this,fg).setValueAtIndex(e,t)}),g5(this,ff,t)):!0===t&&Array.isArray(g8(this,ff))&&g8(this,ff).forEach((t,e)=>{g8(this,fg).setValueAtIndex(e,t)})},!0)}function fI(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var fA=class{constructor(t,e,i,r,n,o){fI(this,"row",void 0),fI(this,"col",void 0),fI(this,"rowspan",void 0),fI(this,"colspan",void 0),fI(this,"removed",!1),fI(this,"cellCoordsFactory",void 0),fI(this,"cellRangeFactory",void 0),this.row=t,this.col=e,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=n,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(t){return ru.e`The merged cell declared with {row: ${t.row}, col: ${t.col},\x20
      rowspan: ${t.rowspan}, colspan: ${t.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){return ru.e`The merged cell declared at [${t.row}, ${t.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){return ru.e`The merged cell declared at [${t.row}, ${t.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){return ru.e`The merged cell declared at [${t.row}, ${t.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){return t.row<0||t.col<0||t.rowspan<0||t.colspan<0}static isSingleCell(t){return 1===t.colspan&&1===t.rowspan}static containsZeroSpan(t){return 0===t.colspan||0===t.rowspan}static isOutOfBounds(t,e,i){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=i||t.col+t.colspan-1>=i}normalize(t){let e=t.countRows(),i=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){let i=t[0]||t[1],r=e+Math.abs(t[0]||t[1])-1,n=t[0]?"colspan":"rowspan",o=t[0]?"col":"row",s=Math.min(e,r),l=Math.max(e,r),a=this[o],h=this[o]+this[n]-1;if(a>=e&&(this[o]+=i),i>0)e<=h&&e>a&&(this[n]+=i);else if(i<0){if(s<=a&&l>=h)return this.removed=!0,!1;if(a>=s&&a<=l){let t=l-a+1;this[o]-=Math.abs(i)-t+i,this[n]-=t}else a<=s&&h>=l?this[n]+=i:a<=s&&h>=s&&h<l&&(this[n]-=h-s+1)}return!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}};function fN(t,e,i,r){e?e.row===i&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function fH(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class f_{constructor(t){fH(this,"plugin",void 0),fH(this,"mergedCells",[]),fH(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){return ru.e`The merged cell declared at [${t.row}, ${t.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){let i=this.mergedCells,r=!1;return(0,u.Bk)(i,i=>!(i.row<=t)||!(i.row+i.rowspan-1>=t)||!(i.col<=e)||!(i.col+i.colspan-1>=e)||(r=i,!1)),r}getByRange(t){let e=this.mergedCells,i=!1;return(0,u.Bk)(e,e=>!(e.row<=t.from.row)||!(e.row+e.rowspan-1>=t.to.row)||!(e.col<=t.from.col)||!(e.col+e.colspan-1>=t.to.col)||(i=e)),i}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.mergedCells,r=[],n=t;if(!n.includesRange){let t=this.hot._createCellCoords(n.from.row,n.from.col),e=this.hot._createCellCoords(n.to.row,n.to.col);n=this.hot._createCellRange(t,t,e)}return(0,u.Bk)(i,t=>{let i=this.hot._createCellCoords(t.row,t.col),o=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),s=this.hot._createCellRange(i,i,o);e?n.overlaps(s)&&r.push(t):n.includesRange(s)&&r.push(t)}),!!r.length&&r}add(t){let e=this.mergedCells,i=t.row,r=t.col,n=t.rowspan,o=t.colspan,s=new fA(i,r,n,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,r),a=this.isOverlapping(s);return l||a?((0,iu.ZK)(f_.IS_OVERLAPPING_WARNING(s)),!1):(this.hot&&s.normalize(this.hot),e.push(s),s)}remove(t,e){let i=this.mergedCells,r=this.get(t,e),n=r?this.mergedCells.indexOf(r):-1;return!!r&&-1!==n&&(i.splice(n,1),r)}clear(){let t=this.mergedCells,e=[],i=[];(0,u.Bk)(t,t=>{let i=this.hot.getCell(t.row,t.col);i&&e.push([i,this.get(t.row,t.col),t.row,t.col])}),this.mergedCells.length=0,(0,u.Bk)(e,(t,r)=>{(0,tT.q4)(0,t.rowspan-1,e=>{(0,tT.q4)(0,t.colspan-1,r=>{if(0!==r||0!==e){let n=this.hot.getCell(t.row+e,t.col+r);n&&i.push([n,null,null,null])}})}),e[r][1]=null}),(0,u.Bk)(e,t=>{fN(...t)}),(0,u.Bk)(i,t=>{fN(...t)})}isOverlapping(t){let e=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1)),i=!1;return(0,u.Bk)(this.mergedCells,t=>{let r=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(t.row,t.col),this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1));return!r.overlaps(e)||(i=!0,!1)}),i}isFirstRenderableMergedCell(t,e){let i=this.get(t,e);return i&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)===e}getFirstRenderableCoords(t,e){let i=this.get(t,e);if(!i||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);let r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,n)}shiftCollections(t,e,i){let r=[0,0];switch(t){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i}(0,u.Bk)(this.mergedCells,t=>{t.shift(r,e)}),(0,tT.yh)(this.mergedCells.length-1,0,t=>{let e=this.mergedCells[t];e&&e.removed&&this.mergedCells.splice(this.mergedCells.indexOf(e),1)})}}function fP(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var fD=class{constructor(t){fP(this,"plugin",void 0),fP(this,"mergedCellsCollection",void 0),fP(this,"currentFillData",null),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(t){if(t[0]===t[2]&&t[1]===t[3]){let e=this.mergedCellsCollection.get(t[0],t[1]);e&&(t[2]=t[0]+e.rowspan-1,t[3]=t[1]+e.colspan-1)}}getDirection(t,e){return e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left"}snapDragArea(t,e,i,r){let n=e.slice(0),o=this.getAutofillSize(t,e,i),[s,l,a,h]=t,u=["up","down"].indexOf(i)>-1,c=u?a-s+1:h-l+1,d=Math.floor(o/c)*c,g=o-d,f=this.getFarthestCollection(t,e,i,r);if(f){if("down"===i){let t=f.row+f.rowspan-s-g,e=n[2]+t;e>=this.plugin.hot.countRows()?n[2]-=g:n[2]+=g?t:0}else if("right"===i){let t=f.col+f.colspan-l-g,e=n[3]+t;e>=this.plugin.hot.countCols()?n[3]-=g:n[3]+=g?t:0}else if("up"===i){let t=a-g-f.row+1,e=n[0]+t;e<0?n[0]+=g:n[0]-=g?t:0}else if("left"===i){let t=h-g-f.col+1,e=n[1]+t;e<0?n[1]+=g:n[1]-=g?t:0}}return this.updateCurrentFillCache({baseArea:t,dragDirection:i,foundMergedCells:r,fillSize:o,dragArea:n,cycleLength:c}),n}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),(0,s.l7)(this.currentFillData,t)}getAutofillSize(t,e,i){let[r,n,o,s]=t,[l,a,h,u]=e;switch(i){case"up":return r-l;case"down":return h-o;case"left":return n-a;case"right":return u-s;default:return null}}getDragArea(t,e,i){let[r,n,o,s]=t,[l,a,h,u]=e;switch(i){case"up":return[l,a,r-1,s];case"down":return[o+1,n,h,s];case"left":return[l,a,o,n-1];case"right":return[r,s+1,h,u];default:return null}}getFarthestCollection(t,e,i,r){let[n,o,s,l]=t,a=["up","down"].indexOf(i)>-1,h=a?s:l,c=a?n:o,d=this.getAutofillSize(t,e,i),g=a?s-n+1:l-o+1,f=d-Math.floor(d/g)*g,p=null,m=null,w=null;switch(i){case"up":p="includesVertically",w=h-f+1;break;case"left":p="includesHorizontally",w=h-f+1;break;case"down":p="includesVertically",w=c+f-1;break;case"right":p="includesHorizontally",w=c+f-1}return(0,u.Bk)(r,t=>{t[p](w)&&t.isFarther(m,i)&&(m=t)}),m}recreateAfterDataPopulation(t){if(!this.currentFillData)return;let e=this.getRangeFromChanges(t),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,n=(t,i)=>{switch(r){case"up":return t.row-i>=e.from.row;case"down":return t.row+t.rowspan-1+i<=e.to.row;case"left":return t.col-i>=e.from.column;case"right":return t.col+t.colspan-1+i<=e.to.column;default:return null}},o=0,s=null,l=1;do for(let t=0;t<i.length;t+=1){if(n(s=i[t],o=l*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:s.row-o,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+o,rowspan:s.rowspan,col:s.col,colspan:s.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-o,colspan:s.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+o,colspan:s.colspan})}t===i.length-1&&(l+=1)}while(n(s,o));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){let e={min:null,max:null},i={min:null,max:null};return(0,u.Bk)(t,t=>{let r=t[0],n=this.plugin.hot.propToCol(t[1]);(null===e.min||r<e.min)&&(e.min=r),(null===e.max||r>e.max)&&(e.max=r),(null===i.min||n<i.min)&&(i.min=n),(null===i.max||n>i.max)&&(i.max=n)}),{from:{row:e.min,column:i.min},to:{row:e.max,column:i.max}}}dragAreaOverlapsCollections(t,e,i){let r=this.getDragArea(t,e,i),[n,o,s,l]=r,a=this.plugin.hot._createCellCoords(n,o),h=this.plugin.hot._createCellCoords(s,l),u=this.plugin.hot._createCellRange(a,a,h);return!!this.mergedCellsCollection.getWithinRange(u,!0)}};function fL(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var fB=class{constructor(t){fL(this,"plugin",void 0),fL(this,"hot",void 0),fL(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=t,this.hot=t.hot}snapDelta(t,e,i){let r=e.to,n=r.row+t.row,o=r.col+t.col;t.row?this.jumpOverMergedCell(t,i,n):t.col&&this.jumpOverMergedCell(t,i,o)}jumpOverMergedCell(t,e,i){let r=t.row||t.col,n=null,o=null,s=null;t.row?(n=e.includesVertically(i),o=e.row,s=e.getLastRow()):t.col&&(n=e.includesHorizontally(i),o=e.col,s=e.getLastColumn()),0!==r&&(r>0?n&&i!==o&&(r+=s-i+1):n&&i!==s&&(r-=i-o+1),t.row?t.row=r:t.col&&(t.col=r))}getUpdatedSelectionRange(t,e){return this.hot._createCellRange(t.highlight,t.from,this.hot._createCellCoords(t.to.row+e.row,t.to.col+e.col))}getSelectedMergedCellClassName(t,e,i,r){let n=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),s=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(void 0===r)return;let a=this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e);if(!a)return;let h=this.plugin.mergedCellsCollection.get(t,e);if(!h)return;let u=h.getLastRow(),c=h.getLastColumn(),d=n<=h.row&&o<=h.col&&s>=u&&l>=c;return d?`${this.fullySelectedMergedCellClassName}-${r}`:this.plugin.selectionCalculations.isMergeCellFullySelected(h,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){let i=[];if(!e||!t)return!1;for(let e=0;e<t.rowspan;e+=1)for(let r=0;r<t.colspan;r+=1)i.push(this.hot._createCellCoords(t.row+e,t.col+r));for(let t=0;t<i.length;t+=1){let r=[];for(let n=0;n<e.length;n+=1)r[n]=e[n].includes(i[t]);if(!r.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){let t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}};function fW(t,e){fV(t,e),e.add(t)}function fV(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function fF(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function fj(t,e,i){var r=f$(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function fU(t,e){var i=f$(t,e,"get");return i.get?i.get.call(t):i.value}function f$(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function fz(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}tt.Z.getSingleton().register("beforeMergeCells"),tt.Z.getSingleton().register("afterMergeCells"),tt.Z.getSingleton().register("beforeUnmergeCells"),tt.Z.getSingleton().register("afterUnmergeCells");let fK="mergeCells";var fG=new WeakMap,fY=new WeakSet,fX=new WeakSet,fq=new WeakSet,fZ=new WeakSet,fJ=new WeakSet,fQ=new WeakSet,f0=new WeakSet,f1=new WeakSet,f2=new WeakSet,f4=new WeakSet,f5=new WeakSet,f8=new WeakSet,f9=new WeakSet,f3=new WeakSet,f7=new WeakSet,f6=new WeakSet,pt=new WeakSet,pe=new WeakSet,pi=new WeakSet,pr=new WeakSet,pn=new WeakSet,po=new WeakSet;class ps extends t9{constructor(){super(...arguments),fW(this,po),fW(this,pn),fW(this,pr),fW(this,pi),fW(this,pe),fW(this,pt),fW(this,f6),fW(this,f7),fW(this,f3),fW(this,f9),fW(this,f8),fW(this,f5),fW(this,f4),fW(this,f2),fW(this,f1),fW(this,f0),fW(this,fQ),fW(this,fJ),fW(this,fZ),fW(this,fq),fW(this,fX),fW(this,fY),fF(this,"mergedCellsCollection",null),fF(this,"autofillCalculations",null),fF(this,"selectionCalculations",null),fV(this,fG),fG.set(this,{writable:!0,value:null})}static get PLUGIN_KEY(){return fK}static get PLUGIN_PRIORITY(){return 150}isEnabled(){return!!this.hot.getSettings()[fK]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new f_(this),this.autofillCalculations=new fD(this),this.selectionCalculations=new fB(this),this.addHook("afterInit",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,fY,pl).call(t,...i)}),this.addHook("modifyTransformStart",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,fq,ph).call(t,...i)}),this.addHook("afterModifyTransformStart",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,pr,pM).call(t,...i)}),this.addHook("modifyTransformEnd",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,fZ,pu).call(t,...i)}),this.addHook("modifyGetCellCoords",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,fJ,pc).call(t,...i)}),this.addHook("beforeSetRangeStart",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f1,pf).call(t,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f1,pf).call(t,...i)}),this.addHook("beforeSetRangeEnd",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f2,pp).call(t,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,fX,pa).call(t,...i)}),this.addHook("afterRenderer",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f0,pg).call(t,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,fQ,pd).call(t,...i)}),this.addHook("afterGetCellMeta",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f4,pm).call(t,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f5,pw).call(t,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f8,pv).call(t,...i)}),this.addHook("modifyAutofillRange",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f9,pb).call(t,...i)}),this.addHook("afterCreateCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f3,py).call(t,...i)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f7,pC).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,f6,pS).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,pt,pE).call(t,...i)}),this.addHook("afterChange",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,pe,pR).call(t,...i)}),this.addHook("beforeDrawBorders",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,pi,pT).call(t,...i)}),this.addHook("afterDrawSelection",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,pn,pO).call(t,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return fz(t,po,pk).call(t,...i)}),this.addHook("beforeUndoStackChange",(t,e)=>{if("MergeCells"===e)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){let t=this.hot.getSettings()[fK];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(t),super.updatePlugin()}ifChromeForceRepaint(){if(!(0,f.i7)())return;let t=[],e=[];this.mergedCellsCollection.mergedCells.forEach(t=>{let{row:i,rowspan:r}=t;for(let t=i+1;t<i+r;t++)e.push(t)}),(e=[...new Set(e)]).forEach(e=>{let i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map(t=>(null==t?void 0:t.name)==="master"?t:t.clone.wtTable).forEach(e=>{let r=e.getRow(i);r&&(r.style.background=(0,n.C2)(r,"backgroundColor").replace(")",", 0.99)"),t.push(r))})}),this.hot._registerTimeout(()=>{t.forEach(t=>{t.style.background=(0,n.C2)(t,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(t){let e=!0;return!!t&&(fA.containsNegativeValues(t)?((0,iu.ZK)(fA.NEGATIVE_VALUES_WARNING(t)),e=!1):fA.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?((0,iu.ZK)(fA.IS_OUT_OF_BOUNDS_WARNING(t)),e=!1):fA.isSingleCell(t)?((0,iu.ZK)(fA.IS_SINGLE_CELL(t)),e=!1):fA.containsZeroSpan(t)&&((0,iu.ZK)(fA.ZERO_SPAN_WARNING(t)),e=!1),e)}generateFromSettings(t){if(Array.isArray(t)){let e=[];(0,u.Bk)(t,t=>{if(!this.validateSetting(t))return;let i=this.hot._createCellCoords(t.row,t.col),r=this.hot._createCellCoords(t.row+t.rowspan-1,t.col+t.colspan-1),n=this.hot._createCellRange(i,i,r);this.mergeRange(n,!0,!0),(0,tT.q4)(t.row,t.row+t.rowspan-1,i=>{(0,tT.q4)(t.col,t.col+t.colspan-1,r=>{!1==(i===t.row&&r===t.col)&&e.push([i,r,null])})})}),0!==e.length&&this.hot.setDataAtCell(e)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}toggleMergeOnSelection(){let t=this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:e,to:i}=t;this.toggleMerge(t),this.hot.selectCell(e.row,e.col,i.row,i.col,!1)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:e,to:i}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,i.row,i.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;let{from:e,to:i}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,i.row,i.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.getTopStartCorner(),n=t.getBottomEndCorner(),o={row:r.row,col:r.col,rowspan:n.row-r.row+1,colspan:n.col-r.col+1},s=[],l=null;if(!this.canMergeRange(o,e))return!1;this.hot.runHooks("beforeMergeCells",t,e),(0,tT.q4)(0,o.rowspan-1,t=>{(0,tT.q4)(0,o.colspan-1,e=>{let i=null;s[t]||(s[t]=[]),0===t&&0===e?i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+t,o.col+e,"hidden",!0),s[t][e]=i})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0);let a=this.mergedCellsCollection.add(o);return!a||(i?l=[o.row,o.col,s]:this.hot.populateFromArray(o.row,o.col,s,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,o,e),l)}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.mergedCellsCollection.getWithinRange(t);i&&(this.hot.runHooks("beforeUnmergeCells",t,e),(0,u.Bk)(i,t=>{this.mergedCellsCollection.remove(t.row,t.col),(0,tT.q4)(0,t.rowspan-1,e=>{(0,tT.q4)(0,t.colspan-1,i=>{this.hot.removeCellMeta(t.row+e,t.col+i,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+i,"copyable")})}),this.hot.removeCellMeta(t.row,t.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){let e=this.mergedCellsCollection.get(t.from.row,t.from.col),i=e.row===t.from.row&&e.col===t.from.col&&e.row+e.rowspan-1===t.to.row&&e.col+e.colspan-1===t.to.col;i?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,i,r){let n=this.hot._createCellCoords(t,e),o=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(n,n,o))}unmerge(t,e,i,r){let n=this.hot._createCellCoords(t,e),o=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(n,n,o))}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("grid");e.addShortcut({keys:[["Control","m"]],callback:()=>{let t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:fK})}unregisterShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(fK)}modifyViewportRowStart(t,e){let i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(t.startRow);for(let n=0;n<e;n+=1){let o=this.mergedCellsCollection.get(r,n);if((0,s.Kn)(o)){let r=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.row,1));if(r<t.startRow){t.startRow=r,this.modifyViewportRowStart(t,e);return}}}}modifyViewportRowEnd(t,e){let i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(t.endRow);for(let n=0;n<e;n+=1){let o=this.mergedCellsCollection.get(r,n);if((0,s.Kn)(o)){let r=o.row+o.rowspan-1,n=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1));if(n>t.endRow){t.endRow=n,this.modifyViewportRowEnd(t,e);return}}}}modifyViewportColumnStart(t,e){let i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(t.startColumn);for(let n=0;n<e;n+=1){let o=this.mergedCellsCollection.get(n,r);if((0,s.Kn)(o)){let r=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.col,1));if(r<t.startColumn){t.startColumn=r,this.modifyViewportColumnStart(t,e);return}}}}modifyViewportColumnEnd(t,e){let i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(t.endColumn);for(let n=0;n<e;n+=1){let o=this.mergedCellsCollection.get(n,r);if((0,s.Kn)(o)){let r=o.col+o.colspan-1,n=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1));if(n>t.endColumn){t.endColumn=n,this.modifyViewportColumnEnd(t,e);return}}}}translateMergedCellToRenderable(t,e,i,r){let n,o;let{rowIndexMapper:s,columnIndexMapper:l}=this.hot;n=0===e?s.getNearestNotHiddenIndex(t,1):s.getNearestNotHiddenIndex(t+e-1,-1),o=0===r?l.getNearestNotHiddenIndex(i,1):l.getNearestNotHiddenIndex(i+r-1,-1);let a=t>=0?s.getRenderableFromVisualIndex(n):t,h=i>=0?l.getRenderableFromVisualIndex(o):i;return[a,h]}}function pl(){this.generateFromSettings(this.hot.getSettings()[fK]),this.hot.render()}function pa(t){if(t){let t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast();for(let i=0;i<t.length;i+=1)if(e.from.row===t[i].row&&e.from.col===t[i].col&&e.to.row===t[i].row+t[i].rowspan-1&&e.to.col===t[i].col+t[i].colspan-1)return!1}return t}function ph(t){let e=this.hot.getSelectedRangeLast(),i={row:t.row,col:t.col},r=null,n=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(n.row,n.col);if(fU(this,fG)||fj(this,fG,this.hot._createCellCoords(null,null)),o){let e=this.hot._createCellCoords(o.row,o.col),r=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1),s=this.hot._createCellRange(e,e,r);s.includes(fU(this,fG))||fj(this,fG,this.hot._createCellCoords(null,null)),i.row=fU(this,fG).row?fU(this,fG).row-n.row:i.row,i.col=fU(this,fG).col?fU(this,fG).col-n.col:i.col,t.row>0?i.row=o.row+o.rowspan-1-n.row+t.row:t.row<0&&(i.row=n.row-o.row+t.row),t.col>0?i.col=o.col+o.colspan-1-n.col+t.col:t.col<0&&(i.col=n.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+i.row,e.highlight.col+i.col);let s=this.mergedCellsCollection.get(r.row,r.col);if(s){let t=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);fj(this,fG,r),i={row:t.row-n.row,col:t.col-n.col}}0!==i.row&&(t.row=i.row),0!==i.col&&(t.col=i.col)}function pu(t){let e=this.hot.getSelectedRangeLast(),i=(0,s.d9)(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t),n=(0,s.d9)(i),o=this.mergedCellsCollection.getWithinRange(r,!0);do n=(0,s.d9)(i),this.selectionCalculations.getUpdatedSelectionRange(e,i),(0,u.Bk)(o,t=>{this.selectionCalculations.snapDelta(i,e,t)});while(i.row!==n.row||i.col!==n.col);t.row=i.row,t.col=i.col}function pc(t,e){if(t<0||e<0)return;let i=this.mergedCellsCollection.get(t,e);if(!i)return;let{row:r,col:n,colspan:o,rowspan:s}=i;return[r,n,r+s-1,n+o-1]}function pd(t){var e;t.items.push({name:"---------"},(e=this,{key:"mergeCells",name(){let t=this.getSelectedLast();if(t){let i=e.mergedCellsCollection.get(t[0],t[1]);if(i.row===t[0]&&i.col===t[1]&&i.row+i.rowspan-1===t[2]&&i.col+i.colspan-1===t[3])return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){e.toggleMergeOnSelection()},disabled(){let t=this.getSelectedLast();if(!t)return!0;let e=fA.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1});return e||this.selection.isSelectedByCorner()},hidden:!1}))}function pg(t,e,i){let r=this.mergedCellsCollection.get(e,i),n=(0,s.Kn)(r)?(0,s.d9)(r):void 0;if((0,s.Kn)(n)){let{rowIndexMapper:t,columnIndexMapper:r}=this.hot,{row:o,col:s,colspan:l,rowspan:a}=n,[h,u]=this.translateMergedCellToRenderable(o,a,s,l),c=t.getRenderableFromVisualIndex(e),d=r.getRenderableFromVisualIndex(i);n.row=t.getNearestNotHiddenIndex(n.row,1),n.col=r.getNearestNotHiddenIndex(n.col,1),n.rowspan=Math.min(n.rowspan,h-c+1),n.colspan=Math.min(n.colspan,u-d+1)}fN(t,n,e,i)}function pf(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){let e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function pp(t){let e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let i=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{i=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){let n=this.mergedCellsCollection.mergedCells[r],o=n.getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,i=!0)}}while(i)}function pm(t,e,i){let r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?i.copyable=!1:(i.rowspan=r.rowspan,i.colspan=r.colspan))}function pw(t){let e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function pv(t){let e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function pb(t,e){this.autofillCalculations.correctSelectionAreaSize(e);let i=this.autofillCalculations.getDirection(e,t),r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,i))return e;let n=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return n?r=this.autofillCalculations.snapDragArea(e,r,i,n):r}function py(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function pC(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function pS(t,e,i){"auto"!==i&&this.mergedCellsCollection.shiftCollections("down",t,e)}function pE(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function pR(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}function pT(t,e){if(e&&"area"===e){let e=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(e);(0,u.Bk)(i,i=>{e.getBottomEndCorner().row===i.getLastRow()&&e.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function pM(t,e,i){if(!this.enabled)return;let r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;let n=r.row+r.rowspan-1==this.hot.countRows()-1,o=0===r.row,s=r.col+r.colspan-1==this.hot.countCols()-1,l=0===r.col;(e>0&&n||e<0&&o||i>0&&s||i<0&&l)&&(t.row=r.row,t.col=r.col)}function pO(t,e,i,r){if(i)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,i,r)}function pk(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function px(){(0,iu.ZK)(ru.e`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}let pI="sort",pA="multiColumnSorting",pN="columnSorting";i1(pA,function(t,e){return function(i,r){let[,...n]=i,[,...o]=r;return function i(r){let s=t[r],l=e[r],a=n[r],h=o[r],u=l.multiColumnSorting,c=u.compareFunctionFactory?u.compareFunctionFactory:i4(l.type),d=c(s,l,u)(a,h);if(0===d){let t=r+1;if(void 0!==e[t])return i(t)}return d}(0)}});class pH extends rr{constructor(){var t,e;super(...arguments),(t="symbol"==typeof(e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="pluginKey","string"))?e:String(e))in this?Object.defineProperty(this,t,{value:pA,enumerable:!0,configurable:!0,writable:!0}):this[t]=pA}static get PLUGIN_KEY(){return pA}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[pN]&&px(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();-1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,i7))},runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()},group:pA})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pA)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];super.updateHeaderClasses(t,...i),(0,n.IV)(t,function(t){let e=t.className.split(" "),i=RegExp(`^${pI}-[0-9]{1,2}$`);return e.filter(t=>i.test(t))}(t)),!1!==this.enabled&&(0,n.cn)(t,function(t,e,i){let r=[];return!1===i||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${pI}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}(...i))}onUpdateSettings(t){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[pN]&&px(),super.onUpdateSettings(t)}onAfterOnCellMouseDown(t,e){!1!==i$(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,i7))):this.sort(this.getColumnNextConfig(e.col)))}}function p_(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class pP extends t9{constructor(){super(...arguments),p_(this,"dragged",[]),p_(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return(0,f.K1)()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){let t=this,{rootElement:e}=this.hot;function i(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;let i=t.dragged.indexOf(e);if(-1===i)return!1;0===i?t.dragged=t.dragged.slice(0,1):1===i&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",e=>{let i;return(0,n.pv)(e.target,"topSelectionHandle-HitArea")?(i=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},e.preventDefault(),!1):(0,n.pv)(e.target,"bottomSelectionHandle-HitArea")?(i=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(e,"touchend",e=>(0,n.pv)(e.target,"topSelectionHandle-HitArea")?(i.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):(0,n.pv)(e.target,"bottomSelectionHandle-HitArea")?(i.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0),this.eventManager.addEventListener(e,"touchmove",e=>{let i,r,n,o,s,l;let{rootDocument:a}=this.hot;if(0===t.dragged.length)return;let h=a.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);h&&h!==t.lastSetCell&&(("TD"===h.nodeName||"TH"===h.nodeName)&&(-1===(i=t.hot.getCoords(h)).col&&(i.col=0),n=(r=t.hot.getSelectedRangeLast()).getWidth(),o=r.getHeight(),s=r.getDirection(),1===n&&1===o&&t.hot.selection.setRangeEnd(i),null!==(l=t.getCurrentRangeCoords(r,i,t.touchStartRange.direction,s,t.dragged[0])).start&&t.hot.selection.setRangeStart(l.start),t.hot.selection.setRangeEnd(l.end),t.lastSetCell=h),e.preventDefault())})}getCurrentRangeCoords(t,e,i,r,n){let o=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.getBottomStartCorner(),a=t.getTopEndCorner(),h={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":h="top"===n?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,o.col)};break;case"SE-NW":"bottom"===n&&(h={start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,o.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===n?h={start:e,end:l}:h.end=e;break;case"NW-SE":"top"===n?h={start:e,end:s}:h.end=e;break;case"SE-NW":"top"===n?h={start:e,end:o}:h.end=e;break;case"SW-NE":"top"===n?h={start:e,end:a}:h.end=e}break;case"SW-NE":switch(r){case"NW-SE":h="bottom"===n?{start:this.hot._createCellCoords(e.row,o.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(o.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SW-NE":h="top"===n?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)}:{start:this.hot._createCellCoords(e.row,o.col),end:this.hot._createCellCoords(o.row,e.col)};break;case"SE-NW":"bottom"===n?h={start:this.hot._createCellCoords(e.row,a.col),end:this.hot._createCellCoords(o.row,e.col)}:"top"===n&&(h={start:l,end:e})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===n&&(h.end=e);break;case"SE-NW":"top"===n?h.end=e:h={start:e,end:o}}}return h}isDragged(){return this.dragged.length>0}}var pD=i(58352);function pL(){let{label:t="",colspan:e=1,origColspan:i=1,collapsible:r=!1,crossHiddenColumns:n=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:l=!1,isPlaceholder:a=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:i,collapsible:r,isCollapsed:o,crossHiddenColumns:n,isHidden:s,isRoot:l,isPlaceholder:a}}function pB(){return{label:"",isPlaceholder:!0}}function pW(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function pV(t,e){var i=pj(t,e,"get");return i.get?i.get.call(t):i.value}function pF(t,e,i){var r=pj(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function pj(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}let pU=["label","collapsible"];var p$=new WeakMap,pz=new WeakMap,pK=new WeakMap;class pG{constructor(){pW(this,p$,{writable:!0,value:[]}),pW(this,pz,{writable:!0,value:0}),pW(this,pK,{writable:!0,value:1/0})}setColumnsLimit(t){pF(this,pK,t)}setData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];pF(this,p$,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=[];if(0===e)return i;(0,u.Bk)(t,t=>{let r=[],n=0;i.push(r),(0,u.Bk)(t,t=>{let i=pL();if((0,s.Kn)(t)){let{label:e,colspan:r}=t;i.label=(0,c.Pz)(e),"number"==typeof r&&r>1&&(i.colspan=r,i.origColspan=r)}else i.label=(0,c.Pz)(t);n+=i.origColspan;let o=!1;if(n>=e&&(i.colspan=i.origColspan-(n-e),i.origColspan=i.colspan,o=!0),r.push(i),i.colspan>1)for(let t=0;t<i.colspan-1;t++)r.push(pB());return!o})});let r=Math.max(...(0,u.Sc)(i,t=>t.length));return(0,u.Bk)(i,t=>{if(t.length<r){let e=(0,u.Sc)(Array(r-t.length),()=>pL());t.splice(t.length,0,...e)}}),i}(t,pV(this,pK))),pF(this,pz,pV(this,p$).length)}getData(){return pV(this,p$)}mergeWith(t){(0,u.Bk)(t,t=>{let{row:e,col:i,...r}=t,n=this.getHeaderSettings(e,i);null!==n&&(0,s.l7)(n,r,pU)})}map(t){(0,u.Bk)(pV(this,p$),e=>{(0,u.Bk)(e,e=>{let i=t({...e});(0,s.Kn)(i)&&(0,s.l7)(e,i,pU)})})}getHeaderSettings(t,e){var i;if(t>=pV(this,pz)||t<0)return null;let r=pV(this,p$)[t];return!1===Array.isArray(r)||e>=r.length?null:null!==(i=r[e])&&void 0!==i?i:null}getHeadersSettings(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(t>=pV(this,pz)||t<0)return r;let n=pV(this,p$)[t],o=0;for(let t=e;t<n.length;t++){let e=n[t];if(e.isPlaceholder)throw Error("The first column settings cannot overlap the other header layers");if(o+=e.colspan,r.push(e),e.colspan>1&&(t+=e.colspan-1),o===i)break;if(o>i)throw Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return pV(this,pz)}getColumnsCount(){return pV(this,pz)>0?pV(this,p$)[0].length:0}clear(){pF(this,p$,[]),pF(this,pz,0)}}function pY(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let pX="DF-pre-order",pq=new Map([[pX,function t(e,i){let r=e.call(i,this);for(let n=0;n<this.childs.length;n++){if(!1===r)return!1;r=t.call(this.childs[n],e,i)}return r}],["DF-post-order",function t(e,i){for(let r=0;r<this.childs.length;r++){let n=t.call(this.childs[r],e,i);if(!1===n)return!1}return e.call(i,this)}],["BF",function(t,e){let i=[this];!function r(){if(0===i.length)return;let n=i.shift();i.push(...n.childs),!1!==t.call(e,n)&&r()}()}]]);class pZ{constructor(t){pY(this,"data",{}),pY(this,"parent",null),pY(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=new pZ({...t.data});for(let i=0;i<t.childs.length;i++)e.addChild(this.cloneTree(t.childs[i]));return e}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!pq.has(e))throw Error(`Traversal strategy "${e}" does not exist`);pq.get(e).call(this,t,this)}walkUp(t){let e=this,i=r=>{let n=t.call(e,r);!1!==n&&null!==r.parent&&i(r.parent)};i(this)}}function pJ(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function pQ(t,e){var i=p0(t,e,"get");return i.get?i.get.call(t):i.value}function p0(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var p1=new WeakMap,p2=new WeakMap,p4=new WeakMap;class p5{constructor(t){pJ(this,p1,{writable:!0,value:new Map}),pJ(this,p2,{writable:!0,value:new Map}),pJ(this,p4,{writable:!0,value:null}),function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,p0(this,p4,"set"),t)}getRoots(){return Array.from(pQ(this,p1).values())}getRootByColumn(t){let e;return pQ(this,p2).has(t)&&(e=pQ(this,p1).get(pQ(this,p2).get(t))),e}getNode(t,e){let i;let r=this.getRootByColumn(e);if(!r)return;let n=e-pQ(this,p2).get(e),o=0;return r.walkDown(r=>{let{data:{origColspan:s,headerLevel:l}}=r;if(t===l){if(n>=o&&n<=o+s-1)return(i=r).data.isRoot=e===i.data.columnIndex,!1;o+=s}}),i}rebuildTreeIndex(){let t=0;pQ(this,p2).clear(),(0,u.Bk)(pQ(this,p1),e=>{let[,{data:{colspan:i}}]=e;for(let e=t;e<t+i;e++)pQ(this,p2).set(e,t);t+=i})}buildTree(){this.clear();let t=pQ(this,p4).getColumnsCount(),e=0;for(;e<t;){let t=pQ(this,p4).getHeaderSettings(0,e),i=new pZ;pQ(this,p1).set(e,i),this.buildLeaves(i,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=pQ(this,p4).getHeadersSettings(i,e,r);i+=1,(0,u.Bk)(n,r=>{let n;let o={...r,headerLevel:i-1,columnIndex:e};1===i?(t.data=o,n=t):(n=new pZ(o),t.addChild(n)),i<pQ(this,p4).getLayersCount()&&this.buildLeaves(n,e,i,r.origColspan),e+=r.origColspan})}clear(){pQ(this,p1).clear(),pQ(this,p2).clear()}}function p8(t,e){t.walkDown(t=>{let{data:i,childs:r}=t;if(!i.isHidden&&(e(i.columnIndex),0===r.length))for(let t=1;t<i.colspan;t++)e(i.columnIndex+t)})}function p9(t,e){let{childs:i}=t;if(0!==i.length)return i[0].data[e]}function p3(t){return p9(t,"origColspan")===t.data.origColspan}function p7(t){let{data:e,childs:i}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};let r=p3(t);if(r)return p7(i[0]);e.isCollapsed=!1;let n=i.slice(1),o=new Set,s=0;if(n.length>0)(0,u.Bk)(n,t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;let e=t.data;s+=e.colspan,p8(t,t=>{o.add(t)})});else{let{colspan:t,origColspan:i,columnIndex:r}=e;s=i-t;for(let t=1;t<i;t++)o.add(r+t)}return t.walkUp(t=>{let{data:e}=t;e.colspan+=s,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):p3(t)&&(e.isCollapsed=p9(t,"isCollapsed"))}),{rollbackModification:()=>p6(t),affectedColumns:Array.from(o),colspanCompensation:s}}function p6(t){var e;let{data:i,childs:r}=t;if(i.isCollapsed||i.isHidden||i.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};let n=p3(t);if(n)return p6(r[0]);i.isCollapsed=!0;let o=r.slice(1),s=new Set;if(o.length>0)(0,u.Bk)(o,t=>{p8(t,t=>{s.add(t)}),t.data.clonedTree=t.cloneTree(),t.walkDown(t=>{let{data:e}=t;e.isHidden=!0})});else{let{origColspan:t,columnIndex:e}=i;for(let i=1;i<t;i++){let t=e+i;s.add(t)}}let l=i.colspan-(null!==(e=p9(t,"colspan"))&&void 0!==e?e:1);return t.walkUp(t=>{let{data:e}=t;e.colspan-=l,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):p3(t)&&(e.isCollapsed=p9(t,"isCollapsed"))}),{rollbackModification:()=>p7(t),affectedColumns:Array.from(s),colspanCompensation:l}}let mt=new Map([["collapse",p6],["expand",p7],["hide-column",function(t,e){if(!Number.isInteger(e))throw Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw Error(ru.e`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);let{crossHiddenColumns:i}=t.data;if(i.includes(e))return;let r=!1;t.walkUp(t=>{let{data:{collapsible:e}}=t;if(e)return r=!0,!1}),r||t.walkUp(t=>{let{data:i}=t;i.crossHiddenColumns.push(e),i.colspan>1?i.colspan-=1:i.isHidden=!0})}],["show-column",function(t,e){if(!Number.isInteger(e))throw Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw Error(ru.e`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);let{crossHiddenColumns:i}=t.data;if(!i.includes(e))return;let r=!1;t.walkUp(t=>{let{data:{collapsible:e}}=t;if(e)return r=!0,!1}),r||t.walkUp(t=>{let{data:i}=t;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(e),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}]]);function me(t){let e=[];return(0,u.Bk)(t,t=>{t.walkDown(t=>{let i;let r=t.data,{origColspan:n,columnIndex:o,headerLevel:s,crossHiddenColumns:l}=r,a=(Array.isArray(e[s])?i=e[s]:(i=[],e[s]=i),i),h=!1;for(let t=o;t<o+n;t++){let e=l.includes(t);if(e||h)a.push(pB(r));else{let t=function(t){let{crossHiddenColumns:e,...i}=pL(t);return i}(r);t.isRoot=!0,a.push(t),h=!0}}})}),e}function mi(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function mr(t,e,i){var r=mo(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function mn(t,e){var i=mo(t,e,"get");return i.get?i.get.call(t):i.value}function mo(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var ms=new WeakMap,ml=new WeakMap,ma=new WeakMap;class mh{constructor(){mi(this,ms,{writable:!0,value:new pG}),mi(this,ml,{writable:!0,value:new p5(mn(this,ms))}),mi(this,ma,{writable:!0,value:[[]]})}setState(t){mn(this,ms).setData(t);let e=!1;try{mn(this,ml).buildTree()}catch(t){mn(this,ml).clear(),mn(this,ms).clear(),e=!0}return mr(this,ma,me(mn(this,ml).getRoots())),e}setColumnsLimit(t){mn(this,ms).setColumnsLimit(t)}mergeStateWith(t){let e=(0,u.Sc)(t,t=>{let{row:e,...i}=t;return{row:e<0?this.rowCoordsToLevel(e):e,...i}});mn(this,ms).mergeWith(e),mn(this,ml).buildTree(),mr(this,ma,me(mn(this,ml).getRoots()))}mapState(t){mn(this,ms).map(t),mn(this,ml).buildTree(),mr(this,ma,me(mn(this,ml).getRoots()))}mapNodes(t){return(0,u.k$)(mn(this,ml).getRoots(),(e,i)=>(i.walkDown(i=>{let r=t(i.data);void 0!==r&&e.push(r)}),e),[])}triggerNodeModification(t,e,i){let r;e<0&&(e=this.rowCoordsToLevel(e));let n=mn(this,ml).getNode(e,i);return n&&(r=function(t,e,i){if(!mt.has(t))throw Error(`The node modifier action ("${t}") does not exist.`);return mt.get(t)(e,i)}(t,n,i),mr(this,ma,me(mn(this,ml).getRoots()))),r}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;let e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;let e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var i,r;return(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())?null:null!==(i=null===(r=mn(this,ma)[t])||void 0===r?void 0:r[e])&&void 0!==i?i:null}getHeaderTreeNodeData(t,e){let i=this.getHeaderTreeNode(t,e);return i?{...i.data}:null}getHeaderTreeNode(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;let i=mn(this,ml).getNode(t,e);return i||null}findTopMostEntireHeaderLevel(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=i-t+1,n=!1,o=null;for(let e=t;e<=i;e++){let s=mn(this,ml).getRootByColumn(e);if(!s)break;n=!0,s.walkDown(e=>{let{columnIndex:n,headerLevel:s,origColspan:l,isHidden:a}=e.data;!a&&l<=r&&n>=t&&n+l-1<=i&&(null===o||s<o)&&(o=s)},pX)}return n&&null===o?-1:this.levelToRowCoords(null!==(e=o)&&void 0!==e?e:0)}findLeftMostColumnIndex(t,e){var i,r;let{isRoot:n}=null!==(i=this.getHeaderSettings(t,e))&&void 0!==i?i:{isRoot:!0};if(n)return e;let o=e-1;for(;o>=0;){let{isRoot:e}=null!==(r=this.getHeaderSettings(t,o))&&void 0!==r?r:{isRoot:!0};if(e)break;o-=1}return o}findRightMostColumnIndex(t,e){var i,r;let{isRoot:n,origColspan:o}=null!==(i=this.getHeaderSettings(t,e))&&void 0!==i?i:{isRoot:!0,origColspan:1};if(n)return e+o-1;let s=e+1;for(;s<this.getColumnsCount();){let{isRoot:e}=null!==(r=this.getHeaderSettings(t,s))&&void 0!==r?r:{isRoot:!0};if(e)break;s+=1}return s-1}getLayersCount(){return mn(this,ms).getLayersCount()}getColumnsCount(){return mn(this,ms).getColumnsCount()}clear(){mr(this,ma,[]),mn(this,ms).clear(),mn(this,ml).clear()}}function mu(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var mc=class{constructor(t,e){mu(this,"hot",void 0),mu(this,"nestedHeaderSettingsGetter",void 0),mu(this,"layersCount",0),mu(this,"container",void 0),mu(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);let t=this.container.querySelectorAll("tr:last-of-type th"),e=t.length;this.widthsMap.clear();for(let i=0;i<e;i++){let e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),r=this.hot.toPhysicalColumn(e);this.widthsMap.setValueAtIndex(r,t[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){let{rootDocument:e,columnIndexMapper:i}=this.hot,r=e.createDocumentFragment(),o=e.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,l=i.getRenderableIndexesLength();for(let t=0;t<this.layersCount;t++){let r=e.createElement("tr");for(let o=0;o<l;o++){let l=i.getVisualFromRenderableIndex(o);null===l&&(l=o);let a=e.createElement("th"),h=this.nestedHeaderSettingsGetter(t,l);if(h&&(!h.isPlaceholder||h.isHidden)){let t=h.label;s&&(t+='<button class="changeType"></button>'),(0,n.uS)(a,t),a.colSpan=h.colspan,r.appendChild(a)}}o.appendChild(r)}r.appendChild(o),t.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}};function md(t,e){mp(t,e),e.add(t)}function mg(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function mf(t,e,i){mp(t,e),e.set(t,i)}function mp(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function mm(t,e,i){var r=mv(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function mw(t,e){var i=mv(t,e,"get");return i.get?i.get.call(t):i.value}function mv(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function mb(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let my="nestedHeaders";var mC=new WeakMap,mS=new WeakMap,mE=new WeakMap,mR=new WeakMap,mT=new WeakSet,mM=new WeakSet,mO=new WeakSet,mk=new WeakSet,mx=new WeakSet,mI=new WeakSet,mA=new WeakSet,mN=new WeakSet,mH=new WeakSet,m_=new WeakSet,mP=new WeakSet,mD=new WeakSet,mL=new WeakSet,mB=new WeakSet,mW=new WeakSet,mV=new WeakSet,mF=new WeakSet,mj=new WeakSet;class mU extends t9{constructor(){super(...arguments),md(this,mj),md(this,mF),md(this,mV),md(this,mW),md(this,mB),md(this,mL),md(this,mD),md(this,mP),md(this,m_),md(this,mH),md(this,mN),md(this,mA),md(this,mI),md(this,mx),md(this,mk),md(this,mO),md(this,mM),md(this,mT),mf(this,mC,{writable:!0,value:new mh}),mf(this,mS,{writable:!0,value:null}),mf(this,mE,{writable:!0,value:null}),mf(this,mR,{writable:!0,value:!1}),mg(this,"ghostTable",new mc(this.hot,(t,e)=>this.getHeaderSettings(t,e))),mg(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return my}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[my]}enablePlugin(){var t=this;if(this.enabled)return;let{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||(0,iu.ZK)(ru.e`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>mb(this,mF,m9).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mj,m3).call(t,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mx,mY).call(t,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mI,mX).call(t,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mA,mq).call(t,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mN,mZ).call(t,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mH,mJ).call(t,...i)}),this.addHook("modifyTransformStart",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,m_,mQ).call(t,...i)}),this.addHook("afterSelection",()=>mb(this,mT,m$).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mM,mz).call(t,...i)}),this.addHook("afterGetColumnHeaderRenderers",t=>mb(this,mD,m1).call(this,t)),this.addHook("modifyColWidth",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mB,m4).call(t,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mW,m5).call(t,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mO,mK).call(t,...i)}),this.addHook("beforeCopy",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mk,mG).call(t,...i)}),this.addHook("beforeSelectColumns",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mP,m0).call(t,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mL,m2).call(t,...i)}),this.addHook("modifyFocusedElement",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mb(t,mV,m8).call(t,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>mb(this,mT,m$).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>mb(this,mT,m$).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;let{nestedHeaders:t}=this.hot.getSettings();mw(this,mC).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=mw(this,mC).setState(t)),this.detectedOverlappedHeaders&&(0,iu.ZK)(ru.e`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,e)=>{mw(this,mC).triggerColumnModification(!0===t?"hide-column":"show-column",e)}),!mw(this,mS)&&this.enabled&&mm(this,mS,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(t=>{let{op:e,index:i,newValue:r}=t;"replace"===e&&mw(this,mC).triggerColumnModification(!0===r?"hide-column":"show-column",i)}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),mw(this,mC).clear(),mw(this,mS).unsubscribe(),mm(this,mS,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return mw(this,mC)}getLayersCount(){return mw(this,mC).getLayersCount()}getHeaderSettings(t,e){return mw(this,mC).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;let{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,i=t.wtTable.THEAD,r=t.wtOverlays.topOverlay.clone.wtTable.THEAD,o=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let t=0;t<e;t++){let e=i.childNodes[t];if(!e)break;let s=r.childNodes[t],l=o?o.childNodes[t]:null;for(let t=0,i=e.childNodes.length;t<i;t++)e.childNodes[t].removeAttribute("colspan"),(0,n.IV)(e.childNodes[t],"hiddenHeader"),s&&s.childNodes[t]&&(s.childNodes[t].removeAttribute("colspan"),(0,n.IV)(s.childNodes[t],"hiddenHeader")),o&&l&&l.childNodes[t]&&(l.childNodes[t].removeAttribute("colspan"),(0,n.IV)(l.childNodes[t],"hiddenHeader"))}}headerRendererFactory(t){var e=this;let i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,o)=>{var s,l,a;let{columnIndexMapper:h,view:u}=this.hot,c=h.getVisualFromRenderableIndex(r);null===c&&(c=r),o.removeAttribute("colspan"),(0,n.IV)(o,"hiddenHeader");let{colspan:d,isHidden:g,isPlaceholder:f}=null!==(s=mw(this,mC).getHeaderSettings(t,c))&&void 0!==s?s:{label:""};if(f||g)(0,n.cn)(o,"hiddenHeader");else if(d>1){let{wtOverlays:t}=u._wt,e=null===(l=t.topInlineStartCornerOverlay)||void 0===l?void 0:l.clone.wtTable.THEAD.contains(o),n=null===(a=t.inlineStartOverlay)||void 0===a?void 0:a.clone.wtTable.THEAD.contains(o),s=e||n?Math.min(d,i-r):d;s>1&&o.setAttribute("colspan",s)}this.hot.view.appendColHeader(c,o,function(){return e.getColumnHeaderValue(...arguments)},t)}}getColumnHeaderValue(t,e){var i;let{isHidden:r,isPlaceholder:n}=null!==(i=mw(this,mC).getHeaderSettings(e,t))&&void 0!==i?i:{};return n||r?"":this.hot.getColHeader(t,e)}destroy(){mm(this,mC,null),null!==mw(this,mS)&&(mw(this,mS).unsubscribe(),mm(this,mS,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0)&&!(t.col<0))return mw(this,mC).getHeaderTreeNodeData(t.row,t.col)}}function m$(){var t;let e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;let{highlight:i}=e,r=i.isHeader()&&i.col>=0;if(r){let t=mw(this,mC).findLeftMostColumnIndex(i.row,i.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}function mz(t){let e=this.hot.getSelectedRangeLast();if(!e)return t;let{highlight:i}=e,r=i.isHeader()&&i.col>=0;if(!r)return t;let n=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=mw(this,mC).findLeftMostColumnIndex(i.row,i.col),l=mw(this,mC).findRightMostColumnIndex(i.row,i.col);return s<n&&l>o?t:s<n?s:l}function mK(t,e,i){let r=mw(this,mC).getHeaderTreeNodeData(e,t);if(!r)return t;let{columnCursor:n,selectionType:o,selectionWidth:s}=i,{isRoot:l,colspan:a}=mw(this,mC).getHeaderSettings(e,t);if(o===pD.Nc){if(!l)return r.columnIndex}else if(o===pD.CD&&(a>s-n||!l))return null;return t}function mG(t,e,i){let{columnHeadersCount:r}=i;if(0!==r)for(let i=0;i<e.length;i++){let{startRow:r,startCol:o,endRow:s,endCol:l}=e[i],a=s-r+1,h=o-l+1;if(r>=0||1===h)break;for(let e=o;e<=l;e++)for(let i=r;i<=s;i++){var n;let r=a+i,s=e-o;if(0===s)continue;let l=null===(n=mw(this,mC).getHeaderTreeNodeData(i,e))||void 0===n?void 0:n.isRoot;!1===l&&(t[r][s]="")}}}function mY(t,e,i,r){let n=this._getHeaderTreeNodeDataByCoords(e);n&&(r.column=!0)}function mX(t,e){let i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;mm(this,mE,e.clone()),mm(this,mR,!0);let{selection:r}=this.hot,n=r.isSelected()?r.getSelectedRange().current():null,s=[],{columnIndex:l,origColspan:a}=i,h=!r.inInSelection(e);t.shiftKey&&n?e.col<n.from.col?s.push(n.getTopEndCorner().col,l,e.row):e.col>n.from.col?s.push(n.getTopStartCorner().col,l+a-1,e.row):s.push(l,l+a-1,e.row):((0,o.pW)(t)||(0,o.dO)(t)&&h)&&s.push(l,l+a-1,e.row),r.selectColumns(...s)}function mq(t,e,i,r){if(!this.hot.view.isMouseDown())return;let n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;let{columnIndex:o,origColspan:s}=n,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:u}=l;r.column=!0,r.cell=!0;let c=[],d=(0,tT.uZ)(e.row,-1/0,-1);e.col<u.col?c.push(h.col,o,d):e.col>u.col?c.push(a.col,o+s-1,d):c.push(o,o+s-1,d),this.hot.selection.selectColumns(...c)}function mZ(){mm(this,mR,!1)}function mJ(){let{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!mw(this,mR)||!t)return;let e=this.hot.getSelectedRangeLast(),i=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:n,origColspan:o}=mw(this,mC).getHeaderTreeNodeData(mw(this,mE).row,mw(this,mE).col);if(e.setHighlight(mw(this,mE)),o>e.getWidth()||n<i||n+o-1>r){let t=mw(this,mC).findTopMostEntireHeaderLevel((0,tT.uZ)(i,n,n+o-1),(0,tT.uZ)(r,n,n+o-1));e.highlight.row=t,e.highlight.col=e.from.col}}function mQ(t){let{highlight:e}=this.hot.getSelectedRangeLast(),i=this.hot._createCellCoords(e.row+t.row,e.col+t.col),r=i.isHeader()&&i.col>=0;if(!r)return;let n=mw(this,mC).findLeftMostColumnIndex(i.row,i.col),o=mw(this,mC).findRightMostColumnIndex(i.row,i.col);if(t.col<0){let i=e.col>=n&&e.col<=o?n-1:o,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i,-1);null===r?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(r,e.col)-1,1)}else if(t.col>0){let i=e.col>=n&&e.col<=o?o+1:n,r=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i,1);null===r?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,r)-1,1)}}function m0(t,e){let i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),n=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),n&&(e.col=n.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),n&&(e.col=n.columnIndex+n.origColspan-1))}function m1(t){t.length=0;for(let e=0;e<mw(this,mC).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function m2(t){let e=mw(this,mC).getLayersCount(),i=t.startColumn,r=!!e;for(let n=0;n<e;n++){let e=mw(this,mC).findLeftMostColumnIndex(n,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(r=!1),(0,tT.kE)(o)&&o<t.startColumn){i=o;break}}t.startColumn=r?mw(this,mC).getHeaderTreeNodeData(0,i).columnIndex:i}function m4(t,e){let i=this.ghostTable.getWidth(e);return t>i?t:i}function m5(t,e,i){var r;let{label:n}=null!==(r=mw(this,mC).getHeaderTreeNodeData(i,e))&&void 0!==r?r:{label:""};return n}function m8(t,e){if(t<0)return this.hot.getCell(t,mw(this,mC).findLeftMostColumnIndex(t,e),!0)}function m9(){this.updatePlugin()}function m3(t,e){e||this.updatePlugin()}function m7(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var m6=class{constructor(t,e){m7(this,"hot",void 0),m7(this,"data",null),m7(this,"plugin",void 0),m7(this,"parentReference",new WeakMap),m7(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=e,this.plugin=t}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,tT.q4)(0,this.data.length-1,t=>{this.cacheNode(this.data[t],0,null)})}cacheNode(t,e,i){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:i,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&(0,u.Bk)(t.__children,i=>{this.cacheNode(i,e+1,t)})}getDataObject(t){return null==t?null:this.cache.rows[t]}readTreeNodes(t,e,i,r){let n=!1,o=e;if(isNaN(o)&&o.end)return o;let s=t;return(s||(s={__children:this.data},n=!0,o-=1),null!=i&&o===i)?{result:s,end:!0}:null!=r&&s===r?{result:o,end:!0}:(o+=1,s.__children&&(0,u.Bk)(s.__children,t=>{if(this.parentReference.set(t,n?null:s),isNaN(o=this.readTreeNodes(t,o,i,r))&&o.end)return!1}),o)}mockParent(){let t=this.mockNode();return t.__children=this.data,t}mockNode(){let t={};return(0,s._l)(this.data[0],(e,i)=>{t[i]=null}),t}getRowIndex(t){return null==t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);let i=this.getRowParent(t);return null==i?this.data.indexOf(e):i.__children.indexOf(e)}countAllRows(){let t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,i=t;return(isNaN(i)||(i=this.getDataObject(i)),i&&i.__children)?((0,u.Bk)(i.__children,t=>{e+=1,t.__children&&(e+=this.countChildren(t))}),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"==typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return(e=isNaN(t)?t:this.getDataObject(t))?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null==t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!!(e.__children&&e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var i;return(null===(i=t.__children)||void 0===i?void 0:i[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let i=t;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&(null===(e=i.__children)||void 0===e?void 0:e.length)!==0}addChild(t,e){let i=e;this.hot.runHooks("beforeAddChild",t,i);let r=null;t&&(r=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(t)+1,1);let n=t;t||(n=this.mockParent()),n.__children||(n.__children=[]),i||(i=this.mockNode()),n.__children.push(i),this.rewriteCache();let o=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",t,i)}addChildAtIndex(t,e,i){let r,n=i;if(n||(n=this.mockNode()),this.hot.runHooks("beforeAddChild",t,n,e),t){let i=this.getRowIndex(t),o=i+e+1;this.hot.runHooks("beforeCreateRow",o,1),t.__children.splice(e,null,n),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(o,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",o,1),r=o}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[e]);n=this.getDataObject(r),this.hot.runHooks("afterAddChild",t,n,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",i=this.translateTrimmedRow(t),r=this.getRowParent(i),n=this.getRowIndexWithinParent(i);switch(e){case"below":this.addChildAtIndex(r,n+1,null);break;case"above":this.addChildAtIndex(r,n,null)}}detachFromParent(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=null,r=[];Array.isArray(t)?((0,tT.q4)(t[0],t[2],t=>{let e=this.translateTrimmedRow(t);r.push(this.getDataObject(e))}),(0,tT.q4)(0,r.length-2,t=>{this.detachFromParent(r[t],!1)}),i=r[r.length-1]):i=t;let n=this.getRowIndex(i),o=this.countChildren(i),s=this.getRowIndexWithinParent(i),l=this.getRowParent(i),a=this.getRowParent(l),h=this.getRowIndex(a),u=null;if(this.hot.runHooks("beforeDetachChild",l,i),null!=s){let t=Array.from(Array(n+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",n,o+1,t,this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",n,o+1,t,this.plugin.pluginName),a){u=h+this.countChildren(a);let t=this.getChild(a,this.countChildren(a)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,o+1,this.plugin.pluginName),a.__children.push(i)}else u=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",u-2,o+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",u-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),e&&this.hot.render()}filterData(t,e,i){let r=[];(0,u.Bk)(i,t=>{r.push(this.getDataObject(t))}),(0,u.Bk)(r,t=>{let e=this.getRowIndexWithinParent(t),i=this.getRowParent(t);null===i?this.data.splice(e,1):i.__children.splice(e,1)}),this.rewriteCache()}spliceData(t,e,i){let r=this.getDataObject(t-1),n=null,o=t;r&&r.__children&&0===r.__children.length?(n=r,o=0):t<this.countAllRows()&&(n=this.getRowParent(t),o=this.getRowIndexWithinParent(t)),n?i?n.__children.splice(o,e,...i):n.__children.splice(o,e):i?this.data.splice(o,e,...i):this.data.splice(o,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,i=null;do null!==(i=this.getRowParent(i))&&(e=i);while(null!==i);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,i,r){let n=e===this.hot.countRows(),o=this.getRowParent(t),s=this.getRowIndexWithinParent(t),l=o.__children.slice(s,s+1),a=t>e,h=n?this.getRowParent(e-1):this.getRowParent(e);null==h&&(h=this.getRowParent(e-1)),null==h&&(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e)).__children=[];let u=n||i||r?h.__children.length:this.getRowIndexWithinParent(e),c=o===h;h.__children.splice(u,0,l[0]),o.__children.splice(s+(a&&c?1:0),1),this.syncRowWithRawSource(o),c||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}};function wt(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var we=class{constructor(t,e){wt(this,"hot",void 0),wt(this,"plugin",void 0),this.hot=e,this.plugin=t}};class wi extends we{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){let i=this.hot.toPhysicalRow(t),r=this.dataManager.getRowLevel(i),o=this.dataManager.getDataObject(i),s=e.getElementsByTagName("DIV")[0],l=s.querySelector("span.rowHeader"),a=s.querySelectorAll('[class^="ht_nesting"]'),h=this.hot.getSettings().ariaTags;if((0,u.Bk)(a,t=>{t&&s.removeChild(t)}),(0,n.cn)(e,wi.CSS_CLASSES.indicatorContainer),r){let{rootDocument:t}=this.hot,e=l.cloneNode(!0);s.innerHTML="",(0,tT.q4)(0,r-1,()=>{let e=t.createElement("SPAN");(0,n.cn)(e,wi.CSS_CLASSES.emptyIndicator),s.appendChild(e)}),s.appendChild(e)}if(this.dataManager.hasChildren(o)){let t=this.hot.rootDocument.createElement("DIV");h&&(0,n.P$)(t,[(0,m.cV)()]),(0,n.cn)(e,wi.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?((0,n.cn)(t,`${wi.CSS_CLASSES.button} ${wi.CSS_CLASSES.expandButton}`),h&&(0,n.P$)(e,[(0,m.JV)(!1)])):((0,n.cn)(t,`${wi.CSS_CLASSES.button} ${wi.CSS_CLASSES.collapseButton}`),h&&(0,n.P$)(e,[(0,m.JV)(!0)])),s.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}}var wr=class extends we{constructor(t,e){var i;super(t,e),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,t)},shiftStash:function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==e&&(e=1/0),(0,u.Bk)(i.lastCollapsedRows,(n,o)=>{n>=t&&n<e&&(i.lastCollapsedRows[o]=n+r)})},applyStash:function(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];i.collapseMultipleChildren(i.lastCollapsedRows,t),i.lastCollapsedRows=void 0},trimStash:(t,e)=>{(0,tT.q4)(t,t+e-1,t=>{let e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)})}}}collapseChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[],n=null,o=null,s=null;return isNaN(t)?(n=t,o=this.dataManager.getRowIndex(n)):(n=this.dataManager.getDataObject(t),o=t),this.dataManager.hasChildren(n)&&(0,u.Bk)(n.__children,t=>{r.push(this.dataManager.getRowIndex(t))}),s=this.collapseRows(r,!0,!1),i&&this.trimRows(s),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(o)&&this.collapsedRows.push(o),s}collapseMultipleChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[];(0,u.Bk)(t,t=>{r.push(...this.collapseChildren(t,!1,!1))}),i&&this.trimRows(r),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return(0,u.Bk)(t,t=>{r.push(t),e&&this.collapseChildRows(t,r)}),i&&this.trimRows(r),r}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){let i=this.dataManager.getDataObject(t);(0,u.Bk)(i.__children,t=>{let i=this.dataManager.getRowIndex(t);e.push(i),this.collapseChildRows(i,e)})}i&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return(0,u.Bk)(t,t=>{r.push(t),e&&this.expandChildRows(t,r)}),i&&this.untrimRows(r),r}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){let i=this.dataManager.getDataObject(t);(0,u.Bk)(i.__children,t=>{if(!this.isAnyParentCollapsed(t)){let i=this.dataManager.getRowIndex(t);e.push(i),this.expandChildRows(i,e)}})}i&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[],n=null,o=null,s=null;return isNaN(t)?(n=t,o=this.dataManager.getRowIndex(t)):(n=this.dataManager.getDataObject(t),o=t),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(n)&&(0,u.Bk)(n.__children,t=>{let e=this.dataManager.getRowIndex(t);r.push(e)}),s=this.expandRows(r,!0,!1),i&&this.untrimRows(s),e&&this.renderAndAdjust(),s}expandMultipleChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[];(0,u.Bk)(t,t=>{r.push(...this.expandChildren(t,!1,!1))}),i&&this.untrimRows(r),e&&this.renderAndAdjust()}collapseAll(){let t=this.dataManager.getData(),e=[];(0,u.Bk)(t,t=>{this.dataManager.hasChildren(t)&&e.push(t)}),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){let t=this.dataManager.getData(),e=[];(0,u.Bk)(t,t=>{this.dataManager.hasChildren(t)&&e.push(t)}),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution(()=>{(0,u.Bk)(t,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(t){this.hot.batchExecution(()=>{(0,u.Bk)(t,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),i=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&(0,u.Bk)(e.__children,t=>{let e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return i=!1,!1}),i}isAnyParentCollapsed(t){let e=t;for(;null!==e;){e=this.dataManager.getRowParent(e);let t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;let i=this.translateTrimmedRow(e.row);(0,n.pv)(t.target,wi.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),(0,o.mM)(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}},wn=new WeakMap,wo=class extends we{constructor(){var t,e,i;super(...arguments),t="dataManager",e=this.plugin.dataManager,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e,function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,wn),wn.set(this,{writable:!0,value:{row_above:(t,e)=>{let i=e[e.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(t,e)=>{let i=e[e.length-1];this.dataManager.addSibling(i.start.row,"below")}}})}appendOptions(t){let e=[{key:"add_child",name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{let t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{let t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(tp.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{let t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]),i=this.dataManager.getRowParent(e);return!i||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return(0,tT.q4)(0,t.items.length-1,i=>{if(0===i)return(0,u.Bk)(e,(e,r)=>{t.items.splice(i+r,0,e)}),!1}),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){return(0,tT.q4)(0,t.items.length-1,e=>{var i;let r=((i=function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return e.get(t)}(this,wn,0)).get?i.get.call(this):i.value)[t.items[e].key];null!=r&&(t.items[e].callback=r)}),t}};function ws(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class wl{constructor(t){ws(this,"plugin",void 0),ws(this,"hot",void 0),ws(this,"dataManager",void 0),ws(this,"collapsingUI",void 0),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,i,r){let n=this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:i,movePossible:r});if(n)return!1;this.movedToCollapsed=!1;let o=i===this.hot.countRows(),s=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),l=!0,a=t.map(t=>{if(!l)return!1;let e=this.dataManager.translateTrimmedRow(t);return l=this.shouldAllowMoving(e,s),e}),h=-1===a.indexOf(s);if(!l||!h)return!1;let u=this.getBaseParent(a),c=this.getTargetParent(o,s),d=u===c;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(c),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(a,s,d),this.moveRows(a,s,c),this.dataManager.rewriteCache(),this.moveCellsMeta(a,s),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,i,r,r&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,i),!1}displayAPICompatibilityWarning(t){let{rows:e,finalIndex:i,dropIndex:r,movePossible:n}=t,o=!1;return(0,c.o8)(r)&&((0,iu.ZK)(ru.e`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,i,r,n,!1),o=!0),o}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let i=this.dataManager.getRowParent(t?e-1:e);return null==i&&(i=this.dataManager.getRowParent(e-1)),i}shiftCollapsibleParentsLocations(t,e,i){i||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,i){let r=e===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{t.forEach(t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,r)})})}moveCellsMeta(t,e){let i=[],r=Math.max(...t)<e;t.forEach(t=>{i.push(this.hot.getCellMetaAtRow(t))}),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(r?i.length:0),0,...i)}selectCells(t,e){let i=t.length,r=0,n=0,o=null,s=null;if(this.movedToCollapsed){let o=null;o=t[i-1]<e?this.dataManager.translateTrimmedRow(e-i):this.dataManager.translateTrimmedRow(e);let s=this.dataManager.getRowParent(null===o?this.hot.countSourceRows()-1:o-1),l=this.dataManager.getRowIndex(s);n=r=this.dataManager.untranslateTrimmedRow(l)}else t[i-1]<e?r=(n=e-1)-i+1:n=(r=e)+i-1;o=this.hot.selection,s=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(r,0)),o.setRangeEnd(this.hot._createCellCoords(n,s),!0)}isRowOrderChanged(t,e){return t.some((t,i)=>t-i!==e)}}function wa(t,e){wu(t,e),e.add(t)}function wh(t,e,i){wu(t,e),e.set(t,i)}function wu(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function wc(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function wd(t,e){var i=wf(t,e,"get");return i.get?i.get.call(t):i.value}function wg(t,e,i){var r=wf(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function wf(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}function wp(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let wm="nestedRows";var ww=new WeakMap,wv=new WeakMap,wb=new WeakSet,wy=new WeakSet,wC=new WeakSet,wS=new WeakSet,wE=new WeakSet,wR=new WeakSet,wT=new WeakSet,wM=new WeakSet,wO=new WeakSet,wk=new WeakSet,wx=new WeakSet,wI=new WeakSet,wA=new WeakSet,wN=new WeakSet,wH=new WeakSet,w_=new WeakSet;class wP extends t9{constructor(){super(...arguments),wa(this,w_),wa(this,wH),wa(this,wN),wa(this,wA),wa(this,wI),wa(this,wx),wa(this,wk),wa(this,wO),wa(this,wM),wa(this,wT),wa(this,wR),wa(this,wE),wa(this,wS),wa(this,wC),wa(this,wy),wa(this,wb),wc(this,"dataManager",null),wc(this,"headersUI",null),wc(this,"collapsedRowsMap",null),wh(this,ww,{writable:!0,value:!1}),wh(this,wv,{writable:!0,value:!1})}static get PLUGIN_KEY(){return wm}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[wm]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new ht.n),this.dataManager=new m6(this,this.hot),this.collapsingUI=new wr(this,this.hot),this.headersUI=new wi(this,this.hot),this.contextMenuUI=new wo(this,this.hot),this.rowMoveController=new wl(this),this.addHook("afterInit",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wN,wX).call(t,...i)}),this.addHook("beforeViewRender",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wH,wq).call(t,...i)}),this.addHook("modifyRowData",function(){return t.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return t.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return t.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wC,wB).call(t,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wS,wW).call(t,...i)}),this.addHook("afterGetRowHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wE,wV).call(t,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wy,wL).call(t,...i)}),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wM,wU).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wT,wj).call(t,...i)}),this.addHook("beforeAddChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wO,w$).call(t,...i)}),this.addHook("afterAddChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wk,wz).call(t,...i)}),this.addHook("beforeDetachChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wx,wK).call(t,...i)}),this.addHook("afterDetachChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wI,wG).call(t,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wR,wF).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wA,wY).call(t,...i)}),this.addHook("beforeRowMove",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wp(t,wb,wD).call(t,...i)}),this.addHook("beforeLoadData",t=>wp(this,w_,wZ).call(this,t)),this.addHook("beforeUpdateData",t=>wp(this,w_,wZ).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();let t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();if(-1===t.col&&t.row>=0){let e=this.collapsingUI.translateTrimmedRow(t.row);this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e)}},runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()},group:wm})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wm)}disableCoreAPIModifiers(){wg(this,wv,!0)}enableCoreAPIModifiers(){wg(this,wv,!1)}onModifyRowData(t){if(!wd(this,wv))return this.dataManager.getDataObject(t)}onModifySourceLength(){if(!wd(this,wv))return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,i){return!!(wd(this,wv)||this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,i),!1)}destroy(){super.destroy()}}function wD(t,e,i,r){return this.rowMoveController.onBeforeRowMove(t,e,i,r)}function wL(t,e,i){this.collapsingUI.toggleState(t,e,i)}function wB(t,e,i){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(i[0],null,-1*e),this.dataManager.filterData(t,e,i),wg(this,ww,!0),this.dataManager.getData().slice()}function wW(t){return this.contextMenuUI.appendOptions(t)}function wV(t,e){this.headersUI.appendLevelIndicators(t,e)}function wF(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function wj(t,e,i,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{wg(this,ww,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function wU(t,e,i){let r=Array.from(i.reduce((t,e)=>{if(this.dataManager.isParent(e)){let i=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(i)&&i.forEach(e=>t.add(this.dataManager.getRowIndex(e))),t}return t.add(e)},new Set));i.length=0,i.push(...r)}function w$(){this.collapsingUI.collapsedRowsStash.stash()}function wz(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function wK(){this.collapsingUI.collapsedRowsStash.stash()}function wG(t,e,i){this.collapsingUI.collapsedRowsStash.shiftStash(i,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function wY(){this.dataManager.rewriteCache()}function wX(){this.headersUI.updateRowHeaderWidth()}function wq(t,e){wd(this,ww)&&(e.skipRender=!0)}function wZ(t){if(!(0,ag.Pj)(t)){(0,iu.vU)("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[wm]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function wJ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var wQ=class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;wJ(this,"rootWindow",void 0),wJ(this,"prefix",void 0),wJ(this,"savedKeys",[]),this.rootWindow=e,this.prefix=t,this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){let i=this.rootWindow.localStorage.getItem(`${this.prefix}_${void 0===t?e:t}`);return null===i?void 0:JSON.parse(i)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){(0,u.Bk)(this.savedKeys,(t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)}),this.clearSavedKeys()}loadSavedKeys(){let t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};tt.Z.getSingleton().register("persistentStateSave"),tt.Z.getSingleton().register("persistentStateLoad"),tt.Z.getSingleton().register("persistentStateReset");let w0="persistentState";class w1 extends t9{constructor(){var t,e,i;super(...arguments),e=void 0,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="storage","string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}static get PLUGIN_KEY(){return w0}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[w0]}enablePlugin(){this.enabled||(this.storage||(this.storage=new wQ(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(t,e)=>this.saveValue(t,e)),this.addHook("persistentStateLoad",(t,e)=>this.loadValue(t,e)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}function w2(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function w4(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}let w5="search",w8=function(t,e,i,r,n){t.getCellMeta(e,i).isSearchResult=n},w9=function(t,e,i){return!((0,c.o8)(t)||null===t||!t.toLocaleLowerCase||0===t.length||(0,c.o8)(e)||null===e)&&-1!==e.toString().toLocaleLowerCase(i.locale).indexOf(t.toLocaleLowerCase(i.locale))};var w3=new WeakSet;class w7 extends t9{constructor(){super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,w3),w3.add(this),w2(this,"callback",w8),w2(this,"queryMethod",w9),w2(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return w5}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[w5]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[w5];this.updatePluginSettings(e),this.addHook("beforeRenderer",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return w4(t,w3,w6).call(t,...i)}),super.enablePlugin()}disablePlugin(){var t=this;let e=function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return w4(t,w3,w6).call(t,...i)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",e)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),r=this.hot.countRows(),n=this.hot.countCols(),o=[],s=this.hot;return(0,tT.q4)(0,r-1,r=>{(0,tT.q4)(0,n-1,n=>{let l=this.hot.getDataAtCell(r,n),a=this.hot.getCellMeta(r,n),h=a.search.callback||e,u=a.search.queryMethod||i,c=u(t,l,a);c&&o.push({row:r,col:n,data:l}),h&&h(s,r,n,l,c)})}),o}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){(0,s.Kn)(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}destroy(){super.destroy()}}function w6(t,e,i,r,n,o){let s=o.className||[],l=[];"string"==typeof s?l=s.split(" "):l.push(...s),this.isEnabled()&&o.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),o.className=l.join(" ")}function vt(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}function ve(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function vi(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}var vr=new WeakSet,vn=new WeakSet,vo=new WeakSet;class vs extends t9{constructor(){super(...arguments),vt(this,vo),vt(this,vn),vt(this,vr),ve(this,"scrollbars",[]),ve(this,"clones",[]),ve(this,"lockedCollection",!1),ve(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return(0,t7.JS)()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>vi(this,vr,vl).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>vi(this,vn,va).call(this)),this.addHook("afterMomentumScroll",()=>vi(this,vo,vh).call(this))}}function vl(){if(this.lockedCollection)return;let{topOverlay:t,bottomOverlay:e,inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(i),r&&this.scrollbars.push(r),n&&n.clone&&this.scrollbars.push(n),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&n.clone&&this.clones.push(n.clone.wtTable.holder.parentNode)}function va(){this.freezeOverlays=!0,(0,u.Bk)(this.clones,t=>{(0,n.cn)(t,"hide-tween")})}function vh(){this.freezeOverlays=!1,(0,u.Bk)(this.clones,t=>{(0,n.IV)(t,"hide-tween"),(0,n.cn)(t,"show-tween")}),this.hot._registerTimeout(()=>{(0,u.Bk)(this.clones,t=>{(0,n.IV)(t,"show-tween")})},400),(0,u.Bk)(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}let vu="trimRows";var vc=new WeakSet;class vd extends t9{constructor(){var t,e;super(...arguments),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,vc),vc.add(this),(t="symbol"==typeof(e=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="trimmedRowsMap","string"))?e:String(e))in this?Object.defineProperty(this,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[t]=null}static get PLUGIN_KEY(){return vu}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[vu]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new ht.n),this.trimmedRowsMap.addLocalHook("init",()=>(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,vc,vg).call(this)),super.enablePlugin())}updatePlugin(){let t=this.hot.getSettings()[vu];Array.isArray(t)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),(0,u.Bk)(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){let e=this.getTrimmedRows(),i=this.isValidConfig(t),r=e;i&&(r=Array.from(new Set(e.concat(t))));let n=this.hot.runHooks("beforeTrimRow",e,r,i);!1!==n&&(i&&this.hot.batchExecution(()=>{(0,u.Bk)(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),this.hot.runHooks("afterTrimRow",e,r,i,i&&r.length>e.length))}trimRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.trimRows(e)}untrimRows(t){let e=this.getTrimmedRows(),i=this.isValidConfig(t),r=e,n=this.trimmedRowsMap.getValues().slice(),o=t.length>0;i&&o&&((0,u.Bk)(t,t=>{n[t]=!1}),r=(0,u.k$)(n,(t,e,i)=>(e&&t.push(i),t),[]));let s=this.hot.runHooks("beforeUntrimRow",e,r,i&&o);!1!==s&&(i&&o&&this.trimmedRowsMap.setValues(n),this.hot.runHooks("afterUntrimRow",e,r,i&&o,i&&r.length<e.length))}untrimRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){let e=this.hot.countSourceRows();return t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}destroy(){super.destroy()}}function vg(){let t=this.hot.getSettings()[vu];Array.isArray(t)&&this.hot.batchExecution(()=>{(0,u.Bk)(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}i(35214);let vf="undoRedo";function vp(t){let e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(i,r){let n=i&&i.length;if(!n)return;let o=i.find(t=>{let[,,e,i]=t;return e!==i});o&&e.done(()=>{let e=i.reduce((t,e)=>(t.push([...e]),t),[]);(0,u.Bk)(e,e=>{e[1]=t.propToCol(e[1])});let r=n>1?this.getSelected():[[e[0][0],e[0][1]]];return new vp.ChangeAction(e,r)},r)}),t.addHook("afterCreateRow",(t,i,r)=>{e.done(()=>new vp.CreateRowAction(t,i),r)});let i=(e,i,r,n)=>{let o=["visualRow","visualCol","row","col","prop"],s=o.length,l=[];return(0,tT.q4)(r,n,r=>{(0,tT.q4)(e,i,e=>{let i=t.getCellMeta(e,r);if(Object.keys(i).length!==s){let t=Object.fromEntries(Object.entries(i).filter(t=>{let[e]=t;return!1===o.includes(e)}));l.push([i.visualRow,i.visualCol,t])}})}),l};t.addHook("beforeRemoveRow",(r,n,o,l)=>{e.done(()=>{let o=t.toPhysicalRow(r),l=o+n-1,a=(0,s.I8)(e.instance.getSourceData(o,0,o+n-1,e.instance.countSourceCols()-1));return new vp.RemoveRowAction(o,a,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),i(o,l,0,t.countCols()-1))},l)}),t.addHook("afterCreateCol",(t,i,r)=>{e.done(()=>new vp.CreateColumnAction(t,i),r)}),t.addHook("beforeRemoveCol",(r,n,o,s)=>{e.done(()=>{let o=e.instance.getSourceDataArray(),s=(e.instance.countCols()+r)%e.instance.countCols(),l=s+n-1,a=[],h=[],u=[];(0,tT.q4)(o.length-1,e=>{let i=[],r=o[e];(0,tT.q4)(s,l,e=>{i.push(r[t.toPhysicalColumn(e)])}),a.push(i)}),(0,tT.q4)(n-1,e=>{u.push(t.toPhysicalColumn(s+e))}),Array.isArray(t.getSettings().colHeaders)&&(0,tT.q4)(n-1,e=>{h.push(t.getSettings().colHeaders[t.toPhysicalColumn(s+e)]||null)});let c=t.columnIndexMapper.getIndexesSequence(),d=t.rowIndexMapper.getIndexesSequence();return new vp.RemoveColumnAction(s,u,a,h,c,d,t.getSettings().fixedColumnsStart,i(0,t.countRows(),s,l))},s)}),t.addHook("beforeCellAlignment",(t,i,r,n)=>{e.done(()=>new vp.CellAlignmentAction(t,i,r,n))}),t.addHook("beforeFilter",t=>{e.done(()=>new vp.FiltersAction(t))}),t.addHook("beforeRowMove",(t,i)=>{!1!==t&&e.done(()=>new vp.RowMoveAction(t,i))}),t.addHook("beforeMergeCells",(i,r)=>{r||e.done(()=>new vp.MergeCellsAction(t,i))}),t.addHook("afterUnmergeCells",(i,r)=>{r||e.done(()=>new vp.UnmergeCellsAction(t,i))}),t.addHook("afterInit",()=>{e.init()})}vp.prototype.done=function(t,e){if(this.ignoreNewActions)return;let i="UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;if(i)return;let r=this.doneActions.slice(),n=this.instance.runHooks("beforeUndoStackChange",r,e);if(!1===n)return;let o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())},vp.prototype.undo=function(){if(this.isUndoAvailable()){let t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);let e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());let i=(0,s.I8)(e),r=this.instance.runHooks("beforeUndo",i);if(!1===r)return;this.ignoreNewActions=!0;let n=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{n.ignoreNewActions=!1,n.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",i)}},vp.prototype.redo=function(){if(this.isRedoAvailable()){let t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);let e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());let i=(0,s.I8)(e),r=this.instance.runHooks("beforeRedo",i);if(!1===r)return;this.ignoreNewActions=!0;let n=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{n.ignoreNewActions=!1,n.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",i)}},vp.prototype.isUndoAvailable=function(){return this.doneActions.length>0},vp.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},vp.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},vp.prototype.isEnabled=function(){return this.enabled},vp.prototype.enable=function(){if(this.isEnabled())return;let t=this.instance;this.enabled=!0,t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()},this.registerShortcuts(),t.addHook("afterChange",vv)},vp.prototype.disable=function(){if(!this.isEnabled())return;let t=this.instance;this.enabled=!1,delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo,this.unregisterShortcuts(),t.removeHook("afterChange",vv)},vp.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},vp.Action=function(){},vp.Action.prototype.undo=function(){},vp.Action.prototype.redo=function(){},vp.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"},(0,s.ED)(vp.ChangeAction,vp.Action),vp.ChangeAction.prototype.undo=function(t,e){let i=(0,s.I8)(this.changes),r=t.countEmptyRows(!0),n=t.countEmptyCols(!0);for(let t=0,e=i.length;t<e;t++)i[t].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(i,null,null,"UndoRedo.undo");for(let e=0,o=i.length;e<o;e++){let[o,s]=i[e];t.getSettings().minSpareRows&&o+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(o+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&s+1+t.getSettings().minSpareCols===t.countCols()&&n===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(s+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}let o=t.getSelectedLast();if(void 0!==o){let[e,r]=i[0],[n,s]=o,l=t.view.getFirstFullyVisibleRow(),a=t.view.getFirstFullyVisibleColumn(),h=e>=l,u=r>=a,c=n!==e||s!==r;if(!1===(h&&u)&&!0===c){let i={row:e,col:r};!1===h&&(i.verticalSnap="top"),!1===u&&(i.horizontalSnap="start"),t.scrollViewportTo(i)}}t.selectCells(this.selected,!1,!1)},vp.ChangeAction.prototype.redo=function(t,e){let i=(0,s.I8)(this.changes);for(let t=0,e=i.length;t<e;t++)i[t].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)},vp.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"},(0,s.ED)(vp.CreateRowAction,vp.Action),vp.CreateRowAction.prototype.undo=function(t,e){let i=t.countRows(),r=t.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},vp.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},vp.RemoveRowAction=function(t,e,i,r,n,o){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=i,this.fixedRowsTop=r,this.rowIndexesSequence=n,this.removedCellMetas=o},(0,s.ED)(vp.RemoveRowAction,vp.Action),vp.RemoveRowAction.prototype.undo=function(t,e){let i=t.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((t,e)=>{Object.keys(t).forEach(i=>{let n=parseInt(i,10);r.push([this.index+e,isNaN(n)?i:n,t[i]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(e=>{let[i,r,n]=e;t.setCellMetaObject(i,r,n)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},vp.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},vp.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"},(0,s.ED)(vp.CreateColumnAction,vp.Action),vp.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},vp.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},vp.RemoveColumnAction=function(t,e,i,r,n,o,s,l){this.index=t,this.indexes=e,this.data=i,this.amount=this.data[0].length,this.headers=r,this.columnPositions=n.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s,this.removedCellMetas=l},(0,s.ED)(vp.RemoveColumnAction,vp.Action),vp.RemoveColumnAction.prototype.undo=function(t,e){let i=t.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;let r=this.indexes.slice(0).sort(),n=(t,e,i)=>i[this.indexes.indexOf(r[e])],o=this.data.length,s=[];for(let t=0;t<o;t++)s.push((0,u.Sc)(this.data[t],n));let l=(0,u.Sc)(this.headers,n),a=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),(0,u.Bk)(t.getSourceDataArray(),(t,e)=>{(0,u.Bk)(r,(i,r)=>{t[i]=s[e][r],a.push([e,i,t[i]])})}),t.setSourceDataAtCell(a,void 0,void 0,"UndoRedo.undo"),void 0!==this.headers&&(0,u.Bk)(l,(e,i)=>{t.getSettings().colHeaders[r[i]]=e}),this.removedCellMetas.forEach(e=>{let[i,r,n]=e;t.setCellMetaObject(i,r,n)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()},vp.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},vp.CellAlignmentAction=function(t,e,i,r){this.stateBefore=t,this.range=e,this.type=i,this.alignment=r},vp.CellAlignmentAction.prototype.undo=function(t,e){(0,u.Bk)(this.range,e=>{e.forAll((e,i)=>{e>=0&&i>=0&&t.setCellMeta(e,i,"className",this.stateBefore[e][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()},vp.CellAlignmentAction.prototype.redo=function(t,e){rx(this.range,this.type,this.alignment,(e,i)=>t.getCellMeta(e,i),(e,i,r,n)=>t.setCellMeta(e,i,r,n)),t.addHookOnce("afterViewRender",e),t.render()},vp.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"},(0,s.ED)(vp.FiltersAction,vp.Action),vp.FiltersAction.prototype.undo=function(t,e){let i=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),i.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),i.filter()},vp.FiltersAction.prototype.redo=function(t,e){let i=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),i.conditionCollection.importAllConditions(this.conditionsStack),i.filter()};class vm extends vp.Action{constructor(t,e){super(),this.cellRange=e;let i=this.cellRange.getTopStartCorner(),r=this.cellRange.getBottomEndCorner();this.rangeData=t.getData(i.row,i.col,r.row,r.col)}undo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.unmergeRange(this.cellRange,!0);let r=this.cellRange.getTopStartCorner();t.populateFromArray(r.row,r.col,this.rangeData,void 0,void 0,"MergeCells")}redo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.mergeRange(this.cellRange)}}vp.MergeCellsAction=vm;class vw extends vp.Action{constructor(t,e){super(),this.cellRange=e}undo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.mergeRange(this.cellRange,!0)}redo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.unmergeRange(this.cellRange,!0),t.render()}}function vv(t,e){if("loadData"===e)return this.undoRedo.clear()}vp.UnmergeCellsAction=vw,vp.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"},(0,s.ED)(vp.RowMoveAction,vp.Action),vp.RowMoveAction.prototype.undo=function(t,e){let i=t.getPlugin("manualRowMove"),r=[].concat(this.rows),n=r.filter(t=>t>this.finalIndex),o=r.filter(t=>t<=this.finalIndex),s=n.sort((t,e)=>e-t).concat(o.sort((t,e)=>t-e));t.addHookOnce("afterViewRender",e);for(let e=0;e<s.length;e+=1){let r=t.toVisualRow(s[e]);i.moveRow(r,s[e])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},vp.RowMoveAction.prototype.redo=function(t,e){let i=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),i.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)},vp.prototype.init=function(){let t=this.instance.getSettings().undo;this.instance.undoRedo||(this.instance.undoRedo=this),void 0===t||t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},vp.prototype.registerShortcuts=function(){let t=this.instance.getShortcutManager(),e=t.getContext("grid");e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],{runOnlyIf:t=>!t.altKey,group:vf})},vp.prototype.unregisterShortcuts=function(){let t=this.instance.getShortcutManager(),e=t.getContext("grid");e.removeShortcutsByGroup(vf)};let vb=tt.Z.getSingleton();function vy(){(0,ta.qm)(S.Hf),(0,ta.qm)(C),(0,ta.qm)(E),(0,ta.qm)(Q),(0,ta.qm)(te),(0,ta.qm)(h),(0,ta.qm)(ti),(0,ta.qm)(tr),(0,ta.qm)(ts),(0,ta.qm)(r.H),(0,ta.qm)(tl),(0,tI.zn)(td),(0,tI.zn)(th.Z),(0,tI.zn)(tC),(0,tI.zn)(tg),(0,tI.zn)(tE),(0,tI.zn)(tu),(0,tI.zn)(tM),(0,tI.zn)(tO),(0,tI.zn)(tk),(0,tI.zn)(p.V),(0,tI.zn)(tx),(0,tB.Ie)(tA),(0,tB.Ie)(t_),(0,tB.Ie)(tH),(0,tB.Ie)(tP),(0,tB.Ie)(tL),(0,tq.xN)(tW),(0,tq.xN)(tV),(0,tq.xN)(tj),(0,tq.xN)(tU),(0,tq.xN)(t$),(0,tq.xN)(tz),(0,tq.xN)(tK),(0,tq.xN)(tG),(0,tq.xN)(tY.n),(0,tq.xN)(tX),(0,tZ.fo)(eb),(0,tZ.fo)(eL),(0,tZ.fo)(eZ),(0,tZ.fo)(ia),(0,tZ.fo)(ik),(0,tZ.fo)(rr),(0,tZ.fo)(rv),(0,tZ.fo)(r6),(0,tZ.fo)(oe),(0,tZ.fo)(o5),(0,tZ.fo)(sb),(0,tZ.fo)(sM),(0,tZ.fo)(sV),(0,tZ.fo)(s1),(0,tZ.fo)(hv),(0,tZ.fo)(uV),(0,tZ.fo)(cv),(0,tZ.fo)(cF),(0,tZ.fo)(c5),(0,tZ.fo)(dA),(0,tZ.fo)(ga),(0,tZ.fo)(gK),(0,tZ.fo)(fS),(0,tZ.fo)(ps),(0,tZ.fo)(pH),(0,tZ.fo)(pP),(0,tZ.fo)(mU),(0,tZ.fo)(wP),(0,tZ.fo)(w1),(0,tZ.fo)(w7),(0,tZ.fo)(vs),(0,tZ.fo)(vd),(0,tZ.fo)(vp)}vb.add("afterUpdateSettings",function(){var t;null===(t=this.getPlugin("undoRedo"))||void 0===t||t.init()}),vb.register("beforeUndo"),vb.register("afterUndo"),vb.register("beforeRedo"),vb.register("afterRedo"),vp.PLUGIN_KEY="undoRedo",vp.SETTING_KEYS=!0},51774:function(t,e,i){"use strict";i.d(e,{Z:function(){return o}}),i(58563);var r=i(5566),n=i(18200);function o(t,e,i,o,s,l,a){let h=a.ariaTags,u=[],c=[],d=[],g=[];a.className&&(0,r.cn)(e,a.className),a.readOnly?(u.push(a.readOnlyCellClassName),h&&g.push((0,n.zR)())):h&&d.push((0,n.zR)()[0]),!1===a.valid&&a.invalidCellClassName?(u.push(a.invalidCellClassName),h&&g.push((0,n.w1)())):(c.push(a.invalidCellClassName),h&&d.push((0,n.w1)()[0])),!1===a.wordWrap&&a.noWordWrapClassName&&u.push(a.noWordWrapClassName),!l&&a.placeholder&&u.push(a.placeholderCellClassName),(0,r.IV)(e,c),(0,r.cn)(e,u),(0,r.d$)(e,d),(0,r.P$)(e,g)}o.RENDERER_TYPE="base"},36903:function(t,e,i){"use strict";i.d(e,{Bp:function(){return h},Y3:function(){return s},zn:function(){return u}}),i(57855);var r=i(82656);let{register:n,getItem:o,hasItem:s,getNames:l,getValues:a}=(0,r.Z)("renderers");function h(t){if("function"==typeof t)return t;if(!s(t))throw Error(`No registered renderer found under "${t}" name`);return o(t)}function u(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),n(t,e)}},49532:function(t,e,i){"use strict";i.d(e,{V:function(){return s}});var r=i(51774),n=i(5566),o=i(2518);function s(t,e,i,s,l,a,h){r.Z.apply(this,[t,e,i,s,l,a,h]);let u=a;if(!u&&h.placeholder&&(u=h.placeholder),u=(0,o.Pz)(u),h.trimWhitespace&&(u=u.trim()),h.rendererTemplate){(0,n.cS)(e);let r=t.rootDocument.createElement("TEMPLATE");r.setAttribute("bind","{{}}"),r.innerHTML=h.rendererTemplate,HTMLTemplateElement.decorate(r),r.model=t.getSourceDataAtRow(i),e.appendChild(r)}else(0,n.tT)(e,u)}s.RENDERER_TYPE="text"},94198:function(t,e,i){"use strict";let r,n;i.d(e,{Z:function(){return tn}}),i(57855),i(58563);var o=i(58352),s=i(69488),l=i(63437);class a{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}}(0,s.jB)(a,l.Z);var h=a,u=class extends h{constructor(t,e){var i,r;super(t,null),(i="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i="visualCellRange","string"))?r:String(r))in this?Object.defineProperty(this,i,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[i]=null,this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:i}=t,r=this.getNearestNotHiddenCoords(e,1),n=this.getNearestNotHiddenCoords(i,-1);return null===r||null===n?null:((r.row>n.row||r.col>n.col)&&(r=e,n=i),this.settings.createCellRange(r,r,n))}getNearestNotHiddenCoords(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===r)return null;let n=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,i);return null===n?null:this.settings.createCellCoords(r,n)}getNearestNotHiddenIndex(t,e,i){return e<0?e:t.getNearestNotHiddenIndex(e,i)}commit(){if(null===this.visualCellRange)return this;let t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return null===t?this.cellRange=null:this.cellRange=this.createRenderableCellRange(t.from,t.to),this}syncWith(t){let e=t.from.clone().normalize(),i="N-S"===t.getVerticalDirection()?1:-1,r="W-E"===t.getHorizontalDirection()?1:-1,n=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),o=null;if((null===n||null===n.col||null===n.row)&&(o=this.getNearestNotHiddenCoords(e,i,r)),null!==o&&t.overlaps(o)){let e=t.highlight.clone();if(e.row>=0&&(e.row=o.row),e.col>=0&&(e.col=o.col),null===this.cellRange){let t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==n&&null===o&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){let t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){let i=this.settings.visualToRenderableCoords(t),r=this.settings.visualToRenderableCoords(e);return null===i.row||null===i.col||null===r.row||null===r.col?null:this.settings.createCellRange(i,i,r)}};function c(t){let{activeHeaderClassName:e,...i}=t;return new u({className:e,...i,selectionType:o.CD})}function d(t){let{areaCornerVisible:e,...i}=t;return new u({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...i,selectionType:o.AI})}function g(t){let{...e}=t;return new u({className:"highlight",...e,selectionType:o.AI})}function f(t){let{columnClassName:e,...i}=t;return new u({className:e,...i,selectionType:o.BA})}var p=i(18200);function m(t){let{headerClassName:e,...i}=t;return new u({className:e,...i,selectionType:o.Nc})}function w(t){let{rowClassName:e,...i}=t;return new u({className:e,...i,selectionType:o.Os})}var b=i(99440);function y(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function C(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}var S=new WeakSet;function E(t,e){let i=this.layerLevel;if(t.has(i))return t.get(i);let r=e({layerLevel:i,...this.options});return t.set(i,r),r}r=Symbol.iterator;var R=class{constructor(t){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,S),S.add(this),y(this,"options",void 0),y(this,"layerLevel",0),y(this,"focus",void 0),y(this,"fill",void 0),y(this,"layeredAreas",new Map),y(this,"areas",new Map),y(this,"rowHeaders",new Map),y(this,"columnHeaders",new Map),y(this,"activeRowHeaders",new Map),y(this,"activeColumnHeaders",new Map),y(this,"activeCornerHeaders",new Map),y(this,"rowHighlights",new Map),y(this,"columnHighlights",new Map),y(this,"customSelections",[]),this.options=t,this.focus=function(t){let{cellCornerVisible:e,...i}=t;return new u({className:"current",headerAttributes:[(0,p.Ak)()],border:{width:2,color:"#4b89ff",cornerVisible:e},...i,selectionType:o.t8})}(t),this.fill=function(t){let{...e}=t;return new u({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:o.P$})}(t)}isEnabledFor(t,e){let i=t;t===o.t8&&(i="current");let r=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof r&&(r=[r]),!1===r||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return C(this,S,E).call(this,this.layeredAreas,d)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return C(this,S,E).call(this,this.areas,g)}getAreas(){return[...this.areas.values()]}createRowHeader(){return C(this,S,E).call(this,this.rowHeaders,m)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return C(this,S,E).call(this,this.columnHeaders,m)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return C(this,S,E).call(this,this.activeRowHeaders,c)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return C(this,S,E).call(this,this.activeColumnHeaders,c)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return C(this,S,E).call(this,this.activeCornerHeaders,c)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return C(this,S,E).call(this,this.rowHighlights,w)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return C(this,S,E).call(this,this.columnHighlights,f)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(function(t){let{border:e,visualCellRange:i,...r}=t;return new u({...e,...r,selectionType:o.$7},i)}({...this.options,...t}))}clear(){this.focus.clear(),this.fill.clear(),(0,b.Bk)(this.areas.values(),t=>void t.clear()),(0,b.Bk)(this.layeredAreas.values(),t=>void t.clear()),(0,b.Bk)(this.rowHeaders.values(),t=>void t.clear()),(0,b.Bk)(this.columnHeaders.values(),t=>void t.clear()),(0,b.Bk)(this.activeRowHeaders.values(),t=>void t.clear()),(0,b.Bk)(this.activeColumnHeaders.values(),t=>void t.clear()),(0,b.Bk)(this.activeCornerHeaders.values(),t=>void t.clear()),(0,b.Bk)(this.rowHighlights.values(),t=>void t.clear()),(0,b.Bk)(this.columnHighlights.values(),t=>void t.clear())}[r](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}};function T(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}n=Symbol.iterator;var M=class{constructor(t){T(this,"ranges",[]),T(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some(e=>e.includes(t))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[n](){return this.ranges[Symbol.iterator]()}},O=i(2518),k=i(67790);function x(t,e){A(t,e),e.add(t)}function I(t,e,i){A(t,e),e.set(t,i)}function A(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function N(t,e){var i=P(t,e,"get");return i.get?i.get.call(t):i.value}function H(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function _(t,e,i){var r=P(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function P(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var D=new WeakMap,L=new WeakMap,B=new WeakMap,W=new WeakSet,V=new WeakSet,F=new WeakSet,j=new WeakSet,U=new WeakSet;class ${constructor(t,e){x(this,U),x(this,j),x(this,F),x(this,V),x(this,W),I(this,D,{writable:!0,value:void 0}),I(this,L,{writable:!0,value:void 0}),I(this,B,{writable:!0,value:{x:0,y:0}}),_(this,D,t),_(this,L,e)}transformStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];H(this,W,z).call(this,{x:N(this,L).navigableHeaders()?N(this,L).countRowHeaders():0,y:N(this,L).navigableHeaders()?N(this,L).countColHeaders():0});let r=N(this,L).createCellCoords(t,e),n=N(this,D).current().highlight,o=N(this,L).visualToRenderableCoords(n),l=0,a=0;if(this.runLocalHooks("beforeTransformStart",r),null!==o.row&&null!==o.col){let{width:t,height:e}=H(this,F,G).call(this),{row:o,col:h}=H(this,j,Y).call(this,n),u=N(this,L).fixedRowsBottom(),c=N(this,L).minSpareRows(),d=N(this,L).minSpareCols(),g=N(this,L).autoWrapRow(),f=N(this,L).autoWrapCol(),p=N(this,L).createCellCoords(o+r.row,h+r.col);if(p.row>=e){let r=(0,s.sm)(i&&c>0&&0===u),n=p.col+1,o=N(this,L).createCellCoords(p.row-e,n>=t?n-t:n);this.runLocalHooks("beforeColumnWrap",r,H(this,U,X).call(this,o),n>=t),r.value?this.runLocalHooks("insertRowRequire",N(this,L).countRenderableRows()):f&&p.assign(o)}else if(p.row<0){let i=(0,s.sm)(f),r=p.col-1,n=N(this,L).createCellCoords(e+p.row,r<0?t+r:r);this.runLocalHooks("beforeColumnWrap",i,H(this,U,X).call(this,n),r<0),f&&p.assign(n)}if(p.col>=t){let r=(0,s.sm)(i&&d>0),n=p.row+1,o=N(this,L).createCellCoords(n>=e?n-e:n,p.col-t);this.runLocalHooks("beforeRowWrap",r,H(this,U,X).call(this,o),n>=e),r.value?this.runLocalHooks("insertColRequire",N(this,L).countRenderableColumns()):g&&p.assign(o)}else if(p.col<0){let i=(0,s.sm)(g),r=p.row-1,n=N(this,L).createCellCoords(r<0?e+r:r,t+p.col);this.runLocalHooks("beforeRowWrap",i,H(this,U,X).call(this,n),r<0),g&&p.assign(n)}let{rowDir:m,colDir:w}=H(this,V,K).call(this,p);l=m,a=w,n=H(this,U,X).call(this,p)}return this.runLocalHooks("afterTransformStart",n,l,a),n}transformEnd(t,e){H(this,W,z).call(this,{x:N(this,L).navigableHeaders()?N(this,L).countRowHeaders():0,y:N(this,L).navigableHeaders()?N(this,L).countColHeaders():0});let i=N(this,L).createCellCoords(t,e),r=N(this,D).current(),n=N(this,L).visualToRenderableCoords(r.highlight),o=r.to.clone(),s=0,l=0;if(this.runLocalHooks("beforeTransformEnd",i),null!==n.row&&null!==n.col){let{row:t,col:e}=H(this,j,Y).call(this,r.to),n=N(this,L).createCellCoords(t+i.row,e+i.col),{rowDir:a,colDir:h}=H(this,V,K).call(this,n);s=a,l=h;let u=H(this,U,X).call(this,n);0===i.row&&0!==i.col?o.col=u.col:0!==i.row&&0===i.col?o.row=u.row:(o.row=u.row,o.col=u.col)}return this.runLocalHooks("afterTransformEnd",o,s,l),o}}function z(t){let{x:e,y:i}=t;_(this,B,{x:e,y:i})}function K(t){let{width:e,height:i}=H(this,F,G).call(this),r=0,n=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=i&&(r=1,t.row=i-1),t.col<0?(n=-1,t.col=0):t.col>0&&t.col>=e&&(n=1,t.col=e-1),{rowDir:r,colDir:n}}function G(){return{width:N(this,B).x+N(this,L).countRenderableColumns(),height:N(this,B).y+N(this,L).countRenderableRows()}}function Y(t){let{row:e,col:i}=N(this,L).visualToRenderableCoords(t);return N(this,L).createCellCoords(N(this,B).y+e,N(this,B).x+i)}function X(t){let e=t.clone();return e.col=t.col-N(this,B).x,e.row=t.row-N(this,B).y,N(this,L).renderableToVisualCoords(e)}(0,s.jB)($,l.Z);var q=i(30855),Z=i(32836);function J(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function Q(t,e,i){var r=te(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function tt(t,e){var i=te(t,e,"get");return i.get?i.get.call(t):i.value}function te(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var ti=new WeakMap;class tr{constructor(t,e){var i=this;J(this,"settings",void 0),J(this,"tableProps",void 0),J(this,"inProgress",!1),J(this,"selectedRange",new M((t,e,i)=>this.tableProps.createCellRange(t,e,i))),J(this,"highlight",void 0),J(this,"transformation",void 0),J(this,"selectedByRowHeader",new Set),J(this,"selectedByColumnHeader",new Set),function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}(this,ti),ti.set(this,{writable:!0,value:!1}),this.settings=t,this.tableProps=e,this.highlight=new R({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[(0,p.Ak)()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,i)=>this.tableProps.createCellRange(t,e,i)}),this.transformation=new $(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),navigableHeaders:()=>t.navigableHeaders,fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformStart",...e)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("afterModifyTransformStart",...e)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformEnd",...e)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("afterModifyTransformEnd",...e)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("insertRowRequire",...e)}),this.transformation.addLocalHook("insertColRequire",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("insertColRequire",...e)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeRowWrap",...e)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeColumnWrap",...e)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,n="multiple"===this.settings.selectionMode,o=(0,O.o8)(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,s=t.clone();this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,s),(!n||n&&!o&&(0,O.o8)(e))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(r.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(t)}setRangeStartOnly(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,i)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;let e=t.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),n=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((i>0||r>0)&&(0===i&&e.col<0&&!n||0===r&&e.row<0&&!n))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();let s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),"single"===this.settings.selectionMode?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(e),i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");let l=this.highlight.getFocus();l.clear(),this.highlight.isEnabledFor(o.t8,s.highlight)&&l.add(this.selectedRange.current().highlight).commit().syncWith(s);let a=this.getLayerLevel();a<this.highlight.layerLevel&&((0,b.Bk)(this.highlight.getAreas(),t=>void t.clear()),(0,b.Bk)(this.highlight.getLayeredAreas(),t=>void t.clear()),(0,b.Bk)(this.highlight.getRowHeaders(),t=>void t.clear()),(0,b.Bk)(this.highlight.getColumnHeaders(),t=>void t.clear()),(0,b.Bk)(this.highlight.getActiveRowHeaders(),t=>void t.clear()),(0,b.Bk)(this.highlight.getActiveColumnHeaders(),t=>void t.clear()),(0,b.Bk)(this.highlight.getActiveCornerHeaders(),t=>void t.clear()),(0,b.Bk)(this.highlight.getRowHighlights(),t=>void t.clear()),(0,b.Bk)(this.highlight.getColumnHighlights(),t=>void t.clear())),this.highlight.useLayerLevel(a);let h=this.highlight.createArea(),u=this.highlight.createLayeredArea(),c=this.highlight.createRowHeader(),d=this.highlight.createColumnHeader(),g=this.highlight.createActiveRowHeader(),f=this.highlight.createActiveColumnHeader(),p=this.highlight.createActiveCornerHeader(),m=this.highlight.createRowHighlight(),w=this.highlight.createColumnHighlight();if(h.clear(),u.clear(),c.clear(),d.clear(),g.clear(),f.clear(),p.clear(),m.clear(),w.clear(),this.highlight.isEnabledFor(o.AI,s.highlight)&&(this.isMultiple()||a>=1)&&(h.add(s.from).add(s.to).commit(),u.add(s.from).add(s.to).commit(),1===a)){let t=this.selectedRange.previous();this.highlight.useLayerLevel(a-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(a)}if(this.highlight.isEnabledFor(o.Nc,s.highlight)){if(!s.isSingleHeader()){let t=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),e=this.tableProps.createCellCoords(s.to.row,-1),i=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),r=this.tableProps.createCellCoords(-1,s.to.col);"single"===this.settings.selectionMode?(c.add(t).commit(),d.add(i).commit(),m.add(t).commit(),w.add(i).commit()):(c.add(t).add(e).commit(),d.add(i).add(r).commit(),m.add(t).add(e).commit(),w.add(i).add(r).commit())}let t=!tt(this,ti)&&this.isEntireRowSelected()&&(r>0&&r===s.getWidth()||0===r&&this.isSelectedByRowHeader()),e=!tt(this,ti)&&this.isEntireColumnSelected()&&(i>0&&i===s.getHeight()||0===i&&this.isSelectedByColumnHeader());t&&g.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),e&&f.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),t&&e&&p.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",t)}isMultiple(){let t=(0,s.sm)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}transformStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.setRangeStart(this.transformation.transformStart(t,e,i))}transformEnd(t,e){this.setRangeEnd(this.transformation.transformEnd(t,e))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),e=t=>{let{col:e}=t.getOuterTopStartCorner(),i=this.tableProps.countRowHeaders(),r=this.tableProps.countCols();return(i>0&&e<0||0===i)&&t.getWidth()===r};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));let i=this.selectedRange.peekByIndex(t);return!!i&&e(i)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),e=t=>{let{row:e}=t.getOuterTopStartCorner(),i=this.tableProps.countColHeaders(),r=this.tableProps.countRows();return(i>0&&e<0||0===i)&&t.getHeight()===r};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));let i=this.selectedRange.peekByIndex(t);return!!i&&e(i)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){let e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},n=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=i?-l:0,h=e?-s:0;if(0===a&&0===h&&(0===n||0===o))return;let u=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight,{focusPosition:c,disableHeadersHighlight:d}=r;Q(this,ti,d),c&&Number.isInteger(null==c?void 0:c.row)&&Number.isInteger(null==c?void 0:c.col)&&(u=this.tableProps.createCellCoords((0,k.uZ)(c.row,a,n-1),(0,k.uZ)(c.col,h,o-1)));let g=this.tableProps.createCellCoords(a,h),f=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(g,void 0,u),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.finish(),Q(this,ti,!1)}selectCells(t){var e=this;let i=(0,q.AV)(t);if(i===q.gk)return!1;if(i===q.Kk)throw Error(Z.e`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let r=(0,q.S5)(i,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),n=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:n?this.tableProps.countRowHeaders():0,countColHeaders:n?this.tableProps.countColHeaders():0},s=!t.some(t=>{let e=r(t),i=e.isValid(o);return!(i&&!e.containsHeaders()||i&&e.containsHeaders()&&e.isSingleHeader())});return s&&(this.clear(),(0,b.Bk)(t,t=>{let{from:e,to:i}=r(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(i.clone()),this.finish()})),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r="string"==typeof t?this.tableProps.propToCol(t):t,n="string"==typeof e?this.tableProps.propToCol(e):e,o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,h=this.tableProps.createCellCoords(a,r),u=this.tableProps.createCellCoords(o-1,n),c=this.tableProps.createCellRange(h,h,u).isValid({countRows:o,countCols:s,countRowHeaders:0,countColHeaders:l});if(c){let t=0===l?0:(0,k.uZ)(i,a,-1),e=o-1,s=this.tableProps.createCellCoords(t,r),h=this.tableProps.createCellCoords(e,n),u=this.tableProps.createCellCoords((0,k.uZ)(i,a,o-1),r);this.runLocalHooks("beforeSelectColumns",s,h,u),s.row=t,h.row=e,this.setRangeStartOnly(s,void 0,u),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectColumns",s,h,u),this.finish()}return c}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.tableProps.countRows(),n=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),s=0===o?0:-o,l=this.tableProps.createCellCoords(t,s),a=this.tableProps.createCellCoords(e,n-1),h=this.tableProps.createCellRange(l,l,a).isValid({countRows:r,countCols:n,countRowHeaders:o,countColHeaders:0});if(h){let r=0===o?0:(0,k.uZ)(i,s,-1),l=n-1,a=this.tableProps.createCellCoords(t,r),h=this.tableProps.createCellCoords(e,l),u=this.tableProps.createCellCoords(t,(0,k.uZ)(i,s,n-1));this.runLocalHooks("beforeSelectRows",a,h,u),a.col=r,h.col=l,this.setRangeStartOnly(a,void 0,u),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(h),this.runLocalHooks("afterSelectRows",a,h,u),this.finish()}return h}refresh(){let t=this.highlight.getCustomSelections();if(t.forEach(t=>{t.commit()}),!this.isSelected())return;let e=this.highlight.getFocus(),i=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let t=0;t<this.selectedRange.size();t+=1){this.highlight.useLayerLevel(t);let e=this.highlight.createArea(),i=this.highlight.createLayeredArea(),r=this.highlight.createRowHeader(),n=this.highlight.createColumnHeader(),o=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();e.commit(),i.commit(),r.commit(),n.commit(),o.commit(),s.commit(),l.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(i)}}(0,s.jB)(tr,l.Z);var tn=tr},30855:function(t,e,i){"use strict";i.d(e,{AV:function(){return d},I8:function(){return p},Kk:function(){return s},S5:function(){return g},X8:function(){return f},gk:function(){return l}}),i(57855),i(58563);var r=i(51648),n=i(99440),o=i(2518);let s=0,l=1,a=[3,2],h=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],u=Symbol("root"),c=Symbol("child");function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;if(e!==u&&e!==c)throw Error("The second argument is used internally only and cannot be overwritten.");let i=Array.isArray(t),n=e===u,o=s;if(i){let e=t[0];if(0===t.length)o=l;else if(n&&e instanceof r.Z)o=3;else if(n&&Array.isArray(e))o=d(e,c);else if(t.length>=2&&t.length<=4){let e=!t.some((t,e)=>!h[e].includes(typeof t));e&&(o=2)}}return o}function g(t){let{createCellCoords:e,createCellRange:i,keepDirection:r=!1,propToCol:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!a.includes(t))throw Error("Unsupported selection ranges schema type was provided.");return function(s){let l=3===t,a=l?s.from.row:s[0],h=l?s.from.col:s[1],u=l?s.to.row:s[2],c=l?s.to.col:s[3];if("function"==typeof n&&("string"==typeof h&&(h=n(h)),"string"==typeof c&&(c=n(c))),(0,o.o8)(u)&&(u=a),(0,o.o8)(c)&&(c=h),!r){let t=a,e=h,i=u,r=c;a=Math.min(t,i),h=Math.min(e,r),u=Math.max(t,i),c=Math.max(e,r)}let d=e(a,h),g=e(u,c);return i(d,d,g)}}function f(t){let e=d(t.getSelected());if(e===s||e===l)return[];let i=g(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;(0,n.Bk)(t.getSelected(),t=>{let{from:e,to:o}=i(t),s=Math.max(e.col,0),l=o.col-s+1;(0,n.Bk)(Array.from(Array(l),(t,e)=>s+e),t=>{r.has(t)||r.add(t)})});let o=Array.from(r).sort((t,e)=>t-e),a=(0,n.k$)(o,(t,e,i,r)=>(0!==i&&e===r[i-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[]);return a}function p(t){let e=d(t.getSelected());if(e===s||e===l)return[];let i=g(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;(0,n.Bk)(t.getSelected(),t=>{let{from:e,to:o}=i(t),s=Math.max(e.row,0),l=o.row-s+1;(0,n.Bk)(Array.from(Array(l),(t,e)=>s+e),t=>{r.has(t)||r.add(t)})});let o=Array.from(r).sort((t,e)=>t-e),a=(0,n.k$)(o,(t,e,i,r)=>(0!==i&&e===r[i-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[]);return a}},82659:function(t,e,i){"use strict";i.d(e,{I:function(){return n},W:function(){return r}});let r="gridDefault",n="editorManager.handlingEditor"},99366:function(t,e,i){"use strict";i.d(e,{xg:function(){return u}});var r=i(82659),n=i(27687);let o=[{name:"editorCloseAndSave",callback(t,e,i){let r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(i.includes("shift"))}},{name:"editorCloseWithoutSaving",callback(t){let e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},{name:"editorFastOpen",callback(t,e){let{highlight:i}=t.getSelectedRangeLast();i.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},{name:"editorOpen",callback(t,e,i){let r=t._getEditorManager(),{highlight:o}=t.getSelectedRangeLast();o.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(i.includes("shift")),(0,n.mM)(e))}},{name:"extendCellsSelectionDown",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},{name:"extendCellsSelectionDownByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),i=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(i,-1);if(null!==r){let i=t._createCellCoords(r,e.col),n=e.row-t.view.getFirstFullyVisibleRow(),o=Math.min(i.row-n,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},{name:"extendCellsSelectionRight",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},{name:"extendCellsSelectionToColumns",callback(t){let{highlight:e,from:i,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(i.col,r.col,e.row)}},{name:"extendCellsSelectionToMostBottom",callback(t){let{selection:e,rowIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){let r=i.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r,o.col))}}},{name:"extendCellsSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,i.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},{name:"extendCellsSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,i.getNearestNotHiddenIndex(0,1)))}},{name:"extendCellsSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){let r=i.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,r))}}},{name:"extendCellsSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){let r=i.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(n.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,r))}}},{name:"extendCellsSelectionToMostTop",callback(t){let{selection:e,rowIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){let r=i.getNearestNotHiddenIndex(0,1);e.setRangeStart(n.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(r,o.col))}}},{name:"extendCellsSelectionToRows",callback(t){let{highlight:e,from:i,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(i.row,r.row,e.col)}},{name:"extendCellsSelectionUp",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},{name:"extendCellsSelectionUpByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),i=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(i,1);if(null!==r){let i=t._createCellCoords(r,e.col),n=e.row-t.view.getFirstFullyVisibleRow(),o=Math.max(i.row-n,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},{name:"moveCellSelectionDownByViewportHeight",callback(t){let{navigableHeaders:e}=t.getSettings(),i=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight,n=t.countVisibleRows()+i;r===t.countRows()-1?n=1:r+n>t.countRows()&&(n=t.countRows()-r-1),t.selection.transformStart(n,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(t,e){let i=t.getSettings(),r="function"==typeof i.tabMoves?i.tabMoves(e):i.tabMoves;t.selection.transformStart(-r.row,-r.col)}},{name:"moveCellSelectionInlineStart",callback(t,e){let i=t.getSettings(),r="function"==typeof i.tabMoves?i.tabMoves(e):i.tabMoves;t.selection.transformStart(r.row,r.col)}},{name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},{name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},{name:"moveCellSelectionToMostBottom",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===i&&(i=-1),t.selection.setRangeStart(t._createCellCoords(i,e))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(t){let{selection:e,rowIndexMapper:i,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedRowsBottom,10),o=i.getNearestNotHiddenIndex(t.countRows()-n-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}},{name:"moveCellSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:i}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,i.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},{name:"moveCellSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),n=t.getSelectedRangeLast().highlight.row,o=i.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(n,o))}},{name:"moveCellSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:i}=t,r=t.getSelectedRangeLast().highlight.row,n=i.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===n&&(n=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,n))}},{name:"moveCellSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:i}=t,{row:r}=t.getSelectedRangeLast().highlight,n=i.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===n&&(n=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,n))}},{name:"moveCellSelectionToMostTop",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===i&&(i=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(i,e))}},{name:"moveCellSelectionToMostTopInlineStart",callback(t){let{selection:e,rowIndexMapper:i,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=i.getNearestNotHiddenIndex(n,1),l=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,l))}},{name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},{name:"moveCellSelectionUpByViewportHight",callback(t){let{navigableHeaders:e}=t.getSettings(),i=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight,n=-(t.countVisibleRows()+i);r===-i?n=-1:r+n<i&&(n=-(r+i)),t.selection.transformStart(n,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(t){let{highlight:e}=t.getSelectedRangeLast(),i=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,n=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(i,r),l=t._createCellCoords(n,o),a=t._createCellRange(s,s,l);if(!a.includes(e)&&(e.row>=0||e.col>=0)){let i={};if(e.col>=0){let r=Math.floor(t.countVisibleCols()/2);i.col=Math.max(e.col-r,0)}if(e.row>=0){let r=Math.floor(t.countVisibleRows()/2);i.row=Math.max(e.row-r,0)}t.scrollViewportTo({...i,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},{name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},{name:"populateSelectedCellsData",callback(t){let e=t.getSelectedRange(),{row:i,col:r}=e[e.length-1].highlight.normalize(),n=t.getDataAtCell(i,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((e,s)=>{if(e>=0&&s>=0&&(e!==i||s!==r)){let{readOnly:i}=t.getCellMeta(e,s);i||o.set(`${e}x${s}`,[e,s,n])}});t.setDataAtCell(Array.from(o.values()))}}];function s(t){let e={};return o.forEach(i=>{let{name:r,callback:n}=i;e[r]=function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return n(t,...i)}}),e}function l(t){let e=t.getShortcutManager().addContext("editor"),i=s(t),n={group:r.I};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>i.editorCloseAndSave(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>i.editorCloseAndSave(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>i.editorCloseWithoutSaving()}],n)}var a=i(2518);function h(t){let e=t.getShortcutManager().addContext("grid"),i=s(t),n={runOnlyIf:()=>{let{navigableHeaders:e}=t.getSettings();return(0,a.$K)(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:r.W};e.addShortcuts([{keys:[["F2"]],callback:t=>i.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>i.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>i.emptySelectedCells()}],{group:r.I,runOnlyIf:()=>(0,a.$K)(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>i.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>i.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>i.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>i.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>i.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>i.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>i.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>i.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>i.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>i.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>i.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>i.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>i.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>i.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>i.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>i.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>i.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>i.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>i.scrollToFocusedCell()}],n)}function u(t){[l,h].forEach(e=>e(t))}},29949:function(t,e,i){"use strict";i.d(e,{U:function(){return R}}),i(57855);var r=i(2488),n=i(27687);i(58563);let o=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),s=t=>t.map(t=>{let e=t.toLowerCase();return o.has(e)?o.get(e):e}).sort().join("+"),l=t=>t.split("+"),a=RegExp("^(?:Key|Digit)([A-Z0-9])$"),h=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),u=t=>{let{key:e,code:i}=t,r=e;return a.test(i)?r=i.replace(a,"$1"):h.has(i)&&(r=i),r.toLowerCase()};var c=i(2518),d=i(98179),g=i(69488),f=i(32836);let p=Symbol("shortcut-context");function m(t){return(0,g.Kn)(t)&&t.__kindOf===p}let w=t=>{let e=(0,r.I)({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),i=function(){let{keys:t,callback:i,group:r,runOnlyIf:n=()=>!0,captureCtrl:o=!1,preventDefault:l=!0,stopPropagation:a=!1,relativeToGroup:h,position:u,forwardToContext:g}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,c.o8)(r))throw Error("You need to define the shortcut's group.");if(!1===(0,d.mf)(i))throw Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw Error(f.e`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let p={callback:i,group:r,runOnlyIf:n,captureCtrl:o,preventDefault:l,stopPropagation:a};(0,c.$K)(h)&&([p.relativeToGroup,p.position]=[h,u]),m(g)&&(p.forwardToContext=g),t.forEach(t=>{let i=s(t),r=e.hasItem(i);if(r){let t=e.getItem(i),r=t.findIndex(t=>t.group===h);-1!==r?"before"===u?r-=1:r+=1:r=t.length,t.splice(r,0,p)}else e.addItem(i,[p])})},n=t=>{let i=s(t);e.removeItem(i)};return{__kindOf:p,addShortcut:i,addShortcuts:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach(t=>{(0,g._l)(e,(i,r)=>{!1===Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=e[r])}),i(t)})},getShortcuts:t=>{let i=s(t),r=e.getItem(i);return(0,c.$K)(r)?r.slice():[]},hasShortcut:t=>{let i=s(t);return e.hasItem(i)},removeShortcutsByKeys:n,removeShortcutsByGroup:t=>{let i=e.getItems();i.forEach(e=>{let[i,r]=e,o=r.filter(e=>e.group!==t);0===o.length?n(l(i)):(r.length=0,r.push(...o))})}}};var b=i(5566),y=i(2228);let C=["meta","alt","shift","control"],S=function(){let t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed:e=>t.has(e)}}(),E=0,R=t=>{let{ownerWindow:e,handleEvent:i,beforeKeyDown:o,afterKeyDown:s}=t,l=(0,r.I)({errorIdExists:t=>`The "${t}" context name is already registered.`}),a="grid",h=()=>a,c=t=>l.getItem(t),d=!1,g=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h(),r=m(i)?i:c(i),o=!1;if(!r.hasShortcut(e))return o;let s=r.getShortcuts(e);for(let i=0;i<s.length;i++){let{callback:r,runOnlyIf:l,preventDefault:a,stopPropagation:h,captureCtrl:u,forwardToContext:c}=s[i];if(!0===l(t)){if(d=u,o=!1===r(t,e),d=!1,a&&t.preventDefault(),h&&((0,n.mM)(t),t.stopPropagation()),o)break;c&&g(t,e,c)}}return o},p=function(t,e,i,r,o){let s=t=>C.includes(t),l=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[];return t.altKey&&i.push("alt"),e&&(t.ctrlKey||t.metaKey)?i.push("control/meta"):(t.ctrlKey&&i.push("control"),t.metaKey&&i.push("meta")),t.shiftKey&&i.push("shift"),i},a=t=>{if(!1===e(t))return;let a=i(t);if(229===t.keyCode||!1===a||(0,n.Ty)(t))return;let h=u(t),c=[];s(h)||(c=l(t));let d=[h].concat(c),g=o(t,d);!g&&((0,y.eE)()&&c.includes("meta")||!(0,y.eE)()&&c.includes("control"))&&o(t,[h].concat(l(t,!0))),r(t)},h=t=>{let e=u(t);s(e)&&S.press(e)},c=t=>{let e=u(t);s(e)&&S.release(e)},d=()=>{S.releaseAll()};return{mount:()=>{let e=t;for(E+=1;e;)1===E&&(e.document.documentElement.addEventListener("keydown",h),e.document.documentElement.addEventListener("keyup",c)),e.document.documentElement.addEventListener("keydown",a),e.document.documentElement.addEventListener("blur",d),e=(0,b.f5)(e)},unmount:()=>{let e=t;for(E-=1;e;)0===E&&(e.document.documentElement.removeEventListener("keydown",h),e.document.documentElement.removeEventListener("keyup",c)),e.document.documentElement.removeEventListener("keydown",a),e.document.documentElement.removeEventListener("blur",d),e=(0,b.f5)(e)},isPressed:t=>S.isPressed(t),releasePressedKeys:()=>S.releaseAll()}}(e,i,o,s,g);return p.mount(),{addContext:t=>{let e=w(t);return l.addItem(t,e),e},getActiveContextName:h,getContext:c,setActiveContextName:t=>{if(!l.hasItem(t))throw Error(f.e`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=t},isCtrlPressed:()=>!d&&(p.isPressed("control")||p.isPressed("meta")),releasePressedKeys:()=>p.releasePressedKeys(),destroy:()=>p.unmount()}}},54892:function(t,e,i){"use strict";i.d(e,{Z:function(){return e0}}),i(58563),i(57855);var r=i(5566),n=i(49773),o=i(27687),s=i(98179),l=i(60973),a=i(2228),h=i(2518);function u(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function c(t,e){var i=g(t,e,"get");return i.get?i.get.call(t):i.value}function d(t,e,i){var r=g(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function g(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var f=new WeakMap,p=new WeakMap,m=new WeakMap,w=new WeakMap,b=new WeakMap,y=new WeakMap,C=new WeakMap,S=new WeakMap,E=new WeakMap,R=new WeakMap,T=class{constructor(t,e,i,r,n,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;u(this,f,{writable:!0,value:void 0}),u(this,p,{writable:!0,value:void 0}),u(this,m,{writable:!0,value:void 0}),u(this,w,{writable:!0,value:void 0}),u(this,b,{writable:!0,value:void 0}),u(this,y,{writable:!0,value:void 0}),u(this,C,{writable:!0,value:void 0}),u(this,S,{writable:!0,value:void 0}),u(this,E,{writable:!0,value:[null,null]}),u(this,R,{writable:!0,value:[null,null]}),d(this,f,i),d(this,p,e),d(this,m,n),d(this,w,o),d(this,b,s),d(this,y,r),d(this,C,t),this.registerEvents()}registerEvents(){c(this,y).addEventListener(c(this,m).holder,"contextmenu",t=>this.onContextMenu(t)),c(this,y).addEventListener(c(this,m).TABLE,"mouseover",t=>this.onMouseOver(t)),c(this,y).addEventListener(c(this,m).TABLE,"mouseout",t=>this.onMouseOut(t));let t=()=>{c(this,y).addEventListener(c(this,m).holder,"touchstart",t=>this.onTouchStart(t)),c(this,y).addEventListener(c(this,m).holder,"touchend",t=>this.onTouchEnd(t)),this.momentumScrolling||(this.momentumScrolling={}),c(this,y).addEventListener(c(this,m).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||c(this,f).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,c(this,f).getSetting("onAfterMomentumScroll"))},200)})};(0,a.K1)()?t():((0,l.JS)()&&t(),(()=>{c(this,y).addEventListener(c(this,m).holder,"mouseup",t=>this.onMouseUp(t)),c(this,y).addEventListener(c(this,m).holder,"mousedown",t=>this.onMouseDown(t))})())}selectedCellWasTouched(t){let e=this.parentCell(t),i=e.coords;if(c(this,S)&&i){let[t,e]=[i.row,c(this,S).from.row],[r,n]=[i.col,c(this,S).from.col];return t===e&&r===n}return!1}parentCell(t){let e={},i=c(this,m).TABLE,n=(0,r.W6)(t,["TD","TH"],i);return n?(e.coords=c(this,m).getCoords(n),e.TD=n):(0,r.pv)(t,"wtBorder")&&(0,r.pv)(t,"current")?(e.coords=c(this,w).getFocusSelection().cellRange.highlight,e.TD=c(this,m).getCell(e.coords)):(0,r.pv)(t,"wtBorder")&&(0,r.pv)(t,"area")&&c(this,w).getAreaSelection().cellRange&&(e.coords=c(this,w).getAreaSelection().cellRange.to,e.TD=c(this,m).getCell(e.coords)),e}onMouseDown(t){let e=c(this,p).rootDocument.activeElement,i=(0,s.r$)(r.G_,t.target),n=t.target;if(!["TD","TH"].includes(e.nodeName)&&(n===e||i(0)===e||i(1)===e))return;let o=this.parentCell(n);(0,r.pv)(n,"corner")?c(this,f).getSetting("onCellCornerMouseDown",t,n):o.TD&&c(this,f).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,o.coords,o.TD),(0===t.button||this.touchApplied)&&o.TD&&(c(this,R)[0]=o.TD,clearTimeout(c(this,E)[0]),c(this,E)[0]=setTimeout(()=>{c(this,R)[0]=null},1e3))}onContextMenu(t){if(c(this,f).has("onCellContextMenu")){let e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!c(this,f).has("onCellMouseOver"))return;let e=c(this,m).TABLE,i=(0,r.W6)(t.target,["TD","TH"],e),n=c(this,b)||this;i&&i!==n.lastMouseOver&&(0,r.MO)(i,e)&&(n.lastMouseOver=i,this.callListener("onCellMouseOver",t,c(this,m).getCoords(i),i))}onMouseOut(t){if(!c(this,f).has("onCellMouseOut"))return;let e=c(this,m).TABLE,i=(0,r.W6)(t.target,["TD","TH"],e),n=(0,r.W6)(t.relatedTarget,["TD","TH"],e),o=c(this,b)||this;i&&i!==n&&(0,r.MO)(i,e)&&(this.callListener("onCellMouseOut",t,c(this,m).getCoords(i),i),null===n&&(o.lastMouseOver=null))}onMouseUp(t){let e=this.parentCell(t.target);e.TD&&c(this,f).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===c(this,R)[0]&&e.TD===c(this,R)[1]?((0,r.pv)(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),c(this,R)[0]=null,c(this,R)[1]=null):e.TD===c(this,R)[0]&&(c(this,R)[1]=e.TD,clearTimeout(c(this,E)[1]),c(this,E)[1]=setTimeout(()=>{c(this,R)[1]=null},500)))}onTouchStart(t){d(this,S,c(this,w).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;let i=t.target,r=null===(e=this.parentCell(i))||void 0===e?void 0:e.coords,n=(0,h.$K)(r)&&r.row>=0&&r.col>=0,o=t.cancelable&&n&&c(this,f).getSetting("isDataViewInstance");o&&((0,a.gn)()&&((0,a.E6)()||(0,a.iF)())&&this.selectedCellWasTouched(i)&&!["A","BUTTON","INPUT"].includes(i.tagName)?t.preventDefault():this.selectedCellWasTouched(i)||t.preventDefault()),this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,i,r){let n=c(this,f).getSettingPure(t);n&&n(e,i,r,c(this,C).call(this))}destroy(){clearTimeout(c(this,E)[0]),clearTimeout(c(this,E)[1]),c(this,y).destroy()}},M=i(99440),O=i(66678);function k(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var x=class{constructor(t,e,i){k(this,"offset",void 0),k(this,"total",void 0),k(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=i}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}};function I(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var A=class{constructor(t,e,i){I(this,"offset",void 0),I(this,"total",void 0),I(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=i}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}};function N(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class H{constructor(){N(this,"currentSize",0),N(this,"nextSize",0),N(this,"currentOffset",0),N(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function _(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class P{constructor(){_(this,"size",new H),_(this,"workingSpace",0),_(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof H}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}function D(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class L{constructor(t,e,i){D(this,"rootNode",void 0),D(this,"nodesPool",void 0),D(this,"sizeSet",new P),D(this,"childNodeType",void 0),D(this,"visualIndex",0),D(this,"collectedNodes",[]),this.rootNode=t,this.nodesPool=e,this.childNodeType=i.toUpperCase()}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){let t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}getRenderedChildCount(){let{rootNode:t,sizeSet:e}=this,i=0;if(this.isSharedViewSet()){let r=t.firstElementChild;for(;r;){if(r.tagName===this.childNodeType)i+=1;else if(e.isPlaceOn(1))break;r=r.nextElementSibling}}else i=t.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;let{rootNode:t,sizeSet:e}=this,i=this.isSharedViewSet(),{nextSize:r}=e.getViewSize(),n=this.getRenderedChildCount();for(;n<r;){let r=this.nodesPool();!i||i&&e.isPlaceOn(2)?t.appendChild(r):t.insertBefore(r,t.firstChild),n+=1}let o=i&&e.isPlaceOn(1);for(;n>r;)t.removeChild(o?t.firstChild:t.lastChild),n-=1}render(){let{rootNode:t,sizeSet:e}=this,i=this.visualIndex;this.isSharedViewSet()&&e.isPlaceOn(2)&&(i+=e.sharedSize.nextSize);let r=t.childNodes[i];if(r.tagName!==this.childNodeType){let e=this.nodesPool();t.replaceChild(e,r),r=e}this.collectedNodes.push(r),this.visualIndex+=1}end(){}}class B extends L{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}class W{constructor(t){var e,i,r;i=void 0,(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="nodeType","string"))?r:String(r))in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i,this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(){return this.rootDocument.createElement(this.nodeType)}}function V(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class F{constructor(t,e){V(this,"nodesPool",null),V(this,"nodeType",void 0),V(this,"rootNode",void 0),V(this,"table",null),V(this,"renderedNodes",0),this.nodesPool="string"==typeof t?new W(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}var j=i(18200);function U(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class $ extends F{constructor(){super("TH"),U(this,"orderViews",new WeakMap),U(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new B(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){let{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:i,rows:n,cells:o}=this.table;for(let s=0;s<t;s++){let t=this.table.renderedRowToSource(s),l=n.getRenderedNode(s);this.sourceRowIndex=t;let a=this.obtainOrderView(l),h=o.obtainOrderView(l);a.appendView(h).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<i;n++){a.render();let i=a.getCurrentNode();i.className="",i.removeAttribute("style"),(0,r.d$)(i,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,r.P$)(i,[(0,j.iL)(),(0,j.Pp)(),(0,j.yz)(n+1),(0,j.Qk)(-1)]),e[n](t,i,n)}a.end()}}}class z extends F{constructor(t){super(null,t)}adjust(){let{columnHeadersCount:t,rowHeadersCount:e}=this.table,i=this.rootNode.firstChild;if(t){let{columnsToRender:r}=this.table,n=r+e;for(let e=0;e<t;e++){for((i=this.rootNode.childNodes[e])||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<n;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>n;)i.removeChild(i.lastChild),this.renderedNodes-=1}let o=this.rootNode.childNodes.length;if(o>t)for(let e=t;e<o;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&(0,r.cS)(i)}render(){let{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&(0,r.P$)(this.rootNode,[(0,j.Ct)()]);for(let e=0;e<t;e+=1){let{columnHeaderFunctions:t,columnsToRender:i,rowHeadersCount:n}=this.table,o=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&(0,r.P$)(o,[(0,j.f3)(),(0,j.d5)(e+1)]);for(let s=-1*n;s<i;s+=1){let i=this.table.renderedColumnToSource(s),l=o.childNodes[s+n];l.className="",l.removeAttribute("style"),(0,r.d$)(l,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,r.P$)(l,[(0,j.yz)(s+1+this.table.rowHeadersCount),(0,j.Qk)(-1),(0,j.Ng)(),...s>=0?[(0,j.iJ)()]:[(0,j.f3)()]]),t[e](i,l,e)}}}}var K=i(24748),G=i(32836);let Y=!1;class X extends F{constructor(t){super(null,t)}adjust(){let{columnsToRender:t,rowHeadersCount:e}=this.table,i=t+e;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:t,rowHeadersCount:e}=this.table;!Y&&t>1e3&&(Y=!0,(0,K.ZK)(G.e`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let t=0;t<e;t++){let e=this.table.renderedColumnToSource(t),i=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[t].style.width=`${i}px`}for(let i=0;i<t;i++){let t=this.table.renderedColumnToSource(i),r=this.table.columnUtils.getStretchedColumnWidth(t);this.rootNode.childNodes[i+e].style.width=`${r}px`}let i=this.rootNode.firstChild;i&&(0,r.cn)(i,"rowHeader")}}let q=!1;class Z extends F{constructor(t){var e,i,r;super("TR",t),i=void 0,(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e="orderView","string"))?r:String(r))in this?Object.defineProperty(this,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[e]=i,this.orderView=new L(t,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(t){return this.orderView.getNode(t)}render(){let{rowsToRender:t}=this.table;!q&&t>1e3&&(q=!0,(0,K.ZK)(G.e`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&(0,r.P$)(this.rootNode,[(0,j.Ct)()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<t;n++){this.orderView.render();let t=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(n);if(this.table.isAriaEnabled()){var e,i;(0,r.P$)(t,[(0,j.f3)(),(0,j.d5)(o+(null!==(e=null===(i=this.table.rowUtils)||void 0===i||null===(i=i.dataAccessObject)||void 0===i?void 0:i.columnHeaders.length)&&void 0!==e?e:0)+1)])}}this.orderView.end()}}function J(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class Q extends F{constructor(){super("TD"),J(this,"orderViews",new WeakMap),J(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new B(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){let{rowsToRender:t,columnsToRender:e,rows:i,rowHeaders:n}=this.table;for(let l=0;l<t;l++){let t=this.table.renderedRowToSource(l),a=i.getRenderedNode(l);this.sourceRowIndex=t;let h=this.obtainOrderView(a),u=n.obtainOrderView(a);h.prependView(u).setSize(e).setOffset(this.table.renderedColumnToSource(0)).start();for(let i=0;i<e;i++){h.render();let e=h.getCurrentNode(),n=this.table.renderedColumnToSource(i);if((0,r.pv)(e,"hide")||(e.className=""),e.removeAttribute("style"),e.removeAttribute("dir"),(0,r.d$)(e,[RegExp("aria-(.*)"),/role/]),this.table.cellRenderer(t,n,e),this.table.isAriaEnabled()){var o,s;(0,r.P$)(e,[...e.hasAttribute("role")?[]:[(0,j.Qz)()],(0,j.Qk)(-1),(0,j.yz)(n+(null!==(o=null===(s=this.table.rowUtils)||void 0===s||null===(s=s.dataAccessObject)||void 0===s?void 0:s.rowHeaders.length)&&void 0!==o?o:0)+1)])}}h.end()}}}function tt(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class te{constructor(t){let{cellRenderer:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};tt(this,"rootNode",void 0),tt(this,"rootDocument",void 0),tt(this,"rowHeaders",null),tt(this,"columnHeaders",null),tt(this,"colGroup",null),tt(this,"rows",null),tt(this,"cells",null),tt(this,"rowFilter",null),tt(this,"columnFilter",null),tt(this,"rowUtils",null),tt(this,"columnUtils",null),tt(this,"rowsToRender",0),tt(this,"columnsToRender",0),tt(this,"rowHeaderFunctions",[]),tt(this,"rowHeadersCount",0),tt(this,"columnHeaderFunctions",[]),tt(this,"columnHeadersCount",0),tt(this,"cellRenderer",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:i,rows:r,cells:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),i.setTable(this),r.setTable(this),n.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=i,this.rows=r,this.cells=n}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:t,rows:e}=this;for(let i=0;i<t;i++){let t=e.getRenderedNode(i);if(t.firstChild){let e=this.renderedRowToSource(i),r=this.rowUtils.getHeight(e);r?t.firstChild.style.height=`${r-1}px`:t.firstChild.style.height=""}}}}class ti{constructor(){let{TABLE:t,THEAD:e,COLGROUP:i,TBODY:r,rowUtils:n,columnUtils:o,cellRenderer:s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new te(t,{cellRenderer:s}),this.renderer.setRenderers({rowHeaders:new $,columnHeaders:new z(e),colGroup:new X(i),rows:new Z(r),cells:new Q}),this.renderer.setAxisUtils(n,o)}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function tr(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function tn(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function to(t,e){var i=tl(t,e,"get");return i.get?i.get.call(t):i.value}function ts(t,e,i){var r=tl(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function tl(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var ta=new WeakMap,th=new WeakMap,tu=new WeakMap,tc=new WeakMap,td=new WeakMap;class tg{static get DEFAULT_WIDTH(){return 50}constructor(t){let{totalColumns:e,stretchMode:i,stretchingColumnWidthFn:r,columnWidthFn:n}=t;tn(this,"stretchAllRatio",0),tn(this,"stretchLastWidth",0),tn(this,"stretchAllColumnsWidth",[]),tr(this,ta,{writable:!0,value:0}),tn(this,"needVerifyLastColumnWidth",!0),tr(this,th,{writable:!0,value:()=>0}),tr(this,tu,{writable:!0,value:t=>t}),tr(this,tc,{writable:!0,value:t=>t}),tr(this,td,{writable:!0,value:()=>"none"}),ts(this,th,e),ts(this,td,i),ts(this,tu,null!=r?r:to(this,tu)),ts(this,tc,null!=n?n:to(this,tc))}refreshStretching(t){if("none"===to(this,td).call(this))return;ts(this,ta,t);let e=0;for(let i=0;i<to(this,th).call(this);i++){let r=this._getColumnWidth(i),n=to(this,tu).call(this,void 0,i);"number"==typeof n?t-=n:e+=r}let i=t-e;if("all"===to(this,td).call(this)&&i>0)this.stretchAllRatio=t/e,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===to(this,td).call(this)&&t!==1/0){let t=this._getColumnWidth(to(this,th).call(this)-1),e=i+t;this.stretchLastWidth=e>=0?e:t}}getStretchedColumnWidth(t,e){let i=null;return"all"===to(this,td).call(this)&&0!==this.stretchAllRatio?i=this._getStretchedAllColumnWidth(t,e):"last"===to(this,td).call(this)&&0!==this.stretchLastWidth&&(i=this._getStretchedLastColumnWidth(t)),i}_getStretchedAllColumnWidth(t,e){let i=0;if(!this.stretchAllColumnsWidth[t]){let i=Math.round(e*this.stretchAllRatio),r=to(this,tu).call(this,i,t);void 0===r?this.stretchAllColumnsWidth[t]=i:this.stretchAllColumnsWidth[t]=isNaN(r)?this._getColumnWidth(t):r}if(this.stretchAllColumnsWidth.length===to(this,th).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let t=0;t<this.stretchAllColumnsWidth.length;t++)i+=this.stretchAllColumnsWidth[t];i!==to(this,ta)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=to(this,ta)-i)}return this.stretchAllColumnsWidth[t]}_getStretchedLastColumnWidth(t){return t===to(this,th).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(t){let e=to(this,tc).call(this,t);return isNaN(e)&&(e=tg.DEFAULT_WIDTH),e}}function tf(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tp{constructor(t,e){tf(this,"dataAccessObject",void 0),tf(this,"wtSettings",void 0),tf(this,"headerWidths",new Map),tf(this,"stretching",void 0),this.dataAccessObject=t,this.wtSettings=e,this.stretching=new tg({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(t,e)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",t,e),columnWidthFn:t=>this.dataAccessObject.wtTable.getColumnWidth(t)})}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(t){let e=this.getWidth(t),i=this.stretching.getStretchedColumnWidth(t,e);return i&&(e=i),e}getHeaderHeight(t){let e=this.wtSettings.getSetting("defaultRowHeight"),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==i&&(e=e?Math.max(e,i):i),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}refreshStretching(){let{wtTable:t,wtViewport:e,cloneSource:i}=this.dataAccessObject,n=i?i.wtTable.holder:t.holder,o=n.offsetHeight<n.scrollHeight?(0,r.np)():0;this.stretching.refreshStretching(e.getViewportWidth()-o)}calculateWidths(){let{wtSettings:t}=this,e=t.getSetting("rowHeaderWidth");if(this.refreshStretching(),null!=(e=t.getSetting("onModifyRowHeaderWidth",e))){let i=t.getSetting("rowHeaders").length,r=t.getSetting("defaultColumnWidth");for(let t=0;t<i;t++){let i=Array.isArray(e)?e[t]:e;i=null==i?r:i,this.headerWidths.set(t,i)}}}}function tm(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tw{constructor(t,e){tm(this,"dataAccessObject",void 0),tm(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t),i=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==i&&(e=void 0===e?i:Math.max(e,i)),e}}let tv="bottom",tb="inline_start",ty="top_inline_start_corner",tC="bottom_inline_start_corner",tS=["top",tv,tb,ty,tC],tE=new Map([["top","ht_clone_top"],[tv,`ht_clone_${tv}`],[tb,`ht_clone_${tb} ht_clone_left`],[ty,`ht_clone_${ty} ht_clone_top_left_corner`],[tC,`ht_clone_${tC} ht_clone_bottom_left_corner`]]);function tR(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var tT=class{constructor(t,e,i,n,o){tR(this,"wtSettings",null),tR(this,"domBindings",void 0),tR(this,"TBODY",null),tR(this,"THEAD",null),tR(this,"COLGROUP",null),tR(this,"hasTableHeight",!0),tR(this,"hasTableWidth",!0),tR(this,"isTableVisible",!1),tR(this,"tableOffset",0),tR(this,"holderOffset",0),this.domBindings=i,this.isMaster="master"===o,this.name=o,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,(0,r.Wu)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new tw(this.dataAccessObject,this.wtSettings),this.columnUtils=new tp(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ti({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(t){return this.name===t}fixTableDomTree(){let t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){let e;let i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.pv)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",i&&i.insertBefore(e,t),e.appendChild(t)),e.style.position="relative",this.wtSettings.getSetting("ariaTags")&&(0,r.P$)(e,[(0,j.Rn)()]),e}createHider(t){let e;let i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.pv)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtHider",i&&i.insertBefore(e,t),e.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&(0,r.P$)(e,[(0,j.Rn)()]),e}createHolder(t){let e;let i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.pv)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",i&&i.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable",e.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&(0,r.P$)(e.parentNode,[(0,j.Rn)()])),e.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&(0,r.P$)(e,[(0,j.Rn)()]),e}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:e}=this,{wtOverlays:i,wtViewport:n}=this.dataAccessObject,o=e.getSetting("totalRows"),s=e.getSetting("totalColumns"),l=e.getSetting("rowHeaders"),a=l.length,h=e.getSetting("columnHeaders"),u=h.length,c=!1,d=t;if(this.isMaster&&(this.holderOffset=(0,r.cv)(this.holder),d=n.createRenderCalculators(d),a&&!e.getSetting("fixedColumnsStart"))){let t=i.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(d=!1)}if(this.isMaster&&(c=i.updateStateOfRendering()),d)this.isMaster&&n.createVisibleCalculators(),i&&i.refresh(!0);else{this.isMaster?this.tableOffset=(0,r.cv)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let t=o>0?this.getFirstRenderedRow():0,e=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new A(t,o,u),this.columnFilter=new x(e,s,a);let i=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let t={};this.wtSettings.getSetting("beforeDraw",!0,t),i=!0!==t.skipRender}if(i){let t;if(this.tableRenderer.setHeaderContentRenderers(l,h),(this.is(tv)||this.is(tC))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(t=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(tv))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();let e=(0,r.iO)(this.hider),i=(0,r.iO)(this.TABLE);0!==e&&i!==e&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),t!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(tv)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let g=!1;return this.isMaster&&(g=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(g=i.bottomOverlay.resetFixedPosition()||g),g=i.inlineStartOverlay.resetFixedPosition()||g,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),g?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(d),c&&i.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){let e,i,n;let o=this.columnFilter.renderedToSource(t),s=this.wtSettings.getSetting("columnHeaders").length,l=this.wtSettings.getSetting("defaultRowHeight"),a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;s;)s-=1,e=this.getColumnHeaderHeight(s),(i=this.getColumnHeader(o,s))&&(n=(0,r.WS)(i),(!e&&l<n||e<n)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=n),Array.isArray(a)?null!==a[s]&&void 0!==a[s]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]<(a[s]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]||a))}adjustColumnHeaderHeights(){let{wtSettings:t}=this,e=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=t.getSetting("columnHeaders");for(let t=0,n=r.length;t<n;t++)if(i[t]){if(!e[t]||0===e[t].childNodes.length)return;e[t].childNodes[0].style.height=`${i[t]}px`}}resetOversizedRows(){let{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(tv))&&!t.getSetting("externalRowCalculator")){let t=this.getRenderedRowsCount();for(let i=0;i<t;i++){let t=this.rowFilter.renderedToSource(i);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,i=t.col,r=this.wtSettings.getSetting("onModifyGetCellCoords",e,i);if(r&&Array.isArray(r)&&([e,i]=r),this.isRowBeforeRenderedRows(e))return -1;if(this.isRowAfterRenderedRows(e))return -2;if(this.isColumnBeforeRenderedColumns(i))return -3;if(this.isColumnAfterRenderedColumns(i))return -4;let n=this.getRow(e);if(!n&&e>=0)throw Error("TR was expected to be rendered but is not");let o=n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!o&&i>=0)throw Error("TD or TH was expected to be rendered but is not");return o}getRow(t){var e,i;let r=null,n=null;return t<0?(r=null===(e=this.rowFilter)||void 0===e?void 0:e.sourceRowToVisibleColHeadedRow(t),n=this.THEAD):(r=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),n=this.TBODY),void 0!==r&&void 0!==n&&!(n.childNodes.length<r+1)&&n.childNodes[r]}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.THEAD.childNodes[e];return null==i?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){let e=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach(t=>{let r=t.childNodes[i];r&&e.push(r)}),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.wtSettings.getSetting("rowHeaders").length;if(e>=i)return;let r=this.rowFilter.sourceToRendered(t),n=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):r,o=r<0?this.THEAD:this.TBODY,s=o.childNodes[n];return null==s?void 0:s.childNodes[e]}getRowHeaders(t){let e=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){let i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],n=null==i?void 0:i.childNodes[r];n&&e.push(n)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=(0,r.oq)(e,["TD","TH"])),null===e)return null;let i=e.parentNode,n=i.parentNode,o=(0,r.Kz)(i),s=e.cellIndex;if((0,r.mK)(ty,e,this.wtRootElement)||(0,r.mK)("top",e,this.wtRootElement))"THEAD"===n.nodeName&&(o-=n.childNodes.length);else if((0,r.mK)(tC,e,this.wtRootElement)||(0,r.mK)(tv,e,this.wtRootElement)){let t=this.wtSettings.getSetting("totalRows");o=t-n.childNodes.length+o}else o=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o);return s=(0,r.mK)(ty,e,this.wtRootElement)||(0,r.mK)(tb,e,this.wtRootElement)||(0,r.mK)(tC,e,this.wtRootElement)?this.columnFilter.offsettedTH(s):this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){let t,e,i,n,o;if(this.wtSettings.getSetting("externalRowCalculator"))return;let s=this.TBODY.childNodes.length,l=s*this.wtSettings.getSetting("defaultRowHeight"),a=(0,r.WS)(this.TBODY)-1;if(l!==a||this.wtSettings.getSetting("fixedRowsBottom"))for(;s;)s-=1,i=this.rowFilter.renderedToSource(s),t=this.getRowHeight(i),e=(o=(n=this.getTrForRow(i)).querySelector("th"))?(0,r.WS)(o):(0,r.WS)(n)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<e||t<e)&&(e+=1,this.dataAccessObject.wtViewport.oversizedRows[i]=e)}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){if(t>=0)return!1;let e=this.wtSettings.getSetting("rowHeaders"),i=e.length;return Math.abs(t)<=i}isRowHeaderRendered(t){if(t>=0)return!1;let e=this.wtSettings.getSetting("columnHeaders"),i=e.length;return Math.abs(t)<=i}isRowBeforeRenderedRows(t){let e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){let e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&0>this.columnFilter.sourceToRendered(t)&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}getStretchedColumnWidth(t){return this.columnUtils.getStretchedColumnWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,r.iO)(this.TABLE)}getHeight(){return(0,r.Pb)(this.TABLE)}getTotalWidth(){let t=(0,r.iO)(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){let t=(0,r.Pb)(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return(0,r.pn)(this.TABLE)}_modifyRowHeaderWidth(t){let e=(0,s.mf)(t)?t():null;return Array.isArray(e)?(e=[...e])[e.length-1]=this._correctRowHeaderWidth(e[e.length-1]):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}},tM=i(69488);let tO={getFirstRenderedRow(){let t=this.wtSettings.getSetting("totalRows");return 0===t?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,tM.jW)(tO,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});let tk={getFirstRenderedColumn(){let t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){let t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getLastRenderedColumn(){let t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){let t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,tM.jW)(tk,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});class tx extends tT{constructor(t,e,i,r){super(t,e,i,r,"top")}}(0,tM.jB)(tx,tO),(0,tM.jB)(tx,tk);var tI=i(66411);function tA(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var tN=class{constructor(t){tA(this,"dataAccessObject",void 0),tA(this,"lastScrolledColumnPos",-1),tA(this,"lastScrolledRowPos",-1),this.dataAccessObject=t}scrollViewport(t,e,i,r,n){let o=this.scrollViewportHorizontally(t.col,i,n),s=this.scrollViewportVertically(t.row,e,r);return o||s}scrollViewportHorizontally(t,e,i){let{drawn:r,totalColumns:n}=this.dataAccessObject;if(!r||!Number.isInteger(t)||t<0||t>n)return!1;let o=this.getFirstVisibleColumn(),s=this.getLastVisibleColumn(),l=void 0===e&&void 0===i,{fixedColumnsStart:a,inlineStartOverlay:h}=this.dataAccessObject;if(l&&t<a)return!1;let u=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t),-1===o?u=h.scrollTo(t,l?t>this.lastScrolledColumnPos:e):(l&&(t<o||t>s)||!l)&&(u=h.scrollTo(t,l?t>s:e)),u&&(this.lastScrolledColumnPos=t),u}scrollViewportVertically(t,e,i){let{drawn:r,totalRows:n}=this.dataAccessObject;if(!r||!Number.isInteger(t)||t<0||t>n)return!1;let o=this.getFirstVisibleRow(),s=this.getLastVisibleRow(),l=void 0===e&&void 0===i,{fixedRowsBottom:a,fixedRowsTop:h,topOverlay:u}=this.dataAccessObject;if(l&&(t<h||t>n-a-1))return!1;let c=!1;return t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t),-1===o?c=u.scrollTo(t,l?t>this.lastScrolledRowPos:i):(l&&(t<o||t>s)||!l)&&(c=u.scrollTo(t,l?t>s:i)),c&&(this.lastScrolledRowPos=t),c}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){let{topOverlay:t,wtTable:e,wtViewport:i,totalRows:n,rootWindow:o}=this.dataAccessObject,s=e.getLastVisibleRow();if(t.mainTableScrollableElement===o){let l=(0,r.cv)(e.wtRootElement),a=(0,r.cx)(o,o);if(l.top>a){let e=(0,r.WS)(o),h=i.getColumnHeaderHeight();for(let i=1;i<=n;i++)if(h+=t.sumCellSizes(i-1,i),l.top+h-a>=e){s=i-2;break}}}return s}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){let{wtSettings:t,inlineStartOverlay:e,wtTable:i,wtViewport:n,totalColumns:o,rootWindow:s}=this.dataAccessObject,l=i.getLastVisibleColumn();if(e.mainTableScrollableElement===s){let a=t.getSetting("rtlMode"),h=null;if(a){let t=i.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document,r=e.documentElement.offsetWidth;h=Math.abs(t.right-r)}else{let t=(0,r.cv)(i.wtRootElement);h=t.left}let u=Math.abs((0,r.vj)(s,s));if(h>u){let t=(0,r.x9)(s),i=n.getRowHeaderWidth();for(let r=1;r<=o;r++)if(h+(i+=e.sumCellSizes(r-1,r))-u>=t){l=r-2;break}}}return l}},tH=i(11070),t_=i(51648);function tP(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tD{get eventManager(){return new n.Z(this)}constructor(t,e){tP(this,"wtTable",void 0),tP(this,"wtScroll",void 0),tP(this,"wtViewport",void 0),tP(this,"wtOverlays",void 0),tP(this,"selectionManager",void 0),tP(this,"wtEvent",void 0),tP(this,"guid",`wt_${(0,tI.O1)()}`),tP(this,"drawInterrupted",!1),tP(this,"drawn",!1),tP(this,"domBindings",void 0),tP(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new tN(this.createScrollDao())}findOriginalHeaders(){let t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;e<i;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,i){(0,r.tT)(i,t[e])}])}}createCellCoords(t,e){return new tH.Z(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,i){return new t_.Z(t,e,i,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,t||this.wtTable.isVisible()?this.wtTable.draw(t):this.drawInterrupted=!0,this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);let i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<r&&t.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<o&&t.row>=i-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else if(t.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);else if(t.row<i&&t.row>=i-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t);return this.wtTable.getCell(t)}scrollViewport(t,e,i,r,n){return!(t.col<0)&&!(t.row<0)&&this.wtScroll.scrollViewport(t,e,i,r,n)}scrollViewportHorizontally(t,e,i){return!(t<0)&&this.wtScroll.scrollViewportHorizontally(t,e,i)}scrollViewportVertically(t,e,i){return!(t<0)&&this.wtScroll.scrollViewportVertically(t,e,i)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get drawn(){return t.drawn},set drawn(v){t.drawn=v},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function tL(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tB extends tD{constructor(t,e,i){super(t,e),tL(this,"cloneSource",void 0),tL(this,"cloneOverlay",void 0);let r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new T(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}class tW{constructor(t,e,i,n,o){var s,l;(s="symbol"==typeof(l=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s="wtSettings","string"))?l:String(l))in this?Object.defineProperty(this,s,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[s]=null,(0,tM.jW)(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=e,this.wtSettings=n;let{TABLE:a,hider:h,spreader:u,holder:c,wtRootElement:d}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=h,this.spreader=u,this.holder=c,this.wtRootElement=d,this.trimmingContainer=(0,r.$g)(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){let t=this.needFullRender;this.needFullRender=this.shouldBeRendered();let e=t!==this.needFullRender;return e&&!this.needFullRender&&this.reset(),e}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,r.$g)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,r.dD)(t.TABLE)}getRelativeCellPosition(t,e,i){if(!1===this.clone.wtTable.holder.contains(t)){(0,K.ZK)(`The provided element is not a child of the ${this.type} overlay`);return}let r=this.mainTableScrollableElement===this.domBindings.rootWindow,n=i<this.wtSettings.getSetting("fixedColumnsStart"),o=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop};return r?this.getRelativeCellPositionWithinWindow(o,n,h,a):this.getRelativeCellPositionWithinHolder(o,s,n,h,a)}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,i,n){let o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(e){let t=o.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(o.left+o.width+(0,r.np)())),s=t<=0?-1*t:0}else s=n.start;if(t){let t=this.clone.wtTable.TABLE.getBoundingClientRect();l=t.top-o.top}else l=n.top;return{start:i.start+s,top:i.top+l}}getRelativeCellPositionWithinHolder(t,e,i,r,n){let o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,l=0;if(i||(s=o.horizontal-n.start),e){let t=this.wot.wtTable.wtRootElement.getBoundingClientRect(),e=this.clone.wtTable.TABLE.getBoundingClientRect();l=-1*e.top+t.top}else t||(l=o.vertical-n.top);return{start:r.start-s,top:r.top-l}}makeClone(){if(-1===tS.indexOf(this.type))throw Error(`Clone type "${this.type}" is not supported.`);let{wtTable:t,wtSettings:e}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=i.createElement("div"),s=i.createElement("table"),l=t.wtRootElement.parentNode;o.className=`${tE.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,e.getSetting("ariaTags")&&(0,r.P$)(o,[(0,j.Rn)()]),s.className=t.TABLE.className;let a=t.TABLE.getAttribute("role");a&&s.setAttribute("role",t.TABLE.getAttribute("role")),o.appendChild(s),l.appendChild(o);let h=this.wtSettings.getSetting("preventOverflow");return!0===h||"horizontal"===h&&"top"===this.type||"vertical"===h&&this.type===tb?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(l).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=(0,r.dD)(t.TABLE),new tB(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.shouldBeRendered();this.clone&&(this.needFullRender||e)&&this.clone.draw(t),this.needFullRender=e}reset(){if(!this.clone)return;let t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,i=t.style,r=e.style,n=t.parentNode.style;(0,M.Bk)([i,r,n],t=>{t.width="",t.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}let tV=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});class tF extends tW{constructor(t,e,i,r){var n,o;super(t,e,"top",i,r),(n="symbol"==typeof(o=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(n="cachedFixedRowsTop","string"))?o:String(o))in this?Object.defineProperty(this,n,{value:-1,enumerable:!0,configurable:!0,writable:!0}):this[n]=-1,this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tx(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow"),n=0,o=!1;if(this.trimmingContainer!==e||i&&"vertical"===i)n=this.getScrollPosition(),(0,r.WH)(t);else{let{wtTable:e}=this.wot,i=e.hider.getBoundingClientRect(),s=Math.ceil(i.bottom),l=t.offsetHeight;o=s===l,n=this.getOverlayOffset(),(0,r.I2)(t,"0px",`${n}px`)}let s=this.adjustHeaderBordersPosition(n,o);return this.adjustElementsSize(),s}setScrollPosition(t){let e=this.domBindings.rootWindow,i=!1;return this.mainTableScrollableElement===e&&e.scrollY!==t?(e.scrollTo((0,r.DZ)(e),t),i=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){let i=this.wtSettings.getSetting("defaultRowHeight"),r=t,n=0;for(;r<e;){let t=this.wot.wtTable.getRowHeight(r);n+=void 0===t?i:t,r+=1}return n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t}=this.wot,{rootDocument:e,rootWindow:i}=this.domBindings,n=(0,r.np)(e),o=this.clone.wtTable.holder.parentNode,s=o.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"horizontal"===l){let e=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(e-=n),e=Math.min(e,t.wtRootElement.scrollWidth),s.width=`${e}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let a=(0,r.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),s.height=`${a}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(tV.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+e}px`}applyToDOM(){let t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let{wot:i,wtSettings:n}=this,o=i.cloneSource?i.cloneSource:i,s=o.wtTable.holder,l=this.getTableParentOffset(),a=0;if(e){let i=this.wot.wtTable.getRowHeight(t),r=this.wot.wtViewport.getViewportHeight();i>r&&(e=!1)}if(e&&s.offsetHeight!==s.clientHeight&&(a=(0,r.np)(this.domBindings.rootDocument)),e){let e=n.getSetting("fixedRowsBottom"),r=n.getSetting("totalRows");l+=this.sumCellSizes(0,t+1),l-=i.wtViewport.getViewportHeight()-this.sumCellSizes(r-e,r),l+=1}else l+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return l+=a,this.setScrollPosition(l)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,r.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){let t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight();(i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>t-e&&(i=0)}return i}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("totalColumns");n?(0,r.IV)(i,"emptyColumns"):(0,r.cn)(i,"emptyColumns");let o=!1;if(!e){let e=this.wtSettings.getSetting("fixedRowsTop"),n=this.cachedFixedRowsTop!==e,s=this.wtSettings.getSetting("columnHeaders");if((n||0===e)&&s.length>0){let e=(0,r.pv)(i,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),t||0===this.wtSettings.getSetting("totalRows")?((0,r.cn)(i,"innerBorderTop"),o=!e):((0,r.IV)(i,"innerBorderTop"),o=e)}}return o}}let tj={getFirstRenderedRow(){let t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),i=t-e;return 0===t||0===e?-1:i<0?0:i},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};(0,tM.jW)(tj,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});class tU extends tT{constructor(t,e,i,r){super(t,e,i,r,tv)}}(0,tM.jB)(tU,tj),(0,tM.jB)(tU,tk);class t$ extends tW{constructor(t,e,i,r){var n,o;super(t,e,tv,i,r),(n="symbol"==typeof(o=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(n="cachedFixedRowsBottom","string"))?o:String(o))in this?Object.defineProperty(this,n,{value:-1,enumerable:!0,configurable:!0,writable:!0}):this[n]=-1,this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tU(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let i=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||r&&"vertical"===r?(i=this.getScrollPosition(),this.repositionOverlay()):(i=this.getOverlayOffset(),e.style.bottom=`${i}px`);let n=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),n}repositionOverlay(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=(0,r.np)(i)),n.style.bottom=`${o}px`}setScrollPosition(t){let{rootWindow:e}=this.domBindings,i=!1;return this.mainTableScrollableElement===e?(e.scrollTo((0,r.DZ)(e),t),i=!0):this.mainTableScrollableElement.scrollTop!==t&&(this.mainTableScrollableElement.scrollTop=t,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){let{wtTable:i,wtSettings:r}=this.wot,n=r.getSetting("defaultRowHeight"),o=t,s=0;for(;o<e;){let t=i.getRowHeight(o);s+=void 0===t?n:t,o+=1}return s}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=(0,r.np)(i),s=this.clone.wtTable.holder.parentNode,l=s.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===a){let i=e.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(i-=o),i=Math.min(i,t.wtRootElement.scrollWidth),l.width=`${i}px`}else l.width="";this.clone.wtTable.holder.style.width=l.width;let h=(0,r.Pb)(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(h=0),l.height=`${h}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){let t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let i=this.getTableParentOffset(),n=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=n.wtTable.holder,s=0;e&&o.offsetHeight!==o.clientHeight&&(s=(0,r.np)(this.domBindings.rootDocument)),e?(i+=this.sumCellSizes(0,t+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),i+=s,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,r.cx)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){let t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),r=this.domBindings.rootDocument.documentElement.clientHeight;(i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-r+t,0))>t-e&&(i=0)}return i}adjustHeaderBordersPosition(t){let e=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==e,n=this.wtSettings.getSetting("columnHeaders"),o=!1;if((i||0===e)&&n.length>0){let e=this.wot.wtTable.holder.parentNode,i=(0,r.pv)(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?((0,r.cn)(e,"innerBorderBottom"),o=!i):((0,r.IV)(e,"innerBorderBottom"),o=i)}return o}}let tz={getFirstRenderedRow(){let t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){let t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getLastRenderedRow(){let t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){let t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,tM.jW)(tz,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});let tK={getFirstRenderedColumn(){let t=this.wtSettings.getSetting("totalColumns");return 0===t?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){let t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,tM.jW)(tK,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});class tG extends tT{constructor(t,e,i,r){super(t,e,i,r,tb)}}(0,tM.jB)(tG,tz),(0,tM.jB)(tG,tK);class tY extends tW{constructor(t,e,i,r){super(t,e,tb,i,r)}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tG(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:t}=this.wot;if(!this.needFullRender||!t.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,i=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer!==e||n&&"horizontal"===n?(o=this.getScrollPosition(),(0,r.WH)(i)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,r.I2)(i,`${o}px`,"0px"));let s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(t){let{rootWindow:e}=this.domBindings,i=!1;return this.isRtl()&&(t=-t),this.mainTableScrollableElement===e&&e.scrollX!==t?(e.scrollTo(t,(0,r.AQ)(e)),i=!0):this.mainTableScrollableElement.scrollLeft!==t&&(this.mainTableScrollableElement.scrollLeft=t,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){let i=this.wtSettings.getSetting("defaultColumnWidth"),r=t,n=0;for(;r<e;)n+=this.wot.wtTable.getStretchedColumnWidth(r)||i,r+=1;return n}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||t)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t}=this.wot,{rootDocument:e,rootWindow:i}=this.domBindings,n=(0,r.np)(e),o=this.clone.wtTable.holder.parentNode,s=o.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||"vertical"===l){let e=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(e-=n),e=Math.min(e,t.wtRootElement.scrollHeight),s.height=`${e}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;let a=(0,r.iO)(this.clone.wtTable.TABLE);s.width=`${a}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable,e=this.wot.selectionManager.getFocusSelection()?parseInt(tV.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+e}px`}applyToDOM(){let t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style[e]="0";else throw Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){let i=this.getTableParentOffset(),n=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=n.wtTable.holder,s=0;if(e){let i=this.wot.wtTable.getColumnWidth(t),r=this.wot.wtViewport.getViewportWidth();i>r&&(e=!1)}return e&&o.offsetWidth!==o.clientWidth&&(s=(0,r.np)(this.domBindings.rootDocument)),e?(i+=this.sumCellSizes(0,t+1),i-=this.wot.wtViewport.getViewportWidth()):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),i+=s,this.setScrollPosition(i)}getTableParentOffset(){let t=this.wtSettings.getSetting("preventOverflow"),e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs((0,r.vj)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){i=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let t=this.wot.wtTable.getTotalWidth(),e=this.clone.wtTable.getTotalWidth();i>t-e&&(i=0)}return i}adjustHeaderBordersPosition(t){let e=this.wot.wtTable.holder.parentNode,i=this.wtSettings.getSetting("rowHeaders"),n=this.wtSettings.getSetting("fixedColumnsStart"),o=this.wtSettings.getSetting("totalRows");o?(0,r.IV)(e,"emptyRows"):(0,r.cn)(e,"emptyRows");let s=!1;if(n&&!i.length)(0,r.cn)(e,"innerBorderLeft innerBorderInlineStart");else if(!n&&i.length){let i=(0,r.pv)(e,"innerBorderInlineStart");t?((0,r.cn)(e,"innerBorderLeft innerBorderInlineStart"),s=!i):((0,r.IV)(e,"innerBorderLeft innerBorderInlineStart"),s=i)}return s}}class tX extends tT{constructor(t,e,i,r){super(t,e,i,r,ty)}}function tq(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,tM.jB)(tX,tO),(0,tM.jB)(tX,tK);class tZ extends tW{constructor(t,e,i,r,n,o){super(t,e,ty,i,r),tq(this,"topOverlay",void 0),tq(this,"inlineStartOverlay",void 0),this.topOverlay=n,this.inlineStartOverlay=o}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tX(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();(0,r.I2)(t,`${e}px`,`${i}px`)}else(0,r.WH)(t);let e=(0,r.Pb)(this.clone.wtTable.TABLE),i=(0,r.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${i}px`,!1}}class tJ extends tT{constructor(t,e,i,r){super(t,e,i,r,tC)}}(0,tM.jB)(tJ,tj),(0,tM.jB)(tJ,tK);class tQ extends tW{constructor(t,e,i,r,n,o){super(t,e,tC,i,r),this.bottomOverlay=n,this.inlineStartOverlay=o}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tJ(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let t=this.inlineStartOverlay.getOverlayOffset(),i=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${i}px`}else(0,r.WH)(e),this.repositionOverlay();let i=(0,r.Pb)(this.clone.wtTable.TABLE),n=(0,r.iO)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),e.style.height=`${i}px`,e.style.width=`${n}px`,!1}repositionOverlay(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=(0,r.np)(i)),n.style.bottom=`${o}px`}}function t0(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var t1=class{constructor(t,e,i,n,o,s){t0(this,"wot",null),t0(this,"topOverlay",null),t0(this,"bottomOverlay",null),t0(this,"inlineStartOverlay",null),t0(this,"topInlineStartCornerOverlay",null),t0(this,"bottomInlineStartCornerOverlay",null),t0(this,"browserLineHeight",void 0),t0(this,"wtSettings",null),t0(this,"resizeObserver",new ResizeObserver(t=>{(0,l.U7)(()=>{Array.isArray(t)&&t.length&&this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=t,this.wtSettings=n,this.domBindings=i,this.facadeGetter=e,this.wtTable=s;let{rootDocument:a,rootWindow:h}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=(0,r.np)(a);let u="hidden"===h.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=u?s.holder:(0,r.dD)(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){let{rootWindow:t,rootDocument:e}=this.domBindings,i=t.getComputedStyle(e.body),r=parseInt(i.lineHeight,10),n=1.2*parseInt(i.fontSize,10);this.browserLineHeight=r||n}initOverlays(){let t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new tF(...t),this.bottomOverlay=new t$(...t),this.inlineStartOverlay=new tY(...t),this.topInlineStartCornerOverlay=new tZ(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new tQ(...t,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let t=this.topOverlay.updateStateOfRendering();return t=this.bottomOverlay.updateStateOfRendering()||t,t=this.inlineStartOverlay.updateStateOfRendering()||t,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(t=this.topInlineStartCornerOverlay.updateStateOfRendering()||t),this.bottomOverlay.needFullRender&&(t=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||t)),t}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let t;let{rootDocument:e,rootWindow:i}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",t=>this.onKeyDown(t)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",t=>this.onTableScroll(t),{passive:!0}),r!==n&&this.eventManager.addEventListener(n,"scroll",t=>this.onTableScroll(t),{passive:!0});let o=i.devicePixelRatio&&i.devicePixelRatio>1,s=this.scrollableElement===i,l=this.wtSettings.getSetting("preventWheel"),h={passive:s};(l||o||!(0,a.i7)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",t=>this.onCloneWheel(t,l),h);let u=[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];u.forEach(t=>{if(t&&t.needFullRender){let{holder:e}=t.clone.wtTable;this.eventManager.addEventListener(e,"wheel",t=>this.onCloneWheel(t,l),h)}}),this.eventManager.addEventListener(i,"resize",()=>{clearTimeout(t),t=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(t){let e=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,n=t.target;(!this.keyPressed||(r===e||n===e||t.target.contains(r))&&(i===e||n===e||t.target.contains(i)))&&this.syncScrollPositions(t)}onCloneWheel(t,e){let{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=t.target,s=n!==i&&o!==i&&!o.contains(n),l=r!==i&&o!==i&&!o.contains(r);if(this.keyPressed&&(s||l))return;let a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==i&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=(0,O.ot)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,i=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(i+=i*this.browserLineHeight,e+=e*this.browserLineHeight);let r=this.scrollVertically(e),n=this.scrollHorizontally(i);return r||n}scrollVertically(t){let e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){let e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let{rootWindow:t}=this.domBindings,e=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[r,n]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=e.scrollLeft!==r||this.lastScrollX!==t.scrollX,this.verticalScrolling=i.scrollTop!==n||this.lastScrollY!==t.scrollY,this.lastScrollX=t.scrollX,this.lastScrollY=t.scrollY,this.horizontalScrolling){e.scrollLeft=r;let t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=r)}this.verticalScrolling&&(i.scrollTop=n),this.refreshAll()}syncScrollWithMaster(){let t=this.topOverlay.mainTableScrollableElement,{scrollLeft:e,scrollTop:i}=t;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=(0,r.dD)(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.updateLastSpreaderSize();e&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){let t=this.wtTable.spreader,e=t.clientWidth,i=t.clientHeight,r=e!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=i),r}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtViewport:e}=this.wot,{wtTable:i}=this,r=this.wtSettings.getSetting("totalColumns"),n=this.wtSettings.getSetting("totalRows"),o=e.getRowHeaderWidth(),s=e.getColumnHeaderHeight(),l=i.hider.style;if(l.width=`${o+this.inlineStartOverlay.sumCellSizes(0,r)}px`,l.height=`${s+this.topOverlay.sumCellSizes(0,n)+1}px`,this.scrollbarSize>0){let{scrollHeight:t,scrollWidth:e}=i.wtRootElement,{scrollHeight:r,scrollWidth:n}=i.holder;this.hasScrollbarRight=t<r,this.hasScrollbarBottom=e<n,this.hasScrollbarRight&&i.hider.scrollWidth+this.scrollbarSize>e?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&i.hider.scrollHeight+this.scrollbarSize>t&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(t),this.inlineStartOverlay.adjustElementsSize(t),this.bottomOverlay.adjustElementsSize(t)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;let e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return(0,M.Bk)(e,e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(i=e.clone)}),i}syncOverlayTableClassNames(){let t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,M.Bk)(e,e=>{e&&(e.clone.wtTable.TABLE.className=t.className)})}};function t2(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class t4{constructor(t){t2(this,"settings",{}),t2(this,"defaults",Object.freeze(this.getDefaults())),(0,tM._l)(this.defaults,(e,i)=>{if(void 0!==t[i])this.settings[i]=t[i];else if(void 0===e)throw Error(`A required setting "${i}" was not provided`);else this.settings[i]=e})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,i)=>{let n=this.getSetting("data",t,e);(0,r.tT)(i,null==n?"":n)},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:t=>t,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?(0,tM._l)(t,(t,e)=>{this.settings[e]=t}):this.settings[t]=e,this}getSetting(t,e,i,r,n){return"function"==typeof this.settings[t]?this.settings[t](e,i,r,n):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class t5 extends tT{constructor(t,e,i,r){super(t,e,i,r,"master")}alignOverlaysWithTrimmingContainer(){let t=(0,r.$g)(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e){let t=this.wtSettings.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{let i=t.parentElement,n=(0,r.C2)(t,"height",e),o=(0,r.C2)(t,"overflow",e),s=this.holder.style,{scrollWidth:l,scrollHeight:a}=t,h=t.offsetWidth,u=t.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){let n=t.cloneNode(!1);n.style.overflow="auto",n.style.position="absolute",t.nextElementSibling?i.insertBefore(n,t.nextElementSibling):i.appendChild(n);let o=parseInt((0,r.Dx)(n,e).height,10);i.removeChild(n),0===o&&(u=0)}u=Math.min(u,a),s.height="auto"===n?"auto":`${u}px`,h=Math.min(h,l),s.width=`${h}px`,s.overflow="",this.hasTableHeight="auto"===s.height||u>0,this.hasTableWidth=h>0}this.isTableVisible=(0,r.pn)(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,i="master",r=t.getSetting("columnHeaders"),n=r.length;if(n&&!e.hasOversizedColumnHeadersMarked[i]){let r=t.getSetting("rowHeaders"),o=r.length,s=this.getRenderedColumnsCount();for(let t=0;t<n;t++)for(let t=-1*o;t<s;t++)this.markIfOversizedColumnHeader(t);e.hasOversizedColumnHeadersMarked[i]=!0}}}(0,tM.jB)(t5,tz),(0,tM.jB)(t5,tk);var t8=i(40746);function t9(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class t3{constructor(t){t9(this,"count",0),t9(this,"startRow",0),t9(this,"endRow",0),t9(this,"startPosition",0),this.count=t.totalRows,this.endRow=this.count-1}}var t7=i(3391);function t6(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class et{constructor(t){t6(this,"count",0),t6(this,"startColumn",0),t6(this,"endColumn",0),t6(this,"startPosition",0),this.count=t.totalColumns,this.endColumn=this.count-1}}var ee=i(27431),ei=class{constructor(t,e,i,r,n){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=i,this.wtTable=n,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer,i=0;if(e===this.domBindings.rootWindow)i=t.documentElement.clientHeight;else{let t=(0,r.Pb)(e);i=t>0&&e.clientHeight>0?e.clientHeight:1/0}return i}getWorkspaceWidth(){let t,e;let{wtSettings:i}=this,{rootDocument:n,rootWindow:o}=this.domBindings,s=this.dataAccessObject.inlineStartOverlayTrimmingContainer,l=n.documentElement.offsetWidth,a=i.getSetting("totalColumns"),h=i.getSetting("preventOverflow"),u=i.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),d=u?c.right-l:c.left,g=l-d;if(h)return(0,r.iO)(this.wtTable.wtRootElement);if(t=i.getSetting("freezeOverlays")?Math.min(g,l):Math.min(this.getContainerFillWidth(),g,l),s===o&&a>0&&this.sumColumnWidths(0,a-1)>t)return n.documentElement.clientWidth;if(s!==o&&("scroll"===(e=(0,r.C2)(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",o))||"hidden"===e||"auto"===e))return Math.max(t,s.clientWidth);let f=i.getSetting("stretchH");return"none"!==f&&f?t:Math.max(t,(0,r.iO)(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(t,e){let i=0,r=t;for(;r<e;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;let t=this.wtTable.holder,e=this.domBindings.rootDocument.createElement("div");e.style.width="100%",e.style.height="1px",t.appendChild(e);let i=e.offsetWidth;return this.containerWidth=i,t.removeChild(e),i}getWorkspaceOffset(){return(0,r.cv)(this.wtTable.TABLE)}getColumnHeaderHeight(){let t=this.wtSettings.getSetting("columnHeaders");return t.length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,r.Pb)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;let e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getRowHeaderWidth(){let t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let i=0,r=e.length;i<r;i++)this.rowHeaderWidth+=t[i]||t}if(isNaN(this.rowHeaderWidth)){if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,n=e.length;i<n;i++)t?(this.rowHeaderWidth+=(0,r.iO)(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){let t=this.getWorkspaceWidth();if(t===1/0)return t;let e=this.getRowHeaderWidth();return e>0?t-e:t}createRowsCalculator(){let t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t8.Ii,{wtSettings:n,wtTable:o}=this;if(n.getSetting("renderAllRows")&&i===t8.Ii)return new t3({totalRows:n.getSetting("totalRows")});let s=this.getViewportHeight();this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,a=n.getSetting("fixedRowsTop"),h=n.getSetting("fixedRowsBottom"),u=n.getSetting("totalRows");return a&&l>=0&&(l+=e=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s-=e),h&&this.dataAccessObject.bottomOverlay.clone&&(s-=e=this.dataAccessObject.bottomOverlay.sumCellSizes(u-h,u)),t=o.holder.clientHeight===o.holder.offsetHeight?0:(0,r.np)(this.domBindings.rootDocument),new t7.U({viewportHeight:s,scrollOffset:l,totalRows:n.getSetting("totalRows"),rowHeightFn:t=>o.getRowHeight(t),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:i,horizontalScrollbarHeight:t})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t8.Ii,{wtSettings:e,wtTable:i}=this;if(e.getSetting("renderAllColumns")&&t===t8.Ii)return new et({totalColumns:e.getSetting("totalColumns")});let n=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let s=e.getSetting("fixedColumnsStart");if(s&&o>=0){let t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=t,n-=t}return i.holder.clientWidth!==i.holder.offsetWidth&&(n-=(0,r.np)(this.domBindings.rootDocument)),new ee.E({viewportWidth:n,scrollOffset:o,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>i.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),calculationType:t,inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:e}=this;if(t&&!e.getSetting("renderAllRows")){let e=this.createRowsCalculator(t8.vp);t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){let e=this.createColumnsCalculator(t8.vp);t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(t8.Ii),this.columnsRenderCalculator=this.createColumnsCalculator(t8.Ii)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(t8.vp),this.columnsVisibleCalculator=this.createColumnsCalculator(t8.vp)}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;let{startRow:e,endRow:i,isVisibleInTrimmingContainer:r}=t;if(null===e&&null===i)return!r;let{startRow:n,endRow:o}=this.rowsRenderCalculator;return!(e<n)&&(e!==n||!(e>0))&&!(i>o||i===o&&i<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;let{startColumn:e,endColumn:i,isVisibleInTrimmingContainer:r}=t;if(null===e&&null===i)return!r;let{startColumn:n,endColumn:o}=this.columnsRenderCalculator;return!(e<n)&&(e!==n||!(e>0))&&!(i>o||i===o&&i<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){(0,tM._l)(this.hasOversizedColumnHeadersMarked,(t,e,i)=>{i[e]=void 0})}};function er(t,e,i){en(t,e),e.set(t,i)}function en(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function eo(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function es(t,e){var i=ea(t,e,"get");return i.get?i.get.call(t):i.value}function el(t,e,i){var r=ea(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function ea(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}i(21767);var eh=new WeakMap,eu=new WeakMap,ec=new WeakSet;class ed{constructor(){en(this,ec),ec.add(this),er(this,eh,{writable:!0,value:void 0}),er(this,eu,{writable:!0,value:void 0})}setActiveOverlay(t){return el(this,eu,t),this}setActiveSelection(t){return el(this,eh,t),this}scan(){let t=es(this,eh).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"area"===t?this.scanCellsRange(t=>e.add(t)):"focus"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t)),this.scanCellsRange(t=>e.add(t))):"fill"===t?this.scanCellsRange(t=>e.add(t)):"header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"row"===t?(this.scanRowsInHeadersRange(t=>e.add(t)),this.scanRowsInCellsRange(t=>e.add(t))):"column"===t&&(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanColumnsInCellsRange(t=>e.add(t))),e}scanColumnsInHeadersRange(t){let[e,i,r,n]=es(this,eh).getCorners(),{wtTable:o}=es(this,eu),s=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount(),a=0;for(let h=-o.getRowHeadersCount();h<s;h++){let s=o.columnFilter.renderedToSource(h);if(!(s<i)&&!(s>n)){for(let h=-l;h<0;h++){if(h<e||h>r)continue;let u=h+l,c=o.getColumnHeader(s,u),d=es(this,eu).getSetting("onBeforeHighlightingColumnHeader",s,u,{selectionType:es(this,eh).settings.selectionType,columnCursor:a,selectionWidth:n-i+1});null!==d&&(d!==s&&(c=o.getColumnHeader(d,u)),t(c))}a+=1}}}scanRowsInHeadersRange(t){let[e,i,r,n]=es(this,eh).getCorners(),{wtTable:o}=es(this,eu),s=o.getRenderedRowsCount(),l=o.getRowHeadersCount(),a=0;for(let h=-o.getColumnHeadersCount();h<s;h++){let s=o.rowFilter.renderedToSource(h);if(!(s<e)&&!(s>r)){for(let h=-l;h<0;h++){if(h<i||h>n)continue;let u=h+l,c=o.getRowHeader(s,u),d=es(this,eu).getSetting("onBeforeHighlightingRowHeader",s,u,{selectionType:es(this,eh).settings.selectionType,rowCursor:a,selectionHeight:r-e+1});null!==d&&(d!==s&&(c=o.getRowHeader(d,u)),t(c))}a+=1}}}scanCellsRange(t){let[e,i,n,o]=es(this,eh).getCorners(),{wtTable:s}=es(this,eu);eo(this,ec,eg).call(this,(l,a)=>{if(l>=e&&l<=n&&a>=i&&a<=o){let e=s.getCell(es(this,eu).createCellCoords(l,a)),i=es(this,eu).getSetting("onAfterDrawSelection",l,a,es(this,eh).settings.layerLevel);"string"==typeof i&&(0,r.cn)(e,i),t(e)}})}scanRowsInCellsRange(t){let[e,,i]=es(this,eh).getCorners(),{wtTable:r}=es(this,eu);eo(this,ec,eg).call(this,(n,o)=>{if(n>=e&&n<=i){let e=r.getCell(es(this,eu).createCellCoords(n,o));t(e)}})}scanColumnsInCellsRange(t){let[,e,,i]=es(this,eh).getCorners(),{wtTable:r}=es(this,eu);eo(this,ec,eg).call(this,(n,o)=>{if(o>=e&&o<=i){let e=r.getCell(es(this,eu).createCellCoords(n,o));t(e)}})}}function eg(t){let{wtTable:e}=es(this,eu),i=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let n=0;n<i;n+=1){let i=e.rowFilter.renderedToSource(n);for(let n=0;n<r;n+=1)t(i,e.columnFilter.renderedToSource(n))}}var ef=class{constructor(t,e){if(!e)return;this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=tV,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners()}registerListeners(){let t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp());for(let t=0,e=this.main.childNodes.length;t<e;t++){let e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",e=>this.onMouseEnter(e,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),(0,o.mM)(t);let i=this,r=this.wot.rootDocument.body,n=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(r,"mousemove",function t(o){(function(t){if(t.clientY<Math.floor(n.top)||t.clientY>Math.ceil(n.top+n.height)||t.clientX<Math.floor(n.left)||t.clientX>Math.ceil(n.left+n.width))return!0})(o)&&(i.eventManager.removeEventListener(r,"mousemove",t),e.style.display="block")})}createBorders(t){let{rootDocument:e}=this.wot;this.main=e.createElement("div");let i=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let n=0;n<5;n++){let o=i[n],s=e.createElement("div");s.className=`wtBorder ${this.settings.className||""}`,this.settings[o]&&this.settings[o].hide&&(s.className+=" hidden"),(r=s.style).backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:t.border.color,r.height=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${t.border.width}px`,r.width=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${t.border.width}px`,this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,a.K1)()&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:n}=this.wot,o=n.bordersHolder;o||((o=e.createElement("div")).className="htBorders",n.bordersHolder=o,n.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:t}=this.wot;this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let e={position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`};(0,tM._l)(e,(t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t});let i={position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};(0,tM._l)(i,(t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){let i=this.wot.selectionManager.getAreaSelection();return!!i.cellRange&&(t!==i.cellRange.to.row||e!==i.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,i,r,n,o){let s=this.wot.wtSettings.getSetting("rtlMode"),l=s?"right":"left",{top:a,topHitArea:h,bottom:u,bottomHitArea:c}=this.selectionHandles.styles,d=parseInt(a.borderWidth,10),g=parseInt(a.width,10),f=parseInt(h.width,10),p=this.wot.wtTable.getWidth(),m=this.wot.wtTable.getHeight();a.top=`${parseInt(i-g-1,10)}px`,a[l]=`${parseInt(r-g-1,10)}px`,h.top=`${parseInt(i-f/4*3,10)}px`,h[l]=`${parseInt(r-f/4*3,10)}px`;let w=Math.min(parseInt(r+n,10),p-g-2*d),b=Math.min(parseInt(r+n-f/4,10),p-f-2*d);u[l]=`${w}px`,c[l]=`${b}px`;let y=Math.min(parseInt(i+o,10),m-g-2*d),C=Math.min(parseInt(i+o-f/4,10),m-f-2*d);u.top=`${y}px`,c.top=`${C}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(a.display="block",h.display="block",this.isPartRange(t,e)?(u.display="none",c.display="none"):(u.display="block",c.display="block")):(a.display="none",u.display="none",h.display="none",c.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(a.zIndex="9999",h.zIndex="9999"):(a.zIndex="",h.zIndex="")}appear(t){let e,i,n,o,s,l;if(this.disabled)return;let{wtTable:h,rootDocument:u,rootWindow:c}=this.wot,d=h.getRenderedRowsCount();for(let i=0;i<d;i+=1){let r=h.rowFilter.renderedToSource(i);if(r>=t[0]&&r<=t[2]){e=r,s=t[0];break}}for(let e=d-1;e>=0;e-=1){let r=h.rowFilter.renderedToSource(e);if(r>=t[0]&&r<=t[2]){i=r;break}}let g=h.getRenderedColumnsCount();for(let e=0;e<g;e+=1){let i=h.columnFilter.renderedToSource(e);if(i>=t[1]&&i<=t[3]){n=i,l=t[1];break}}for(let e=g-1;e>=0;e-=1){let i=h.columnFilter.renderedToSource(e);if(i>=t[1]&&i<=t[3]){o=i;break}}if(void 0===e||void 0===n){this.disappear();return}let f=h.getCell(this.wot.createCellCoords(e,n)),p=e!==i||n!==o,m=p?h.getCell(this.wot.createCellCoords(i,o)):f,w=(0,r.cv)(f),b=p?(0,r.cv)(m):w,y=(0,r.cv)(h.TABLE),C=(0,r.iO)(h.TABLE),S=w.top,E=w.left,R=this.wot.wtSettings.getSetting("rtlMode"),T=0,M=0;if(R){let t=(0,r.iO)(f),e=c.innerWidth-y.left-C;M=E+t-b.left,T=c.innerWidth-E-t-e-1}else M=b.left+(0,r.iO)(m)-E,T=E-y.left-1;if(this.isEntireColumnSelected(e,i)){let t=this.getDimensionsFromHeader("columns",n,o,s,y),e=null;t&&([e,T,M]=t),e&&(f=e)}let O=S-y.top-1,k=b.top+(0,r.Pb)(m)-S;if(this.isEntireRowSelected(n,o)){let t=this.getDimensionsFromHeader("rows",e,i,l,y),r=null;t&&([r,O,k]=t),r&&(f=r)}let x=(0,r.Dx)(f,c);parseInt(x.borderTopWidth,10)>0&&(O+=1,k=k>0?k-1:0),parseInt(x[R?"borderRightWidth":"borderLeftWidth"],10)>0&&(T+=1,M=M>0?M-1:0);let I=R?"right":"left";this.topStyle.top=`${O}px`,this.topStyle[I]=`${T}px`,this.topStyle.width=`${M}px`,this.topStyle.display="block",this.startStyle.top=`${O}px`,this.startStyle[I]=`${T}px`,this.startStyle.height=`${k}px`,this.startStyle.display="block";let A=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${O+k-A}px`,this.bottomStyle[I]=`${T}px`,this.bottomStyle.width=`${M}px`,this.bottomStyle.display="block",this.endStyle.top=`${O}px`,this.endStyle[I]=`${T+M-A}px`,this.endStyle.height=`${k+1}px`,this.endStyle.display="block";let N=this.settings.border.cornerVisible;N="function"==typeof N?N(this.settings.layerLevel):N;let H=this.wot.getSetting("onModifyGetCellCoords",i,o),[_,P]=[i,o];if(H&&Array.isArray(H)&&([,,_,P]=H),(0,a.K1)()||!N||this.isPartRange(_,P))this.cornerStyle.display="none";else{this.cornerStyle.top=`${O+k+this.cornerCenterPointOffset-1}px`,this.cornerStyle[I]=`${T+M+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=(0,r.$g)(h.TABLE),e=t===c;e&&(t=u.documentElement);let n=parseInt(this.cornerDefaultStyle.width,10)/2,s=parseInt(this.cornerDefaultStyle.height,10)/2;if(o===this.wot.getSetting("totalColumns")-1){let i=e?m.getBoundingClientRect().left:m.offsetLeft;(R?i-parseInt(this.cornerDefaultStyle.width,10)/2<0:i+(0,r.iO)(m)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,r.x9)(t))&&(this.cornerStyle[I]=`${Math.floor(T+M+this.cornerCenterPointOffset-n)}px`,this.cornerStyle[R?"borderLeftWidth":"borderRightWidth"]=0)}if(i===this.wot.getSetting("totalRows")-1){let i=e?m.getBoundingClientRect().top:m.offsetTop,n=i+(0,r.Pb)(m)+parseInt(this.cornerDefaultStyle.height,10)/2,o=n>=(0,r.WS)(t);o&&(this.cornerStyle.top=`${Math.floor(O+k+this.cornerCenterPointOffset-s)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}(0,a.K1)()&&this.updateMultipleSelectionHandlesPosition(i,o,O,T,M,k)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,i,n,o){let{wtTable:s}=this.wot,l=s.wtRootElement.parentNode,a=null,h=null,u=null,c=null,d=null,g=null,f=null,p=null;switch(t){case"rows":a=function(){return s.getRowHeader(...arguments)},h=function(){return(0,r.Pb)(...arguments)},u="ht__selection--rows",g="top";break;case"columns":a=function(){return s.getColumnHeader(...arguments)},h=function(){return(0,r.iO)(...arguments)},u="ht__selection--columns",g="left"}if(l.classList.contains(u)){let t=this.wot.getSetting("columnHeaders").length;if(f=a(e,t-n),p=a(i,t-n),!f||!p)return!1;let s=(0,r.cv)(f),l=(0,r.cv)(p);return f&&p&&(c=s[g]-o[g]-1,d=l[g]+h(p)-s[g]),[f,c,d]}return!1}changeBorderStyle(t,e){let i=this[t].style,n=e[t];!n||n.hide?(0,r.cn)(this[t],"hidden"):((0,r.pv)(this[t],"hidden")&&(0,r.IV)(this[t],"hidden"),i.backgroundColor=n.color,("top"===t||"bottom"===t)&&(i.height=`${n.width}px`),("start"===t||"end"===t)&&(i.width=`${n.width}px`))}changeBorderToDefaultStyle(t){let e={width:1,color:"#000"},i=this[t].style;i.backgroundColor=e.color,i.width=`${e.width}px`,i.height=`${e.width}px`}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?(0,r.cn)(this[t],"hidden"):(0,r.IV)(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,a.K1)()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function ep(t,e,i){em(t,e),e.set(t,i)}function em(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ew(t,e){var i=eb(t,e,"get");return i.get?i.get.call(t):i.value}function ev(t,e,i){var r=eb(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function eb(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var ey=new WeakMap,eC=new WeakMap,eS=new WeakMap,eE=new WeakMap,eR=new WeakMap,eT=new WeakMap,eM=new WeakSet;class eO{constructor(t){em(this,eM),eM.add(this),ep(this,ey,{writable:!0,value:void 0}),ep(this,eC,{writable:!0,value:void 0}),ep(this,eS,{writable:!0,value:new ed}),ep(this,eE,{writable:!0,value:new WeakMap}),ep(this,eR,{writable:!0,value:new WeakSet}),ep(this,eT,{writable:!0,value:new Map}),ev(this,eC,t)}setActiveOverlay(t){return ev(this,ey,t),ew(this,eS).setActiveOverlay(ew(this,ey)),ew(this,eE).has(ew(this,ey))||ew(this,eE).set(ew(this,ey),new Set),this}getFocusSelection(){return null!==ew(this,eC)?ew(this,eC).getFocus():null}getAreaSelection(){return null!==ew(this,eC)?ew(this,eC).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(ew(this,eT).has(t)){let e=ew(this,eT).get(t);if(e.has(ew(this,ey)))return e.get(ew(this,ey));let i=new ef(ew(this,ey),t.settings);return e.set(ew(this,ey),i),i}let e=new ef(ew(this,ey),t.settings);return ew(this,eT).set(t,new Map([[ew(this,ey),e]])),e}getBorderInstances(t){var e,i;return Array.from(null!==(e=null===(i=ew(this,eT).get(t))||void 0===i?void 0:i.values())&&void 0!==e?e:[])}destroyBorders(t){ew(this,eT).get(t).forEach(t=>t.destroy()),ew(this,eT).delete(t)}render(t){if(null===ew(this,eC))return;t&&(function(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i})(this,eM,ek).call(this);let e=Array.from(ew(this,eC)),i=new Map,n=new Map;for(let t=0;t<e.length;t++){let r=e[t],{className:o,headerAttributes:s,createLayers:l,selectionType:a}=r.settings;ew(this,eR).has(r)||(ew(this,eR).add(r),r.addLocalHook("destroy",()=>this.destroyBorders(r)));let h=this.getBorderInstance(r);if(r.isEmpty()){null==h||h.disappear();continue}if(o){let t=ew(this,eS).setActiveSelection(r).scan();t.forEach(t=>{if(i.has(t)){let e=i.get(t);e.has(o)&&!0===l?e.set(o,e.get(o)+1):e.set(o,1)}else i.set(t,new Map([[o,1]]));s&&(n.has(t)||n.set(t,[]),"TH"===t.nodeName&&n.get(t).push(...s))})}let u=r.getCorners();ew(this,ey).getSetting("onBeforeDrawBorders",u,a),null==h||h.appear(u)}i.forEach((t,e)=>{var i;let n=Array.from(t).map(t=>{let[e,i]=t;return 1===i?e:[e,...Array.from({length:i-1},(t,i)=>`${e}-${i+1}`)]}).flat();n.forEach(t=>ew(this,eE).get(ew(this,ey)).add(t)),(0,r.cn)(e,n),"TD"===e.nodeName&&Array.isArray(null===(i=ew(this,eC).options)||void 0===i?void 0:i.cellAttributes)&&(0,r.P$)(e,ew(this,eC).options.cellAttributes)}),Array.from(n.keys()).forEach(t=>{(0,r.P$)(t,[...n.get(t)])})}}function ek(){let t=ew(this,eE).get(ew(this,ey)),e=ew(this,ey).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let i=0;i<e.length;i++)t.add(e[i]);t.forEach(t=>{var e,i;let n=ew(this,ey).wtTable.TABLE.querySelectorAll(`.${t}`),o=[];Array.isArray(null===(e=ew(this,eC).options)||void 0===e?void 0:e.cellAttributes)&&(o=ew(this,eC).options.cellAttributes.map(t=>t[0])),Array.isArray(null===(i=ew(this,eC).options)||void 0===i?void 0:i.headerAttributes)&&(o=[...o,...ew(this,eC).options.headerAttributes.map(t=>t[0])]);for(let e=0,i=n.length;e<i;e++)(0,r.IV)(n[e],t),(0,r.d$)(n[e],o)}),t.clear()}class ex extends tD{constructor(t,e){super(t,new t4(e));let i=this.wtSettings.getSetting("facade",this);this.wtTable=new t5(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new ei(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new eO(this.wtSettings.getSetting("selections")),this.wtEvent=new T(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new t1(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let t=[],e=[];(0,tM._l)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(i,r)=>{this.wtSettings.getSetting(r).length&&e.push(i),t.push(i)}),(0,r.IV)(this.wtTable.wtRootElement.parentNode,t),(0,r.cn)(this.wtTable.wtRootElement.parentNode,e)}getViewportDao(){let t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class eI{constructor(t){t instanceof tD?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{let e=new eI(t);return()=>e},this._wot=new ex(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,i){return this._wot.createCellRange(t,e,i)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,i,r,n){return this._wot.scrollViewport(t,e,i,r,n)}scrollViewportHorizontally(t,e,i){return this._wot.scrollViewportHorizontally(t,e,i)}scrollViewportVertically(t,e,i){return this._wot.scrollViewportVertically(t,e,i)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,i,r,n){return this._wot.wtSettings.getSetting(t,e,i,r,n)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function eA(t){let{isShiftKey:e,isLeftClick:i,isRightClick:r,coords:n,selection:o,controller:s,cellCoordsFactory:l}=t,a=o.isSelected()?o.getSelectedRange().current():null,h=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(e&&a)n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(n):(h||u)&&n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(l(n.row,n.col)):h&&n.row<0&&!s.column?o.setRangeEnd(l(a.to.row,n.col)):u&&n.col<0&&!s.row?o.setRangeEnd(l(n.row,a.to.col)):(!h&&!u&&n.col<0||h&&n.col<0)&&!s.row?o.selectRows(Math.max(a.from.row,0),n.row,n.col):(!h&&!u&&n.row<0||u&&n.row<0)&&!s.column&&o.selectColumns(Math.max(a.from.col,0),n.col,n.row);else{let t=!o.inInSelection(n),e=i||r&&t;n.row<0&&n.col>=0&&!s.column?e&&o.selectColumns(n.col,n.col,n.row):n.col<0&&n.row>=0&&!s.row?e&&o.selectRows(n.row,n.row,n.col):n.col>=0&&n.row>=0&&!s.cell?e&&o.setRangeStart(n):n.col<0&&n.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}let eN=new Map([["mousedown",eA],["mouseover",function(t){let{isLeftClick:e,coords:i,selection:r,controller:n,cellCoordsFactory:o}=t;if(!e)return;let s=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),a=r.tableProps.countCols(),h=r.tableProps.countRows();l&&!n.column?r.setRangeEnd(o(h-1,i.col)):s&&!n.row?r.setRangeEnd(o(i.row,a-1)):n.cell||r.setRangeEnd(i)}],["touchstart",eA]]);function eH(t,e){let{coords:i,selection:r,controller:n,cellCoordsFactory:s}=e;eN.get(t.type)({coords:i,selection:r,controller:n,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:(0,o.pW)(t)||"touchstart"===t.type,isRightClick:(0,o.dO)(t)})}var e_=i(3732);function eP(t,e){eL(t,e),e.add(t)}function eD(t,e,i){eL(t,e),e.set(t,i)}function eL(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function eB(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function eW(t,e,i){if(!e.has(t))throw TypeError("attempted to get private field on non-instance");return i}function eV(t,e){var i=ej(t,e,"get");return i.get?i.get.call(t):i.value}function eF(t,e,i){var r=ej(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function ej(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var eU=new WeakMap,e$=new WeakMap,ez=new WeakMap,eK=new WeakMap,eG=new WeakMap,eY=new WeakMap,eX=new WeakMap,eq=new WeakSet,eZ=new WeakSet;function eJ(){return parseInt(this.hot.rootElement.getAttribute((0,j.Wv)()[0]),10)}function eQ(t){let e=eW(this,eq,eJ).call(this)+t;(0,r.P$)(this.hot.rootElement,...(0,j.Wv)(e))}var e0=class{constructor(t){eP(this,eZ),eP(this,eq),eB(this,"hot",void 0),eB(this,"eventManager",void 0),eB(this,"settings",void 0),eB(this,"THEAD",void 0),eB(this,"TBODY",void 0),eB(this,"_wt",void 0),eB(this,"activeWt",void 0),eD(this,eU,{writable:!0,value:0}),eD(this,e$,{writable:!0,value:0}),eB(this,"postponedAdjustElementsSize",!1),eD(this,ez,{writable:!0,value:!1}),eD(this,eK,{writable:!0,value:void 0}),eD(this,eG,{writable:!0,value:void 0}),eD(this,eY,{writable:!0,value:0}),eD(this,eX,{writable:!0,value:0}),this.hot=t,this.eventManager=new n.Z(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(t)}getCellAtCoords(t,e){let i=this._wt.getCell(t,e);return i<0?null:i}scrollViewport(t,e,i,r,n){return this._wt.scrollViewport(t,e,i,r,n)}scrollViewportHorizontally(t,e,i){return this._wt.scrollViewportHorizontally(t,e,i)}scrollViewportVertically(t,e,i){return this._wt.scrollViewportVertically(t,e,i)}createElements(){let{rootElement:t,rootDocument:e}=this.hot,i=t.getAttribute("style");i&&t.setAttribute("data-originalstyle",i),(0,r.cn)(t,"handsontable"),eF(this,eG,e.createElement("TABLE")),(0,r.cn)(eV(this,eG),"htCore"),this.hot.getSettings().tableClassName&&(0,r.cn)(eV(this,eG),this.hot.getSettings().tableClassName),this.settings.ariaTags&&((0,r.P$)(eV(this,eG),[(0,j.Rn)()]),(0,r.P$)(t,[(0,j.nO)(),(0,j.a2)(-1),(0,j.Wv)(this.hot.countCols()),(0,j.qt)()])),this.THEAD=e.createElement("THEAD"),eV(this,eG).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),eV(this,eG).appendChild(this.TBODY),this.hot.table=eV(this,eG),this.hot.container.insertBefore(eV(this,eG),this.hot.container.firstChild)}registerEvents(){let{rootElement:t,rootDocument:e,selection:i}=this.hot,n=e.documentElement;this.eventManager.addEventListener(t,"mousedown",t=>{if(eF(this,ez,!0),!this.isTextSelectionAllowed(t.target)){let{rootWindow:e}=this.hot;(0,r.a7)(e),t.preventDefault(),e.focus()}}),this.eventManager.addEventListener(t,"mouseup",()=>{eF(this,ez,!1)}),this.eventManager.addEventListener(t,"mousemove",t=>{eV(this,ez)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&(0,r.a7)(this.hot.rootWindow),t.preventDefault())}),this.eventManager.addEventListener(n,"keyup",t=>{i.isInProgress()&&!t.shiftKey&&i.finish()}),this.eventManager.addEventListener(n,"mouseup",n=>{i.isInProgress()&&(0,o.pW)(n)&&i.finish(),eF(this,eK,!1);let s=(0,r.pV)(e.activeElement);(!(0,r.u7)(e.activeElement)||s)&&(!s&&(i.isSelected()||i.isSelectedByAnyHeader()||t.contains(n.target)||(0,o.dO)(n))||this.hot.unlisten())}),this.eventManager.addEventListener(n,"contextmenu",t=>{i.isInProgress()&&(0,o.dO)(t)&&(i.finish(),eF(this,eK,!1))}),this.eventManager.addEventListener(n,"touchend",()=>{i.isInProgress()&&i.finish(),eF(this,eK,!1)}),this.eventManager.addEventListener(n,"mousedown",i=>{let o=i.target,s=i.x||i.clientX,l=i.y||i.clientY,a=i.target;if(eV(this,eK)||!t||!this.hot.view)return;let{holder:h}=this.hot.view._wt.wtTable;if(a===h){let t=(0,r.np)(e);if(e.elementFromPoint(s+t,l)!==h||e.elementFromPoint(s,l+t)!==h)return}else for(;a!==n;){if(null===a){if(i.isTargetWebComponent)break;return}if(a===t)return;a=a.parentNode}let u="function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(o):this.settings.outsideClickDeselects;u?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(eV(this,eG),"selectstart",t=>{this.settings.fragmentSelection||(0,r.u7)(t.target)||t.preventDefault()})}translateFromRenderableToVisualCoords(t){let{row:e,col:i}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,i))}translateFromRenderableToVisualIndex(t,e){let i=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,r=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===i&&(i=t),null===r&&(r=e),[i,r]}countRenderableIndexes(t,e){let i=Math.min(t.getNotTrimmedIndexesLength(),e),r=t.getNearestNotHiddenIndex(i-1,-1);return null===r?0:t.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,i,r){if(isNaN(t)||t<0)return 0;let n=i.getNearestNotHiddenIndex(t,e),o=i.getRenderableFromVisualIndex(n);if(!Number.isInteger(o))return 0;let s=0;return e<0?s=o+1:e>0&&(s=r-o),s}countNotHiddenFixedColumnsStart(){let t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){let t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){let t=this.hot.countRows(),e=Math.max(t-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(t,e){let i=0;for(let r=t;r<=e;r++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)&&(i+=1);return i}countRenderableRowsInRange(t,e){let i=0;for(let r=t;r<=e;r++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)&&(i+=1);return i}isMainTableNotFullyCoveredByOverlays(){let t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){let t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:eV(this,eG),isDataViewInstance:()=>(0,e_._v)(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{let t=[];return this.hot.hasRowHeaders()&&t.push((t,e)=>{let i=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(i,e)}),this.hot.runHooks("afterGetRowHeaderRenderers",t),eF(this,e$,t.length),this.hot.getSettings().ariaTags&&eW(this,eq,eJ).call(this)===this.hot.countCols()&&eW(this,eZ,eQ).call(this,eV(this,e$)),t},columnHeaders:()=>{let t=[];return this.hot.hasColHeaders()&&t.push((t,e)=>{let i=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(i,e)}),this.hot.runHooks("afterGetColumnHeaderRenderers",t),eF(this,eU,t.length),t},columnWidth:t=>{let e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{let e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},cellRenderer:(t,e,i)=>{let[r,n]=this.translateFromRenderableToVisualIndex(t,e),o=this.hot.runHooks("modifyGetCellCoords",r,n),s=r,l=n;Array.isArray(o)&&([s,l]=o);let a=this.hot.getCellMeta(s,l),h=this.hot.colToProp(l),u=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(u=this.hot.runHooks("beforeValueRender",u,a)),this.hot.runHooks("beforeRenderer",i,r,n,h,u,a),this.hot.getCellRenderer(a)(this.hot,i,r,n,h,u,a),this.hot.runHooks("afterRenderer",i,r,n,h,u,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&(0,r.pn)(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e),s={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=r,eF(this,eK,!0),this.hot.runHooks("beforeOnCellMouseDown",t,n,i,s),(0,o.Ty)(t)||(eH(t,{coords:n,selection:this.hot.selection,controller:s,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,n,i),this.activeWt=this._wt)},onCellContextMenu:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,eF(this,eK,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,n,i),(0,o.Ty)(t)||(this.hot.runHooks("afterOnCellContextMenu",t,n,i),this.activeWt=this._wt)},onCellMouseOut:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOut",t,n,i),(0,o.Ty)(t)||(this.hot.runHooks("afterOnCellMouseOut",t,n,i),this.activeWt=this._wt)},onCellMouseOver:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e),s={row:!1,column:!1,cell:!1};this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOver",t,n,i,s),(0,o.Ty)(t)||(eV(this,eK)&&eH(t,{coords:n,selection:this.hot.selection,controller:s,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,n,i),this.activeWt=this._wt)},onCellMouseUp:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseUp",t,n,i),(0,o.Ty)(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,n,i),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:t=>{let e=this.hot.rowIndexMapper,i=t<0,r=t;return i||null!==(r=e.getVisualFromRenderableIndex(t))?(r=this.hot.runHooks("beforeViewportScrollVertically",r),this.hot.runHooks("beforeViewportScroll"),i)?r:e.getRenderableFromVisualIndex(r):t},onBeforeViewportScrollHorizontally:t=>{let e=this.hot.columnIndexMapper,i=t<0,r=t;return i||null!==(r=e.getVisualFromRenderableIndex(t))?(r=this.hot.runHooks("beforeViewportScrollHorizontally",r),this.hot.runHooks("beforeViewportScroll"),i)?r:e.getRenderableFromVisualIndex(r):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,i)=>{let r=this.hot.rowIndexMapper,n=t<0,o=t;n||(o=r.getVisualFromRenderableIndex(t));let s=this.hot.runHooks("beforeHighlightingRowHeader",o,e,i);return n?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,i)=>{let r=this.hot.columnIndexMapper,n=t<0,o=t;n||(o=r.getVisualFromRenderableIndex(t));let s=this.hot.runHooks("beforeHighlightingColumnHeader",o,e,i);return n?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,i)=>{let r;let[n,o]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange(),l=s.size();if(l>0){let t=s.peekByIndex(null!=i?i:0);r=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",n,o,r,i)},onBeforeDrawBorders:(t,e)=>{let[i,r,n,o]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(t,e)=>{let i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.runHooks("beforeStretchingColumnWidth",t,i)},onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,i)=>{let r=this.hot.rowIndexMapper,n=this.hot.columnIndexMapper,o=e>=0?n.getVisualFromRenderableIndex(e):e,s=t>=0?r.getVisualFromRenderableIndex(t):t,l=this.hot.runHooks("modifyGetCellCoords",s,o,i);if(Array.isArray(l)){let[t,e,i,o]=l;return[t>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,1)):t,e>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1)):e,i>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i,-1)):i,o>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1)):o]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){let i=this.countRenderableRows(),r=t.startRow,n=t.endRow;if("number"==typeof e)t.startRow=Math.max(r-e,0),t.endRow=Math.min(n+e,i-1);else if("auto"===e){let e=Math.ceil(n/i*12);t.startRow=Math.max(r-e,0),t.endRow=Math.min(n+e,i-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){let i=this.countRenderableColumns(),r=t.startColumn,n=t.endColumn;if("number"==typeof e&&(t.startColumn=Math.max(r-e,0),t.endColumn=Math.min(n+e,i-1)),"auto"===e){let e=Math.ceil(n/i*6);t.startColumn=Math.max(r-e,0),t.endColumn=Math.min(n+e,i-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new eI(t),this.activeWt=this._wt;let e=this._wt.wtTable.spreader,{width:i,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,n),this.eventManager.addEventListener(e,"mousedown",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(e,"contextmenu",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(t){if((0,r.u7)(t))return!0;let e=(0,r.MO)(t,this.hot.view._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&e||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&e||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return eV(this,eK)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){let t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){let i=e.firstChild;if(!(0,r.pv)(i,"relative")){(0,r.cS)(e),this.appendRowHeader(t,e);return}this.updateCellHeader(i.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{let{rootDocument:i,getRowHeader:r}=this.hot,n=i.createElement("div"),o=i.createElement("span");n.className="relative",o.className="rowHeader",this.updateCellHeader(o,t,r),n.appendChild(o),e.appendChild(n)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e.firstChild){let o=e.firstChild;(0,r.pv)(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),t,i,n):((0,r.cS)(e),this.appendColHeader(t,e,i,n))}else{let{rootDocument:o}=this.hot,s=o.createElement("div"),l=o.createElement("span");s.className="relative",l.className="colHeader",this.settings.ariaTags&&((0,r.P$)(s,...(0,j.Rn)()),(0,r.P$)(l,...(0,j.Rn)())),this.updateCellHeader(l,t,i,n),s.appendChild(l),e.appendChild(s)}this.hot.runHooks("afterGetColHeader",t,e,n)}updateCellHeader(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e,s=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&((0,r.pv)(t,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(e):(0,r.pv)(t,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(e))),o>-1?(0,r.uS)(t,i(e,n)):((0,r.tT)(t,String.fromCharCode(160)),(0,r.cn)(t,"cornerHeader"))}maximumVisibleElementWidth(t){let e=this._wt.wtViewport.getWorkspaceWidth(),i=e-t;return i>0?i:0}maximumVisibleElementHeight(t){let e=this._wt.wtViewport.getWorkspaceHeight(),i=e-t;return i>0?i:0}setLastSize(t,e){eF(this,eY,t),eF(this,eX,e)}getLastSize(){return{width:eV(this,eY),height:eV(this,eX)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return eV(this,eU)}getRowHeadersCount(){return eV(this,e$)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}},26769:function(t,e,i){"use strict";i.d(e,{d:function(){return P}}),i(57855);var r=i(99440),n=i(42457),o=i(27392),s=i(16301),l=i(537),a=i(45843),h=i(96592);let u=new Map([["hiding",o.o],["index",s.n],["linkedPhysicalIndexToValue",l.A],["physicalIndexToValue",a.L],["trimming",h.n]]);var c=i(97362);i(58563);var d=i(2518),g=i(69488),f=i(63437);let p=0;class m{constructor(){var t,e,i;t="collection",e=new Map,(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",()=>this.runLocalHooks("change",e)),p+=1)}unregister(t){let e=this.collection.get(t);(0,d.$K)(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),p-=1)}unregisterAll(){this.collection.forEach((t,e)=>this.unregister(e)),this.collection.clear()}get(t){return(0,d.o8)(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach(e=>{e.remove(t)})}insertToEvery(t,e){this.collection.forEach(i=>{i.insert(t,e)})}initEvery(t){this.collection.forEach(e=>{e.init(t)})}}function w(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,g.jB)(m,f.Z);class b extends m{constructor(t,e){super(),w(this,"mergedValuesCache",[]),w(this,"aggregationFunction",void 0),w(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];let e=(0,r.Sc)(this.get(),t=>t.getValues()),i=[],n=(0,d.$K)(e[0])&&e[0].length||0;for(let t=0;t<n;t+=1){let r=[];for(let i=0;i<this.getLength();i+=1)r.push(e[i][t]);i.push(r)}return(0,r.Sc)(i,this.aggregationFunction)}getMergedValueAtIndex(t,e){let i=this.getMergedValues(e)[t];return(0,d.$K)(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function y(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}var C=new WeakMap;class S{constructor(){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(this,C),C.set(this,{writable:!0,value:[]})}subscribe(t){var e;return this.addLocalHook("change",t),this._write((e=y(this,C,"get")).get?e.get.call(this):e.value),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){!function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(this,y(this,C,"set"),t)}}function E(t,e){let i=[],r=0,n=0;for(;r<t.length&&n<e.length;r++,n++)t[r]!==e[n]&&i.push({op:"replace",index:n,oldValue:t[r],newValue:e[n]});for(;r<e.length;r++)i.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;n<t.length;n++)i.push({op:"remove",index:n,oldValue:t[n],newValue:void 0});return i}function R(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function T(t,e){var i=O(t,e,"get");return i.get?i.get.call(t):i.value}function M(t,e,i){var r=O(t,e,"set");return function(t,e,i){if(e.set)e.set.call(t,i);else{if(!e.writable)throw TypeError("attempted to set read only private field");e.value=i}}(t,r,i),i}function O(t,e,i){if(!e.has(t))throw TypeError("attempted to "+i+" private field on non-instance");return e.get(t)}(0,g.jB)(S,f.Z);var k=new WeakMap,x=new WeakMap,I=new WeakMap,A=new WeakMap,N=new WeakMap;class H{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};R(this,k,{writable:!0,value:new Set}),R(this,x,{writable:!0,value:[]}),R(this,I,{writable:!0,value:[]}),R(this,A,{writable:!0,value:!1}),R(this,N,{writable:!0,value:!1}),M(this,N,null!=t&&t)}createObserver(){let t=new S;return T(this,k).add(t),t.addLocalHook("unsubscribe",()=>{T(this,k).delete(t)}),t._writeInitialChanges(E(T(this,x),T(this,I))),t}emit(t){let e=T(this,I);T(this,A)&&T(this,x).length===t.length||(0===t.length?t=Array(e.length).fill(T(this,N)):M(this,x,Array(t.length).fill(T(this,N))),T(this,A)||(M(this,A,!0),e=T(this,x)));let i=E(e,t);T(this,k).forEach(t=>t._write(i)),M(this,I,t)}}function _(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class P{constructor(){_(this,"indexesSequence",new n.b),_(this,"trimmingMapsCollection",new b(t=>t.some(t=>!0===t),!1)),_(this,"hidingMapsCollection",new b(t=>t.some(t=>!0===t),!1)),_(this,"variousMapsCollection",new m),_(this,"hidingChangesObservable",new H({initialIndexValue:!1})),_(this,"notTrimmedIndexesCache",[]),_(this,"notHiddenIndexesCache",[]),_(this,"isBatched",!1),_(this,"indexesSequenceChanged",!1),_(this,"indexesChangeSource",void 0),_(this,"trimmedIndexesChanged",!1),_(this,"hiddenIndexesChanged",!1),_(this,"renderablePhysicalIndexesCache",[]),_(this,"fromPhysicalToVisualIndexesCache",new Map),_(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",t=>{this.runLocalHooks("change",t,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,i){return this.registerMap(t,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!u.has(t))throw Error(`The provided map type ("${t}") does not exist.`);return new(u.get(t))(e)}(e,i))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof h.n?this.trimmingMapsCollection.register(t,e):e instanceof o.o?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);let i=this.getNumberOfIndexes();return i>0&&e.init(i),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){let e=this.notTrimmedIndexesCache[t];return(0,d.$K)(e)?e:null}getPhysicalFromRenderableIndex(t){let e=this.renderablePhysicalIndexesCache[t];return(0,d.$K)(e)?e:null}getVisualFromPhysicalIndex(t){let e=this.fromPhysicalToVisualIndexesCache.get(t);return(0,d.$K)(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){let e=this.fromVisualToRenderableIndexesCache.get(t);return(0,d.$K)(e)?e:null}getNearestNotHiddenIndex(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.getPhysicalFromVisualIndex(t);if(null===r)return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;let n=Array.from(this.fromVisualToRenderableIndexesCache.keys()),o=-1;return -1===(o=e>0?n.findIndex(e=>e>t):n.reverse().findIndex(e=>e<t))?i?this.getNearestNotHiddenIndex(t,-e,!1):null:n[o]}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...Array(t).keys()],this.notHiddenIndexesCache=[...Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){let e=this.getNumberOfIndexes();if(t<e){let e=[...Array(this.getNumberOfIndexes()-t).keys()].map(e=>e+t);this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.notTrimmedIndexesCache;let e=this.getIndexesSequence();return e.filter(t=>!1===this.isTrimmed(t))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.notHiddenIndexesCache;let e=this.getIndexesSequence();return e.filter(t=>!1===this.isHidden(t))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.renderablePhysicalIndexesCache;let e=this.getNotTrimmedIndexes();return e.filter(t=>!1===this.isHidden(t))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"==typeof t&&(t=[t]);let i=(0,r.Sc)(t,t=>this.getPhysicalFromVisualIndex(t)),n=this.getNotTrimmedIndexesLength(),o=t.length,s=(0,c.t)(this.getIndexesSequence(),i),l=s.filter(t=>!1===this.isTrimmed(t)),a=s.indexOf(l[l.length-1])+1;if(e+o<n){let t=l[e];a=s.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence((0,c.S)(s,a,i)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){let i=this.getNotTrimmedIndexes()[t],n=(0,d.$K)(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=(0,r.Sc)(Array(e).fill(n),(t,e)=>t+e);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){let t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){let t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){let t=this.getPhysicalFromRenderableIndex(e),i=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(i,e)}}}(0,g.jB)(P,f.Z)},27392:function(t,e,i){"use strict";i.d(e,{o:function(){return o}}),i(58563);var r=i(45843),n=i(99440);class o extends r.L{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return(0,n.k$)(this.getValues(),(t,e,i)=>(e&&t.push(i),t),[])}}},16301:function(t,e,i){"use strict";i.d(e,{n:function(){return a}}),i(58563),i(57855);var r=i(67790),n=i(69488),o=i(98179),s=i(63437);function l(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:String(r))in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class a{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;l(this,"indexedValues",[]),l(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){let e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,o.mf)(this.initValueOrFn)?(0,r.q4)(t-1,t=>this.indexedValues.push(this.initValueOrFn(t))):(0,r.q4)(t-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}(0,n.jB)(a,s.Z)},42457:function(t,e,i){"use strict";i.d(e,{b:function(){return s}});var r=i(16301),n=i(97362),o=i(65724);class s extends r.n{constructor(){super(t=>t)}insert(t,e){let i=(0,o.X)(this.indexedValues,e);this.indexedValues=(0,n.S)(i,t,e),super.insert(t,e)}remove(t){let e=(0,n.t)(this.indexedValues,t);this.indexedValues=(0,o.i)(e,t),super.remove(t)}}},537:function(t,e,i){"use strict";i.d(e,{A:function(){return a}}),i(57855);var r=i(16301),n=i(5354),o=i(97362),s=i(65724),l=i(98179);class a extends r.n{constructor(){var t,e,i;super(...arguments),e=[],(t="symbol"==typeof(i=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t="orderOfIndexes","string"))?i:String(i))in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}getValues(){return this.orderOfIndexes.map(t=>this.indexedValues[t])}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(i,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=(0,o.t)(this.orderOfIndexes,[t]),(0,l.mf)(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=(0,n.S)(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=(0,s.X)(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=(0,n.t)(this.indexedValues,t),this.orderOfIndexes=(0,o.t)(this.orderOfIndexes,t),this.orderOfIndexes=(0,s.i)(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map(t=>[t,this.getValueAtIndex(t)])}}},45843:function(t,e,i){"use strict";i.d(e,{L:function(){return o}});var r=i(16301),n=i(5354);class o extends r.n{insert(t,e){this.indexedValues=(0,n.S)(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=(0,n.t)(this.indexedValues,t),super.remove(t)}}},96592:function(t,e,i){"use strict";i.d(e,{n:function(){return o}}),i(58563);var r=i(45843),n=i(99440);class o extends r.L{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return(0,n.k$)(this.getValues(),(t,e,i)=>(e&&t.push(i),t),[])}}},65724:function(t,e,i){"use strict";i.d(e,{X:function(){return o},i:function(){return n}});var r=i(99440);function n(t,e){return(0,r.Sc)(t,t=>t-e.filter(e=>e<t).length)}function o(t,e){let i=e[0],n=e.length;return(0,r.Sc)(t,t=>t>=i?t+n:t)}},97362:function(t,e,i){"use strict";i.d(e,{S:function(){return n},t:function(){return o}});var r=i(99440);function n(t,e,i){return[...t.slice(0,e),...i,...t.slice(e)]}function o(t,e){return(0,r.w7)(t,t=>!1===e.includes(t))}},5354:function(t,e,i){"use strict";i.d(e,{S:function(){return o},t:function(){return s}});var r=i(98179),n=i(99440);function o(t,e,i,n){let o=i.length?i[0]:void 0;return[...t.slice(0,o),...i.map((t,e)=>(0,r.mf)(n)?n(t,e):n),...void 0===o?[]:t.slice(o)]}function s(t,e){return(0,n.w7)(t,(t,i)=>!1===e.includes(i))}},2488:function(t,e,i){"use strict";i.d(e,{I:function(){return o}}),i(57855);var r=i(98179);let n=t=>`The id '${t}' is already declared in a map.`;function o(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Map;function i(){return[...e]}function o(t){return e.has(t)}return t=(0,r.mf)(t)?t:n,{addItem:function(i,r){if(o(i))throw Error(t(i));e.set(i,r)},clear:function(){e.clear()},getId:function(t){let[e]=i().find(e=>{let[i,r]=e;return t===r&&i})||[null];return e},getItem:function(t){return e.get(t)},getItems:i,hasItem:o,removeItem:function(t){return e.delete(t)}}}},84350:function(t,e,i){"use strict";i.d(e,{BU:function(){return a},bt:function(){return l},vo:function(){return s}}),i(58563);var r=i(2518);let n={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},o=RegExp(Object.keys(n).map(t=>`(${t})`).join("|"),"gi");function s(t){let e=t.hasColHeaders(),i=t.hasRowHeaders(),n=[e?-1:0,i?-1:0,t.countRows()-1,t.countCols()-1],o=t.getData(...n),s=o.length,l=s>0?o[0].length:0,a=["<table>","</table>"],h=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=i?1:0,d=e?1:0;for(let n=0;n<s;n+=1){let s=e&&0===n,a=[];for(let e=0;e<l;e+=1){let l=!s&&i&&0===e,h="";if(s)h=`<th>${t.getColHeader(e-c)}</th>`;else if(l)h=`<th>${t.getRowHeader(n-d)}</th>`;else{let i=o[n][e],{hidden:s,rowspan:l,colspan:a}=t.getCellMeta(n-d,e-c);if(!s){let t=[];if(l&&t.push(`rowspan="${l}"`),a&&t.push(`colspan="${a}"`),(0,r.xb)(i))h=`<td ${t.join(" ")}></td>`;else{let e=i.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");h=`<td ${t.join(" ")}>${e}</td>`}}}a.push(h)}let g=["<tr>",...a,"</tr>"].join("");s?h.splice(1,0,g):u.splice(-1,0,g)}return a.splice(1,0,h.join(""),u.join("")),a.join("")}function l(t){let e=t.length,i=["<table>"];for(let n=0;n<e;n+=1){let o=t[n],s=o.length,l=[];0===n&&i.push("<tbody>");for(let t=0;t<s;t+=1){let e=o[t],i=(0,r.xb)(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`).replace(/\t/gi,"&#9;");l.push(`<td>${i}</td>`)}i.push("<tr>",...l,"</tr>"),n+1===e&&i.push("</tbody>")}return i.push("</table>"),i.join("")}function a(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r={},s=i.createDocumentFragment(),l=i.createElement("div");s.appendChild(l);let a=t;if("string"==typeof a){let t=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,t=>{let e=t.match(/<td\b[^>]*?>/g)[0],i=t.substring(e.length,t.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${e}${i}</td>`});l.insertAdjacentHTML("afterbegin",`${t}`),a=l.querySelector("table")}if(!a||"TABLE"!==((e=a)&&e.nodeName||""))return;let h=l.querySelector('meta[name$="enerator"]'),u=null!==a.querySelector("tbody th"),c=a.querySelector("tr"),d=c?Array.from(c.cells).reduce((t,e)=>t+e.colSpan,0)-(u?1:0):0,g=a.tFoot&&Array.from(a.tFoot.rows)||[],f=[],p=!1,m=0,w=0;if(a.tHead){let t=Array.from(a.tHead.rows).filter(t=>{let e=null!==t.querySelector("td");return e&&f.push(t),!e});p=(m=t.length)>0,m>1?r.nestedHeaders=Array.from(t).reduce((t,e)=>{let i=Array.from(e.cells).reduce((t,e,i)=>{if(u&&0===i)return t;let{colSpan:r,innerHTML:n}=e,o=r>1?{label:n,colspan:r}:n;return t.push(o),t},[]);return t.push(i),t},[]):p&&(r.colHeaders=Array.from(t[0].children).reduce((t,e,i)=>(u&&0===i||t.push(e.innerHTML),t),[]))}f.length&&(r.fixedRowsTop=f.length),g.length&&(r.fixedRowsBottom=g.length);let b=[...f,...Array.from(a.tBodies).reduce((t,e)=>(t.push(...Array.from(e.rows)),t),[]),...g];w=b.length;let y=Array(w);for(let t=0;t<w;t++)y[t]=Array(d);let C=[],S=[];for(let t=0;t<w;t++){let e=b[t],i=Array.from(e.cells),r=i.length;for(let e=0;e<r;e++){let r=i[e],{nodeName:s,innerHTML:l,rowSpan:a,colSpan:u}=r,c=y[t].findIndex(t=>void 0===t);if("TD"===s){if(a>1||u>1){for(let e=t;e<t+a;e++)if(e<w)for(let t=c;t<c+u;t++)y[e][t]=null;let e=r.getAttribute("style"),i=e&&e.includes("mso-ignore:colspan");i||C.push({col:c,row:t,rowspan:a,colspan:u})}let e="";e=h&&/excel/gi.test(h.content)?l.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):l.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),y[t][c]=e.replace(o,t=>n[t])}else S.push(l)}}return C.length&&(r.mergeCells=C),S.length&&(r.rowHeaders=S),y.length&&(r.data=y),r}},3732:function(t,e,i){"use strict";i.d(e,{IU:function(){return o},_v:function(){return l},dU:function(){return s},mc:function(){return n}});let r=new WeakMap,n=Symbol("rootInstance");function o(t){r.set(t,!0)}function s(t){return t===n}function l(t){return r.has(t)}},82656:function(t,e,i){"use strict";i.d(e,{Z:function(){return n}});let r=new Map;function n(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";r.has(t)||r.set(t,new Map);let e=r.get(t);return{register:function(t,i){e.set(t,i)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return[...e.keys()]},getValues:function(){return[...e.values()]}}}},92740:function(t,e,i){"use strict";i.d(e,{Ie:function(){return u},Te:function(){return h},oh:function(){return s}}),i(57855);var r=i(82656);let{register:n,getItem:o,hasItem:s,getNames:l,getValues:a}=(0,r.Z)("validators");function h(t){if("function"==typeof t)return t;if(!s(t))throw Error(`No registered validator found under "${t}" name`);return o(t)}function u(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),n(t,e)}}}]);