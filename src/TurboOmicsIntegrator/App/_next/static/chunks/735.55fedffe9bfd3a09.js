"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[735],{13716:function(e,t,s){s.d(t,{E:function(){return n},c:function(){return a}});var i=s(57437),l=s(96507);function n(e){let{children:t,sx:s}=e;return(0,i.jsx)(l.Z,{sx:{...s},style:{scrollSnapAlign:"center",border:"0px solid yellow"},children:t})}function a(e){let{children:t,height:s}=e;return(0,i.jsx)(l.Z,{sx:{height:{height:s},scrollSnapType:"y mandatory",overflow:"auto",border:"0px solid red"},children:t})}s(2265)},88030:function(e,t,s){s.d(t,{$Y:function(){return M},Mz:function(){return A},T3:function(){return C}});var i=s(57437),l=s(41637),n=s(96507),a=s(14172),o=s(88444),r=s(85269),c=s(46776),d=s(52481),x=s(90053),u=s(2265),h=s(41125),p=s(16573),m=s(24235),g=s(33343),j=s(50039),f=s(2047),y=s(89366),b=s(561),Z=s(79857),v=s(31863),w=s(11093);function C(e){let t,{omic:s,scatterData:a,mdataCol:o,PCA:r}=e,[c,d]=(0,u.useState)(!1),{OMIC2NAME:Z}=(0,w.S)(),v=(0,u.useRef)(),C=(0,l.tc)().mdataType[o].type;return"categorical"==C&&(t="category"),"numeric"==C&&(t="number"),(0,i.jsxs)(n.Z,{children:[(0,i.jsx)(F,{scatterRef:v,name:Z[s]}),(0,i.jsxs)(h.G,{width:600,height:550,ref:v,margin:{top:20,right:20,bottom:20,left:20},children:[(0,i.jsx)(p.q,{}),(0,i.jsx)(m.K,{type:t,dataKey:"mdataValue",name:o,allowDuplicatedCategory:!1,children:(0,i.jsx)(g._,{value:o,offset:-10,position:"insideBottom"})}),(0,i.jsx)(j.B,{type:"number",dataKey:"projection",name:"PCA ".concat(r),children:(0,i.jsx)(g._,{value:"PCA ".concat(r),offset:20,position:"insideLeft",angle:-90})}),(0,i.jsx)(f.u,{cursor:{strokeDasharray:"3 3"},content:(0,i.jsx)(S,{})}),(0,i.jsx)(y.b,{data:a,fill:x.s[0],children:c&&(0,i.jsx)(b.e,{dataKey:"element",position:"right"})})]}),(0,i.jsx)(A,{showLabels:c,setShowLabels:d})]})}function M(e){let{omic:t,scatterData:s,selectedPlot2D:l}=e,{OMIC2NAME:a}=(0,w.S)(),o=(0,u.useRef)(),[r,c]=(0,u.useState)(!1);return(0,i.jsxs)(n.Z,{children:[(0,i.jsx)(F,{scatterRef:o,name:a[t]}),(0,i.jsxs)(h.G,{ref:o,width:600,height:550,margin:{top:20,right:20,bottom:20,left:20},children:[(0,i.jsx)(p.q,{}),(0,i.jsx)(m.K,{type:"number",dataKey:"x",name:"PCA ".concat(l.x),children:(0,i.jsx)(g._,{value:"PCA ".concat(l.x),offset:-10,position:"insideBottom"})}),(0,i.jsx)(j.B,{type:"number",dataKey:"y",name:"PCA ".concat(l.y),children:(0,i.jsx)(g._,{value:"PCA ".concat(l.y),offset:20,position:"insideLeft",angle:-90})}),(0,i.jsx)(f.u,{cursor:{strokeDasharray:"3 3"},content:(0,i.jsx)(S,{})}),Object.keys(s).length>1&&(0,i.jsx)(Z.D,{verticalAlign:"top"}),Object.keys(s).map((e,t)=>(0,i.jsx)(y.b,{data:s[e],fill:x.s[t%x.s.length],name:e,children:r&&(0,i.jsx)(b.e,{dataKey:"element",position:"top"})},e))]}),(0,i.jsx)(n.Z,{sx:{mt:1},children:(0,i.jsx)(A,{showLabels:r,setShowLabels:c})})]})}let A=e=>{let{showLabels:t,setShowLabels:s}=e;return(0,i.jsx)(n.Z,{sx:{mt:0,display:"flex",justifyContent:"center"},children:(0,i.jsxs)(n.Z,{sx:{width:100,textAlign:"center",position:"relative",left:30,border:"0px solid red"},children:[(0,i.jsx)(a.Z,{component:"legend",sx:{pt:0},children:"Show Labels"}),(0,i.jsx)(o.Z,{sx:{position:"relative",top:-10,border:"0px solid red"},checked:t,onChange:e=>{s(e=>!e)},inputProps:{"aria-label":"controlled"}})]})})},S=e=>{let{active:t,payload:s}=e;return t&&s&&s.length?(0,i.jsxs)(n.Z,{className:"custom-tooltip",sx:{backgroundColor:"rgba(5,5,5,0.8)",color:"rgba(250,250,250,0.8)",border:"1px solid rgba(50, 50, 50, 0.8)",padding:1,borderRadius:1},children:[(0,i.jsx)(r.Z,{variant:"h8",sx:{display:"block"},children:"".concat(s[0].payload.element)}),(0,i.jsx)(r.Z,{variant:"h9",sx:{display:"block"},children:"".concat(s[0].name,": ").concat("string"==typeof s[0].value?s[0].value:s[0].value.toFixed(3))}),(0,i.jsx)(r.Z,{variant:"h9",sx:{display:"block"},children:"".concat(s[1].name,": ").concat(s[1].value.toFixed(3))})]}):null},F=e=>{let{scatterRef:t,name:s}=e;return(0,i.jsx)(n.Z,{sx:{height:0},children:(0,i.jsx)(n.Z,{sx:{width:50,position:"relative",top:5,zIndex:5e3},children:(0,i.jsx)(c.Z,{"aria-label":"download",size:"small",onClick:()=>{let e=t.current.container.cloneNode(!0),i=window.document.createElement("div");i.appendChild(e),(0,v.default)(i,"PCA_Scatter-".concat(s))},sx:{opacity:.5},children:(0,i.jsx)(d.Z,{})})})})}},93735:function(e,t,s){s.r(t),s.d(t,{default:function(){return eV}});var i=s(57437),l=s(96507),n=s(54986),a=s(49600),o=s(65498),r=s(47042),c=s(85269),d=s(24094),x=s(2265),u=s(64728),h=s(11093),p=s(41637),m=s(46776),g=s(38939),j=s(23503),f=s(75897),y=s(53514),b=s(77370),Z=s(80470),v=s(57842),w=s(62254),C=s(55183),M=s(35843),A=s(22079),S=s(91797),F=s(52151),k=s(91928),P=s(33533),D=s(80565),O=s(37682),z=s(666);let L=(0,M.ZP)(A.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function T(){let[e,t]=x.useState(!1),s=()=>{t(!1)};return(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(m.Z,{"aria-label":"question",size:"large",onClick:()=>{t(!0)},children:(0,i.jsx)(z.Z,{fontSize:"inherit"})}),(0,i.jsxs)(L,{onClose:s,"aria-labelledby":"customized-dialog-title",open:e,maxWidth:"lg",children:[(0,i.jsx)(S.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Multi-Omics Factor Analysis (MOFA)"}),(0,i.jsx)(m.Z,{"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,i.jsx)(P.default,{})}),(0,i.jsxs)(F.Z,{sx:{textAlign:"justify"},dividers:!0,children:[(0,i.jsx)(c.Z,{gutterBottom:!0,children:"This section presents the results of the Multi-Omics Factor Analysis (MOFA) [1], a multivariate statistical technique that decomposes your omics data into latent factors. These factors capture the major sources of variation across different data modalities, allowing for the identification of continuous molecular gradients or discrete subgroups of samples. MOFA operates in an unsupervised manner and runs with default parameters."}),(0,i.jsxs)(c.Z,{gutterBottom:!0,children:["At the top of this section you can find a ",(0,i.jsx)("strong",{children:"Summary Table of Latent Factor"})," with the following information:"]}),(0,i.jsx)(l.Z,{sx:{pl:3},children:(0,i.jsxs)(D.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,i.jsxs)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,i.jsx)("strong",{children:"Variability Explained"}),": For each latent factor, the table summarizes the percentage of variability explained in each omic dataset. This information helps users understand the contribution of each factor to the overall variability within each omic type."]}),(0,i.jsxs)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,i.jsx)("strong",{children:"Metadata Associations"}),": The table also includes additional rows corresponding to the variables in the uploaded Experimental Metadata table. For each metadata variable, the table displays the p-value of the linear regression between the variable and the sample projections on each latent factor. These p-values indicate the significance of the association between the factors and the experimental conditions or other metadata, helping to identify potentially meaningful biological or technical influences."]})]})})]}),(0,i.jsx)(k.Z,{children:(0,i.jsx)(l.Z,{sx:{textAlign:"justify",p:2},children:(0,i.jsx)(c.Z,{gutterBottom:!0,children:"[1] Argelaguet R, Velten B, Arnol D, Dietrich S, Zenz T, Marioni JC, Buettner F, Huber W, Stegle O. Multi-Omics Factor Analysis-a framework for unsupervised integration of multi-omics data sets. Mol Syst Biol. 2018 Jun 20;14(6):e8124. doi: 10.15252/msb.20178124. PMID: 29925568; PMCID: PMC6010767."})})})]})]})}let B="rgba(200,200,200,0.5)",I=e=>({cell:{transition:"background-color 0.3s, border-color 0.3s",border:"1px solid ".concat(B),cursor:"1D"==e?"pointer":"",padding:.5,fontSize:15,textAlign:"center",userSelect:"none","&:hover":{border:"1D"==e?"1px solid rgba(50,50,50,1)":"1px solid ".concat(B)}},selectedCell:{border:"1D"==e?"1px solid rgba(50,50,50,1)":"1px solid ".concat(B)}}),R={textAlign:"center",padding:.5,border:"1px solid ".concat(B),borderRight:"1px solid rgba(10,10,10,1)",fontSize:15,whiteSpace:"nowrap",userSelect:"none"},E=e=>({backgroundColor:e<.1?"rgba(".concat(2550*e,",").concat(200+550*e,",").concat(2550*e,", 0.5)"):"rgba(255,255,255,0.5)"}),N=e=>({backgroundColor:"rgba(".concat(255,",").concat(255-255*e/100,",").concat(255-255*e/100,", 0.8)")});function _(e){let{anova:t,explained_variance:s,setSelectedPlot:n,selectedCell:a,setSelectedCell:o,scatterMode:r,factorNames:c,colNames:d,rowNames:u}=e,{OMIC2NAME:M}=(0,h.S)(),{omics:A}=(0,p.tc)(),S=I(r),F=(0,x.useMemo)(()=>u.map(e=>c.map(s=>t[s][e].pvalue)),[t,u,c]),k=(0,x.useMemo)(()=>A.reduce((e,t)=>({...e,[t]:c.map(e=>s[t][e].Explained_Variance)}),{}),[s,c,A]),P=(e,t)=>{"2D"!=r&&(o({rowIndex:e,colIndex:t}),n({mdataCol:u[e],Factor:c[t]}),console.log("Plot scatter: MOFA ".concat(c[t]," vs ").concat(u[e])))},D=(0,x.useMemo)(()=>{let e=[];e.push(["Factor / Cond.",...d]),A.map(t=>e.push(["%Var (".concat(t.toUpperCase(),")"),...k[t]]));let t=F.map((e,t)=>[u[t],...e]);return e=[...e,...t]},[d,F,u,A,k]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{sx:{height:0,width:50,zIndex:5e3,display:"flex",paddingLeft:.5},children:(0,i.jsx)(m.Z,{"aria-label":"download",size:"small",sx:{opacity:.5,position:"relative",top:-21},children:(0,i.jsx)(C.CSVLink,{data:D,filename:"MOFA_Anova_pvalues.csv",separator:",",children:(0,i.jsx)(w.Z,{})})})}),(0,i.jsxs)(g.ZP,{container:!0,children:[(0,i.jsx)(g.ZP,{item:!0,xs:2,children:(0,i.jsx)(j.Z,{sx:{margin:"auto"},children:(0,i.jsxs)(f.Z,{children:[(0,i.jsx)(y.Z,{children:(0,i.jsx)(b.Z,{children:(0,i.jsx)(Z.Z,{sx:{padding:0,textAlign:"center"},children:"Factor / Cond."})})}),(0,i.jsxs)(v.Z,{children:[A.map((e,t)=>(0,i.jsx)(b.Z,{children:(0,i.jsx)(Z.Z,{sx:{padding:0,border:0},children:(0,i.jsxs)(l.Z,{sx:{...R,borderBottom:t==A.length-1&&"1px solid rgba(10,10,10,1)"},children:["%Var (",M[e].slice(0,4),".)"]})})},e)),u.map((e,t)=>(0,i.jsx)(b.Z,{children:(0,i.jsx)(Z.Z,{sx:{padding:0,border:0},children:(0,i.jsx)(l.Z,{sx:R,children:e})})},t))]})]})})}),(0,i.jsx)(g.ZP,{item:!0,xs:10,children:(0,i.jsx)(j.Z,{sx:{margin:"auto"},children:(0,i.jsxs)(f.Z,{children:[(0,i.jsx)(y.Z,{children:(0,i.jsx)(b.Z,{children:d.map((e,t)=>(0,i.jsx)(Z.Z,{sx:{padding:0,textAlign:"center",userSelect:"none"},children:e},t))})}),(0,i.jsxs)(v.Z,{children:[A.map(e=>k[e]).map((e,t)=>(0,i.jsx)(b.Z,{children:e.map((e,s)=>(0,i.jsx)(Z.Z,{sx:{padding:0,border:0},children:(0,i.jsx)(l.Z,{sx:{padding:.5,border:"1px solid ".concat(B),borderBottom:t==A.length-1&&"1px solid rgba(10,10,10,1)",fontSize:15,textAlign:"center",backgroundColor:N(e),userSelect:"none"},children:e.toFixed(2)})},s))},t)),F.map((e,t)=>(0,i.jsx)(b.Z,{children:e.map((e,s)=>(0,i.jsx)(Z.Z,{sx:{padding:0,border:0},onClick:()=>P(t,s),style:{minWidth:100},children:(0,i.jsx)(l.Z,{sx:a&&a.rowIndex===t&&a.colIndex===s?{...S.cell,...S.selectedCell,...E(e)}:{...S.cell,...E(e)},children:e<.001?e.toExponential(3):e.toFixed(3)})},s))},t))]})]})})})]})]})}var K=s(50294);function q(e){let{factorNames:t,rowNames:s,selectedPlot2D:n,setSelectedPlot2D:a}=e,o=(0,u.mX)(),{mdataType:r}=(0,p.tc)();return(0,i.jsxs)(l.Z,{sx:{height:75,display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)(l.Z,{sx:{width:"25%"},children:(0,i.jsx)(K.$S,{options:t.map(e=>({label:e,value:e})),onChange:e=>{a(t=>({...t,x:e.value})),o({type:"set-selected-plot-2d-mofa",mode:{...n,x:e.value}})},value:{label:"".concat(n.x),value:n.x},label:"X axis"})}),(0,i.jsx)(l.Z,{sx:{width:"25%"},children:(0,i.jsx)(K.$S,{options:t.map(e=>({label:e,value:e})),onChange:e=>{a(t=>({...t,y:e.value})),o({type:"set-selected-plot-2d-mofa",mode:{...n,y:e.value}})},value:{label:"".concat(n.y),value:n.y},label:"Y axis"})}),(0,i.jsx)(l.Z,{sx:{width:"40%"},children:(0,i.jsx)(K.$S,{options:[{label:"No color",value:"No color"},...s.filter(e=>"categorical"==r[e].type).map(e=>({label:e,value:e}))],onChange:e=>{a(t=>({...t,g:e.value})),o({type:"set-selected-plot-2d-mofa",mode:{...n,g:e.value}})},value:{label:n.g,value:n.g},label:"Color by"})})]})}function V(e){let{factorNames:t,rowNames:s,selectedPlot:n,setSelectedPlot:a,setSelectedCell:o}=e;(0,u.mX)();let{mdataType:r}=(0,p.tc)();return(0,i.jsxs)(l.Z,{sx:{height:75,display:"flex",justifyContent:"space-around"},children:[(0,i.jsx)(l.Z,{sx:{width:"25%"},children:(0,i.jsx)(K.$S,{options:t.map(e=>({label:e,value:e})),onChange:e=>{a(t=>({...t,Factor:e.value})),o(s=>({...s,colIndex:t.map((e,t)=>[e,t]).filter(t=>t[0]==e.value)[0][1]}))},value:{label:"".concat(n.Factor),value:n.Factor},label:"Factor"})}),(0,i.jsx)(l.Z,{sx:{width:"40%"},children:(0,i.jsx)(K.$S,{options:s.filter(e=>"categorical"==r[e].type).map(e=>({label:e,value:e})),onChange:e=>{a(t=>({...t,mdataCol:e.value})),o(t=>({...t,rowIndex:s.map((e,t)=>[e,t]).filter(t=>t[0]==e.value)[0][1]}))},value:{label:n.mdataCol,value:n.mdataCol},label:"Group by"})})]})}var H=s(92233),W=s(5301),J=function(e){let{scatterMode:t,setScatterMode:s,disable2D:n}=e,a=(0,u.mX)();return(0,i.jsx)(l.Z,{sx:{textAlign:"center"},children:(0,i.jsx)(l.Z,{sx:{mb:2},children:(0,i.jsxs)(H.Z,{color:"primary",value:t,exclusive:!0,onChange:(e,t)=>{s(e.target.value),a({type:"set-scatter-mode-mofa",mode:e.target.value})},"aria-label":"Platform",children:[(0,i.jsx)(W.Z,{value:"1D",children:"1D"}),(0,i.jsx)(W.Z,{value:"2D",disabled:n,children:"2D"})]})})})},X=s(90053),G=s(35048),$=s(41125),Y=s(16573),U=s(24235),Q=s(33343),ee=s(50039),et=s(2047),es=s(89366),ei=s(561),el=s(79857),en=s(2678),ea=s(88030);let eo=e=>{let{active:t,payload:s}=e;return t&&s&&s.length?(0,i.jsxs)(l.Z,{className:"custom-tooltip",sx:{backgroundColor:"rgba(5,5,5,0.8)",color:"rgba(250,250,250,0.8)",border:"1px solid rgba(50, 50, 50, 0.8)",padding:1,borderRadius:1},children:[(0,i.jsx)(c.Z,{variant:"h8",sx:{display:"block"},children:"".concat(s[0].payload.element)}),(0,i.jsx)(c.Z,{variant:"h9",sx:{display:"block"},children:"".concat(s[0].name,": ").concat("string"==typeof s[0].value?s[0].value:s[0].value.toFixed(3))}),(0,i.jsx)(c.Z,{variant:"h9",sx:{display:"block"},children:"".concat(s[1].name,": ").concat(s[1].value.toFixed(3))})]}):null};function er(e){let t,{scatterData:s,mdataCol:n,Factor:a}=e,[o,r]=(0,x.useState)(!1),c=(0,x.useRef)(),d=(0,p.tc)().mdataType[n].type;return"categorical"==d&&(t="category"),"numeric"==d&&(t="number"),(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(ea.Mz,{showLabels:o,setShowLabels:r}),(0,i.jsx)(en.L,{scatterRef:c,fileName:"MOFA_Scatter_1D"}),(0,i.jsx)(G.h,{width:"100%",height:400,children:(0,i.jsxs)($.G,{ref:c,margin:{top:5,right:20,bottom:20,left:20},children:[(0,i.jsx)(Y.q,{}),(0,i.jsx)(U.K,{type:t,dataKey:"mdataValue",name:n,allowDuplicatedCategory:!1,children:(0,i.jsx)(Q._,{value:n,offset:-10,position:"insideBottom"})}),(0,i.jsx)(ee.B,{type:"number",dataKey:"projection",name:"".concat(a),children:(0,i.jsx)(Q._,{value:"".concat(a),offset:20,position:"insideLeft",angle:-90})}),(0,i.jsx)(et.u,{cursor:{strokeDasharray:"3 3"},content:(0,i.jsx)(eo,{})}),(0,i.jsx)(es.b,{data:s,fill:X.s[0],children:o&&(0,i.jsx)(ei.e,{dataKey:"element",position:"right"})})]})})]})}function ec(e){let{scatterData:t,selectedPlot2D:s}=e,[n,a]=(0,x.useState)(!1),o=(0,x.useRef)();return(0,i.jsx)(l.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,i.jsxs)(l.Z,{sx:{width:600},children:[(0,i.jsx)(ea.Mz,{showLabels:n,setShowLabels:a}),(0,i.jsx)(en.L,{scatterRef:o,fileName:"MOFA_Scatter_2D"}),(0,i.jsxs)($.G,{ref:o,width:600,height:500,margin:{top:5,right:20,bottom:20,left:20},children:[(0,i.jsx)(Y.q,{}),(0,i.jsx)(U.K,{type:"number",dataKey:"x",name:"".concat(s.x),children:(0,i.jsx)(Q._,{value:"".concat(s.x),offset:-10,position:"insideBottom"})}),(0,i.jsx)(ee.B,{type:"number",dataKey:"y",name:"".concat(s.y),children:(0,i.jsx)(Q._,{value:"".concat(s.y),offset:20,position:"insideLeft",angle:-90})}),(0,i.jsx)(et.u,{cursor:{strokeDasharray:"3 3"},content:(0,i.jsx)(eo,{})}),Object.keys(t).length>1&&(0,i.jsx)(el.D,{verticalAlign:"top"}),Object.keys(t).map((e,s)=>(0,i.jsx)(es.b,{data:t[e],fill:X.s[s%X.s.length],name:e,children:n&&(0,i.jsx)(ei.e,{dataKey:"element",position:"top"})},e))]})]})})}let ed=(0,M.ZP)(A.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function ex(){let[e,t]=x.useState(!1),s=()=>{t(!1)};return(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(m.Z,{"aria-label":"question",size:"large",onClick:()=>{t(!0)},children:(0,i.jsx)(z.Z,{fontSize:"inherit"})}),(0,i.jsxs)(ed,{onClose:s,"aria-labelledby":"customized-dialog-title",open:e,maxWidth:"lg",children:[(0,i.jsx)(S.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Multi-Omics Factor Analysis (MOFA) - Loading Plot"}),(0,i.jsx)(m.Z,{"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,i.jsx)(P.default,{})}),(0,i.jsxs)(F.Z,{sx:{textAlign:"justify"},dividers:!0,children:[(0,i.jsx)(c.Z,{gutterBottom:!0,children:"This subsection allows you to visualize the projection of your samples onto the latent factors calculated by MOFA, providing insights into how these factors capture variability across your multi-omics data. The scatter plot can be viewed in two modes:"}),(0,i.jsx)(l.Z,{sx:{pl:3},children:(0,i.jsxs)(D.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,i.jsxs)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,i.jsx)("strong",{children:"1D Mode (Default)"}),(0,i.jsxs)(D.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,i.jsx)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:"In this mode, the Y axis represents the projection of samples on a single selected factor, while the X axis displays the different sample groups. This view is particularly useful for comparing how different groups of samples project onto the selected factor."}),(0,i.jsxs)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,i.jsx)("strong",{children:"Further Exploration:"})," When using the 1D mode, you can explore the selected factor in greater detail using additional sections below, which include further analyses or visualizations related to the factor."]})]})]}),(0,i.jsxs)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,i.jsx)("strong",{children:"2D Mode"}),(0,i.jsxs)(D.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,i.jsx)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:"This mode allows you to visualize the relationship between two factors simultaneously. You can select one factor to be displayed on the X axis and another on the Y axis."}),(0,i.jsxs)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,i.jsx)("strong",{children:"Color-Coding by Group"}),": The data points representing samples can be color-coded based on different grouping criteria, such as experimental conditions or metadata categories. This helps in identifying patterns, subgroups, or gradients within the data."]})]})]})]})})]}),(0,i.jsx)(k.Z,{children:(0,i.jsx)(l.Z,{sx:{textAlign:"justify",p:2},children:(0,i.jsx)(c.Z,{gutterBottom:!0,children:"[1] Argelaguet R, Velten B, Arnol D, Dietrich S, Zenz T, Marioni JC, Buettner F, Huber W, Stegle O. Multi-Omics Factor Analysis-a framework for unsupervised integration of multi-omics data sets. Mol Syst Biol. 2018 Jun 20;14(6):e8124. doi: 10.15252/msb.20178124. PMID: 29925568; PMCID: PMC6010767."})})})]})]})}let eu=(e,t,s,i,l,n)=>{let a=null;if(s&&"1D"==t){a=[];let t=l.column(s.mdataCol),i={};t.index.map((e,s)=>{i[e]=t.values[s]}),Object.keys(e).map(t=>{a.push({element:t,mdataValue:i[t],projection:e[t][s.Factor]})})}else"2D"==t&&(a={},Object.keys(n).includes(i.g)?n[i.g].levels.map(t=>{a[t]=[...n[i.g].level2id[t].map(t=>Object.keys(e).includes(t)?{element:t,x:e[t][i.x],y:e[t][i.y]}:null).filter(e=>null!=e)]}):a[i.g]=Object.keys(e).map(t=>({element:t,x:e[t][i.x],y:e[t][i.y]})));return a};var eh=function(e){let{scatterMode:t,setScatterMode:s,selectedPlot:n,setSelectedPlot:a,setSelectedCell:o,selectedPlot2D:r,setSelectedPlot2D:c,factorNames:d,rowNames:u,projections:h}=e,{mdata:m}=(0,p.tc)().user,{mdataType:j}=(0,p.tc)(),f=(0,x.useMemo)(()=>eu(h,t,n,r,m,j),[h,t,n,r,m,j]);return(0,i.jsxs)(g.ZP,{container:!0,children:[(0,i.jsx)(l.Z,{children:(0,i.jsx)(ex,{})}),(0,i.jsxs)(g.ZP,{sx:{pt:2},item:!0,xs:6,children:[(0,i.jsx)(J,{scatterMode:t,setScatterMode:s,disable2D:Object.keys(Object.values(h)[0]).length<2}),(0,i.jsx)(l.Z,{sx:{px:3,pt:7,textAlign:"center"},children:"1D"==t?(0,i.jsx)(V,{factorNames:d,rowNames:u,selectedPlot:n,setSelectedPlot:a,setSelectedCell:o}):(0,i.jsx)(q,{factorNames:d,rowNames:u,selectedPlot2D:r,setSelectedPlot2D:c})})]}),(0,i.jsx)(g.ZP,{item:!0,xs:6,children:f&&(0,i.jsx)(l.Z,{sx:{height:470},children:"1D"==t?(0,i.jsx)(er,{scatterData:f,mdataCol:n.mdataCol,Factor:n.Factor}):(0,i.jsx)(ec,{scatterData:f,selectedPlot2D:r})})})]})},ep=s(13716),em=s(73295),eg=s(67248),ej=s(38227),ef=s(20003),ey=s(27978),eb=s(19223),eZ=s(15632);function ev(e){return"".concat(e)}var ew=function(e){let{omic:t,fLVec:s,nFeatRef:n,thrLRef:a,plotHeatMap:o}=e,[r,d]=(0,x.useState)({down:0,up:0}),[u,h]=(0,x.useState)({down:0,up:0});(0,x.useEffect)(()=>{let e={down:Math.floor(.01*s.length),up:Math.floor(.01*s.length)};h(e),n.current[t]=e;let i={down:s[e.down][1],up:s[s.length-e.up-1][1]};d(i),a.current[t]=i},[s,n,t,a]),(0,x.useEffect)(()=>{let e=setTimeout(o,100);return()=>clearInterval(e)},[u,o]);let p=(0,x.useMemo)(()=>{let e=Math.min(200,s.length),t=Math.floor(s.length/e);return s.map(e=>({f:e[0],loading:Math.floor(1e4*e[1])/1e4,quantile:e[2]})).filter((e,i)=>i%t==0||i==s.length-1).map(e=>e.loading>r.down&&e.loading<r.up?{...e,qNS:e.quantile}:{...e,qS:e.quantile})},[s,r]),m=e=>{let[i,l]=e,o={down:Math.min(i,0),up:Math.max(l,0)};d(o),a.current[t]=o;let r={down:s.filter(e=>e[1]<o.down).length,up:s.filter(e=>e[1]>o.up).length};h(r),n.current[t]=r},g=e=>{if(e<0){d(t=>({...t,down:e})),a.current[t].down=e;let i=s.filter(t=>t[1]<e).length;h(e=>({...e,down:i})),n.current[t].down=i}else{d(t=>({...t,up:e})),a.current[t].up=e;let i=s.filter(t=>t[1]>e).length;h(e=>({...e,up:i})),n.current[t].up=i}},j=(e,i)=>{let l=parseInt(e);if(isNaN(l)){h(e=>({...e,[i]:0}));return}if("down"==i){let e=s.filter(e=>e[1]<0);l>=0&&l<e.length?(h(e=>({...e,down:l})),n.current[t].down=l,d(t=>({...t,down:e[l][1]})),a.current[t].down=e[l][1]):l>=e.length&&(h(t=>({...t,down:e.length})),n.current[t].down=e.length,d(e=>({...e,down:0})),a.current[t].down=0)}if("up"==i){let e=s.filter(e=>e[1]>0);l>=0&&l<e.length?(h(e=>({...e,up:l})),n.current[t].up=l,d(t=>({...t,up:e[e.length-l-1][1]})),a.current[t].up=e[e.length-l-1][1]):l<0?(h(e=>({...e,up:0})),n.current[t].up=0,d(t=>({...t,up:e[e.length-1][1]})),a.current[t].up=e[e.length-1][1]):l>=e.length&&(h(t=>({...t,up:e.length})),n.current[t].up=e.length,d(e=>({...e,up:0})),a.current[t].up=0)}},f=Math.ceil(1e3*Math.max(Math.abs(s[0][1]),Math.abs(s[s.length-1][1])))/1e3;return(0,i.jsx)(l.Z,{sx:{overflow:"auto"},children:(0,i.jsxs)(l.Z,{sx:{mt:1,display:"block",m:"auto",width:400},children:[(0,i.jsx)(l.Z,{sx:{width:400,position:"relative"},children:(0,i.jsxs)(ej.w,{data:p,margin:{top:5,right:30,left:20,bottom:20},width:400,height:200,onClick:e=>null!=e&&g(e.activeLabel),children:[(0,i.jsx)(Y.q,{strokeDasharray:"3 3"}),(0,i.jsx)(U.K,{dataKey:"loading",type:"number",name:"Loadings",domain:[-f,f],label:{value:"Loading",position:"insideBottom",offset:-10},ticks:(0,eZ.jI)(-f,f,6)}),(0,i.jsx)(ee.B,{type:"number",label:{value:"Quantile",position:"insideLeft",angle:-90,dy:30,offset:-5}}),(0,i.jsx)(ef.z,{x1:r.down,x2:r.up,y1:0,y2:1}),(0,i.jsx)(ey.d,{x:0,stroke:"#333333",strokeDasharray:"3 3"}),(0,i.jsx)(eb.x,{type:"monotone",dataKey:"quantile",stroke:"#aaaaaa",dot:!1,strokeWidth:1}),(0,i.jsx)(eb.x,{type:"monotone",dataKey:"qS",stroke:"#8884d8",dot:!1,strokeWidth:3})]})}),(0,i.jsx)(l.Z,{sx:{width:290,position:"relative",left:80},children:(0,i.jsx)(em.ZP,{track:"inverted",value:[Math.floor(1e3*r.down)/1e3,Math.ceil(1e3*r.up)/1e3],getAriaValueText:ev,valueLabelDisplay:"auto",step:.001,min:-f,max:f,onChange:e=>m(e.target.value)})}),(0,i.jsxs)(l.Z,{sx:{width:290,position:"relative",left:80,display:"flex",textAlign:"center",justifyContent:"space-around"},children:[(0,i.jsxs)(l.Z,{sx:{width:"33%"},children:[(0,i.jsx)(c.Z,{variant:"body2",children:"Negatively Associated"}),(0,i.jsx)(eg.Z,{size:"small",value:u.down,inputProps:{min:0,style:{textAlign:"center",width:45,height:12}},onChange:e=>j(e.target.value,"down")})]}),(0,i.jsxs)(l.Z,{sx:{width:"33%"},children:[(0,i.jsx)(c.Z,{variant:"body2",children:"Positively Associated"}),(0,i.jsx)(eg.Z,{size:"small",value:u.up,inputProps:{min:0,style:{textAlign:"center",width:45,height:12}},onChange:e=>j(e.target.value,"up")})]})]})]})})};let eC=(0,M.ZP)(A.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function eM(){let[e,t]=x.useState(!1),s=()=>{t(!1)};return(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(m.Z,{"aria-label":"question",size:"large",onClick:()=>{t(!0)},children:(0,i.jsx)(z.Z,{fontSize:"inherit"})}),(0,i.jsxs)(eC,{onClose:s,"aria-labelledby":"customized-dialog-title",open:e,maxWidth:"lg",children:[(0,i.jsx)(S.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Multi-Omics Factor Analysis (MOFA) - Loading Plot"}),(0,i.jsx)(m.Z,{"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,i.jsx)(P.default,{})}),(0,i.jsxs)(F.Z,{sx:{textAlign:"justify"},dividers:!0,children:[(0,i.jsxs)(c.Z,{gutterBottom:!0,children:["This subsection provides insights into how individual biomolecules contribute to each latent factor calculated by MOFA. For each omic, users can visualize the",(0,i.jsx)("strong",{children:"loading distribution"})," of biomolecules, which represents the strength and direction (positive or negative) of their association within the selected factor."]}),(0,i.jsxs)(c.Z,{gutterBottom:!0,children:["Users can ",(0,i.jsx)("strong",{children:"select the top most positively and negatively associated"})," biomolecules for the chosen factor within each omic. This selection is crucial for deeper analysis as these biomolecules are the key drivers of the factor’s influence. The selected biomolecules are used to generate a heatmap, allowing for visual exploration of their expression patterns across samples."]}),(0,i.jsxs)(c.Z,{gutterBottom:!0,children:["At the bottom of the page, a button directs users to a ",(0,i.jsx)("strong",{children:"detailed exploratory subsection"})," where the selected biomolecules can be further analyzed, helping to reveal more about their roles and significance within the dataset."]})]}),(0,i.jsx)(k.Z,{children:(0,i.jsx)(l.Z,{sx:{textAlign:"justify",p:2},children:(0,i.jsx)(c.Z,{gutterBottom:!0,children:"[1] Argelaguet R, Velten B, Arnol D, Dietrich S, Zenz T, Marioni JC, Buettner F, Huber W, Stegle O. Multi-Omics Factor Analysis-a framework for unsupervised integration of multi-omics data sets. Mol Syst Biol. 2018 Jun 20;14(6):e8124. doi: 10.15252/msb.20178124. PMID: 29925568; PMCID: PMC6010767."})})})]})]})}var eA=function(e){let{fLVec:t,nFeatRef:s,thrLRef:n,plotHeatMap:a}=e,{omics:o}=(0,p.tc)(),{OMIC2NAME:r}=(0,h.S)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{sx:{height:0},children:(0,i.jsx)(eM,{})}),(0,i.jsx)(l.Z,{sx:{my:3,display:"flex",justifyContent:"space-evenly"},children:o.map((e,o)=>(0,i.jsxs)(l.Z,{sx:{width:"31%"},children:[(0,i.jsx)(c.Z,{variant:"h6",sx:{textAlign:"center"},children:r[e]}),(0,i.jsx)(ew,{omic:e,fLVec:t[e],nFeatRef:s,thrLRef:n,plotHeatMap:a})]},o))})]})},eS=s(63870);function eF(e){let{omic:t,myIndex:s,myFeat:n,mdataCol:a,zLegend:o}=e,r=2*(0,p.tc)().omics.length,c=(0,p.tc)().norm["x".concat(t)],d=(0,p.tc)().mdataType[a],u=(0,x.useMemo)(()=>eP(s,n,c,d),[s,n,c,d]);return(0,i.jsx)(l.Z,{sx:{height:510,width:1160/r,marginRight:.5,border:"2px solid #444444"},children:(0,i.jsx)(eS.Tu,{data:u,margin:{top:0,right:0,bottom:0,left:0},axisTop:{tickSize:0,tickPadding:0,tickRotation:0,legend:"",legendOffset:0},colors:{type:"diverging",scheme:"red_blue",minValue:o.min,maxValue:o.max},emptyColor:"#555555",isInteractive:!1,animate:!1,enableLabels:!1})})}let ek=e=>{let{myIndex:t,mdataCol:s,showBorder:l,showLevel:n}=e,a=(0,p.tc)().mdataType[s],o=(0,x.useMemo)(()=>eP(t,[],null,a),[t,a]),r=[];r=n?o.map(e=>e.id.split("##")).map(e=>e[e.length-1]):o.map(e=>e.id.split("##")).map(e=>e.slice(0,-1).join("##"));let d={};r.forEach(e=>{d[e]=(d[e]||0)+1});let u=[...new Set(r)];return(0,i.jsx)("table",{children:(0,i.jsx)("tbody",{children:u.map((e,t)=>(0,i.jsx)("tr",{style:{height:500*d[e]/r.length,borderTop:l&&"2px solid #444444",borderBottom:l&&"2px solid #444444"},children:(0,i.jsx)("td",{style:{paddingRight:5},children:(0,i.jsx)(c.Z,{variant:"h7",children:e})})},t))})})},eP=(e,t,s,i)=>{let l={};return e.map(e=>{l[e]=[]}),t.map(t=>{let i=s.column(t);i.index.map((e,t)=>[e,i.values[t]]).filter(t=>e.includes(t[0])).map(e=>{l[e[0]].push({x:t,y:-e[1]})})}),"categorical"==i.type?l=i.levels.map(t=>i.level2id[t].filter(t=>e.includes(t)).map(e=>({id:"".concat(e,"##").concat(t),data:l[e]}))).flat():"numeric"==i.type&&(l=e.map(e=>({id:e,data:l[e]}))),l};var eD=function(e){let{nFeatRef:t}=e,{OMIC2NAME:s}=(0,h.S)(),n=(0,p.tc)().omics;return(0,i.jsxs)(l.Z,{sx:{mt:1,display:"flex",justifyContent:"center",textAlign:"center"},children:[(0,i.jsx)(l.Z,{sx:{width:"5%"}}),n.map(e=>(0,i.jsx)(l.Z,{children:(t.current[e].up>0||t.current[e].down>0)&&(0,i.jsxs)(l.Z,{sx:{marginRight:.5},children:[(0,i.jsx)(l.Z,{children:(0,i.jsx)(c.Z,{variant:"h6",children:s[e]})}),(0,i.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"space-around"},children:[t.current[e].down>0&&(0,i.jsx)(l.Z,{sx:{width:1160/(2*n.length),marginRight:.5},children:(0,i.jsx)(l.Z,{children:"Negatively Associated"})}),t.current[e].up>0&&(0,i.jsx)(l.Z,{sx:{width:1160/(2*n.length)},children:(0,i.jsx)(l.Z,{children:"Positively Associated"})})]})]},e)},e)),(0,i.jsx)(l.Z,{sx:{width:"5%"}})]})};let eO=e=>{let{a:t,b:s,updateZLegend:l,omic:n,plotHeatMap:a}=e,[o,r]=(0,x.useState)({min:t,max:s}),c=(0,u.mX)(),d=(t+s)/2,h={display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:"10px",background:"linear-gradient(to right, ".concat("#1f4e79",", ").concat("rgb(255, 255, 255)"," ").concat((d-t)/(s-t)*100,"%, ").concat("#9e2a2b",")"),color:"#fff",height:"15px"},p=(e,t)=>{let s=Number(t);r(s=>({...s,[e]:t})),"number"!=typeof s||isNaN(s)||(l(t=>{t[n][e]=s}),c({type:"update-zlegend",omic:n,minmax:e,numValue:s}),a())};return(0,i.jsxs)("div",{style:h,children:[(0,i.jsx)("div",{children:(0,i.jsx)("input",{type:"text",style:{width:30,height:20,textAlign:"center"},value:o.min,onChange:e=>p("min",e.target.value)})}),(0,i.jsx)("div",{style:{color:"black"},children:d.toFixed(0)}),(0,i.jsx)("div",{children:(0,i.jsx)("input",{type:"text",style:{width:30,height:20,textAlign:"center"},value:o.max,onChange:e=>p("max",e.target.value)})})]})};var ez=e=>{let{nFeatRef:t,zLegend:s,updateZLegend:n,plotHeatMap:a}=e,o=(0,p.tc)().omics;return(0,i.jsxs)(l.Z,{sx:{mt:1,display:"flex",justifyContent:"center",textAlign:"center"},children:[(0,i.jsx)(l.Z,{sx:{width:"5%"}}),o.map(e=>(0,i.jsx)(l.Z,{sx:{mr:.7},children:(t.current[e].up>0||t.current[e].down>0)&&(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(eO,{a:s[e].min,b:s[e].max,updateZLegend:n,omic:e,plotHeatMap:a}),(0,i.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"space-around"},children:[t.current[e].down>0&&(0,i.jsx)(l.Z,{sx:{width:1160/(2*o.length)}}),t.current[e].up>0&&(0,i.jsx)(l.Z,{sx:{width:1160/(2*o.length)}})]})]})},e)),(0,i.jsx)(l.Z,{sx:{width:"5%"}})]})},eL=s(36970);let eT=(0,M.ZP)(A.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function eB(){let[e,t]=x.useState(!1),s=()=>{t(!1)};return(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(m.Z,{"aria-label":"question",size:"large",onClick:()=>{t(!0)},children:(0,i.jsx)(z.Z,{fontSize:"inherit"})}),(0,i.jsxs)(eT,{onClose:s,"aria-labelledby":"customized-dialog-title",open:e,maxWidth:"lg",children:[(0,i.jsx)(S.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"Multi-Omics Factor Analysis (MOFA) - Heatmap"}),(0,i.jsx)(m.Z,{"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,i.jsx)(P.default,{})}),(0,i.jsxs)(F.Z,{sx:{textAlign:"justify"},dividers:!0,children:[(0,i.jsx)(c.Z,{gutterBottom:!0,children:"This subsection visualizes the quantitative values of the biomolecules selected in the Loading Plot Distribution section, providing a comprehensive overview of their expression patterns across samples."}),(0,i.jsxs)(l.Z,{sx:{pl:3},children:[(0,i.jsx)(c.Z,{gutterBottom:!0,children:(0,i.jsx)("strong",{children:"Heatmap Representation:"})}),(0,i.jsxs)(D.Z,{sx:{listStyleType:"disc",border:"0px solid blue",listStyle:"outside"},children:[(0,i.jsxs)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,i.jsx)("strong",{children:"Columns"}),": Each column represents a biomolecule from the selected omics, showcasing their quantitative values."]}),(0,i.jsxs)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,i.jsx)("strong",{children:"Rows"}),": Each row corresponds to a sample, grouped according to the metadata variable selected at the top of the section."]}),(0,i.jsxs)(O.ZP,{sx:{display:"list-item",textAlign:"justify"},children:[(0,i.jsx)("strong",{children:"Color Range Customization"}),": The heatmap’s color range can be adjusted using the legend at the bottom."]})]}),(0,i.jsx)(c.Z,{gutterBottom:!0,children:"Located at the bottom of the section, the Explore Features button allows for an in-depth exploration of the biomolecules displayed in the heatmap. Clicking it will take you to a detailed analysis section, where you can further investigate the selected biomolecules and delve into their biological significance."})]})]}),(0,i.jsx)(k.Z,{children:(0,i.jsx)(l.Z,{sx:{textAlign:"justify",p:2},children:(0,i.jsx)(c.Z,{gutterBottom:!0,children:"[1] Argelaguet R, Velten B, Arnol D, Dietrich S, Zenz T, Marioni JC, Buettner F, Huber W, Stegle O. Multi-Omics Factor Analysis-a framework for unsupervised integration of multi-omics data sets. Mol Syst Biol. 2018 Jun 20;14(6):e8124. doi: 10.15252/msb.20178124. PMID: 29925568; PMCID: PMC6010767."})})})]})]})}var eI=function(e){let{nFeatRef:t,fLVec:s,mdataCol:n,plotHM:a,plotHeatMap:o}=e,{omics:r}=(0,p.tc)(),c=(0,p.tc)().user.mdata.shape[0]<=24;(0,p.tc)().user.mdata.columns[0];let d=(0,u.a0)().MOFA.displayOpts.zLegend,[h,m]=(0,eL.x)(r.reduce((e,t)=>({...e,[t]:{min:d[t].min,max:d[t].max}}),{})),g=(0,p.tc)().norm,j=(0,x.useMemo)(()=>r.map(e=>g["x".concat(e)].index).reduce((e,t)=>e.filter(e=>t.includes(e))),[r,g]),f=(0,x.useMemo)(()=>{console.log(a);let e={};return r.map(i=>{e[i]={down:s[i].filter((e,s)=>s<t.current[i].down).map(e=>e[0]),up:s[i].filter((e,l)=>l>=s[i].length-t.current[i].up).map(e=>e[0])}}),e},[r,t,s,a]);return(0,i.jsxs)(l.Z,{children:[(0,i.jsx)(l.Z,{children:(0,i.jsx)(eB,{})}),(0,i.jsx)(eD,{nFeatRef:t}),(0,i.jsxs)(l.Z,{sx:{mt:1,display:"flex",justifyContent:"center"},children:[(0,i.jsx)(l.Z,{sx:{width:"5%",display:"flex",justifyContent:"flex-end"},children:(0,i.jsx)(ek,{myIndex:j,mdataCol:n,showBorder:!0,showLevel:!0})}),r.map(e=>(0,i.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"center"},children:[t.current[e].down>0&&(0,i.jsx)(eF,{omic:e,myIndex:j,myFeat:f[e].down,mdataCol:n,zLegend:h[e]}),t.current[e].up>0&&(0,i.jsx)(eF,{omic:e,myIndex:j,myFeat:f[e].up,mdataCol:n,zLegend:h[e]})]},e)),(0,i.jsx)(l.Z,{sx:{width:"5%",display:"flex",justifyContent:"flex-start"},children:c&&(0,i.jsx)(ek,{myIndex:j,mdataCol:n,showBorder:!1,showLevel:!1})})]}),(0,i.jsx)(ez,{nFeatRef:t,zLegend:h,updateZLegend:m,plotHeatMap:o})]})},eR=s(98864),eE=s.n(eR);let eN=eE()(()=>Promise.all([s.e(813),s.e(261),s.e(30),s.e(378),s.e(794),s.e(164)]).then(s.bind(s,47169)),{loadableGenerated:{webpack:()=>[47169]}}),e_=e=>{if(null==e)return[null,null];let t=Object.keys(e.anova),s=Object.keys(e.explained_variance);t=t.map(t=>({f:t,var:s.reduce((s,i)=>s+e.explained_variance[i][t].Explained_Variance,0)})).filter(e=>e.var>2).map(e=>e.f);let i=t.map((e,t)=>t+1);return[i,t]},eK=(e,t)=>null==e?null:Object.keys(e.anova[t[0]]).map(s=>[s,t.map(t=>0==Object.keys(e.anova[t][s]).length).every(e=>e)]).filter(e=>!e[1]).map(e=>e[0]),eq=(e,t,s)=>{if(null==e||null==t)return null;let i=s.reduce((e,t)=>({...e,[t]:[]}),{});return Object.keys(i).map(s=>{i[s]=Object.keys(e.loadings[s][t.Factor]).map(i=>[i,e.loadings[s][t.Factor][i]]),i[s].sort((e,t)=>e[1]-t[1]),i[s]=i[s].map((e,t)=>[...e,(t+1)/i[s].length])}),i};var eV=function(){let e=(0,u.mX)(),{API_URL:t}=(0,h.S)(),{jobID:s}=(0,p.tc)(),m=(0,u.a0)().MOFA.data,[g,j]=(0,x.useState)(m),f=(0,u.a0)().MOFA.displayOpts.scatterMode,[y,b]=(0,x.useState)(f),Z=(0,u.a0)().MOFA.displayOpts.selectedPlot,[v,w]=(0,x.useState)(Z),C=(0,u.a0)().MOFA.displayOpts.selectedCell,[M,A]=(0,x.useState)(C),S=(0,u.a0)().MOFA.displayOpts.selectedPlot2D,[F,k]=(0,x.useState)(S),P=(0,x.useCallback)(async()=>{if(console.log("Fetching MOFA data"),null==m){let i=await fetch("".concat(t,"/get_mofa/").concat(s)),l=await i.json();j(l.dataMOFA),e({type:"set-mofa-data",data:l.dataMOFA})}},[m,t,e,s]);(0,x.useEffect)(()=>{let e=setTimeout(P,100);return()=>clearTimeout(e)},[P]);let[D,O]=(0,x.useMemo)(()=>e_(g),[g]),z=(0,x.useMemo)(()=>eK(g,O),[g,O]);null!=O&&null!=z&&null==v&&(w({mdataCol:z[0],Factor:O[0]}),A({rowIndex:0,colIndex:0})),(0,x.useEffect)(()=>{if(null!=O&&null!=z&&null==F){let t={x:O[0],y:O.length>1?O[1]:O[0],g:"No color"};k(t),e({type:"set-selected-plot-2d-mofa",mode:t})}},[O,z,F,e]);let[L,B]=(0,x.useState)(!1),I=(0,x.useCallback)(()=>{console.log("Refresh"),B(e=>!e)},[B]);(0,x.useEffect)(()=>{let e=setTimeout(I,1e3);return()=>clearTimeout(e)},[B,I]),(0,x.useEffect)(()=>{null!=v&&null!=M&&(I(),e({type:"set-selected-plot-cell-mofa",rowIndex:M.rowIndex,colIndex:M.colIndex,mdataCol:v.mdataCol,Factor:v.Factor}))},[v,M,e,I]);let{omics:R}=(0,p.tc)(),E=(0,x.useRef)(R.reduce((e,t)=>({...e,[t]:{down:0,up:0}}),{})),N=(0,x.useRef)(R.reduce((e,t)=>({...e,[t]:{down:0,up:0}}),{})),K=(0,x.useMemo)(()=>eq(g,v,R),[g,v,R]),[q,V]=(0,x.useState)(!1),[H,W]=(0,x.useState)(!1);return(0,i.jsx)(l.Z,{children:(0,i.jsx)(ep.c,{height:"80vh",children:null!=g&&null!=v&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ep.E,{children:[(0,i.jsx)(l.Z,{sx:{height:3},children:(0,i.jsx)(T,{})}),(0,i.jsx)(l.Z,{sx:{p:5},children:(0,i.jsx)(_,{anova:g.anova,explained_variance:g.explained_variance,setSelectedPlot:w,selectedCell:M,setSelectedCell:A,scatterMode:y,rowNames:z,colNames:D,factorNames:O})})]}),(0,i.jsxs)(ep.E,{children:[(0,i.jsx)(n.Z,{children:"Projections"}),(0,i.jsx)(l.Z,{sx:{mt:2},children:(0,i.jsx)(eh,{scatterMode:y,setScatterMode:b,selectedPlot:v,setSelectedPlot:w,setSelectedCell:A,selectedPlot2D:F,setSelectedPlot2D:k,rowNames:z,factorNames:O,projections:g.projections})})]}),"1D"==y&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(ep.E,{sx:{mt:1},children:[(0,i.jsxs)(n.Z,{variant:"h6",sx:{textAlign:"center"},children:["Feature Loading Analysis: ",v.Factor]}),(0,i.jsx)(eA,{fLVec:K,nFeatRef:E,thrLRef:N,plotHeatMap:I})]}),(0,i.jsxs)(ep.E,{children:[(0,i.jsx)(n.Z,{children:"HeatMap"}),(0,i.jsx)(eI,{nFeatRef:E,fLVec:K,mdataCol:v.mdataCol,plotHM:L,plotHeatMap:I})]}),(0,i.jsxs)(ep.E,{children:[(0,i.jsx)(l.Z,{sx:{textAlign:"center",mt:2},children:(0,i.jsx)(a.Z,{color:"primary",variant:"outlined",endIcon:(0,i.jsx)(d.Z,{}),onClick:()=>{W(!0),V(!0)},children:"Explore Features"})}),(0,i.jsx)(o.Z,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:H,children:(0,i.jsxs)(l.Z,{sx:{textAlign:"center"},children:[(0,i.jsx)(r.Z,{color:"inherit"}),(0,i.jsx)(l.Z,{sx:{pt:2},children:(0,i.jsx)(c.Z,{children:"Loading features..."})})]})}),q&&(0,i.jsx)(eN,{exploreF:q,setExploreF:V,Factor:v.Factor,mdataCol:v.mdataCol,thrLRef:N.current,setEFLoading:W})]})]})]})})})}},2678:function(e,t,s){s.d(t,{L:function(){return r}});var i=s(57437),l=s(96507),n=s(46776),a=s(52481),o=s(31863);let r=e=>{let{scatterRef:t,fileName:s}=e;return(0,i.jsx)(l.Z,{sx:{height:0},children:(0,i.jsx)(l.Z,{sx:{width:50,position:"relative",top:0,zIndex:500},children:(0,i.jsx)(n.Z,{"aria-label":"download",size:"small",onClick:()=>{let e=t.current.container.cloneNode(!0),i=window.document.createElement("div");i.appendChild(e),(0,o.default)(i,s)},sx:{opacity:.5},children:(0,i.jsx)(a.Z,{})})})})}}}]);