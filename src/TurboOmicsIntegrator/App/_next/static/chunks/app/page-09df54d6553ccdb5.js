(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{19026:function(e,t,l){Promise.resolve().then(l.bind(l,28325)),Promise.resolve().then(l.bind(l,24611)),Promise.resolve().then(l.bind(l,11093))},28325:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return u}});var a=l(57437),n=l(42824),r=l(57380),s=l(87550),i=l(57175),o=l(11093),c=l(16691),d=l.n(c);function u(){let e=(0,o.useVars)().BASE_URL;return(0,a.jsxs)(s.Z,{bg:"dark","data-bs-theme":"dark",className:"bg-body-tertiary",style:{fontSize:"1.2em"},children:[(0,a.jsxs)(n.Z,{className:"mx-0",children:[(0,a.jsx)(s.Z.Brand,{href:"#home",children:(0,a.jsx)(d(),{src:"".concat(e,"/icon.ico"),width:"30",height:"30",className:"d-inline-block align-top",alt:"TurboPutative"})}),(0,a.jsx)(s.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,a.jsx)(s.Z.Collapse,{id:"basic-navbar-nav",children:(0,a.jsxs)(r.Z,{className:"me-auto",children:[(0,a.jsx)(r.Z.Link,{href:"home",className:"mx-2",children:"Home"}),(0,a.jsx)(r.Z.Link,{href:"TurboOmicsApp.html",active:!0,className:"mx-2",children:"TurboOmics"}),(0,a.jsx)(r.Z.Link,{href:"webserver",className:"mx-2",children:"Web Server"}),(0,a.jsx)(r.Z.Link,{href:"webservices",className:"mx-2",children:"Web Services"}),(0,a.jsxs)(i.Z,{title:"Help",id:"basic-nav-dropdown",children:[(0,a.jsx)(i.Z.Item,{href:"webserverhelp",children:"Web Server"}),(0,a.jsx)(i.Z.Item,{href:"webserviceshelp",children:"Web Services"}),(0,a.jsx)(i.Z.Divider,{}),(0,a.jsx)(i.Z.Item,{href:"moduleshelp",children:"Modules"})]}),(0,a.jsx)(r.Z.Link,{href:"contactUs",className:"mx-2",children:"Contact us"})]})})]}),(0,a.jsx)(s.Z.Collapse,{className:"justify-content-end",children:(0,a.jsx)(s.Z.Brand,{href:"home",style:{fontSize:"1.2em"},children:"TurboPutative"})})]})}},11093:function(e,t,l){"use strict";l.r(t),l.d(t,{VarsProvider:function(){return s},useVars:function(){return i}});var a=l(57437),n=l(2265);let r=(0,n.createContext)({DEV_MODE:!1,BASE_URL:"/TurboPutative",API_URL:"https://proteomics.cnic.es/TurboPutative/api/tbomics"});function s(e){let{children:t}=e,l=i();return(0,a.jsx)(r.Provider,{value:l,children:t})}function i(){return(0,n.useContext)(r)}},24611:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return ts}});var a=l(57437),n=l(2265),r=l(24983),s=l(59844);function i(e){let{children:t}=e;return(0,a.jsx)(s.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeOut",duration:.5},children:t})}var o=l(49904),c=l(58991),d=l(62455),u=l(62970),x=l(49381),h=l(43226),m=l(15133),p=l(35843);let j=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{width:110,height:70,textAlign:"center",backgroundColor:e,cursor:t?"not-allowed":"pointer",userSelect:"none",margin:"0px 15px"}},b=(0,p.ZP)(m.Z)(e=>{let{theme:t}=e;return{transition:"transform 0.15s ease-in-out, background 0.15s","&:hover":{transform:"scale3d(1.05, 1.05, 1)",backgroundColor:"rgba(204, 229, 255, 0.8)"}}});function f(e){let t,{children:l,text:n,id:s,setPage:i,page:o}=e,c=(0,r.tc)().jobID,d="results"==s&&null==c;t=d?"rgba(210,210,210,0.8)":o==s?"rgba(204, 229, 255, 0.8)":"rgba(255,255,255,1)";let u=j(t,d);return(0,a.jsx)(a.Fragment,{children:d?(0,a.jsxs)(m.Z,{sx:u,children:[(0,a.jsx)("div",{className:"py-2",children:l}),(0,a.jsx)("div",{children:(0,a.jsx)(h.Z,{gutterBottom:!0,variant:"h7",component:"div",children:n})})]}):(0,a.jsxs)(b,{sx:u,onClick:()=>i(s),children:[(0,a.jsx)("div",{className:"py-2",children:l}),(0,a.jsx)("div",{children:(0,a.jsx)(h.Z,{gutterBottom:!0,variant:"h7",component:"div",children:n})})]})})}let g=(0,p.ZP)(m.Z)(e=>{let{theme:t}=e;return{transition:"transform 0.15s ease-in-out, background 0.15s","&:hover":{transform:"scale3d(1.05, 1.05, 1)",backgroundColor:"rgba(255, 0, 0, 0.3)"}}});function v(e){let{children:t,text:l,setPage:n}=e;return(0,a.jsxs)(g,{sx:{...j("rgba(255, 0, 0, 0.2)"),position:"absolute",right:"12%"},onClick:()=>n("create-job"),children:[(0,a.jsx)("div",{className:"py-2",children:t}),(0,a.jsx)("div",{children:(0,a.jsx)(h.Z,{gutterBottom:!0,variant:"h7",component:"div",children:l})})]})}var y=l(11093),Z=l(35551);function C(e){let{children:t}=e,{API_URL:l}=(0,y.useVars)(),n=(0,r.Lq)(),s=async e=>{console.log("Loading sample data");let t=await fetch("".concat(l,"/load_sample_data")),a=await t.json();Object.keys(a).forEach(e=>{n({type:"user-upload",fileType:e,userFileName:"".concat(e,".tsv"),dfJson:a[e]})})};return(0,a.jsx)("div",{className:"align-self-center",style:{position:"absolute",left:"10%"},children:(0,a.jsx)(Z.Z,{variant:"outlined",startIcon:t,onClick:s,children:"Load Sample Data"})})}function P(e){let{page:t,setPage:l}=e,{jobID:n,user:s}=(0,r.tc)();return(0,a.jsxs)("div",{className:"my-2 d-flex justify-content-center",children:["new-job"==t&&(0,a.jsx)(C,{page:t,children:(0,a.jsx)(x.Z,{})}),(0,a.jsx)(f,{text:"New Job",id:"new-job",setPage:l,page:t,children:(0,a.jsx)(o.Z,{})}),(0,a.jsx)(f,{text:"Find Job",id:"find-job",setPage:l,page:t,children:(0,a.jsx)(c.Z,{})}),(0,a.jsx)(f,{text:"Results",id:"results",setPage:l,page:t,children:(0,a.jsx)(d.Z,{})}),"new-job"==t&&s.mdata&&s.xm&&s.m2i&&s.xq&&s.q2i&&(0,a.jsx)(i,{children:(0,a.jsx)(v,{text:"Create Job",setPage:l,children:(0,a.jsx)(u.Z,{})})})]})}var w=l(96507),A=l(11922),T=l(89394),N=l(91797),S=l(26337),k=l(52653),D=l(6252),F=l(33533);l(16691);let I=(0,p.ZP)(T.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function R(e){let{title:t}=e,[l,r]=(0,n.useState)(!1),s=()=>r(!1),i=(0,y.useVars)().BASE_URL;return(0,a.jsxs)("div",{className:"mt-0 pt-0",children:[(0,a.jsx)(k.Z,{onClick:()=>r(!0),children:(0,a.jsx)(D.Z,{})}),(0,a.jsxs)(I,{onClose:s,"aria-labelledby":"customized-dialog-title",open:l,maxWidth:"md",children:[(0,a.jsxs)(N.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:[t," Table"]}),(0,a.jsx)(k.Z,{"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,a.jsx)(F.Z,{})}),(0,a.jsxs)(S.Z,{dividers:!0,children:[(0,a.jsx)(h.Z,{gutterBottom:!0,children:"Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1"}),(0,a.jsx)(h.Z,{gutterBottom:!0,children:"Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2"}),(0,a.jsx)("div",{className:"text-center mt-3",children:(0,a.jsx)("img",{src:"".concat(i,"/table.png"),alt:"Table"})})]})]})]})}let M=["","#N/A","#N/A","N/A","#NA","-1.#IND","-1.#QNAN","-NaN","-nan","1.#IND","1.#QNAN","<NA>","N/A","NA","NULL","NaN","None","n/a","nan","null"],q=["TSV"];function E(e){let{title:t,fileType:l}=e,n=(0,r.tc)().userFileNames[l],s=(0,r.Lq)();async function i(e){let t=await e.text(),a=await function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"	";return new Promise(l=>{let a=e.split(/[\r\n]+/);if(a.length<2)throw Error("String text does not have expected DataFrame format");let n=a[0].split(t).map(e=>e.trim()),r=[];for(let e=1;e<a.length;e++){let l=a[e].split(t).map(e=>e.trim());if(l.length===n.length){let e={};for(let t=0;t<n.length;t++)e[n[t]]=M.includes(l[t])?void 0:l[t];r.push(e)}else console.log(l),console.log("Row number ".concat(e," could not be read"))}l(r)})}(t);s({type:"user-upload",fileType:l,userFileName:e.name,dfJson:a})}return(0,a.jsx)("div",{className:"DragFile mx-2 text-center",style:{width:"30%"},children:(0,a.jsxs)(m.Z,{variant:"outlined",className:"px-4 ".concat(n&&"border-dark"),style:{transition:"all 1s ease"},children:[(0,a.jsx)(h.Z,{variant:"h6",className:"pt-2",children:t}),(0,a.jsx)(R,{title:t}),(0,a.jsx)(A.b,{multiple:!1,handleChange:i,name:l,types:q}),(0,a.jsx)("p",{className:"mt-3",children:n?"File name: ".concat(n):"no files uploaded yet"})]})})}var V=l(73701),L=l(39279),O=l(30666),z=l(15795),B=l(98489),_=l(29872),J=l(39190);let K=(0,J.Z)(O.Z)(e=>{let{theme:t}=e;return{textAlign:"center"}});function U(){let e=(0,r.tc)().results.PRE.MVThr.xq,t=(0,r.tc)().results.PRE.MVThr.xm,l=(0,r.tc)().user;return(0,a.jsx)(z.Z,{component:_.Z,sx:{width:300},children:(0,a.jsx)(V.Z,{size:"small","aria-label":"a dense table",children:(0,a.jsxs)(L.Z,{children:[null!=l.mdata&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(B.Z,{children:[(0,a.jsx)(K,{children:"n"}),(0,a.jsx)(K,{children:l.mdata.shape[0]})]}),(0,a.jsxs)(B.Z,{children:[(0,a.jsx)(K,{children:"Meta-variables"}),(0,a.jsx)(K,{children:l.mdata.shape[1]})]})]}),null!=l.xq&&(0,a.jsxs)(B.Z,{children:[(0,a.jsx)(K,{children:"Proteomic features"}),(0,a.jsxs)(K,{children:[l.xq.isNa().sum({axis:0}).div(l.xq.shape[0]).le(e).sum()," / ",l.xq.shape[1]]})]}),null!=l.xm&&(0,a.jsxs)(B.Z,{children:[(0,a.jsx)(K,{children:"Metabolomic features"}),(0,a.jsxs)(K,{children:[l.xm.isNa().sum({axis:0}).div(l.xm.shape[0]).le(t).sum()," / ",l.xm.shape[1]]})]})]})})})}var G=l(98864),Y=l.n(G);let H=Y()(()=>l.e(362).then(l.bind(l,84362)),{loadableGenerated:{webpack:()=>[84362]},ssr:!1});function W(){return(0,a.jsxs)(w.Z,{sx:{width:"100%"},className:"p-2",children:[(0,a.jsxs)("div",{className:"py-2 d-flex justify-content-between",children:[(0,a.jsx)(E,{title:"Proteomic Metadata",fileType:"q2i"}),(0,a.jsx)(E,{title:"Metadata",fileType:"mdata"}),(0,a.jsx)(E,{title:"Metabolomic Metadata",fileType:"m2i"})]}),(0,a.jsxs)("div",{className:"py-2 d-flex justify-content-between align-items-center",children:[(0,a.jsx)(E,{title:"Proteomic Quantifications",fileType:"xq"}),(0,a.jsx)(U,{}),(0,a.jsx)(E,{title:"Metabolomic Quantifications",fileType:"xm"})]}),(0,a.jsxs)("div",{className:"py-2 d-flex justify-content-between",children:[(0,a.jsx)(H,{fileType:"xq",omic:"Proteomic"}),(0,a.jsx)(H,{fileType:"xm",omic:"Metabolomic"})]})]})}var X=l(99960);function Q(e){let{setPage:t}=e,[l,s]=(0,n.useState)(""),[i,o]=(0,n.useState)(!0),d=(0,r.Lq)(),u=(0,y.useVars)().API_URL;async function x(e){console.log("Search Job ID: ".concat(e));let l=await fetch("".concat(u,"/search/").concat(e)),a=await l.json();console.log("Server response received:"),a.exist?(d({type:"find-job",results:a.results}),t("results")):o(!1)}return(0,a.jsx)("div",{className:"mx-auto mt-4 text-center",children:(0,a.jsx)(X.Z,{id:"outlined-basic",label:"Search Job",variant:"outlined",onChange:e=>{s(e.target.value),o(!0)},value:l,InputProps:{endAdornment:(0,a.jsx)(()=>(0,a.jsx)(k.Z,{onClick:()=>x(l),children:(0,a.jsx)(c.Z,{})}),{})},sx:{width:"70%",marginTop:"20%"},autoFocus:!0,error:!i,helperText:!i&&"Job not found"})})}var $=l(74275),ee=l.n($),et=l(19045),el=l(92277),ea=l(6882),en=l(28874);function er(e,t){let l=e.slice().sort((e,t)=>e-t),a=Math.floor(l.length*t),n=l[a];return n}var es=l(90045),ei=l(16573),eo=l(24235),ec=l(50039),ed=l(2047),eu=l(51125);let ex=["#636EFA","#EF553B","#00CC96","#AB63FA","#FFA15A","#19D3F3","#FF6692","#B6E880","#FF97FF","#FECB52"];function eh(e){let{dataHist:t,gValues:l,xrange:n,yrange:r,xTicks:s,histRef:i}=e;return(0,a.jsxs)(es.T,{ref:i,style:{margin:"auto"},width:500,height:210,data:t,margin:{top:10,right:30,left:0,bottom:0},children:[(0,a.jsx)(ei.q,{strokeDasharray:"3 3"}),(0,a.jsx)(eo.K,{dataKey:"binCenter",type:"number",ticks:s,domain:n}),(0,a.jsx)(ec.B,{domain:r}),(0,a.jsx)(ed.u,{}),l.map((e,t)=>(0,a.jsx)(eu.u,{connectNulls:!0,type:"monotone",dataKey:e,fillOpacity:.3,stroke:ex[t%ex.length],fill:ex[t%ex.length]},e))]})}let em=Y()(()=>Promise.all([l.e(934),l.e(901)]).then(l.bind(l,87022)),{loadableGenerated:{webpack:()=>[87022]},ssr:!1});function ep(e){let{data:t,xrange:l,xTicks:n,boxRef:r}=e;return(0,a.jsx)(w.Z,{ref:r,children:(0,a.jsx)(em,{style:{position:"relative",left:-20},data:t,layout:{width:570,height:280,showlegend:!0,legend:{orientation:"h"},xaxis:{zeroline:!1,range:l,tickvals:n},yaxis:{type:"category",showticklabels:!1},margin:{t:0}},config:{staticPlot:!0,displayModeBar:!1},onChange:e=>console.log(e)})})}function ej(e){let{fileType:t,filteredID:l,groupby:s,showNorm:o,histRef:c,boxRef:d}=e,u=(0,r.tc)().user.mdata,x={norm:(0,r.tc)().norm[t],user:(0,r.tc)().user[t]},h=o?x.norm:x.user,{myData:m,dataAnova:p,gValues:j,idx2g:b}=(0,n.useMemo)(()=>{let e;let t={};for(let e=0;e<u.shape[0];e++)u.columns.includes(s)?null!=u.column(s).values[e]&&(t[u.index[e]]=u.column(s).values[e]):t[u.index[e]]="All values";let a=Object.keys(t).map(e=>t[e]).filter((e,t,l)=>l.indexOf(e)===t),n=[],r={};a.map(e=>r[e]=[]);let i=(e={},dfd.toJSON(h).map((t,l)=>{e[h.index[l]]=t}),e);return Object.keys(i).map(e=>{Object.keys(t).includes(e)&&Object.keys(i[e]).map(a=>{null!=i[e][a]&&l.includes(a)&&(r[t[e]].push(i[e][a]),n.push({ID:e,feature:a,g:t[e],x:i[e][a]}))})}),{myData:r,dataAnova:n,gValues:a,idx2g:t}},[s,u,h,l]),{xrange:f,xTicks:g,minimum:v,maximum:y}=(0,n.useMemo)(e=>{let t=Object.keys(m).map(e=>m[e]).flat(),l=er(t,1e-4),a=er(t,.9999),n=[l-Math.abs(.05*l),a+Math.abs(.05*a)],r=function(e,t,l){let a=(t-e)/(l-1),n=[];for(let t=0;t<l;t++){let l=e+t*a;n.push(l)}return n.filter(e=>e<0).length>0&&n.filter(e=>e>0).length>0&&n.push(0),n.sort((e,t)=>e-t),n=n.map(e=>Math.floor(100*e)/100)}(l,a,6);return{xrange:n,xTicks:r,minimum:l,maximum:a}},[m]),{dataHist:Z,yrange:C}=(0,n.useMemo)(()=>{let e={};Object.keys(m).map(t=>{e[t]=m[t].filter(e=>v<=e&&e<=y)}),Object.keys(e).map(t=>{try{e[t].length>0?e[t]=function(e,t){let l=Math.min(...e),a=(Math.max(...e)-l)/t,n=Array(t).fill(0);e.forEach(e=>{let r=Math.floor((e-l)/a);r>=0&&r<t&&n[r]++});let r=n.map(t=>t/(e.length*a)),s=Array(t).fill(0).map((e,t)=>l+(t+.5)*a),i=[];for(let e=0;e<t;e++)i.push({binCenter:s[e],density:r[e]});return i}(e[t],1+Math.ceil(Math.log2(e[t].length))):delete e[t]}catch(e){console.error(e)}}),(e=(e=Object.keys(e).map(t=>e[t].map(e=>{let{binCenter:l,density:a}=e;return{binCenter:Math.round(100*l)/100,[t]:Number.parseFloat(a).toExponential(3),d:a}}))).flat()).sort((e,t)=>e.binCenter-t.binCenter);let t=Math.max(...e.map(e=>e.d)),l=[0,Number.parseFloat((1.05*t).toPrecision(2))];return{dataHist:e,yrange:l}},[m,v,y]),P=(0,n.useMemo)(()=>Object.keys(m).map((e,t)=>m[e].length>0?{x:m[e],type:"box",name:"".concat(e),marker:{color:ex[t%ex.length]}}:null).filter(e=>null!=e),[m]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.Z,{sx:{height:210},children:(0,a.jsx)(eh,{dataHist:Z,gValues:j,xrange:f,xTicks:g,yrange:C,histRef:c})}),(0,a.jsx)(w.Z,{sx:{height:280,width:500,margin:"auto",overflowX:"hidden",overflowY:"hidden"},children:(0,a.jsx)(i,{children:(0,a.jsx)(ep,{data:P,xrange:f,xTicks:g,boxRef:d})})})]})}var eb=l(40182),ef=l(45421),eg=l(97472);function ev(e){let{handleSwitch:t,label:l}=e,[r,s]=(0,n.useState)(!0);return(0,a.jsx)(eb.Z,{control:(0,a.jsx)(ef.Z,{checked:r,onChange:e=>{s(e.target.checked),setTimeout(()=>{t(e)},100)}}),label:l})}function ey(e){let{options:t,handleSelect:l,label:r}=e,[s,i]=(0,n.useState)({label:"All values",value:"All values"});return(0,a.jsxs)(w.Z,{children:[(0,a.jsx)("label",{id:"aria-label",htmlFor:"aria-example-input",children:r}),(0,a.jsx)(eg.ZP,{"aria-labelledby":"aria-label",inputId:"aria-example-input",className:"basic-single",classNamePrefix:"select",placeholder:"",isSearchable:!0,isClearable:!1,options:t,value:s,onChange:e=>{i({label:e.value,value:e.value}),setTimeout(()=>l(e),100)}})]})}function eZ(e){let{options:t,value:l,onChange:n,label:r}=e;return(0,a.jsxs)(w.Z,{children:[(0,a.jsx)("label",{id:"aria-label",htmlFor:"aria-example-input",children:r}),(0,a.jsx)(eg.ZP,{"aria-labelledby":"aria-label",inputId:"aria-example-input",className:"basic-single",classNamePrefix:"select",placeholder:"",isSearchable:!0,isClearable:!1,options:t,value:l,onChange:n})]})}var eC=l(43560);function eP(e){let{columns:t,data:l}=e,r=(0,n.useRef)(null),[s,o]=(0,n.useState)(!0),[c,d]=(0,n.useState)([]);return(0,n.useEffect)(()=>{o(!1)},[]),(0,n.useEffect)(()=>{try{var e,t;null===(t=r.current)||void 0===t||null===(e=t.scrollToIndex)||void 0===e||e.call(t,0)}catch(e){console.error(e)}},[c]),(0,a.jsx)(i,{children:(0,a.jsx)("div",{style:{opacity:.9,width:"100%",margin:"auto"},children:(0,a.jsx)(eC.P2,{columns:t,data:l,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnResizing:!0,enableColumnVirtualization:!0,enableColumnActions:!1,enableColumnFilters:!1,enableGlobalFilterModes:!1,enableFullScreenToggle:!1,enablePinning:!1,enablePagination:!1,enableRowNumbers:!1,enableDensityToggle:!1,enableRowVirtualization:!0,muiTableContainerProps:{sx:{maxHeight:"500px"}},onSortingChange:d,state:{isLoading:s,sorting:c},rowVirtualizerInstanceRef:r,rowVirtualizerProps:{overscan:1},columnVirtualizerProps:{overscan:2}})})})}function ew(e){let{omic:t,fileType:l,setFilteredID:s,updatePlot:o}=e,[c,d]=(0,n.useState)(""),[u,x]=(0,n.useState)("All features"),h=(0,r.tc)().user[l],{filteredFeatures:m,columns:p}=(0,n.useMemo)(()=>{console.log("calculating filteredFeatures");let e={},t=[{accessorKey:"ID",header:"ID",size:50}];return h.columns.includes(u)?(e=(e=(e=h.column(u)).values.map((t,l)=>({ID:e.index[l],[u]:t}))).filter(e=>null!=e[u]&&"".concat(e[u]).toLowerCase().includes(c.toLowerCase())),t.push({accessorKey:u,header:u,size:170})):e=(e=h.index).map((e,t)=>({ID:e})),{filteredFeatures:e,columns:t}},[c,u,h]);return(0,n.useEffect)(()=>{console.log("useEffect: Recalculating features");let e=setTimeout(()=>{s(e=>({...e,[l]:m.map(e=>e.ID)})),o([t]),console.log("Features recalculated")},500);return()=>clearTimeout(e)},[m,l,s,o,t]),(0,a.jsxs)(w.Z,{sx:{width:"95%",margin:"auto"},children:[(0,a.jsxs)(w.Z,{sx:{display:"flex",height:"10vh"},children:[(0,a.jsx)(w.Z,{sx:{width:"40%",pt:1},children:(0,a.jsx)(eZ,{options:[{label:"All features",value:"All features"},...h.columns.map(e=>({label:e,value:e}))],onChange:e=>x(e.value),value:{label:u,value:u}})}),h.columns.includes(u)&&(0,a.jsx)(i,{children:(0,a.jsx)(w.Z,{sx:{mt:3,ml:3},children:(0,a.jsx)(X.Z,{id:"standard-name",placeholder:"Filter text",value:c,onChange:e=>d(e.target.value)})})})]}),(0,a.jsx)(w.Z,{sx:{mt:0},children:(0,a.jsx)(eP,{data:m,columns:p})})]})}var eA=l(52481),eT=l(93097),eN=l.n(eT);function eS(){let e=(0,n.useRef)(),t=(0,n.useRef)(),l=(0,n.useRef)(),s=(0,n.useRef)(),[i,o]=(0,n.useState)({q:!1,m:!1}),[c,d]=(0,n.useState)({q2i:[],m2i:[]}),[u,x]=(0,n.useState)(!0),[m,p]=(0,n.useState)({label:"All values",value:"All values"}),{mdataType:j}=(0,r.tc)(),b=(0,r.tc)().user.mdata.columns.map(e=>({label:e,value:e}));b=[{label:"All values",value:"All values"},...b=b.filter(e=>"categorical"==j[e.value].type)];let f=(0,n.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["q","m"];e.map(e=>{o(t=>({...t,[e]:!1}))}),e.map(e=>setTimeout(()=>o(t=>({...t,[e]:!0})),300))},[]),g=(0,n.useCallback)(e=>{p({label:e.value,value:e.value}),f(["q","m"])},[f]),v=(0,n.useCallback)(e=>{x(e.target.checked),f(["q","m"])},[f]);return(0,a.jsxs)(w.Z,{children:[(0,a.jsxs)(en.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",sx:{mb:3,mt:0},children:[(0,a.jsx)(en.ZP,{item:!0,xs:2,children:(0,a.jsx)(ev,{handleSwitch:v,label:"Normalized"})}),(0,a.jsx)(en.ZP,{item:!0,xs:3,children:(0,a.jsx)(ey,{options:b,handleSelect:g,label:"Group by"})})]}),(0,a.jsx)(w.Z,{sx:{flexGrow:1,p:0,mt:0},children:(0,a.jsxs)(en.ZP,{container:!0,direction:"row",justifyContent:"center",spacing:2,sx:{p:0},children:[(0,a.jsxs)(en.ZP,{item:!0,sx:{borderRight:"1px solid #cccccc"},xs:6,children:[(0,a.jsxs)(h.Z,{variant:"h6",sx:{textAlign:"center",color:"#555555"},children:["Proteomics",(0,a.jsx)(k.Z,{"aria-label":"download",size:"small",onClick:l=>eN()(e.current,t.current,"Proteomics"),sx:{opacity:.5,visibility:i.q?"visible":"hidden"},children:(0,a.jsx)(eA.Z,{})})]}),i.q?(0,a.jsx)(w.Z,{sx:{height:550,overflowX:"auto"},children:(0,a.jsx)(ej,{fileType:"xq",filteredID:c.q2i,groupby:m.value,showNorm:u,histRef:e,boxRef:t})}):(0,a.jsx)(w.Z,{sx:{textAlign:"center",pt:20,height:"52vh"},children:(0,a.jsx)(ea.Z,{size:100,thickness:2})}),(0,a.jsx)(ew,{omic:"q",fileType:"q2i",setFilteredID:d,updatePlot:f})]}),(0,a.jsxs)(en.ZP,{item:!0,xs:6,sx:{borderLeft:"1px solid #cccccc"},children:[(0,a.jsxs)(h.Z,{variant:"h6",sx:{textAlign:"center",color:"#555555"},children:["Metabolomics",(0,a.jsx)(k.Z,{"aria-label":"download",size:"small",onClick:e=>eN()(l.current,s.current,"Metabolomics"),sx:{opacity:.5,visibility:i.m?"visible":"hidden"},children:(0,a.jsx)(eA.Z,{})})]}),i.m?(0,a.jsx)(w.Z,{sx:{height:550,overflowX:"auto"},children:(0,a.jsx)(ej,{fileType:"xm",filteredID:c.m2i,groupby:m.value,showNorm:u,histRef:l,boxRef:s})}):(0,a.jsx)(w.Z,{sx:{textAlign:"center",pt:20,height:"52vh"},children:(0,a.jsx)(ea.Z,{size:100,thickness:2})}),(0,a.jsx)(ew,{omic:"m",fileType:"m2i",setFilteredID:d,updatePlot:f})]})]})})]})}var ek=l(66988);let eD="rgba(200,200,200,0.5)",eF=()=>({cell:{transition:"background-color 0.3s, border-color 0.3s",border:"1px solid ".concat(eD),cursor:"pointer",padding:.5,fontSize:15,textAlign:"center",userSelect:"none","&:hover":{border:"1px solid rgba(50,50,50,1)"}},selectedCell:{border:"1px solid rgba(20,20,20,1)","&:hover":{border:"1px solid rgba(20,20,20,1)"}}}),eI={textAlign:"center",padding:.5,border:"1px solid ".concat(eD),borderRight:"1px solid rgba(10,10,10,1)",fontSize:15,whiteSpace:"nowrap",userSelect:"none"},eR=e=>({backgroundColor:"rgba(".concat(2550*e,",").concat(200+550*e,",").concat(2550*e,", 0.5)")}),eM=e=>({backgroundColor:"rgba(".concat(255,",").concat(255-255*e/100,",").concat(255-255*e/100,", 0.8)")});function eq(e){let{data:t,rowNames:l,colNames:r,expVar:s,setSelectedPlot:i}=e,o=eF(),[c,d]=(0,n.useState)(null),u=(e,t)=>{d({rowIndex:e,colIndex:t}),i({mdataCol:l[e],PCA:r[t]}),console.log("Plot scatter: PCA ".concat(r[t]," vs ").concat(l[e]))};return(0,a.jsxs)(en.ZP,{container:!0,children:[(0,a.jsx)(en.ZP,{item:!0,xs:2,children:(0,a.jsx)(z.Z,{sx:{margin:"auto"},children:(0,a.jsxs)(V.Z,{children:[(0,a.jsx)(ek.Z,{children:(0,a.jsx)(B.Z,{children:(0,a.jsx)(O.Z,{sx:{padding:0,textAlign:"center"},children:"PCA / Cond."})})}),(0,a.jsxs)(L.Z,{children:[(0,a.jsx)(B.Z,{children:(0,a.jsx)(O.Z,{sx:{padding:0,border:0},children:(0,a.jsx)(w.Z,{sx:{...eI,borderBottom:"1px solid rgba(10,10,10,1)"},children:"%Variance"})})},"expVar"),l.map((e,t)=>(0,a.jsx)(B.Z,{children:(0,a.jsx)(O.Z,{sx:{padding:0,border:0},children:(0,a.jsx)(w.Z,{sx:eI,children:e})})},t))]})]})})}),(0,a.jsx)(en.ZP,{item:!0,xs:10,children:(0,a.jsx)(z.Z,{sx:{margin:"auto"},children:(0,a.jsxs)(V.Z,{children:[(0,a.jsx)(ek.Z,{children:(0,a.jsx)(B.Z,{children:t[0].map((e,t)=>(0,a.jsx)(O.Z,{sx:{padding:0,textAlign:"center",width:50,userSelect:"none"},children:t+1},t))})}),(0,a.jsxs)(L.Z,{children:[(0,a.jsx)(B.Z,{children:s.map((e,t)=>(0,a.jsx)(O.Z,{sx:{padding:0,border:0},children:(0,a.jsx)(w.Z,{sx:{padding:.5,border:"1px solid ".concat(eD),borderBottom:"1px solid rgba(10,10,10,1)",fontSize:15,textAlign:"center",backgroundColor:eM(e),userSelect:"none"},children:e})},t))},"expVar"),t.map((e,t)=>(0,a.jsx)(B.Z,{children:e.map((e,l)=>(0,a.jsx)(O.Z,{sx:{padding:0,border:0},onClick:()=>u(t,l),children:(0,a.jsx)(w.Z,{sx:c&&c.rowIndex===t&&c.colIndex===l?{...o.cell,...o.selectedCell,...eR(e)}:{...o.cell,...eR(e)},children:e.toFixed(3)})},l))},t))]})]})})})]})}var eE=l(35048),eV=l(41125),eL=l(33343),eO=l(89366);let ez=e=>{let{active:t,payload:l}=e;return t&&l&&l.length?(0,a.jsxs)(w.Z,{className:"custom-tooltip",sx:{backgroundColor:"rgba(255,255,255,0.5)",border:"1px solid rgba(50, 50, 50, 0.8)",padding:1,borderRadius:1,color:"rgba(50,50,50,0.8)"},children:[(0,a.jsx)(h.Z,{variant:"h8",sx:{display:"block"},children:"".concat(l[0].payload.element)}),(0,a.jsx)(h.Z,{variant:"h9",sx:{display:"block"},children:"".concat(l[0].name,": ").concat(l[0].payload.mdataValue)}),(0,a.jsx)(h.Z,{variant:"h9",sx:{display:"block"},children:"".concat(l[1].name,": ").concat(l[0].payload.projection.toFixed(3))})]}):null};function eB(e){let t,{scatterData:l,mdataCol:n,PCA:s}=e,i=(0,r.tc)().mdataType[n].type;return"categorical"==i&&(t="category"),"numeric"==i&&(t="number"),(0,a.jsx)(w.Z,{children:(0,a.jsx)(eE.h,{width:"100%",height:400,children:(0,a.jsxs)(eV.G,{margin:{top:20,right:20,bottom:20,left:20},children:[(0,a.jsx)(ei.q,{}),(0,a.jsx)(eo.K,{type:t,dataKey:"mdataValue",name:n,allowDuplicatedCategory:!1,children:(0,a.jsx)(eL._,{value:n,offset:-10,position:"insideBottom"})}),(0,a.jsx)(ec.B,{type:"number",dataKey:"projection",name:"PCA ".concat(s),children:(0,a.jsx)(eL._,{value:"PCA ".concat(s),offset:20,position:"insideLeft",angle:-90})}),(0,a.jsx)(ed.u,{cursor:{strokeDasharray:"3 3"},content:(0,a.jsx)(ez,{})}),(0,a.jsx)(eO.b,{data:l,fill:"#8884d8"})]})})})}var e_=l(92069);function eJ(e){let{omic:t,selectedLoadings:l,selectedPCA:s}=e,[o,c]=(0,n.useState)(""),[d,u]=(0,n.useState)("All features"),x=(0,r.tc)().user["".concat(t,"2i")],{filteredFeatures:h,columns:m}=(0,n.useMemo)(()=>{console.log("calculating filteredFeatures");let e={},t=[{accessorKey:"ID",header:"ID",size:60},{accessorKey:"mdataValue",header:"",size:100},{accessorKey:"PCA",header:"Loadings PCA".concat(s),size:100}];return x.columns.includes(d)?(e=(e=(e=x.column(d)).values.map((t,a)=>({ID:e.index[a],mdataValue:t,PCA:l[e.index[a]]}))).filter(e=>null!=e.mdataValue&&"".concat(e.mdataValue).toLowerCase().includes(o.toLowerCase())),t[1].header=d):e=(e=x.index).map((e,t)=>({ID:e,mdataValue:"",PCA:l[e]})),{filteredFeatures:e=e.filter(e=>void 0!=e.PCA),columns:t}},[l,o,d,x,s]);return(0,a.jsxs)(w.Z,{sx:{width:"95%",margin:"auto"},children:[(0,a.jsxs)(w.Z,{sx:{display:"flex",height:"10vh"},children:[(0,a.jsx)(w.Z,{sx:{width:"40%",pt:1},children:(0,a.jsx)(eZ,{options:[{label:"All features",value:"All features"},...x.columns.map(e=>({label:e,value:e}))],onChange:e=>u(e.value),value:{label:d,value:d}})}),x.columns.includes(d)&&(0,a.jsx)(i,{children:(0,a.jsx)(w.Z,{sx:{mt:3,ml:3},children:(0,a.jsx)(X.Z,{id:"standard-name",placeholder:"Filter text",value:o,onChange:e=>c(e.target.value)})})}),(0,a.jsx)(w.Z,{sx:{mt:4,ml:3},children:(0,a.jsx)(k.Z,{"aria-label":"download",size:"small",onClick:e=>eK(h,m),sx:{opacity:.5},children:(0,a.jsx)(eA.Z,{})})})]}),(0,a.jsx)(w.Z,{sx:{mt:0},children:(0,a.jsx)(eU,{data:h,columns:m})})]})}let eK=(e,t)=>{let l=(0,e_.iL)({useKeysAsHeaders:!0,filename:"PCA_Loading_Table"}),a=e.map(e=>{let l={};return t.map(t=>{""!=t.header&&(l[t.header]=e[t.accessorKey])}),l}),n=(0,e_.gB)(l)(a);(0,e_.LR)(l)(n)};function eU(e){let{columns:t,data:l}=e,r=(0,n.useRef)(null),[s,o]=(0,n.useState)(!0),[c,d]=(0,n.useState)([]);return(0,n.useEffect)(()=>{o(!1)},[]),(0,n.useEffect)(()=>{try{var e,t;null===(t=r.current)||void 0===t||null===(e=t.scrollToIndex)||void 0===e||e.call(t,0)}catch(e){console.error(e)}},[c]),(0,a.jsx)(i,{children:(0,a.jsx)("div",{style:{opacity:.9,width:"100%",margin:"auto"},children:(0,a.jsx)(eC.P2,{columns:t,data:l,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnResizing:!0,enableColumnVirtualization:!0,enableColumnActions:!1,enableColumnFilters:!1,enableGlobalFilterModes:!1,enableFullScreenToggle:!1,enablePinning:!1,enablePagination:!1,enableRowNumbers:!1,enableDensityToggle:!1,enableRowVirtualization:!0,muiTableContainerProps:{sx:{maxHeight:"500px"}},onSortingChange:d,state:{isLoading:s,sorting:c},rowVirtualizerInstanceRef:r,rowVirtualizerProps:{overscan:1},columnVirtualizerProps:{overscan:2}})})})}function eG(e){let{title:t,omic:l}=e,[s,i]=(0,n.useState)(null),[o,c]=(0,n.useState)({projections:null,loadings:null,explained_variance:null,anova:null}),{projections:d,loadings:u,explained_variance:x,anova:m}=o,{mdata:p}=(0,r.tc)().user,{jobID:j}=(0,r.tc)(),{API_URL:b}=(0,y.useVars)();(0,n.useEffect)(()=>{console.log("Get PCA and ANOVA data");let e=async()=>{let e=await fetch("".concat(b,"/get_eda_pca/").concat(j,"/").concat(l)),t=await e.json();console.log(t),c(t)};e()},[b,j,l]);let{pvTable:f,pvRowNames:g,pvColNames:v,pvExpVar:Z}=(0,n.useMemo)(()=>{let e,t,l,a,n;if(null!=m){e=p.columns.map(e=>Object.keys(m).map(t=>[e,parseInt(t),m[t][e]]));for(let t=0;t<e.length;t++)e[t].sort((e,t)=>e[1]-t[1]);l=(e=e.filter(e=>!e.map(e=>0==Object.keys(e[2]).length).every(e=>e))).map(e=>e[0][0]),a=e[0].map(e=>e[1]),t=e.map(e=>e.map(e=>e[2].pvalue)),n=Object.keys(x).map(e=>(100*x[e].Explained_Variance).toFixed(1))}return{pvTable:t,pvRowNames:l,pvColNames:a,pvExpVar:n}},[m,x,p]),C=(0,n.useMemo)(()=>{let e=null;if(s){e=[];let t=p.column(s.mdataCol);Object.keys(d).forEach(l=>{e.push({element:l,projection:d[l][s.PCA],mdataValue:t.values[t.index.indexOf(l)]})})}return e},[s,p,d]),P=(0,n.useMemo)(()=>{let e={};return u&&s&&Object.keys(u).map(t=>{e[t]=parseFloat(u[t][s.PCA].toFixed(5))}),e},[u,s]);return(0,a.jsxs)(w.Z,{sx:{borderRight:"q"==l?"1px solid #cccccc":"0px"},children:[(0,a.jsx)(h.Z,{variant:"h6",sx:{textAlign:"center",color:"#555555"},children:t}),null!=m&&(0,a.jsxs)(w.Z,{sx:{padding:1},children:[(0,a.jsx)(eq,{data:f,rowNames:g,colNames:v,expVar:Z,setSelectedPlot:i}),(0,a.jsx)(w.Z,{sx:{marginTop:5,textAlign:"center"},children:C?(0,a.jsxs)(w.Z,{children:[(0,a.jsx)(eB,{scatterData:C,mdataCol:s.mdataCol,PCA:s.PCA}),(0,a.jsx)(eJ,{omic:l,selectedLoadings:P,selectedPCA:s.PCA})]}):(0,a.jsx)(w.Z,{children:"Select a pvalue cell to plot values"})})]})]})}function eY(){return(0,a.jsx)(w.Z,{children:(0,a.jsxs)(en.ZP,{container:!0,children:[(0,a.jsx)(en.ZP,{item:!0,xs:6,children:(0,a.jsx)(eG,{title:"Proteomics",omic:"q"})}),(0,a.jsx)(en.ZP,{item:!0,xs:6,children:(0,a.jsx)(eG,{title:"Metabolomics",omic:"m"})})]})})}function eH(e){let{children:t,value:l,index:n,...r}=e;return(0,a.jsx)("div",{role:"tabpanel",hidden:l!==n,id:"vertical-tabpanel-".concat(n),"aria-labelledby":"vertical-tab-".concat(n),...r,children:l===n&&(0,a.jsx)(w.Z,{sx:{p:3},children:(0,a.jsx)(h.Z,{children:t})})})}function eW(e){return{id:"vertical-tab-".concat(e),"aria-controls":"vertical-tabpanel-".concat(e)}}function eX(){let[e,t]=(0,n.useState)(.2),l=Math.floor(e),{jobID:s}=(0,r.tc)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(h.Z,{variant:"body2",sx:{textAlign:"right",pr:4},children:["Job ID: ",s]}),(0,a.jsxs)(w.Z,{sx:{flexGrow:1,bgcolor:"background.paper",display:"flex",height:"80vh"},children:[(0,a.jsxs)(et.Z,{orientation:"vertical",value:e,onChange:(e,l)=>{t(l)},"aria-label":"Vertical tabs example",sx:{borderRight:1,borderColor:"divider",width:"15%"},children:[(0,a.jsx)(el.Z,{label:"EXPLORATORY DATA ANALYSIS",value:.1,...eW(0),sx:{mt:2,p:0,color:0==l?"#1976d2":"#00000099"}}),0==l&&(0,a.jsx)(el.Z,{label:"DATA DISTRIBUTION",value:.1,...eW(1),sx:{fontSize:12,m:0,p:0,borderTop:"1px solid #cccccc"}}),0==l&&(0,a.jsx)(el.Z,{label:"PCA",value:.2,...eW(2),sx:{fontSize:12,m:0,p:0,borderBottom:"1px solid #cccccc"}}),(0,a.jsx)(el.Z,{label:"MULTIOMICS FACTOR ANALYSIS",value:1.1,...eW(1),sx:{mt:2}}),(0,a.jsx)(el.Z,{label:"COMMUNITY ANALYSIS",value:2.1,...eW(3),sx:{mt:2}}),(0,a.jsx)(el.Z,{label:"REGULARIZED CANONICAL CORRELATION ANALYSIS",value:3.1,...eW(4),sx:{mt:2}}),(0,a.jsx)(el.Z,{label:"DIFFERENTIAL CORRELATION ANALYSIS",value:4.1,...eW(5),sx:{mt:2}}),(0,a.jsx)(el.Z,{label:"ELASTIC NET",value:5.1,...eW(6),sx:{mt:2}})]}),(0,a.jsxs)(w.Z,{sx:{width:"85%",borderTop:"1px solid #cccccc"},children:[.1==e&&(0,a.jsx)(w.Z,{sx:{p:1},children:(0,a.jsx)(eS,{})}),.2==e&&(0,a.jsx)(w.Z,{sx:{p:1},children:(0,a.jsx)(eY,{})}),(0,a.jsx)(eH,{value:e,index:1.1,children:"MOFA"}),(0,a.jsx)(eH,{value:e,index:2.1,children:"Community Analysis"}),(0,a.jsx)(eH,{value:e,index:3.1,children:"rCCA"}),(0,a.jsx)(eH,{value:e,index:4.1,children:"Differential Correlation Analysis"}),(0,a.jsx)(eH,{value:e,index:5.1,children:"Elastic Net"})]})]})]})}eH.propTypes={children:ee().node,index:ee().number.isRequired,value:ee().number.isRequired};var eQ=l(76500),e$=l(34989),e0=l(8088);function e1(){let e=(0,r.tc)().user.m2i.columns.map(e=>({label:e,value:e})),t=(0,r.Lq)();return(0,a.jsxs)(w.Z,{sx:{p:2,textAlign:"center"},children:[(0,a.jsx)(h.Z,{variant:"h6",children:"Please select the column containing metabolomic annotations"}),(0,a.jsx)("div",{children:(0,a.jsx)(w.Z,{sx:{width:"50%",pt:2,mx:"auto",my:2},children:(0,a.jsx)(eg.ZP,{className:"basic-single",classNamePrefix:"select",isSearchable:!0,isClearable:!0,options:e,onChange:e=>null!=e&&t({type:"set-annotations-column",column:e.value})})})})]})}function e2(){let e=(0,n.useRef)(null),[t,l]=(0,n.useState)(!0),[s,o]=(0,n.useState)([]);(0,n.useEffect)(()=>{l(!1)},[]),(0,n.useEffect)(()=>{try{var t,l;null===(l=e.current)||void 0===l||null===(t=l.scrollToIndex)||void 0===t||t.call(l,0)}catch(e){console.error(e)}},[s]);let c=(0,r.tc)().user.m2i,d=(0,r.tc)().annotations.column;if(null==d||!c.columns.includes(d))return(0,a.jsx)(a.Fragment,{});let u=dfd.toJSON(c),x=c.index.map((e,t)=>({ID:e,[d]:u[t][d]})),h=[{accessorKey:"ID",header:"ID",size:50},{accessorKey:d,header:d,size:170}];return(0,a.jsx)(i,{children:(0,a.jsx)("div",{style:{opacity:.9,width:"50%",margin:"auto"},children:(0,a.jsx)(eC.P2,{columns:h,data:x,enableBottomToolbar:!1,enableTopToolbar:!0,enableColumnResizing:!0,enableColumnVirtualization:!0,enableColumnActions:!1,enableColumnFilters:!1,enableGlobalFilterModes:!1,enableFullScreenToggle:!1,enablePinning:!1,enablePagination:!1,enableRowNumbers:!1,enableDensityToggle:!1,enableRowVirtualization:!0,muiTableContainerProps:{sx:{maxHeight:"500px"}},onSortingChange:o,state:{isLoading:t,sorting:s},rowVirtualizerInstanceRef:e,rowVirtualizerProps:{overscan:1},columnVirtualizerProps:{overscan:2}})})})}function e5(e){let{children:t,value:l,index:n,...r}=e;return(0,a.jsx)("div",{role:"tabpanel",hidden:l!==n,id:"simple-tabpanel-".concat(n),"aria-labelledby":"simple-tab-".concat(n),...r,children:l===n&&(0,a.jsx)(w.Z,{sx:{p:3},children:t})})}function e3(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function e9(e){let{setPage:t,loading:l,setLoading:n}=e,s=(0,r.Lq)(),i=(0,r.tc)(),o=(0,r.tc)().annotations.mode,c=(0,r.tc)().annotations.column,d=(0,r.tc)().user.m2i,{API_URL:u,DEV_MODE:x}=(0,y.useVars)(),h=async()=>{n(!0);let e=x?"123456":function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l="";for(let a=0;a<e;a++){let e=Math.floor(Math.random()*t.length);l+=t.charAt(e)}return l}(10);console.log("Creating job: ".concat(e)),s({type:"set-job-id",jobID:e});let l=await fetch("".concat(u,"/create_job"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...{...i,user:{xq:dfd.toJSON(i.user.xq),xm:dfd.toJSON(i.user.xm),mdata:dfd.toJSON(i.user.mdata),q2i:dfd.toJSON(i.user.q2i),m2i:dfd.toJSON(i.user.m2i)}},jobID:e})}),a=await l.json(),r={...a,user:{xq:new dfd.DataFrame(a.user.xq,{index:a.index.xq}),xm:new dfd.DataFrame(a.user.xm,{index:a.index.xm}),mdata:new dfd.DataFrame(a.user.mdata,{index:a.index.mdata}),q2i:new dfd.DataFrame(a.user.q2i,{index:a.index.q2i}),m2i:new dfd.DataFrame(a.user.m2i,{index:a.index.m2i})},norm:{xq:new dfd.DataFrame(a.norm.xq,{index:a.index.xq}),xm:new dfd.DataFrame(a.norm.xm,{index:a.index.xm})}};s({type:"set-job-context",jobContext:r}),n(!1),t("results")};return(0,a.jsxs)(w.Z,{sx:{width:"100%"},children:[(0,a.jsx)(w.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,a.jsxs)(et.Z,{value:o,onChange:(e,t)=>{s({type:"set-annotations-mode",mode:t})},"aria-label":"basic tabs example",centered:!0,children:[(0,a.jsx)(el.Z,{label:"Use my annotations",...e3(0),sx:{px:4}}),(0,a.jsx)(el.Z,{label:"Perform annotations",...e3(1),sx:{px:4}})]})}),(0,a.jsxs)(e5,{value:o,index:0,children:[(0,a.jsx)(e1,{}),(0,a.jsx)(e2,{}),null!=c&&d.columns.includes(c)&&(0,a.jsx)(w.Z,{sx:{mt:4,textAlign:"center"},children:(0,a.jsx)(Z.Z,{variant:"outlined",color:"error",onClick:e=>h(),children:"Create Job"})})]}),(0,a.jsx)(e5,{value:o,index:1,children:"Perform annotations using CMM & TP (To be developed...)"})]})}e5.propTypes={children:ee().node,index:ee().number.isRequired,value:ee().number.isRequired};var e6=l(39350);function e4(e){let{loading:t}=e;return(0,a.jsx)("div",{children:(0,a.jsx)(e6.Z,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:t,children:(0,a.jsx)(ea.Z,{color:"inherit"})})})}let e8=n.forwardRef(function(e,t){return(0,a.jsx)(e0.Z,{direction:"up",ref:t,...e})});function e7(e){let{page:t,setPage:l}=e;console.log(t);let[r,s]=(0,n.useState)(!1);return(0,a.jsx)("div",{children:(0,a.jsxs)(T.Z,{fullScreen:!0,open:"create-job"==t,TransitionComponent:e8,children:[(0,a.jsx)(eQ.Z,{sx:{position:"relative",backgroundColor:"rgba(160, 0, 0, 1)"},children:(0,a.jsxs)(e$.Z,{children:[(0,a.jsx)(k.Z,{edge:"start",color:"inherit",onClick:()=>l("new-job"),"aria-label":"close",children:(0,a.jsx)(F.Z,{})}),(0,a.jsx)(h.Z,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:"Metabolomic Putative Annotations"})]})}),(0,a.jsxs)(w.Z,{className:"m-2",children:[(0,a.jsx)(e9,{setPage:l,loading:r,setLoading:s}),(0,a.jsx)(e4,{loading:r})]})]})})}var te=l(36970);let tt=(0,n.createContext)(),tl=(0,n.createContext)();function ta(e){let{children:t}=e,[l,n]=(0,te.C)(tn,tr);return(0,a.jsx)(tt.Provider,{value:l,children:(0,a.jsx)(tl.Provider,{value:n,children:t})})}function tn(e,t){switch(console.log("Results object updated: ".concat(t.type)),console.log(t),t.type){case"set-eda-dd-groupby":e.EDA.DD.groupby=t.groupby;break;case"set-eda-dd-norm":e.EDA.DD.showNorm=t.showNorm;break;case"set-eda-dd-filter":e.EDA.DD.filterCol[t.fileType]=t.filterCol;case"set-eda-dd-filter-text":e.EDA.DD.filterText[t.fileType]=t.filterText}}let tr={EDA:{DD:{showNorm:!0,groupby:"All values",filterCol:{q2i:"All features",m2i:"All features"},filterText:{q2i:"",m2i:""}}}};function ts(){let[e,t]=(0,n.useState)("new-job");return(0,a.jsx)("div",{children:(0,a.jsx)(r.JV,{children:(0,a.jsxs)(ta,{children:[(0,a.jsx)(P,{page:e,setPage:t}),"new-job"==e&&(0,a.jsx)(i,{children:(0,a.jsx)(W,{})}),"create-job"==e&&(0,a.jsx)(e7,{page:e,setPage:t}),"find-job"==e&&(0,a.jsx)(i,{children:(0,a.jsx)(Q,{setPage:t})}),"results"==e&&(0,a.jsx)(i,{children:(0,a.jsx)(eX,{})})]})})})}},24983:function(e,t,l){"use strict";l.d(t,{JV:function(){return d},Lq:function(){return c},tc:function(){return o}});var a=l(57437),n=l(2265),r=l(36970);let s=(0,n.createContext)(null),i=(0,n.createContext)(null);function o(){return(0,n.useContext)(s)}function c(){return(0,n.useContext)(i)}function d(e){let{children:t}=e,[l,n]=(0,r.C)(u,x);return(0,a.jsx)(s.Provider,{value:l,children:(0,a.jsx)(i.Provider,{value:n,children:t})})}function u(e,t){switch(console.log("jobReducer called: ".concat(t.type)),t.type){case"find-job":return console.log("findJob"),t.results;case"user-upload":{let l=new dfd.DataFrame(t.dfJson);if(l.setIndex({column:l.columns[0],inplace:!0}),"xq"==t.fileType||"xm"==t.fileType){l.drop({columns:[l.columns[0]],inplace:!0});let a=l.isNa().sum({axis:0}).div(l.shape[0]),n=function(e,t,l){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof l)throw Error("All arguments must be numbers");if(e>t&&l>0)throw Error('The "step" value must be negative if "start" is greater than "end"');if(e<t&&l<0)throw Error('The "step" value must be positive if "start" is less than "end"');let a=[],n=e;for(;e<=t&&n<=t||e>=t&&n>=t;)a.push(n),n+=l;return a}(0,1.05,.05);n=n.map(e=>({MVThr:Math.round(100*e)/100,Features:a.le(e).sum()})),e.results.PRE.MV[t.fileType]=n}if("mdata"==t.fileType){let t=l.ctypes;t.values.map((a,n)=>{let r=t.index[n];if(a.includes("string"))e.mdataType[r]={type:"categorical"};else if(r.toLowerCase().includes("[categorical]")){let t=r.replace(/\[categorical\]/i,"");e.mdataType[t]={type:"categorical"},l.rename({[r]:t},{inplace:!0}),r=t}else a.includes("int")||a.includes("float")?e.mdataType[r]={type:"numeric"}:e.mdataType[r]={type:null};if("categorical"==e.mdataType[r].type){let t=new Set(l.column(r).values);t=(t=[...t]).filter(e=>null!=e),e.mdataType[r].nlevels=t.length,e.mdataType[r].levels=t}})}e.user[t.fileType]=l,e.userFileNames[t.fileType]=t.userFileName,e.index[t.fileType]=l.index;break}case"set-mv-thr":e.results.PRE.MVThr[t.fileType]=t.thr;break;case"set-mv-type":e.results.PRE.MVType[t.fileType]=t.MVType;break;case"set-annotations-mode":e.annotations.mode=t.mode;break;case"set-annotations-column":e.annotations.column=t.column;break;case"set-job-id":e.jobID=t.jobID;break;case"set-job-context":return t.jobContext}}let x={jobID:null,userFileNames:{xq:null,xm:null,mdata:null,q2i:null,m2i:null},user:{xq:null,xm:null,mdata:null,q2i:null,m2i:null},index:{xq:null,xm:null,mdata:null,q2i:null,m2i:null},norm:{xq:null,xm:null},mdataType:{},annotations:{mode:0,column:null},results:{PRE:{MV:{xq:null,xm:null},MVThr:{xq:.2,xm:.2},MVType:{xq:"KNN",xm:"KNN"}},EDA:null,MOFA:null,CORR:null,ML:null}}},93097:function(e){"use strict";let t=async(e,t,l)=>{let a=e.container.firstChild.cloneNode(!0),n=t.firstChild.firstChild.firstChild,r=n.children[0].cloneNode(!0),s=n.children[2].cloneNode(!0),i=window.document.createElement("div");i.style.position="relative";let o=window.document.createElement("div");o.appendChild(a),o.style.paddingLeft="20px";let c=window.document.createElement("div");c.appendChild(r);let d=window.document.createElement("div");d.style.position="absolute",d.style.top="230px",d.appendChild(s),i.appendChild(o),i.appendChild(c),i.appendChild(d);let u=new XMLSerializer().serializeToString(i),x=new Blob([u],{type:"image/svg+xml;charset=utf-8"});var h=URL.createObjectURL(x);let m=window.document.createElement("a");m.style="display:none",m.download="DataDistribution_".concat(l),m.href=h,document.body.appendChild(m),m.click(),document.body.removeChild(m),m.remove()};e.exports=t}},function(e){e.O(0,[683,122,971,596,744],function(){return e(e.s=19026)}),_N_E=e.O()}]);