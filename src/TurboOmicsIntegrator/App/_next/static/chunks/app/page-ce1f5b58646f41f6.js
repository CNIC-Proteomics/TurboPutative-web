(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{37045:function(e,t,n){Promise.resolve().then(n.bind(n,11093)),Promise.resolve().then(n.bind(n,28325)),Promise.resolve().then(n.bind(n,78686))},28325:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var l=n(57437),a=n(42824),s=n(57380),r=n(87550),i=n(57175),o=n(11093),c=n(16691),u=n.n(c);function d(){let e=(0,o.useVars)().BASE_URL;return(0,l.jsxs)(r.Z,{bg:"dark","data-bs-theme":"dark",className:"bg-body-tertiary",style:{fontSize:"1.2em"},children:[(0,l.jsxs)(a.Z,{className:"mx-0",children:[(0,l.jsx)(r.Z.Brand,{href:"#home",children:(0,l.jsx)(u(),{src:"".concat(e,"/icon.ico"),width:"30",height:"30",className:"d-inline-block align-top",alt:"TurboPutative"})}),(0,l.jsx)(r.Z.Toggle,{"aria-controls":"basic-navbar-nav"}),(0,l.jsx)(r.Z.Collapse,{id:"basic-navbar-nav",children:(0,l.jsxs)(s.Z,{className:"me-auto",children:[(0,l.jsx)(s.Z.Link,{href:"home",className:"mx-2",children:"Home"}),(0,l.jsx)(s.Z.Link,{href:"TurboOmicsApp.html",active:!0,className:"mx-2",children:"TurboOmics"}),(0,l.jsx)(s.Z.Link,{href:"webserver",className:"mx-2",children:"Web Server"}),(0,l.jsx)(s.Z.Link,{href:"webservices",className:"mx-2",children:"Web Services"}),(0,l.jsxs)(i.Z,{title:"Help",id:"basic-nav-dropdown",children:[(0,l.jsx)(i.Z.Item,{href:"webserverhelp",children:"Web Server"}),(0,l.jsx)(i.Z.Item,{href:"webserviceshelp",children:"Web Services"}),(0,l.jsx)(i.Z.Divider,{}),(0,l.jsx)(i.Z.Item,{href:"moduleshelp",children:"Modules"})]}),(0,l.jsx)(s.Z.Link,{href:"contactUs",className:"mx-2",children:"Contact us"})]})})]}),(0,l.jsx)(r.Z.Collapse,{className:"justify-content-end",children:(0,l.jsx)(r.Z.Brand,{href:"home",style:{fontSize:"1.2em"},children:"TurboPutative"})})]})}},11093:function(e,t,n){"use strict";n.r(t),n.d(t,{VarsProvider:function(){return r},useVars:function(){return i}});var l=n(57437),a=n(2265);let s=(0,a.createContext)({DEV_MODE:!0,BASE_URL:"/TurboPutative",API_URL:"http://localhost:8080/TurboPutative/api/tbomics"});function r(e){let{children:t}=e,n=i();return(0,l.jsx)(s.Provider,{value:n,children:t})}function i(){return(0,a.useContext)(s)}},78686:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eG}});var l=n(57437),a=n(2265),s=n(24983),r=n(59844);function i(e){let{children:t}=e;return(0,l.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeOut",duration:.5},children:t})}var o=n(49904),c=n(58991),u=n(62455),d=n(62970),x=n(49381),h=n(43226),m=n(15133),p=n(35843);let j=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{width:110,height:70,textAlign:"center",backgroundColor:e,cursor:t?"not-allowed":"pointer",userSelect:"none",margin:"0px 15px"}},b=(0,p.ZP)(m.Z)(e=>{let{theme:t}=e;return{transition:"transform 0.15s ease-in-out, background 0.15s","&:hover":{transform:"scale3d(1.05, 1.05, 1)",backgroundColor:"rgba(204, 229, 255, 0.8)"}}});function f(e){let t,{children:n,text:a,id:r,setPage:i,page:o}=e,c=(0,s.tc)().jobID,u="results"==r&&null==c;t=u?"rgba(210,210,210,0.8)":o==r?"rgba(204, 229, 255, 0.8)":"rgba(255,255,255,1)";let d=j(t,u);return(0,l.jsx)(l.Fragment,{children:u?(0,l.jsxs)(m.Z,{sx:d,children:[(0,l.jsx)("div",{className:"py-2",children:n}),(0,l.jsx)("div",{children:(0,l.jsx)(h.Z,{gutterBottom:!0,variant:"h7",component:"div",children:a})})]}):(0,l.jsxs)(b,{sx:d,onClick:()=>i(r),children:[(0,l.jsx)("div",{className:"py-2",children:n}),(0,l.jsx)("div",{children:(0,l.jsx)(h.Z,{gutterBottom:!0,variant:"h7",component:"div",children:a})})]})})}let g=(0,p.ZP)(m.Z)(e=>{let{theme:t}=e;return{transition:"transform 0.15s ease-in-out, background 0.15s","&:hover":{transform:"scale3d(1.05, 1.05, 1)",backgroundColor:"rgba(255, 0, 0, 0.3)"}}});function v(e){let{children:t,text:n,setPage:a}=e;return(0,l.jsxs)(g,{sx:{...j("rgba(255, 0, 0, 0.2)"),position:"absolute",right:"12%"},onClick:()=>a("create-job"),children:[(0,l.jsx)("div",{className:"py-2",children:t}),(0,l.jsx)("div",{children:(0,l.jsx)(h.Z,{gutterBottom:!0,variant:"h7",component:"div",children:n})})]})}var y=n(11093),Z=n(35551);function P(e){let{children:t,page:n}=e,a=(0,y.useVars)().API_URL,r=(0,s.Lq)(),i=async e=>{console.log("Loading sample data");let t=await fetch("".concat(a,"/load_sample_data")),n=await t.json();Object.keys(n).forEach(e=>{r({type:"user-upload",fileType:e,userFileName:"".concat(e,".tsv"),dfJson:n[e]})})};return(0,l.jsx)("div",{className:"align-self-center",style:{position:"absolute",left:"10%"},children:(0,l.jsx)(Z.Z,{variant:"outlined",startIcon:t,onClick:i,children:"Load Sample Data"})})}function N(e){let{page:t,setPage:n}=e,{jobID:a,user:r}=(0,s.tc)();return(0,l.jsxs)("div",{className:"my-2 d-flex justify-content-center",children:["new-job"==t&&(0,l.jsx)(P,{page:t,children:(0,l.jsx)(x.Z,{})}),(0,l.jsx)(f,{text:"New Job",id:"new-job",setPage:n,page:t,children:(0,l.jsx)(o.Z,{})}),(0,l.jsx)(f,{text:"Find Job",id:"find-job",setPage:n,page:t,children:(0,l.jsx)(c.Z,{})}),(0,l.jsx)(f,{text:"Results",id:"results",setPage:n,page:t,children:(0,l.jsx)(u.Z,{})}),"new-job"==t&&r.mdata&&(r.xm&&r.m2i||r.xq&&r.q2i)&&(0,l.jsx)(i,{children:(0,l.jsx)(v,{text:"Create Job",setPage:n,children:(0,l.jsx)(d.Z,{})})})]})}var C=n(96507),T=n(11922),A=n(89394),w=n(91797),D=n(26337),S=n(52653),k=n(6252),I=n(33533);n(16691);let q=(0,p.ZP)(A.Z)(e=>{let{theme:t}=e;return{"& .MuiDialogContent-root":{padding:t.spacing(2)},"& .MuiDialogActions-root":{padding:t.spacing(1)}}});function F(e){let{title:t}=e,[n,s]=(0,a.useState)(!1),r=()=>s(!1),i=(0,y.useVars)().BASE_URL;return(0,l.jsxs)("div",{className:"mt-0 pt-0",children:[(0,l.jsx)(S.Z,{onClick:()=>s(!0),children:(0,l.jsx)(k.Z,{})}),(0,l.jsxs)(q,{onClose:r,"aria-labelledby":"customized-dialog-title",open:n,maxWidth:"md",children:[(0,l.jsxs)(w.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:[t," Table"]}),(0,l.jsx)(S.Z,{"aria-label":"close",onClick:r,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]},children:(0,l.jsx)(I.Z,{})}),(0,l.jsxs)(D.Z,{dividers:!0,children:[(0,l.jsx)(h.Z,{gutterBottom:!0,children:"Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1Paragraph 1"}),(0,l.jsx)(h.Z,{gutterBottom:!0,children:"Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2Paragraph 2"}),(0,l.jsx)("div",{className:"text-center mt-3",children:(0,l.jsx)("img",{src:"".concat(i,"/table.png"),alt:"Table"})})]})]})]})}let M=["","#N/A","#N/A","N/A","#NA","-1.#IND","-1.#QNAN","-NaN","-nan","1.#IND","1.#QNAN","<NA>","N/A","NA","NULL","NaN","None","n/a","nan","null"],E=["TSV"];function R(e){let{title:t,fileType:n}=e,a=(0,s.tc)().userFileNames[n],r=(0,s.Lq)();async function i(e){let t=await e.text(),l=await function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"	";return new Promise(n=>{let l=e.split(/[\r\n]+/);if(l.length<2)throw Error("String text does not have expected DataFrame format");let a=l[0].split(t).map(e=>e.trim()),s=[];for(let e=1;e<l.length;e++){let n=l[e].split(t).map(e=>e.trim());if(n.length===a.length){let e={};for(let t=0;t<a.length;t++)e[a[t]]=M.includes(n[t])?void 0:n[t];s.push(e)}else console.log(n),console.log("Row number ".concat(e," could not be read"))}n(s)})}(t);r({type:"user-upload",fileType:n,userFileName:e.name,dfJson:l})}return(0,l.jsx)("div",{className:"DragFile mx-2 text-center",style:{width:"30%"},children:(0,l.jsxs)(m.Z,{variant:"outlined",className:"px-4 ".concat(a&&"border-dark"),style:{transition:"all 1s ease"},children:[(0,l.jsx)(h.Z,{variant:"h6",className:"pt-2",children:t}),(0,l.jsx)(F,{title:t}),(0,l.jsx)(T.b,{multiple:!1,handleChange:i,name:n,types:E}),(0,l.jsx)("p",{className:"mt-3",children:a?"File name: ".concat(a):"no files uploaded yet"})]})})}var O=n(73701),L=n(39279),V=n(30666),z=n(15795),J=n(98489),B=n(29872),_=n(39190);let U=(0,_.Z)(V.Z)(e=>{let{theme:t}=e;return{textAlign:"center"}});function K(){let e=(0,s.tc)().results.PRE.MVThr.xq,t=(0,s.tc)().results.PRE.MVThr.xm,n=(0,s.tc)().user;return(0,l.jsx)(z.Z,{component:B.Z,sx:{width:300},children:(0,l.jsx)(O.Z,{size:"small","aria-label":"a dense table",children:(0,l.jsxs)(L.Z,{children:[null!=n.mdata&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(J.Z,{children:[(0,l.jsx)(U,{children:"n"}),(0,l.jsx)(U,{children:n.mdata.shape[0]})]}),(0,l.jsxs)(J.Z,{children:[(0,l.jsx)(U,{children:"Meta-variables"}),(0,l.jsx)(U,{children:n.mdata.shape[1]})]})]}),null!=n.xq&&(0,l.jsxs)(J.Z,{children:[(0,l.jsx)(U,{children:"Proteomic features"}),(0,l.jsxs)(U,{children:[n.xq.isNa().sum({axis:0}).div(n.xq.shape[0]).le(e).sum()," / ",n.xq.shape[1]]})]}),null!=n.xm&&(0,l.jsxs)(J.Z,{children:[(0,l.jsx)(U,{children:"Metabolomic features"}),(0,l.jsxs)(U,{children:[n.xm.isNa().sum({axis:0}).div(n.xm.shape[0]).le(t).sum()," / ",n.xm.shape[1]]})]})]})})})}var G=n(98864),Y=n.n(G);let H=Y()(()=>n.e(362).then(n.bind(n,84362)),{loadableGenerated:{webpack:()=>[84362]},ssr:!1});function W(){return(0,l.jsxs)(C.Z,{sx:{width:"100%"},className:"p-2",children:[(0,l.jsxs)("div",{className:"py-2 d-flex justify-content-between",children:[(0,l.jsx)(R,{title:"Proteomic Metadata",fileType:"q2i"}),(0,l.jsx)(R,{title:"Metadata",fileType:"mdata"}),(0,l.jsx)(R,{title:"Metabolomic Metadata",fileType:"m2i"})]}),(0,l.jsxs)("div",{className:"py-2 d-flex justify-content-between align-items-center",children:[(0,l.jsx)(R,{title:"Proteomic Quantifications",fileType:"xq"}),(0,l.jsx)(K,{}),(0,l.jsx)(R,{title:"Metabolomic Quantifications",fileType:"xm"})]}),(0,l.jsxs)("div",{className:"py-2 d-flex justify-content-between",children:[(0,l.jsx)(H,{fileType:"xq",omic:"Proteomic"}),(0,l.jsx)(H,{fileType:"xm",omic:"Metabolomic"})]})]})}var Q=n(99960);function X(e){let{setPage:t}=e,[n,r]=(0,a.useState)(""),[i,o]=(0,a.useState)(!0),u=(0,s.Lq)(),d=(0,y.useVars)().API_URL;async function x(e){console.log("Search Job ID: ".concat(e));let n=await fetch("".concat(d,"/search/").concat(e)),l=await n.json();console.log("Server response received:"),l.exist?(u({type:"find-job",results:l.results}),t("results")):o(!1)}return(0,l.jsx)("div",{className:"mx-auto mt-4 text-center",children:(0,l.jsx)(Q.Z,{id:"outlined-basic",label:"Search Job",variant:"outlined",onChange:e=>{r(e.target.value),o(!0)},value:n,InputProps:{endAdornment:(0,l.jsx)(()=>(0,l.jsx)(S.Z,{onClick:()=>x(n),children:(0,l.jsx)(c.Z,{})}),{})},sx:{width:"70%",marginTop:"20%"},autoFocus:!0,error:!i,helperText:!i&&"Job not found"})})}var $=n(74275),ee=n.n($),et=n(19045),en=n(92277),el=n(28874),ea=n(36970);let es=(0,a.createContext)(),er=(0,a.createContext)();function ei(e){let{children:t}=e,[n,a]=(0,ea.C)(eo,ec);return(0,l.jsx)(es.Provider,{value:n,children:(0,l.jsx)(er.Provider,{value:a,children:t})})}function eo(e,t){switch(console.log("Results object updated: ".concat(t.type)),console.log(t),t.type){case"set-eda-dd-groupby":e.EDA.DD.groupby=t.groupby;break;case"set-eda-dd-norm":e.EDA.DD.showNorm=t.showNorm;break;case"set-eda-dd-filter":e.EDA.DD.filterCol[t.fileType]=t.filterCol;case"set-eda-dd-filter-text":e.EDA.DD.filterText[t.fileType]=t.filterText}}let ec={EDA:{DD:{showNorm:!0,groupby:"All values",filterCol:{q2i:"All features",m2i:"All features"},filterText:{q2i:"",m2i:""}}}};function eu(e,t){let n=e.slice().sort((e,t)=>e-t),l=Math.floor(n.length*t),a=n[l];return a}var ed=n(6882),ex=n(90045),eh=n(16573),em=n(24235),ep=n(50039),ej=n(2047),eb=n(51125);let ef=["#636EFA","#EF553B","#00CC96","#AB63FA","#FFA15A","#19D3F3","#FF6692","#B6E880","#FF97FF","#FECB52"];function eg(e){let{dataHist:t,gValues:n,range:a,xTicks:s}=e;return(0,l.jsxs)(ex.T,{style:{margin:"auto"},width:500,height:230,data:t,margin:{top:10,right:30,left:0,bottom:0},children:[(0,l.jsx)(eh.q,{strokeDasharray:"3 3"}),(0,l.jsx)(em.K,{dataKey:"binCenter",type:"number",ticks:s,domain:a}),(0,l.jsx)(ep.B,{}),(0,l.jsx)(ej.u,{}),n.map((e,t)=>(0,l.jsx)(eb.u,{connectNulls:!0,type:"monotone",dataKey:e,fillOpacity:.3,stroke:ef[t%ef.length],fill:ef[t%ef.length]},e))]})}let ev=Y()(()=>Promise.all([n.e(934),n.e(901)]).then(n.bind(n,87022)),{loadableGenerated:{webpack:()=>[87022]},ssr:!1});function ey(e){let{data:t,range:n,xTicks:a}=e;return ef[0],ef[1],(0,l.jsx)(ev,{style:{position:"relative",left:-20},data:t,layout:{width:570,height:330,showlegend:!0,legend:{orientation:"h"},xaxis:{zeroline:!1,range:n,tickvals:a},yaxis:{type:"category",showticklabels:!1},margin:{t:0}},config:{staticPlot:!1,displayModeBar:!1},onChange:e=>console.log(e)})}function eZ(e){let{omic:t,fileType:n,showPlot:r,filteredID:o,groupby:c,showNorm:u,pvalue:d,setPvalue:x}=e,{API_URL:m}=(0,y.useVars)(),{jobID:p}=(0,s.tc)(),j=(0,s.tc)().user.mdata,b={norm:(0,s.tc)().norm[n],user:(0,s.tc)().user[n]},f=u?b.norm:b.user,{myData:g,dataAnova:v,gValues:Z,idx2g:P}=(0,a.useMemo)(()=>{let e;let t={};for(let e=0;e<j.shape[0];e++)t[j.index[e]]=j.columns.includes(c)?j.column(c).values[e]:"All values";let n=Object.keys(t).map(e=>t[e]).filter((e,t,n)=>n.indexOf(e)===t),l=[],a={};n.map(e=>a[e]=[]);let s=(e={},dfd.toJSON(f).map((t,n)=>{e[f.index[n]]=t}),e);return Object.keys(s).map(e=>{Object.keys(t).includes(e)&&Object.keys(s[e]).map(n=>{null!=s[e][n]&&o.includes(n)&&(a[t[e]].push(s[e][n]),l.push({ID:e,feature:n,g:t[e],x:s[e][n]}))})}),{myData:a,dataAnova:l,gValues:n,idx2g:t}},[c,j,f,o]),{range:N,xTicks:T,minimum:A,maximum:w}=(0,a.useMemo)(e=>{let t=Object.keys(g).map(e=>g[e]).flat(),n=eu(t,1e-4),l=eu(t,.9999),a=[n-Math.abs(.05*n),l+Math.abs(.05*l)],s=function(e,t,n){let l=(t-e)/(n-1),a=[];for(let t=0;t<n;t++){let n=e+t*l;a.push(n)}return a.filter(e=>e<0).length>0&&a.filter(e=>e>0).length>0&&a.push(0),a.sort((e,t)=>e-t),a=a.map(e=>Math.floor(100*e)/100)}(n,l,6);return{range:a,xTicks:s,minimum:n,maximum:l}},[g]),D=(0,a.useMemo)(()=>{let e={};return Object.keys(g).map(t=>{e[t]=g[t].filter(e=>A<=e&&e<=w)}),Object.keys(e).map(t=>{try{e[t].length>0?e[t]=function(e,t){let n=Math.min(...e),l=(Math.max(...e)-n)/t,a=Array(t).fill(0);e.forEach(e=>{let s=Math.floor((e-n)/l);s>=0&&s<t&&a[s]++});let s=a.map(t=>t/(e.length*l)),r=Array(t).fill(0).map((e,t)=>n+(t+.5)*l),i=[];for(let e=0;e<t;e++)i.push({binCenter:r[e],density:s[e]});return i}(e[t],1+Math.ceil(Math.log2(e[t].length))):delete e[t]}catch(e){console.error(e)}}),(e=(e=Object.keys(e).map(t=>e[t].map(e=>{let{binCenter:n,density:l}=e;return{binCenter:Math.round(100*n)/100,[t]:l}}))).flat()).sort((e,t)=>e.binCenter-t.binCenter),e},[g,A,w]),S=(0,a.useMemo)(()=>Object.keys(g).map((e,t)=>g[e].length>0?{x:g[e],type:"box",name:"".concat(e),marker:{color:ef[t]}}:null).filter(e=>null!=e),[g]);return(0,a.useEffect)(()=>{console.log("useEffect: Calculating ANOVA");let e=setTimeout(()=>{fetch("".concat(m,"/get_anova"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataAnova:v,jobID:p})}).then(e=>e.json()).then(e=>x(n=>({...n,[t]:e.pvalue}))),console.log("Anova was calculated")},2e3);return()=>clearTimeout(e)},[v,m,p,x,t]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(C.Z,{sx:{height:"2vh",margin:"auto",width:380},children:r&&null!=d&&(0,l.jsx)(i,{children:(0,l.jsxs)(h.Z,{variant:"body2",sx:{color:"#555555"},children:["ANOVA pvalue: ",d]})})}),(0,l.jsx)(C.Z,{sx:{height:"25vh"},children:r?(0,l.jsx)(eg,{dataHist:D,gValues:Z,range:N,xTicks:T}):(0,l.jsx)(C.Z,{sx:{textAlign:"center",pt:10},children:(0,l.jsx)(ed.Z,{size:100,thickness:2})})}),(0,l.jsx)(C.Z,{sx:{height:"37vh",width:500,margin:"auto",overflowX:"hidden",overflowY:"visible"},children:r?(0,l.jsx)(i,{children:(0,l.jsx)(ey,{data:S,range:N,xTicks:T})}):(0,l.jsx)(C.Z,{sx:{textAlign:"center",pt:15},children:(0,l.jsx)(ed.Z,{size:100,thickness:2})})})]})}var eP=n(40182),eN=n(45421),eC=n(97472);function eT(e){let{options:t,value:n,onChange:a,label:s}=e;return(0,l.jsxs)(C.Z,{children:[(0,l.jsx)("label",{id:"aria-label",htmlFor:"aria-example-input",children:s}),(0,l.jsx)(eC.ZP,{"aria-labelledby":"aria-label",inputId:"aria-example-input",className:"basic-single",classNamePrefix:"select",placeholder:"",isSearchable:!0,isClearable:!1,options:t,value:n,onChange:a})]})}function eA(e){let{checked:t,onChange:n,label:a}=e;return(0,l.jsx)(eP.Z,{control:(0,l.jsx)(eN.Z,{checked:t,onChange:n}),label:a})}var ew=n(43560);function eD(e){let{columns:t,data:n}=e,s=(0,a.useRef)(null),[r,o]=(0,a.useState)(!0),[c,u]=(0,a.useState)([]);return(0,a.useEffect)(()=>{o(!1)},[]),(0,a.useEffect)(()=>{try{var e,t;null===(t=s.current)||void 0===t||null===(e=t.scrollToIndex)||void 0===e||e.call(t,0)}catch(e){console.error(e)}},[c]),(0,l.jsx)(i,{children:(0,l.jsx)("div",{style:{opacity:.9,width:"100%",margin:"auto"},children:(0,l.jsx)(ew.P2,{columns:t,data:n,enableBottomToolbar:!1,enableTopToolbar:!1,enableColumnResizing:!0,enableColumnVirtualization:!0,enableColumnActions:!1,enableColumnFilters:!1,enableGlobalFilterModes:!1,enableFullScreenToggle:!1,enablePinning:!1,enablePagination:!1,enableRowNumbers:!1,enableDensityToggle:!1,enableRowVirtualization:!0,muiTableContainerProps:{sx:{maxHeight:"500px"}},onSortingChange:u,state:{isLoading:r,sorting:c},rowVirtualizerInstanceRef:s,rowVirtualizerProps:{overscan:1},columnVirtualizerProps:{overscan:2}})})})}function eS(e){let{omic:t,fileType:n,filteredID:r,setFilteredID:o,updatePlot:c}=e,[u,d]=(0,a.useState)(""),[x,h]=(0,a.useState)("All features"),m=(0,s.tc)().user[n],{filteredFeatures:p,columns:j}=(0,a.useMemo)(()=>{console.log("calculating filteredFeatures");let e={},t=[{accessorKey:"ID",header:"ID",size:50}];return m.columns.includes(x)?(e=(e=(e=m.column(x)).values.map((t,n)=>({ID:e.index[n],[x]:t}))).filter(e=>null!=e[x]&&"".concat(e[x]).toLowerCase().includes(u.toLowerCase())),t.push({accessorKey:x,header:x,size:170})):e=(e=m.index).map((e,t)=>({ID:e})),{filteredFeatures:e,columns:t}},[u,x,m]);return(0,a.useEffect)(()=>{console.log("Recalculating features");let e=p.map(e=>e.ID);if(e.every(e=>r.includes(e))&&r.every(t=>e.includes(t)))return;let l=setTimeout(()=>{o(e=>({...e,[n]:p.map(e=>e.ID)})),c([t])},500);return()=>clearTimeout(l)},[p,n,o,c,r,t]),(0,l.jsxs)(C.Z,{sx:{width:"95%",margin:"auto"},children:[(0,l.jsxs)(C.Z,{sx:{display:"flex",height:"8vh"},children:[(0,l.jsx)(C.Z,{sx:{width:"40%",pt:1},children:(0,l.jsx)(eT,{options:[{label:"All features",value:"All features"},...m.columns.map(e=>({label:e,value:e}))],onChange:e=>{h(e.value)},value:{label:x,value:x}})}),m.columns.includes(x)&&(0,l.jsx)(i,{children:(0,l.jsx)(C.Z,{sx:{mt:3,ml:3},children:(0,l.jsx)(Q.Z,{id:"standard-name",placeholder:"Filter text",value:u,onChange:e=>d(e.target.value)})})})]}),(0,l.jsx)(C.Z,{sx:{mt:2},children:(0,l.jsx)(eD,{data:p,columns:j})})]})}function ek(){let[e,t]=(0,a.useState)({q:!1,m:!1}),[n,r]=(0,a.useState)({q2i:[],m2i:[]}),[o,c]=(0,a.useState)({q:null,m:null}),[u,d]=(0,a.useState)(!0),[x,m]=(0,a.useState)({label:"All values",value:"All values"}),[p,j]=(0,a.useState)({q2i:"",m2i:""}),b=(0,s.tc)().user.mdata.columns.map(e=>({label:e,value:e}));b=[{label:"All values",value:"All values"},...b];let f=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["q","m"];e.map(e=>{t(t=>({...t,[e]:!1})),c(t=>({...t,[e]:null}))}),e.map(e=>setTimeout(()=>t(t=>({...t,[e]:!0})),2e3))},[]),g=(0,a.useCallback)(e=>{m({label:e.value,value:e.value}),f(["q","m"])},[f]),v=(0,a.useCallback)(e=>{d(!u),f(["q","m"])},[u,f]);return(0,l.jsxs)(C.Z,{children:[(0,l.jsxs)(el.ZP,{container:!0,direction:"row",justifyContent:"center",alignItems:"center",sx:{mb:3,mt:0},children:[(0,l.jsx)(el.ZP,{item:!0,xs:2,children:(0,l.jsx)(eA,{checked:u,onChange:v,label:"Normalized"})}),(0,l.jsx)(el.ZP,{item:!0,xs:3,children:(0,l.jsx)(eT,{options:b,onChange:g,value:x,label:"Group by"})})]}),(0,l.jsx)(C.Z,{sx:{flexGrow:1,p:0,mt:0},children:(0,l.jsxs)(el.ZP,{container:!0,direction:"row",justifyContent:"center",spacing:2,sx:{p:1},children:[(0,l.jsxs)(el.ZP,{item:!0,sx:{borderRight:"1px solid #cccccc"},xs:6,children:[(0,l.jsx)(h.Z,{variant:"h6",sx:{textAlign:"center",color:"#555555"},children:"Proteomics"}),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(eZ,{omic:"q",fileType:"xq",showPlot:e.q,filteredID:n.q2i,groupby:x.value,showNorm:u,pvalue:o.q,setPvalue:c}),(0,l.jsx)(eS,{omic:"q",fileType:"q2i",setFilteredID:r,updatePlot:f,filteredID:n.q2i})]})]}),(0,l.jsxs)(el.ZP,{item:!0,xs:6,sx:{borderLeft:"1px solid #cccccc"},children:[(0,l.jsx)(h.Z,{variant:"h6",sx:{textAlign:"center",color:"#555555"},children:"Metabolomics"}),(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(i,{children:[(0,l.jsx)(eZ,{omic:"m",fileType:"xm",showPlot:e.m,filteredID:n.m2i,groupby:x.value,showNorm:u,pvalue:o.m,setPvalue:c}),(0,l.jsx)(eS,{omic:"m",fileType:"m2i",setFilteredID:r,updatePlot:f,filteredID:n.m2i})]})})]})]})})]})}function eI(e){let{children:t,value:n,index:a,...s}=e;return(0,l.jsx)("div",{role:"tabpanel",hidden:n!==a,id:"vertical-tabpanel-".concat(a),"aria-labelledby":"vertical-tab-".concat(a),...s,children:n===a&&(0,l.jsx)(C.Z,{sx:{p:3},children:(0,l.jsx)(h.Z,{children:t})})})}function eq(e){return{id:"vertical-tab-".concat(e),"aria-controls":"vertical-tabpanel-".concat(e)}}function eF(){let[e,t]=(0,a.useState)(.1),n=Math.floor(e),r=(0,s.tc)().jobID;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(h.Z,{variant:"body2",sx:{textAlign:"right",pr:4},children:["Job ID: ",r]}),(0,l.jsxs)(C.Z,{sx:{flexGrow:1,bgcolor:"background.paper",display:"flex",height:"80vh"},children:[(0,l.jsxs)(et.Z,{orientation:"vertical",value:e,onChange:(e,n)=>{t(n)},"aria-label":"Vertical tabs example",sx:{borderRight:1,borderColor:"divider",width:"15%"},children:[(0,l.jsx)(en.Z,{label:"EXPLORATORY DATA ANALYSIS",value:.1,...eq(0),sx:{mt:2,p:0,color:0==n?"#1976d2":"#00000099"}}),0==n&&(0,l.jsx)(en.Z,{label:"DATA DISTRIBUTION",value:.1,...eq(1),sx:{fontSize:12,m:0,p:0,borderTop:"1px solid #cccccc"}}),0==n&&(0,l.jsx)(en.Z,{label:"PCA",value:.2,...eq(2),sx:{fontSize:12,m:0,p:0,borderBottom:"1px solid #cccccc"}}),(0,l.jsx)(en.Z,{label:"MULTIOMICS FACTOR ANALYSIS",value:1.1,...eq(1),sx:{mt:2}}),(0,l.jsx)(en.Z,{label:"COMMUNITY ANALYSIS",value:2.1,...eq(3),sx:{mt:2}}),(0,l.jsx)(en.Z,{label:"REGULARIZED CANONICAL CORRELATION ANALYSIS",value:3.1,...eq(4),sx:{mt:2}}),(0,l.jsx)(en.Z,{label:"DIFFERENTIAL CORRELATION ANALYSIS",value:4.1,...eq(5),sx:{mt:2}}),(0,l.jsx)(en.Z,{label:"ELASTIC NET",value:5.1,...eq(6),sx:{mt:2}})]}),(0,l.jsxs)(C.Z,{sx:{width:"85%"},children:[.1==e&&(0,l.jsx)(C.Z,{sx:{p:1,borderTop:"1px solid #cccccc"},children:(0,l.jsx)(ek,{})}),(0,l.jsx)(eI,{value:e,index:.2,children:"PCA"}),(0,l.jsx)(eI,{value:e,index:1.1,children:"MOFA"}),(0,l.jsx)(eI,{value:e,index:2.1,children:"Community Analysis"}),(0,l.jsx)(eI,{value:e,index:3.1,children:"rCCA"}),(0,l.jsx)(eI,{value:e,index:4.1,children:"Differential Correlation Analysis"}),(0,l.jsx)(eI,{value:e,index:5.1,children:"Elastic Net"})]})]})]})}eI.propTypes={children:ee().node,index:ee().number.isRequired,value:ee().number.isRequired};var eM=n(76500),eE=n(34989),eR=n(8088);function eO(){let e=(0,s.tc)().user.m2i.columns.map(e=>({label:e,value:e})),t=(0,s.Lq)();return(0,l.jsxs)(C.Z,{sx:{p:2,textAlign:"center"},children:[(0,l.jsx)(h.Z,{variant:"h6",children:"Please select the column containing metabolomic annotations"}),(0,l.jsx)("div",{children:(0,l.jsx)(C.Z,{sx:{width:"50%",pt:2,mx:"auto",my:2},children:(0,l.jsx)(eC.ZP,{className:"basic-single",classNamePrefix:"select",isSearchable:!0,isClearable:!0,options:e,onChange:e=>null!=e&&t({type:"set-annotations-column",column:e.value})})})})]})}function eL(){let e=(0,a.useRef)(null),[t,n]=(0,a.useState)(!0),[r,o]=(0,a.useState)([]);(0,a.useEffect)(()=>{n(!1)},[]),(0,a.useEffect)(()=>{try{var t,n;null===(n=e.current)||void 0===n||null===(t=n.scrollToIndex)||void 0===t||t.call(n,0)}catch(e){console.error(e)}},[r]);let c=(0,s.tc)().user.m2i,u=(0,s.tc)().annotations.column;if(null==u||!c.columns.includes(u))return(0,l.jsx)(l.Fragment,{});let d=dfd.toJSON(c),x=c.index.map((e,t)=>({ID:e,[u]:d[t][u]})),h=[{accessorKey:"ID",header:"ID",size:50},{accessorKey:u,header:u,size:170}];return(0,l.jsx)(i,{children:(0,l.jsx)("div",{style:{opacity:.9,width:"50%",margin:"auto"},children:(0,l.jsx)(ew.P2,{columns:h,data:x,enableBottomToolbar:!1,enableTopToolbar:!0,enableColumnResizing:!0,enableColumnVirtualization:!0,enableColumnActions:!1,enableColumnFilters:!1,enableGlobalFilterModes:!1,enableFullScreenToggle:!1,enablePinning:!1,enablePagination:!1,enableRowNumbers:!1,enableDensityToggle:!1,enableRowVirtualization:!0,muiTableContainerProps:{sx:{maxHeight:"500px"}},onSortingChange:o,state:{isLoading:t,sorting:r},rowVirtualizerInstanceRef:e,rowVirtualizerProps:{overscan:1},columnVirtualizerProps:{overscan:2}})})})}function eV(e){let{children:t,value:n,index:a,...s}=e;return(0,l.jsx)("div",{role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a),...s,children:n===a&&(0,l.jsx)(C.Z,{sx:{p:3},children:t})})}function ez(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function eJ(e){let{setPage:t,loading:n,setLoading:a}=e,r=(0,s.Lq)(),i=(0,s.tc)(),o=(0,s.tc)().annotations.mode,c=(0,s.tc)().annotations.column,u=(0,s.tc)().user.m2i,{API_URL:d,DEV_MODE:x}=(0,y.useVars)(),h=async()=>{a(!0);let e=x?"123456":function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="";for(let l=0;l<e;l++){let e=Math.floor(Math.random()*t.length);n+=t.charAt(e)}return n}(10);console.log("Creating job: ".concat(e)),r({type:"set-job-id",jobID:e});let n=await fetch("".concat(d,"/create_job"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...{...i,user:{xq:dfd.toJSON(i.user.xq),xm:dfd.toJSON(i.user.xm),mdata:dfd.toJSON(i.user.mdata),q2i:dfd.toJSON(i.user.q2i),m2i:dfd.toJSON(i.user.m2i)}},jobID:e})}),l=await n.json(),s={...l,user:{xq:new dfd.DataFrame(l.user.xq,{index:l.index.xq}),xm:new dfd.DataFrame(l.user.xm,{index:l.index.xm}),mdata:new dfd.DataFrame(l.user.mdata,{index:l.index.mdata}),q2i:new dfd.DataFrame(l.user.q2i,{index:l.index.q2i}),m2i:new dfd.DataFrame(l.user.m2i,{index:l.index.m2i})},norm:{xq:new dfd.DataFrame(l.norm.xq,{index:l.index.xq}),xm:new dfd.DataFrame(l.norm.xm,{index:l.index.xm})}};r({type:"set-job-context",jobContext:s}),a(!1),t("results")};return(0,l.jsxs)(C.Z,{sx:{width:"100%"},children:[(0,l.jsx)(C.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,l.jsxs)(et.Z,{value:o,onChange:(e,t)=>{r({type:"set-annotations-mode",mode:t})},"aria-label":"basic tabs example",centered:!0,children:[(0,l.jsx)(en.Z,{label:"Use my annotations",...ez(0),sx:{px:4}}),(0,l.jsx)(en.Z,{label:"Perform annotations",...ez(1),sx:{px:4}})]})}),(0,l.jsxs)(eV,{value:o,index:0,children:[(0,l.jsx)(eO,{}),(0,l.jsx)(eL,{}),null!=c&&u.columns.includes(c)&&(0,l.jsx)(C.Z,{sx:{mt:4,textAlign:"center"},children:(0,l.jsx)(Z.Z,{variant:"outlined",color:"error",onClick:e=>h(),children:"Create Job"})})]}),(0,l.jsx)(eV,{value:o,index:1,children:"Perform annotations using CMM & TP (To be developed...)"})]})}n(50553),eV.propTypes={children:ee().node,index:ee().number.isRequired,value:ee().number.isRequired};var eB=n(39350);function e_(e){let{loading:t}=e;return(0,l.jsx)("div",{children:(0,l.jsx)(eB.Z,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:t,children:(0,l.jsx)(ed.Z,{color:"inherit"})})})}let eU=a.forwardRef(function(e,t){return(0,l.jsx)(eR.Z,{direction:"up",ref:t,...e})});function eK(e){let{page:t,setPage:n}=e;console.log(t);let[s,r]=(0,a.useState)(!1);return(0,l.jsx)("div",{children:(0,l.jsxs)(A.Z,{fullScreen:!0,open:"create-job"==t,TransitionComponent:eU,children:[(0,l.jsx)(eM.Z,{sx:{position:"relative",backgroundColor:"rgba(160, 0, 0, 1)"},children:(0,l.jsxs)(eE.Z,{children:[(0,l.jsx)(S.Z,{edge:"start",color:"inherit",onClick:()=>n("new-job"),"aria-label":"close",children:(0,l.jsx)(I.Z,{})}),(0,l.jsx)(h.Z,{sx:{ml:2,flex:1},variant:"h6",component:"div",children:"Metabolomic Putative Annotations"})]})}),(0,l.jsxs)(C.Z,{className:"m-2",children:[(0,l.jsx)(eJ,{setPage:n,loading:s,setLoading:r}),(0,l.jsx)(e_,{loading:s})]})]})})}function eG(){let[e,t]=(0,a.useState)("new-job");return(0,l.jsx)("div",{children:(0,l.jsx)(s.JV,{children:(0,l.jsxs)(ei,{children:[(0,l.jsx)(N,{page:e,setPage:t}),"new-job"==e&&(0,l.jsx)(i,{children:(0,l.jsx)(W,{})}),"create-job"==e&&(0,l.jsx)(eK,{page:e,setPage:t}),"find-job"==e&&(0,l.jsx)(i,{children:(0,l.jsx)(X,{setPage:t})}),"results"==e&&(0,l.jsx)(i,{children:(0,l.jsx)(eF,{})})]})})})}},24983:function(e,t,n){"use strict";n.d(t,{JV:function(){return u},Lq:function(){return c},tc:function(){return o}});var l=n(57437),a=n(2265),s=n(36970);let r=(0,a.createContext)(null),i=(0,a.createContext)(null);function o(){return(0,a.useContext)(r)}function c(){return(0,a.useContext)(i)}function u(e){let{children:t}=e,[n,a]=(0,s.C)(d,x);return(0,l.jsx)(r.Provider,{value:n,children:(0,l.jsx)(i.Provider,{value:a,children:t})})}function d(e,t){switch(console.log("jobReducer called: ".concat(t.type)),t.type){case"find-job":return console.log("findJob"),t.results;case"user-upload":{let n=new dfd.DataFrame(t.dfJson);if(n.setIndex({column:n.columns[0],inplace:!0}),"xq"==t.fileType||"xm"==t.fileType){n.drop({columns:[n.columns[0]],inplace:!0});let l=n.isNa().sum({axis:0}).div(n.shape[0]),a=function(e,t,n){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof n)throw Error("All arguments must be numbers");if(e>t&&n>0)throw Error('The "step" value must be negative if "start" is greater than "end"');if(e<t&&n<0)throw Error('The "step" value must be positive if "start" is less than "end"');let l=[],a=e;for(;e<=t&&a<=t||e>=t&&a>=t;)l.push(a),a+=n;return l}(0,1.05,.05);a=a.map(e=>({MVThr:Math.round(100*e)/100,Features:l.le(e).sum()})),e.results.PRE.MV[t.fileType]=a}e.user[t.fileType]=n,e.userFileNames[t.fileType]=t.userFileName,e.index[t.fileType]=n.index;break}case"set-mv-thr":e.results.PRE.MVThr[t.fileType]=t.thr;break;case"set-mv-type":e.results.PRE.MVType[t.fileType]=t.MVType;break;case"set-annotations-mode":e.annotations.mode=t.mode;break;case"set-annotations-column":e.annotations.column=t.column;break;case"set-job-id":e.jobID=t.jobID;break;case"set-job-context":return t.jobContext}}let x={jobID:null,userFileNames:{xq:null,xm:null,mdata:null,q2i:null,m2i:null},user:{xq:null,xm:null,mdata:null,q2i:null,m2i:null},index:{xq:null,xm:null,mdata:null,q2i:null,m2i:null},norm:{xq:null,xm:null},annotations:{mode:0,column:null},results:{PRE:{MV:{xq:null,xm:null},MVThr:{xq:.2,xm:.2},MVType:{xq:"KNN",xm:"KNN"}},EDA:null,MOFA:null,CORR:null,ML:null}}}},function(e){e.O(0,[625,163,960,8,898,365,683,978,971,596,744],function(){return e(e.s=37045)}),_N_E=e.O()}]);